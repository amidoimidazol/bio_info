<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../displayToc.js"></script>
<script language="JavaScript" src="../../tocParas.js"></script>
<script language="JavaScript" src="../../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../../scineplex.css">
<title></title>
<link rel="stylesheet" href="../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#Data:-Numbers">Data: Numbers</a>
    <ul>
      <li><a href="#Why-am-I-getting-long-decimals-eg-19.9499999999999-instead-of-the-numbers-I-should-be-getting-eg-19.95-">Why am I getting long decimals (eg, 19.9499999999999) instead of the numbers I should be getting (eg, 19.95)?</a></li>
      <li><a href="#Why-is-int-broken-">Why is int() broken?</a></li>
      <li><a href="#Why-isnt-my-octal-data-interpreted-correctly-">Why isn&#39;t my octal data interpreted correctly?</a></li>
      <li><a href="#Does-Perl-have-a-round-function-What-about-ceil-and-floor-Trig-functions-">Does Perl have a round() function? What about ceil() and floor()? Trig functions?</a></li>
      <li><a href="#How-do-I-convert-between-numeric-representations-bases-radixes-">How do I convert between numeric representations/bases/radixes?</a></li>
      <li><a href="#Why-doesnt-work-the-way-I-want-it-to-">Why doesn&#39;t &amp; work the way I want it to?</a></li>
      <li><a href="#How-do-I-multiply-matrices-">How do I multiply matrices?</a></li>
      <li><a href="#How-do-I-perform-an-operation-on-a-series-of-integers-">How do I perform an operation on a series of integers?</a></li>
      <li><a href="#How-can-I-output-Roman-numerals-">How can I output Roman numerals?</a></li>
      <li><a href="#Why-arent-my-random-numbers-random-">Why aren&#39;t my random numbers random?</a></li>
      <li><a href="#How-do-I-get-a-random-number-between-X-and-Y-">How do I get a random number between X and Y?</a></li>
    </ul>
  </li>
  <li><a href="#Data:-Dates">Data: Dates</a>
    <ul>
      <li><a href="#How-do-I-find-the-day-or-week-of-the-year-">How do I find the day or week of the year?</a></li>
      <li><a href="#How-do-I-find-the-current-century-or-millennium-">How do I find the current century or millennium?</a></li>
      <li><a href="#How-can-I-compare-two-dates-and-find-the-difference-">How can I compare two dates and find the difference?</a></li>
      <li><a href="#How-can-I-take-a-string-and-turn-it-into-epoch-seconds-">How can I take a string and turn it into epoch seconds?</a></li>
      <li><a href="#How-can-I-find-the-Julian-Day-">How can I find the Julian Day?</a></li>
      <li><a href="#How-do-I-find-yesterdays-date-">How do I find yesterday&#39;s date?          </a></li>
      <li><a href="#Does-Perl-have-a-Year-2000-or-2038-problem-Is-Perl-Y2K-compliant-">Does Perl have a Year 2000 or 2038 problem? Is Perl Y2K compliant?</a></li>
    </ul>
  </li>
  <li><a href="#Data:-Strings">Data: Strings</a>
    <ul>
      <li><a href="#How-do-I-validate-input-">How do I validate input?</a></li>
      <li><a href="#How-do-I-unescape-a-string-">How do I unescape a string?</a></li>
      <li><a href="#How-do-I-remove-consecutive-pairs-of-characters-">How do I remove consecutive pairs of characters?</a></li>
      <li><a href="#How-do-I-expand-function-calls-in-a-string-">How do I expand function calls in a string?</a></li>
      <li><a href="#How-do-I-find-matching-nesting-anything-">How do I find matching/nesting anything?</a></li>
      <li><a href="#How-do-I-reverse-a-string-">How do I reverse a string?</a></li>
      <li><a href="#How-do-I-expand-tabs-in-a-string-">How do I expand tabs in a string?</a></li>
      <li><a href="#How-do-I-reformat-a-paragraph-">How do I reformat a paragraph?</a></li>
      <li><a href="#How-can-I-access-or-change-N-characters-of-a-string-">How can I access or change N characters of a string?</a></li>
      <li><a href="#How-do-I-change-the-Nth-occurrence-of-something-">How do I change the Nth occurrence of something?</a></li>
      <li><a href="#How-can-I-count-the-number-of-occurrences-of-a-substring-within-a-string-">How can I count the number of occurrences of a substring within a string?</a></li>
      <li><a href="#How-do-I-capitalize-all-the-words-on-one-line-">How do I capitalize all the words on one line?    </a></li>
      <li><a href="#How-can-I-split-a-character--delimited-string-except-when-inside-character-">How can I split a [character]-delimited string except when inside [character]?</a></li>
      <li><a href="#How-do-I-strip-blank-space-from-the-beginning-end-of-a-string-">How do I strip blank space from the beginning/end of a string?</a></li>
      <li><a href="#How-do-I-pad-a-string-with-blanks-or-pad-a-number-with-zeroes-">How do I pad a string with blanks or pad a number with zeroes?</a></li>
      <li><a href="#How-do-I-extract-selected-columns-from-a-string-">How do I extract selected columns from a string?</a></li>
      <li><a href="#How-do-I-find-the-soundex-value-of-a-string-">How do I find the soundex value of a string?</a></li>
      <li><a href="#How-can-I-expand-variables-in-text-strings-">How can I expand variables in text strings?</a></li>
      <li><a href="#Whats-wrong-with-always-quoting-vars-">What&#39;s wrong with always quoting &quot;$vars&quot;?</a></li>
      <li><a href="#Why-dont-my-HERE-documents-work-">Why don&#39;t my &lt;&lt;HERE documents work?</a></li>
    </ul>
  </li>
  <li><a href="#Data:-Arrays">Data: Arrays</a>
    <ul>
      <li><a href="#What-is-the-difference-between-a-list-and-an-array-">What is the difference between a list and an array?</a></li>
      <li><a href="#What-is-the-difference-between-array-1-and-array-1-">What is the difference between $array[1] and @array[1]?</a></li>
      <li><a href="#How-can-I-remove-duplicate-elements-from-a-list-or-array-">How can I remove duplicate elements from a list or array?</a></li>
      <li><a href="#How-can-I-tell-whether-a-certain-element-is-contained-in-a-list-or-array-">How can I tell whether a certain element is contained in a list or array?</a></li>
      <li><a href="#How-do-I-compute-the-difference-of-two-arrays-How-do-I-compute-the-intersection-of-two-arrays-">How do I compute the difference of two arrays? How do I compute the intersection of two arrays?</a></li>
      <li><a href="#How-do-I-test-whether-two-arrays-or-hashes-are-equal-">How do I test whether two arrays or hashes are equal?</a></li>
      <li><a href="#How-do-I-find-the-first-array-element-for-which-a-condition-is-true-">How do I find the first array element for which a condition is true?</a></li>
      <li><a href="#How-do-I-handle-linked-lists-">How do I handle linked lists?</a></li>
      <li><a href="#How-do-I-handle-circular-lists-">How do I handle circular lists?      </a></li>
      <li><a href="#How-do-I-shuffle-an-array-randomly-">How do I shuffle an array randomly?</a></li>
      <li><a href="#How-do-I-process-modify-each-element-of-an-array-">How do I process/modify each element of an array?</a></li>
      <li><a href="#How-do-I-select-a-random-element-from-an-array-">How do I select a random element from an array?</a></li>
      <li><a href="#How-do-I-permute-N-elements-of-a-list-">How do I permute N elements of a list?      </a></li>
      <li><a href="#How-do-I-sort-an-array-by-anything-">How do I sort an array by (anything)?</a></li>
      <li><a href="#How-do-I-manipulate-arrays-of-bits-">How do I manipulate arrays of bits?</a></li>
      <li><a href="#Why-does-defined-return-true-on-empty-arrays-and-hashes-">Why does defined() return true on empty arrays and hashes?</a></li>
    </ul>
  </li>
  <li><a href="#Data:-Hashes-Associative-Arrays-">Data: Hashes (Associative Arrays)</a>
    <ul>
      <li><a href="#How-do-I-process-an-entire-hash-">How do I process an entire hash?</a></li>
      <li><a href="#How-do-I-merge-two-hashes-">How do I merge two hashes?   </a></li>
      <li><a href="#What-happens-if-I-add-or-remove-keys-from-a-hash-while-iterating-over-it-">What happens if I add or remove keys from a hash while iterating over it?</a></li>
      <li><a href="#How-do-I-look-up-a-hash-element-by-value-">How do I look up a hash element by value?</a></li>
      <li><a href="#How-can-I-know-how-many-entries-are-in-a-hash-">How can I know how many entries are in a hash?</a></li>
      <li><a href="#How-do-I-sort-a-hash-optionally-by-value-instead-of-key-">How do I sort a hash (optionally by value instead of key)?</a></li>
      <li><a href="#How-can-I-always-keep-my-hash-sorted-">How can I always keep my hash sorted? </a></li>
      <li><a href="#Whats-the-difference-between-delete-and-undef-with-hashes-">What&#39;s the difference between &quot;delete&quot; and &quot;undef&quot; with hashes?</a></li>
      <li><a href="#Why-dont-my-tied-hashes-make-the-defined-exists-distinction-">Why don&#39;t my tied hashes make the defined/exists distinction?</a></li>
      <li><a href="#How-do-I-reset-an-each-operation-part-way-through-">How do I reset an each() operation part-way through?</a></li>
      <li><a href="#How-can-I-get-the-unique-keys-from-two-hashes-">How can I get the unique keys from two hashes?</a></li>
      <li><a href="#How-can-I-store-a-multidimensional-array-in-a-DBM-file-">How can I store a multidimensional array in a DBM file?</a></li>
      <li><a href="#How-can-I-make-my-hash-remember-the-order-I-put-elements-into-it-">How can I make my hash remember the order I put elements into it?</a></li>
      <li><a href="#Why-does-passing-a-subroutine-an-undefined-element-in-a-hash-create-it-">Why does passing a subroutine an undefined element in a hash create it?</a></li>
      <li><a href="#How-can-I-make-the-Perl-equivalent-of-a-C-structure-C-class-hash-or-array-of-hashes-or-arrays-">How can I make the Perl equivalent of a C structure/C++ class/hash or array of hashes or arrays?</a></li>
      <li><a href="#How-can-I-use-a-reference-as-a-hash-key-">How can I use a reference as a hash key?</a></li>
      <li><a href="#How-can-I-check-if-a-key-exists-in-a-multilevel-hash-">How can I check if a key exists in a multilevel hash?</a></li>
      <li><a href="#How-can-I-prevent-addition-of-unwanted-keys-into-a-hash-">How can I prevent addition of unwanted keys into a hash?</a></li>
    </ul>
  </li>
  <li><a href="#Data:-Misc">Data: Misc</a>
    <ul>
      <li><a href="#How-do-I-handle-binary-data-correctly-">How do I handle binary data correctly?</a></li>
      <li><a href="#How-do-I-determine-whether-a-scalar-is-a-number-whole-integer-float-">How do I determine whether a scalar is a number/whole/integer/float?</a></li>
      <li><a href="#How-do-I-keep-persistent-data-across-program-calls-">How do I keep persistent data across program calls?</a></li>
      <li><a href="#How-do-I-print-out-or-copy-a-recursive-data-structure-">How do I print out or copy a recursive data structure?</a></li>
      <li><a href="#How-do-I-define-methods-for-every-class-object-">How do I define methods for every class/object?</a></li>
      <li><a href="#How-do-I-verify-a-credit-card-checksum-">How do I verify a credit card checksum?</a></li>
      <li><a href="#How-do-I-pack-arrays-of-doubles-or-floats-for-XS-code-">How do I pack arrays of doubles or floats for XS code?</a></li>
    </ul>
  </li>
  <li><a href="#AUTHOR-AND-COPYRIGHT">AUTHOR AND COPYRIGHT</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>perlfaq4 - Data Manipulation</p>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>This section of the FAQ answers questions related to manipulating numbers, dates, strings, arrays, hashes, and miscellaneous data issues.</p>

<h1 id="Data:-Numbers">Data: Numbers</h1>

<h2 id="Why-am-I-getting-long-decimals-eg-19.9499999999999-instead-of-the-numbers-I-should-be-getting-eg-19.95-">Why am I getting long decimals (eg, 19.9499999999999) instead of the numbers I should be getting (eg, 19.95)?</h2>

<p>For the long explanation, see David Goldberg&#39;s &quot;What Every Computer Scientist Should Know About Floating-Point Arithmetic&quot; (<a href="http://web.cse.msu.edu/~cse320/Documents/FloatingPoint.pdf">http://web.cse.msu.edu/~cse320/Documents/FloatingPoint.pdf</a>).</p>

<p>Internally, your computer represents floating-point numbers in binary. Digital (as in powers of two) computers cannot store all numbers exactly. Some real numbers lose precision in the process. This is a problem with how computers store numbers and affects all computer languages, not just Perl.</p>

<p><a href="../../lib/pods/perlnumber.html">perlnumber</a> shows the gory details of number representations and conversions.</p>

<p>To limit the number of decimal places in your numbers, you can use the <code><code>printf</code></code> or <code><code>sprintf</code></code> function. See <a href="../../lib/pods/perlop.html#Floating-point-Arithmetic">&quot;Floating-point Arithmetic&quot; in perlop</a> for more details.</p>

<pre><code><code>    <span class="keyword">printf</span> <span class="string">"%.2f"</span><span class="operator">,</span> <span class="number">10</span><span class="operator">/</span><span class="number">3</span><span class="operator">;</span>
    
    <span class="keyword">my</span> <span class="variable">$number</span> <span class="operator">=</span> <span class="keyword">sprintf</span> <span class="string">"%.2f"</span><span class="operator">,</span> <span class="number">10</span><span class="operator">/</span><span class="number">3</span><span class="operator">;</span>
</code></code></pre>

<h2 id="Why-is-int-broken-">Why is int() broken?</h2>

<p>Your <code><code>int()</code></code> is most probably working just fine. It&#39;s the numbers that aren&#39;t quite what you think.</p>

<p>First, see the answer to &quot;Why am I getting long decimals (eg, 19.9499999999999) instead of the numbers I should be getting (eg, 19.95)?&quot;.</p>

<p>For example, this</p>

<pre><code><code>    <span class="keyword">print</span> <span class="keyword">int</span><span class="operator">(</span><span class="number">0</span><span class="operator">.</span><span class="number">6</span><span class="operator">/</span><span class="number">0</span><span class="operator">.</span><span class="number">2</span><span class="operator">-</span><span class="number">2</span><span class="operator">),</span> <span class="string">"\n"</span><span class="operator">;</span>
</code></code></pre>

<p>will in most computers print 0, not 1, because even such simple numbers as 0.6 and 0.2 cannot be presented exactly by floating-point numbers. What you think in the above as &#39;three&#39; is really more like 2.9999999999999995559.</p>

<h2 id="Why-isnt-my-octal-data-interpreted-correctly-">Why isn&#39;t my octal data interpreted correctly?</h2>

<p>(contributed by brian d foy)</p>

<p>You&#39;re probably trying to convert a string to a number, which Perl only converts as a decimal number. When Perl converts a string to a number, it ignores leading spaces and zeroes, then assumes the rest of the digits are in base 10:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$string</span> <span class="operator">=</span> <span class="string">'0644'</span><span class="operator">;</span>
    
    <span class="keyword">print</span> <span class="variable">$string</span> <span class="operator">+</span> <span class="number">0</span><span class="operator">;</span>  <span class="comment"># prints 644</span>
    
    <span class="keyword">print</span> <span class="variable">$string</span> <span class="operator">+</span> <span class="number">44</span><span class="operator">;</span> <span class="comment"># prints 688, certainly not octal!</span>
</code></code></pre>

<p>This problem usually involves one of the Perl built-ins that has the same name a Unix command that uses octal numbers as arguments on the command line. In this example, <code><code>chmod</code></code> on the command line knows that its first argument is octal because that&#39;s what it does:</p>

<pre><code><code>    %prompt&gt; chmod 644 file</code></code></pre>

<p>If you want to use the same literal digits (644) in Perl, you have to tell Perl to treat them as octal numbers either by prefixing the digits with a <code><code>0</code></code> or using <code><code>oct</code></code>:</p>

<pre><code><code>    <span class="keyword">chmod</span><span class="operator">(</span>     <span class="number">0644</span><span class="operator">,</span> <span class="variable">$filename</span> <span class="operator">);</span>  <span class="comment"># right, has leading zero</span>
    <span class="keyword">chmod</span><span class="operator">(</span> <span class="keyword">oct</span><span class="operator">(</span><span class="number">644</span><span class="operator">),</span> <span class="variable">$filename</span> <span class="operator">);</span>  <span class="comment"># also correct</span>
</code></code></pre>

<p>The problem comes in when you take your numbers from something that Perl thinks is a string, such as a command line argument in <code><code>@ARGV</code></code>:</p>

<pre><code><code>    <span class="keyword">chmod</span><span class="operator">(</span> <span class="variable">$ARGV</span><span class="operator">[</span><span class="number">0</span><span class="operator">]</span><span class="operator">,</span>      <span class="variable">$filename</span> <span class="operator">);</span>  <span class="comment"># wrong, even if "0644"</span>
    
    <span class="keyword">chmod</span><span class="operator">(</span> <span class="keyword">oct</span><span class="operator">(</span><span class="variable">$ARGV</span><span class="operator">[</span><span class="number">0</span><span class="operator">]</span><span class="operator">),</span> <span class="variable">$filename</span> <span class="operator">);</span>  <span class="comment"># correct, treat string as octal</span>
</code></code></pre>

<p>You can always check the value you&#39;re using by printing it in octal notation to ensure it matches what you think it should be. Print it in octal and decimal format:</p>

<pre><code><code>    <span class="keyword">printf</span> <span class="string">"0%o %d"</span><span class="operator">,</span> <span class="variable">$number</span><span class="operator">,</span> <span class="variable">$number</span><span class="operator">;</span>
</code></code></pre>

<h2 id="Does-Perl-have-a-round-function-What-about-ceil-and-floor-Trig-functions-">Does Perl have a round() function? What about ceil() and floor()? Trig functions?</h2>

<p>Remember that <code><code>int()</code></code> merely truncates toward 0. For rounding to a certain number of digits, <code><code>sprintf()</code></code> or <code><code>printf()</code></code> is usually the easiest route.</p>

<pre><code><code>    <span class="keyword">printf</span><span class="operator">(</span><span class="string">"%.3f"</span><span class="operator">,</span> <span class="number">3.1415926535</span><span class="operator">);</span>   <span class="comment"># prints 3.142</span>
</code></code></pre>

<p>The <a href="../../lib/POSIX.html">POSIX</a> module (part of the standard Perl distribution) implements <code><code>ceil()</code></code>, <code><code>floor()</code></code>, and a number of other mathematical and trigonometric functions.</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">POSIX</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$ceil</span>   <span class="operator">=</span> <span class="variable">ceil</span><span class="operator">(</span><span class="number">3.5</span><span class="operator">);</span>   <span class="comment"># 4</span>
    <span class="keyword">my</span> <span class="variable">$floor</span>  <span class="operator">=</span> <span class="variable">floor</span><span class="operator">(</span><span class="number">3.5</span><span class="operator">);</span>  <span class="comment"># 3</span>
</code></code></pre>

<p>In 5.000 to 5.003 perls, trigonometry was done in the <a href="../../lib/Math/Complex.html">Math::Complex</a> module. With 5.004, the <a href="../../lib/Math/Trig.html">Math::Trig</a> module (part of the standard Perl distribution) implements the trigonometric functions. Internally it uses the <a href="../../lib/Math/Complex.html">Math::Complex</a> module and some functions can break out from the real axis into the complex plane, for example the inverse sine of 2.</p>

<p>Rounding in financial applications can have serious implications, and the rounding method used should be specified precisely. In these cases, it probably pays not to trust whichever system of rounding is being used by Perl, but instead to implement the rounding function you need yourself.</p>

<p>To see why, notice how you&#39;ll still have an issue on half-way-point alternation:</p>

<pre><code><code>    <span class="keyword">for</span> <span class="operator">(</span><span class="keyword">my</span> <span class="variable">$i</span> <span class="operator">=</span> <span class="number">0</span><span class="operator">;</span> <span class="variable">$i</span> <span class="operator">&lt;</span> <span class="number">1.01</span><span class="operator">;</span> <span class="variable">$i</span> <span class="operator">+=</span> <span class="number">0</span><span class="operator">.</span><span class="number">05</span><span class="operator">)</span> <span class="operator">{</span> <span class="keyword">printf</span> <span class="string">"%.1f "</span><span class="operator">,</span><span class="variable">$i</span><span class="operator">}</span>
    
    <span class="number">0</span><span class="operator">.</span><span class="number">0</span> <span class="number">0</span><span class="operator">.</span><span class="number">1</span> <span class="number">0</span><span class="operator">.</span><span class="number">1</span> <span class="number">0</span><span class="operator">.</span><span class="number">2</span> <span class="number">0</span><span class="operator">.</span><span class="number">2</span> <span class="number">0</span><span class="operator">.</span><span class="number">2</span> <span class="number">0</span><span class="operator">.</span><span class="number">3</span> <span class="number">0</span><span class="operator">.</span><span class="number">3</span> <span class="number">0</span><span class="operator">.</span><span class="number">4</span> <span class="number">0</span><span class="operator">.</span><span class="number">4</span> <span class="number">0</span><span class="operator">.</span><span class="number">5</span> <span class="number">0</span><span class="operator">.</span><span class="number">5</span> <span class="number">0</span><span class="operator">.</span><span class="number">6</span> <span class="number">0</span><span class="operator">.</span><span class="number">7</span> <span class="number">0</span><span class="operator">.</span><span class="number">7</span>
    <span class="number">0</span><span class="operator">.</span><span class="number">8</span> <span class="number">0</span><span class="operator">.</span><span class="number">8</span> <span class="number">0</span><span class="operator">.</span><span class="number">9</span> <span class="number">0</span><span class="operator">.</span><span class="number">9</span> <span class="number">1.0</span> <span class="number">1.0</span>
</code></code></pre>

<p>Don&#39;t blame Perl. It&#39;s the same as in C. IEEE says we have to do this. Perl numbers whose absolute values are integers under 2**31 (on 32-bit machines) will work pretty much like mathematical integers. Other numbers are not guaranteed.</p>

<h2 id="How-do-I-convert-between-numeric-representations-bases-radixes-">How do I convert between numeric representations/bases/radixes?</h2>

<p>As always with Perl there is more than one way to do it. Below are a few examples of approaches to making common conversions between number representations. This is intended to be representational rather than exhaustive.</p>

<p>Some of the examples later in <a href="../../lib/pods/perlfaq4.html">perlfaq4</a> use the <a href="../../lib/Bit/Vector.html">Bit::Vector</a> module from CPAN. The reason you might choose <a href="../../lib/Bit/Vector.html">Bit::Vector</a> over the perl built-in functions is that it works with numbers of ANY size, that it is optimized for speed on some operations, and for at least some programmers the notation might be familiar.</p>

<dl>

<dt id="How-do-I-convert-hexadecimal-into-decimal">How do I convert hexadecimal into decimal</dt>
<dd>

<p>Using perl&#39;s built in conversion of <code><code>0x</code></code> notation:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$dec</span> <span class="operator">=</span> <span class="number">0xDEADBEEF</span><span class="operator">;</span>
</code></code></pre>

<p>Using the <code><code>hex</code></code> function:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$dec</span> <span class="operator">=</span> <span class="keyword">hex</span><span class="operator">(</span><span class="string">"DEADBEEF"</span><span class="operator">);</span>
</code></code></pre>

<p>Using <code><code>pack</code></code>:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$dec</span> <span class="operator">=</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">"N"</span><span class="operator">,</span> <span class="keyword">pack</span><span class="operator">(</span><span class="string">"H8"</span><span class="operator">,</span> <span class="keyword">substr</span><span class="operator">(</span><span class="string">"0"</span> <span class="operator">x</span> <span class="number">8</span> <span class="operator">.</span> <span class="string">"DEADBEEF"</span><span class="operator">,</span> <span class="operator">-</span><span class="number">8</span><span class="operator">)));</span>
</code></code></pre>

<p>Using the CPAN module <code><code>Bit::Vector</code></code>:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Bit::Vector</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$vec</span> <span class="operator">=</span> <span class="variable">Bit::Vector</span><span class="operator">-&gt;</span><span class="variable">new_Hex</span><span class="operator">(</span><span class="number">32</span><span class="operator">,</span> <span class="string">"DEADBEEF"</span><span class="operator">);</span>
    <span class="keyword">my</span> <span class="variable">$dec</span> <span class="operator">=</span> <span class="variable">$vec</span><span class="operator">-&gt;</span><span class="variable">to_Dec</span><span class="operator">();</span>
</code></code></pre>

</dd>
<dt id="How-do-I-convert-from-decimal-to-hexadecimal">How do I convert from decimal to hexadecimal</dt>
<dd>

<p>Using <code><code>sprintf</code></code>:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$hex</span> <span class="operator">=</span> <span class="keyword">sprintf</span><span class="operator">(</span><span class="string">"%X"</span><span class="operator">,</span> <span class="number">3735928559</span><span class="operator">);</span> <span class="comment"># upper case A-F</span>
    <span class="keyword">my</span> <span class="variable">$hex</span> <span class="operator">=</span> <span class="keyword">sprintf</span><span class="operator">(</span><span class="string">"%x"</span><span class="operator">,</span> <span class="number">3735928559</span><span class="operator">);</span> <span class="comment"># lower case a-f</span>
</code></code></pre>

<p>Using <code><code>unpack</code></code>:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$hex</span> <span class="operator">=</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">"H*"</span><span class="operator">,</span> <span class="keyword">pack</span><span class="operator">(</span><span class="string">"N"</span><span class="operator">,</span> <span class="number">3735928559</span><span class="operator">));</span>
</code></code></pre>

<p>Using <a href="../../lib/Bit/Vector.html">Bit::Vector</a>:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Bit::Vector</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$vec</span> <span class="operator">=</span> <span class="variable">Bit::Vector</span><span class="operator">-&gt;</span><span class="variable">new_Dec</span><span class="operator">(</span><span class="number">32</span><span class="operator">,</span> <span class="operator">-</span><span class="number">559038737</span><span class="operator">);</span>
    <span class="keyword">my</span> <span class="variable">$hex</span> <span class="operator">=</span> <span class="variable">$vec</span><span class="operator">-&gt;</span><span class="variable">to_Hex</span><span class="operator">();</span>
</code></code></pre>

<p>And <a href="../../lib/Bit/Vector.html">Bit::Vector</a> supports odd bit counts:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Bit::Vector</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$vec</span> <span class="operator">=</span> <span class="variable">Bit::Vector</span><span class="operator">-&gt;</span><span class="variable">new_Dec</span><span class="operator">(</span><span class="number">33</span><span class="operator">,</span> <span class="number">3735928559</span><span class="operator">);</span>
    <span class="variable">$vec</span><span class="operator">-&gt;</span><span class="variable">Resize</span><span class="operator">(</span><span class="number">32</span><span class="operator">);</span> <span class="comment"># suppress leading 0 if unwanted</span>
    <span class="keyword">my</span> <span class="variable">$hex</span> <span class="operator">=</span> <span class="variable">$vec</span><span class="operator">-&gt;</span><span class="variable">to_Hex</span><span class="operator">();</span>
</code></code></pre>

</dd>
<dt id="How-do-I-convert-from-octal-to-decimal">How do I convert from octal to decimal</dt>
<dd>

<p>Using Perl&#39;s built in conversion of numbers with leading zeros:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$dec</span> <span class="operator">=</span> <span class="number">033653337357</span><span class="operator">;</span> <span class="comment"># note the leading 0!</span>
</code></code></pre>

<p>Using the <code><code>oct</code></code> function:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$dec</span> <span class="operator">=</span> <span class="keyword">oct</span><span class="operator">(</span><span class="string">"33653337357"</span><span class="operator">);</span>
</code></code></pre>

<p>Using <a href="../../lib/Bit/Vector.html">Bit::Vector</a>:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Bit::Vector</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$vec</span> <span class="operator">=</span> <span class="variable">Bit::Vector</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span><span class="number">32</span><span class="operator">);</span>
    <span class="variable">$vec</span><span class="operator">-&gt;</span><span class="variable">Chunk_List_Store</span><span class="operator">(</span><span class="number">3</span><span class="operator">,</span> <span class="keyword">split</span><span class="operator">(</span><span class="regex">//</span><span class="operator">,</span> <span class="keyword">reverse</span> <span class="string">"33653337357"</span><span class="operator">));</span>
    <span class="keyword">my</span> <span class="variable">$dec</span> <span class="operator">=</span> <span class="variable">$vec</span><span class="operator">-&gt;</span><span class="variable">to_Dec</span><span class="operator">();</span>
</code></code></pre>

</dd>
<dt id="How-do-I-convert-from-decimal-to-octal">How do I convert from decimal to octal</dt>
<dd>

<p>Using <code><code>sprintf</code></code>:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$oct</span> <span class="operator">=</span> <span class="keyword">sprintf</span><span class="operator">(</span><span class="string">"%o"</span><span class="operator">,</span> <span class="number">3735928559</span><span class="operator">);</span>
</code></code></pre>

<p>Using <a href="../../lib/Bit/Vector.html">Bit::Vector</a>:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Bit::Vector</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$vec</span> <span class="operator">=</span> <span class="variable">Bit::Vector</span><span class="operator">-&gt;</span><span class="variable">new_Dec</span><span class="operator">(</span><span class="number">32</span><span class="operator">,</span> <span class="operator">-</span><span class="number">559038737</span><span class="operator">);</span>
    <span class="keyword">my</span> <span class="variable">$oct</span> <span class="operator">=</span> <span class="keyword">reverse</span> <span class="keyword">join</span><span class="operator">(</span><span class="string">''</span><span class="operator">,</span> <span class="variable">$vec</span><span class="operator">-&gt;</span><span class="variable">Chunk_List_Read</span><span class="operator">(</span><span class="number">3</span><span class="operator">));</span>
</code></code></pre>

</dd>
<dt id="How-do-I-convert-from-binary-to-decimal">How do I convert from binary to decimal</dt>
<dd>

<p>Perl 5.6 lets you write binary numbers directly with the <code><code>0b</code></code> notation:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$number</span> <span class="operator">=</span> <span class="number">0b10110110</span><span class="operator">;</span>
</code></code></pre>

<p>Using <code><code>oct</code></code>:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$input</span> <span class="operator">=</span> <span class="string">"10110110"</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$decimal</span> <span class="operator">=</span> <span class="keyword">oct</span><span class="operator">(</span> <span class="string">"0b</span><span class="variable">$input</span><span class="string">"</span> <span class="operator">);</span>
</code></code></pre>

<p>Using <code><code>pack</code></code> and <code><code>ord</code></code>:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$decimal</span> <span class="operator">=</span> <span class="keyword">ord</span><span class="operator">(</span><span class="keyword">pack</span><span class="operator">(</span><span class="string">'B8'</span><span class="operator">,</span> <span class="string">'10110110'</span><span class="operator">));</span>
</code></code></pre>

<p>Using <code><code>pack</code></code> and <code><code>unpack</code></code> for larger strings:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$int</span> <span class="operator">=</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">"N"</span><span class="operator">,</span> <span class="keyword">pack</span><span class="operator">(</span><span class="string">"B32"</span><span class="operator">,</span>
    <span class="keyword">substr</span><span class="operator">(</span><span class="string">"0"</span> <span class="operator">x</span> <span class="number">32</span> <span class="operator">.</span> <span class="string">"11110101011011011111011101111"</span><span class="operator">,</span> <span class="operator">-</span><span class="number">32</span><span class="operator">)));</span>
    <span class="keyword">my</span> <span class="variable">$dec</span> <span class="operator">=</span> <span class="keyword">sprintf</span><span class="operator">(</span><span class="string">"%d"</span><span class="operator">,</span> <span class="variable">$int</span><span class="operator">);</span>
    
    <span class="comment"># substr() is used to left-pad a 32-character string with zeros.</span>
</code></code></pre>

<p>Using <a href="../../lib/Bit/Vector.html">Bit::Vector</a>:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$vec</span> <span class="operator">=</span> <span class="variable">Bit::Vector</span><span class="operator">-&gt;</span><span class="variable">new_Bin</span><span class="operator">(</span><span class="number">32</span><span class="operator">,</span> <span class="string">"11011110101011011011111011101111"</span><span class="operator">);</span>
    <span class="keyword">my</span> <span class="variable">$dec</span> <span class="operator">=</span> <span class="variable">$vec</span><span class="operator">-&gt;</span><span class="variable">to_Dec</span><span class="operator">();</span>
</code></code></pre>

</dd>
<dt id="How-do-I-convert-from-decimal-to-binary">How do I convert from decimal to binary</dt>
<dd>

<p>Using <code><code>sprintf</code></code> (perl 5.6+):</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$bin</span> <span class="operator">=</span> <span class="keyword">sprintf</span><span class="operator">(</span><span class="string">"%b"</span><span class="operator">,</span> <span class="number">3735928559</span><span class="operator">);</span>
</code></code></pre>

<p>Using <code><code>unpack</code></code>:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$bin</span> <span class="operator">=</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">"B*"</span><span class="operator">,</span> <span class="keyword">pack</span><span class="operator">(</span><span class="string">"N"</span><span class="operator">,</span> <span class="number">3735928559</span><span class="operator">));</span>
</code></code></pre>

<p>Using <a href="../../lib/Bit/Vector.html">Bit::Vector</a>:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Bit::Vector</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$vec</span> <span class="operator">=</span> <span class="variable">Bit::Vector</span><span class="operator">-&gt;</span><span class="variable">new_Dec</span><span class="operator">(</span><span class="number">32</span><span class="operator">,</span> <span class="operator">-</span><span class="number">559038737</span><span class="operator">);</span>
    <span class="keyword">my</span> <span class="variable">$bin</span> <span class="operator">=</span> <span class="variable">$vec</span><span class="operator">-&gt;</span><span class="variable">to_Bin</span><span class="operator">();</span>
</code></code></pre>

<p>The remaining transformations (e.g. hex -&gt; oct, bin -&gt; hex, etc.) are left as an exercise to the inclined reader.</p>

</dd>
</dl>

<h2 id="Why-doesnt-work-the-way-I-want-it-to-">Why doesn&#39;t &amp; work the way I want it to?</h2>

<p>The behavior of binary arithmetic operators depends on whether they&#39;re used on numbers or strings. The operators treat a string as a series of bits and work with that (the string <code><code>&quot;3&quot;</code></code> is the bit pattern <code><code>00110011</code></code>). The operators work with the binary form of a number (the number <code><code>3</code></code> is treated as the bit pattern <code><code>00000011</code></code>).</p>

<p>So, saying <code><code>11 &amp; 3</code></code> performs the &quot;and&quot; operation on numbers (yielding <code><code>3</code></code>). Saying <code><code>&quot;11&quot; &amp; &quot;3&quot;</code></code> performs the &quot;and&quot; operation on strings (yielding <code><code>&quot;1&quot;</code></code>).</p>

<p>Most problems with <code><code>&amp;</code></code> and <code><code>|</code></code> arise because the programmer thinks they have a number but really it&#39;s a string or vice versa. To avoid this, stringify the arguments explicitly (using <code><code>&quot;&quot;</code></code> or <code><code>qq()</code></code>) or convert them to numbers explicitly (using <code><code>0+$arg</code></code>). The rest arise because the programmer says:</p>

<pre><code><code>    <span class="keyword">if</span> <span class="operator">(</span><span class="string">"\020\020"</span> <span class="operator">&amp;</span> <span class="string">"\101\101"</span><span class="operator">)</span> <span class="operator">{</span>
        <span class="comment"># ...</span>
    <span class="operator">}</span>
</code></code></pre>

<p>but a string consisting of two null bytes (the result of <code><code>&quot;\020\020&quot; &amp; &quot;\101\101&quot;</code></code>) is not a false value in Perl. You need:</p>

<pre><code><code>    <span class="keyword">if</span> <span class="operator">(</span> <span class="operator">(</span><span class="string">"\020\020"</span> <span class="operator">&amp;</span> <span class="string">"\101\101"</span><span class="operator">)</span> <span class="operator">!~</span> <span class="regex">/[^\000]/</span><span class="operator">)</span> <span class="operator">{</span>
        <span class="comment"># ...</span>
    <span class="operator">}</span>
</code></code></pre>

<h2 id="How-do-I-multiply-matrices-">How do I multiply matrices?</h2>

<p>Use the <a>Math::Matrix</a> or <a>Math::MatrixReal</a> modules (available from CPAN) or the <a>PDL</a> extension (also available from CPAN).</p>

<h2 id="How-do-I-perform-an-operation-on-a-series-of-integers-">How do I perform an operation on a series of integers?</h2>

<p>To call a function on each element in an array, and collect the results, use:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@results</span> <span class="operator">=</span> <span class="keyword">map</span> <span class="operator">{</span> <span class="variable">my_func</span><span class="operator">(</span><span class="variable">$_</span><span class="operator">)</span> <span class="operator">}</span> <span class="variable">@array</span><span class="operator">;</span>
</code></code></pre>

<p>For example:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@triple</span> <span class="operator">=</span> <span class="keyword">map</span> <span class="operator">{</span> <span class="number">3</span> <span class="operator">*</span> <span class="variable">$_</span> <span class="operator">}</span> <span class="variable">@single</span><span class="operator">;</span>
</code></code></pre>

<p>To call a function on each element of an array, but ignore the results:</p>

<pre><code><code>    <span class="keyword">foreach</span> <span class="keyword">my</span> <span class="variable">$iterator</span> <span class="operator">(</span><span class="variable">@array</span><span class="operator">)</span> <span class="operator">{</span>
        <span class="variable">some_func</span><span class="operator">(</span><span class="variable">$iterator</span><span class="operator">);</span>
    <span class="operator">}</span>
</code></code></pre>

<p>To call a function on each integer in a (small) range, you <b>can</b> use:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@results</span> <span class="operator">=</span> <span class="keyword">map</span> <span class="operator">{</span> <span class="variable">some_func</span><span class="operator">(</span><span class="variable">$_</span><span class="operator">)</span> <span class="operator">}</span> <span class="operator">(</span><span class="number">5</span> <span class="operator">..</span> <span class="number">25</span><span class="operator">);</span>
</code></code></pre>

<p>but you should be aware that in this form, the <code><code>..</code></code> operator creates a list of all integers in the range, which can take a lot of memory for large ranges. However, the problem does not occur when using <code><code>..</code></code> within a <code><code>for</code></code> loop, because in that case the range operator is optimized to <i>iterate</i> over the range, without creating the entire list. So</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@results</span> <span class="operator">=</span> <span class="operator">();</span>
    <span class="keyword">for</span> <span class="keyword">my</span> <span class="variable">$i</span> <span class="operator">(</span><span class="number">5</span> <span class="operator">..</span> <span class="number">500_005</span><span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">push</span><span class="operator">(</span><span class="variable">@results</span><span class="operator">,</span> <span class="variable">some_func</span><span class="operator">(</span><span class="variable">$i</span><span class="operator">));</span>
    <span class="operator">}</span>
</code></code></pre>

<p>or even</p>

<pre><code><code>   <span class="keyword">push</span><span class="operator">(</span><span class="variable">@results</span><span class="operator">,</span> <span class="variable">some_func</span><span class="operator">(</span><span class="variable">$_</span><span class="operator">))</span> <span class="keyword">for</span> <span class="number">5</span> <span class="operator">..</span> <span class="number">500_005</span><span class="operator">;</span>
</code></code></pre>

<p>will not create an intermediate list of 500,000 integers.</p>

<h2 id="How-can-I-output-Roman-numerals-">How can I output Roman numerals?</h2>

<p>Get the <a href="http://www.cpan.org/modules/by-module/Roman">http://www.cpan.org/modules/by-module/Roman</a> module.</p>

<h2 id="Why-arent-my-random-numbers-random-">Why aren&#39;t my random numbers random?</h2>

<p>If you&#39;re using a version of Perl before 5.004, you must call <code><code>srand</code></code> once at the start of your program to seed the random number generator.</p>

<pre><code><code>     <span class="keyword">BEGIN</span> <span class="operator">{</span> <span class="keyword">srand</span><span class="operator">()</span> <span class="keyword">if</span> <span class="variable">$]</span> <span class="operator">&lt;</span> <span class="number">5.004</span> <span class="operator">}</span>
</code></code></pre>

<p>5.004 and later automatically call <code><code>srand</code></code> at the beginning. Don&#39;t call <code><code>srand</code></code> more than once--you make your numbers less random, rather than more.</p>

<p>Computers are good at being predictable and bad at being random (despite appearances caused by bugs in your programs :-). The <i>random</i> article in the &quot;Far More Than You Ever Wanted To Know&quot; collection in <a href="http://www.cpan.org/misc/olddoc/FMTEYEWTK.tgz">http://www.cpan.org/misc/olddoc/FMTEYEWTK.tgz</a>, courtesy of Tom Phoenix, talks more about this. John von Neumann said, &quot;Anyone who attempts to generate random numbers by deterministic means is, of course, living in a state of sin.&quot;</p>

<p>Perl relies on the underlying system for the implementation of <code><code>rand</code></code> and <code><code>srand</code></code>; on some systems, the generated numbers are not random enough (especially on Windows : see <a href="http://www.perlmonks.org/?node_id=803632">http://www.perlmonks.org/?node_id=803632</a>). Several CPAN modules in the <code><code>Math</code></code> namespace implement better pseudorandom generators; see for example <a>Math::Random::MT</a> (&quot;Mersenne Twister&quot;, fast), or <a>Math::TrulyRandom</a> (uses the imperfections in the system&#39;s timer to generate random numbers, which is rather slow). More algorithms for random numbers are described in &quot;Numerical Recipes in C&quot; at <a href="http://www.nr.com/">http://www.nr.com/</a></p>

<h2 id="How-do-I-get-a-random-number-between-X-and-Y-">How do I get a random number between X and Y?</h2>

<p>To get a random number between two values, you can use the <code><code>rand()</code></code> built-in to get a random number between 0 and 1. From there, you shift that into the range that you want.</p>

<p><code><code>rand($x)</code></code> returns a number such that <code><code>0 &lt;= rand($x) &lt; $x</code></code>. Thus what you want to have perl figure out is a random number in the range from 0 to the difference between your <i>X</i> and <i>Y</i>.</p>

<p>That is, to get a number between 10 and 15, inclusive, you want a random number between 0 and 5 that you can then add to 10.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$number</span> <span class="operator">=</span> <span class="number">10</span> <span class="operator">+</span> <span class="keyword">int</span> <span class="keyword">rand</span><span class="operator">(</span> <span class="number">15</span><span class="operator">-</span><span class="number">10</span><span class="operator">+</span><span class="number">1</span> <span class="operator">);</span> <span class="comment"># ( 10,11,12,13,14, or 15 )</span>
</code></code></pre>

<p>Hence you derive the following simple function to abstract that. It selects a random integer between the two given integers (inclusive), For example: <code><code>random_int_between(50,120)</code></code>.</p>

<pre><code><code>    <span class="keyword">sub</span><span class="variable"> random_int_between </span><span class="operator">{</span>
        <span class="keyword">my</span><span class="operator">(</span><span class="variable">$min</span><span class="operator">,</span> <span class="variable">$max</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">@_</span><span class="operator">;</span>
        <span class="comment"># Assumes that the two arguments are integers themselves!</span>
        <span class="keyword">return</span> <span class="variable">$min</span> <span class="keyword">if</span> <span class="variable">$min</span> <span class="operator">==</span> <span class="variable">$max</span><span class="operator">;</span>
        <span class="operator">(</span><span class="variable">$min</span><span class="operator">,</span> <span class="variable">$max</span><span class="operator">)</span> <span class="operator">=</span> <span class="operator">(</span><span class="variable">$max</span><span class="operator">,</span> <span class="variable">$min</span><span class="operator">)</span>  <span class="keyword">if</span>  <span class="variable">$min</span> <span class="operator">&gt;</span> <span class="variable">$max</span><span class="operator">;</span>
        <span class="keyword">return</span> <span class="variable">$min</span> <span class="operator">+</span> <span class="keyword">int</span> <span class="keyword">rand</span><span class="operator">(</span><span class="number">1</span> <span class="operator">+</span> <span class="variable">$max</span> <span class="operator">-</span> <span class="variable">$min</span><span class="operator">);</span>
    <span class="operator">}</span>
</code></code></pre>

<h1 id="Data:-Dates">Data: Dates</h1>

<h2 id="How-do-I-find-the-day-or-week-of-the-year-">How do I find the day or week of the year?</h2>

<p>The day of the year is in the list returned by the <code><code>localtime</code></code> function. Without an argument <code><code>localtime</code></code> uses the current time.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$day_of_year</span> <span class="operator">=</span> <span class="operator">(</span><span class="keyword">localtime</span><span class="operator">)</span><span class="operator">[</span><span class="number">7</span><span class="operator">]</span><span class="operator">;</span>
</code></code></pre>

<p>The <a href="../../lib/POSIX.html">POSIX</a> module can also format a date as the day of the year or week of the year.</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">POSIX</span> <span class="string">qw/strftime/</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$day_of_year</span>  <span class="operator">=</span> <span class="variable">strftime</span> <span class="string">"%j"</span><span class="operator">,</span> <span class="keyword">localtime</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$week_of_year</span> <span class="operator">=</span> <span class="variable">strftime</span> <span class="string">"%W"</span><span class="operator">,</span> <span class="keyword">localtime</span><span class="operator">;</span>
</code></code></pre>

<p>To get the day of year for any date, use <a href="../../lib/POSIX.html">POSIX</a>&#39;s <code><code>mktime</code></code> to get a time in epoch seconds for the argument to <code><code>localtime</code></code>.</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">POSIX</span> <span class="string">qw/mktime strftime/</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$week_of_year</span> <span class="operator">=</span> <span class="variable">strftime</span> <span class="string">"%W"</span><span class="operator">,</span>
        <span class="keyword">localtime</span><span class="operator">(</span> <span class="variable">mktime</span><span class="operator">(</span> <span class="number">0</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="number">18</span><span class="operator">,</span> <span class="number">11</span><span class="operator">,</span> <span class="number">87</span> <span class="operator">)</span> <span class="operator">);</span>
</code></code></pre>

<p>You can also use <a href="../../lib/Time/Piece.html">Time::Piece</a>, which comes with Perl and provides a <code><code>localtime</code></code> that returns an object:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Time::Piece</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$day_of_year</span>  <span class="operator">=</span> <span class="keyword">localtime</span><span class="operator">-&gt;</span><span class="variable">yday</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$week_of_year</span> <span class="operator">=</span> <span class="keyword">localtime</span><span class="operator">-&gt;</span><span class="variable">week</span><span class="operator">;</span>
</code></code></pre>

<p>The <a href="../../lib/Date/Calc.html">Date::Calc</a> module provides two functions to calculate these, too:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Date::Calc</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$day_of_year</span>  <span class="operator">=</span> <span class="variable">Day_of_Year</span><span class="operator">(</span>  <span class="number">1987</span><span class="operator">,</span> <span class="number">12</span><span class="operator">,</span> <span class="number">18</span> <span class="operator">);</span>
    <span class="keyword">my</span> <span class="variable">$week_of_year</span> <span class="operator">=</span> <span class="variable">Week_of_Year</span><span class="operator">(</span> <span class="number">1987</span><span class="operator">,</span> <span class="number">12</span><span class="operator">,</span> <span class="number">18</span> <span class="operator">);</span>
</code></code></pre>

<h2 id="How-do-I-find-the-current-century-or-millennium-">How do I find the current century or millennium?</h2>

<p>Use the following simple functions:</p>

<pre><code><code>    <span class="keyword">sub</span><span class="variable"> get_century    </span><span class="operator">{</span>
        <span class="keyword">return</span> <span class="keyword">int</span><span class="operator">((((</span><span class="keyword">localtime</span><span class="operator">(</span><span class="keyword">shift</span> <span class="operator">||</span> <span class="keyword">time</span><span class="operator">))</span><span class="operator">[</span><span class="number">5</span><span class="operator">]</span> <span class="operator">+</span> <span class="number">1999</span><span class="operator">))/</span><span class="number">100</span><span class="operator">);</span>
    <span class="operator">}</span>
    
    <span class="keyword">sub</span><span class="variable"> get_millennium </span><span class="operator">{</span>
        <span class="keyword">return</span> <span class="number">1</span><span class="operator">+</span><span class="keyword">int</span><span class="operator">((((</span><span class="keyword">localtime</span><span class="operator">(</span><span class="keyword">shift</span> <span class="operator">||</span> <span class="keyword">time</span><span class="operator">))</span><span class="operator">[</span><span class="number">5</span><span class="operator">]</span> <span class="operator">+</span> <span class="number">1899</span><span class="operator">))/</span><span class="number">1000</span><span class="operator">);</span>
    <span class="operator">}</span>
</code></code></pre>

<p>On some systems, the <a href="../../lib/POSIX.html">POSIX</a> module&#39;s <code><code>strftime()</code></code> function has been extended in a non-standard way to use a <code><code>%C</code></code> format, which they sometimes claim is the &quot;century&quot;. It isn&#39;t, because on most such systems, this is only the first two digits of the four-digit year, and thus cannot be used to determine reliably the current century or millennium.</p>

<h2 id="How-can-I-compare-two-dates-and-find-the-difference-">How can I compare two dates and find the difference?</h2>

<p>(contributed by brian d foy)</p>

<p>You could just store all your dates as a number and then subtract. Life isn&#39;t always that simple though.</p>

<p>The <a href="../../lib/Time/Piece.html">Time::Piece</a> module, which comes with Perl, replaces <a href="../../lib/Time/localtime.html">localtime</a> with a version that returns an object. It also overloads the comparison operators so you can compare them directly:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Time::Piece</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$date1</span> <span class="operator">=</span> <span class="keyword">localtime</span><span class="operator">(</span> <span class="variable">$some_time</span> <span class="operator">);</span>
    <span class="keyword">my</span> <span class="variable">$date2</span> <span class="operator">=</span> <span class="keyword">localtime</span><span class="operator">(</span> <span class="variable">$some_other_time</span> <span class="operator">);</span>
    
    <span class="keyword">if</span><span class="operator">(</span> <span class="variable">$date1</span> <span class="operator">&lt;</span> <span class="variable">$date2</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">print</span> <span class="string">"The date was in the past\n"</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>You can also get differences with a subtraction, which returns a <a href="../../lib/Time/Seconds.html">Time::Seconds</a> object:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$diff</span> <span class="operator">=</span> <span class="variable">$date1</span> <span class="operator">-</span> <span class="variable">$date2</span><span class="operator">;</span>
    <span class="keyword">print</span> <span class="string">"The difference is "</span><span class="operator">,</span> <span class="variable">$date_diff</span><span class="operator">-&gt;</span><span class="variable">days</span><span class="operator">,</span> <span class="string">" days\n"</span><span class="operator">;</span>
</code></code></pre>

<p>If you want to work with formatted dates, the <a>Date::Manip</a>, <a href="../../lib/Date/Calc.html">Date::Calc</a>, or <a href="../../lib/ActiveState/DateTime.html">DateTime</a> modules can help you.</p>

<h2 id="How-can-I-take-a-string-and-turn-it-into-epoch-seconds-">How can I take a string and turn it into epoch seconds?</h2>

<p>If it&#39;s a regular enough string that it always has the same format, you can split it up and pass the parts to <code><code>timelocal</code></code> in the standard <a href="../../lib/Time/Local.html">Time::Local</a> module. Otherwise, you should look into the <a href="../../lib/Date/Calc.html">Date::Calc</a>, <a>Date::Parse</a>, and <a>Date::Manip</a> modules from CPAN.</p>

<h2 id="How-can-I-find-the-Julian-Day-">How can I find the Julian Day?</h2>

<p>(contributed by brian d foy and Dave Cross)</p>

<p>You can use the <a href="../../lib/Time/Piece.html">Time::Piece</a> module, part of the Standard Library, which can convert a date/time to a Julian Day:</p>

<pre><code><code>    $ perl -MTime::Piece -le &#39;print localtime-&gt;julian_day&#39;
    2455607.7959375</code></code></pre>

<p>Or the modified Julian Day:</p>

<pre><code><code>    $ perl -MTime::Piece -le &#39;print localtime-&gt;mjd&#39;
    55607.2961226851</code></code></pre>

<p>Or even the day of the year (which is what some people think of as a Julian day):</p>

<pre><code><code>    $ perl -MTime::Piece -le &#39;print localtime-&gt;yday&#39;
    45</code></code></pre>

<p>You can also do the same things with the <a href="../../lib/ActiveState/DateTime.html">DateTime</a> module:</p>

<pre><code><code>    $ perl -MDateTime -le&#39;print DateTime-&gt;today-&gt;jd&#39;
    2453401.5
    $ perl -MDateTime -le&#39;print DateTime-&gt;today-&gt;mjd&#39;
    53401
    $ perl -MDateTime -le&#39;print DateTime-&gt;today-&gt;doy&#39;
    31</code></code></pre>

<p>You can use the <a>Time::JulianDay</a> module available on CPAN. Ensure that you really want to find a Julian day, though, as many people have different ideas about Julian days (see <a href="http://www.hermetic.ch/cal_stud/jdn.htm">http://www.hermetic.ch/cal_stud/jdn.htm</a> for instance):</p>

<pre><code><code>    $  perl -MTime::JulianDay -le &#39;print local_julian_day( time )&#39;
    55608</code></code></pre>

<h2 id="How-do-I-find-yesterdays-date-">How do I find yesterday&#39;s date?          </h2>

<p>(contributed by brian d foy)</p>

<p>To do it correctly, you can use one of the <code><code>Date</code></code> modules since they work with calendars instead of times. The <a href="../../lib/ActiveState/DateTime.html">DateTime</a> module makes it simple, and give you the same time of day, only the day before, despite daylight saving time changes:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">DateTime</span><span class="operator">;</span>
    
    <span class="keyword">my</span> <span class="variable">$yesterday</span> <span class="operator">=</span> <span class="variable">DateTime</span><span class="operator">-&gt;</span><span class="variable">now</span><span class="operator">-&gt;</span><span class="variable">subtract</span><span class="operator">(</span> <span class="string">days</span> <span class="operator">=&gt;</span> <span class="number">1</span> <span class="operator">);</span>
    
    <span class="keyword">print</span> <span class="string">"Yesterday was </span><span class="variable">$yesterday</span><span class="string">\n"</span><span class="operator">;</span>
</code></code></pre>

<p>You can also use the <a href="../../lib/Date/Calc.html">Date::Calc</a> module using its <code><code>Today_and_Now</code></code> function.</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Date::Calc</span> <span class="string">qw( Today_and_Now Add_Delta_DHMS )</span><span class="operator">;</span>
    
    <span class="keyword">my</span> <span class="variable">@date_time</span> <span class="operator">=</span> <span class="variable">Add_Delta_DHMS</span><span class="operator">(</span> <span class="variable">Today_and_Now</span><span class="operator">(),</span> <span class="operator">-</span><span class="number">1</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="number">0</span> <span class="operator">);</span>
    
    <span class="keyword">print</span> <span class="string">"</span><span class="variable">@date_time</span><span class="string">\n"</span><span class="operator">;</span>
</code></code></pre>

<p>Most people try to use the time rather than the calendar to figure out dates, but that assumes that days are twenty-four hours each. For most people, there are two days a year when they aren&#39;t: the switch to and from summer time throws this off. For example, the rest of the suggestions will be wrong sometimes:</p>

<p>Starting with Perl 5.10, <a href="../../lib/Time/Piece.html">Time::Piece</a> and <a href="../../lib/Time/Seconds.html">Time::Seconds</a> are part of the standard distribution, so you might think that you could do something like this:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Time::Piece</span><span class="operator">;</span>
    <span class="keyword">use</span> <span class="variable">Time::Seconds</span><span class="operator">;</span>
    
    <span class="keyword">my</span> <span class="variable">$yesterday</span> <span class="operator">=</span> <span class="keyword">localtime</span><span class="operator">()</span> <span class="operator">-</span> <span class="variable">ONE_DAY</span><span class="operator">;</span> <span class="comment"># WRONG</span>
    <span class="keyword">print</span> <span class="string">"Yesterday was </span><span class="variable">$yesterday</span><span class="string">\n"</span><span class="operator">;</span>
</code></code></pre>

<p>The <a href="../../lib/Time/Piece.html">Time::Piece</a> module exports a new <code><code>localtime</code></code> that returns an object, and <a href="../../lib/Time/Seconds.html">Time::Seconds</a> exports the <code><code>ONE_DAY</code></code> constant that is a set number of seconds. This means that it always gives the time 24 hours ago, which is not always yesterday. This can cause problems around the end of daylight saving time when there&#39;s one day that is 25 hours long.</p>

<p>You have the same problem with <a href="../../lib/Time/Local.html">Time::Local</a>, which will give the wrong answer for those same special cases:</p>

<pre><code><code>    <span class="comment"># contributed by Gunnar Hjalmarsson</span>
     <span class="keyword">use</span> <span class="variable">Time::Local</span><span class="operator">;</span>
     <span class="keyword">my</span> <span class="variable">$today</span> <span class="operator">=</span> <span class="variable">timelocal</span> <span class="number">0</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="number">12</span><span class="operator">,</span> <span class="operator">(</span> <span class="keyword">localtime</span> <span class="operator">)</span><span class="operator">[</span><span class="number">3</span><span class="operator">..</span><span class="number">5</span><span class="operator">]</span><span class="operator">;</span>
     <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$d</span><span class="operator">,</span> <span class="variable">$m</span><span class="operator">,</span> <span class="variable">$y</span><span class="operator">)</span> <span class="operator">=</span> <span class="operator">(</span> <span class="keyword">localtime</span> <span class="variable">$today</span><span class="operator">-</span><span class="number">86400</span> <span class="operator">)</span><span class="operator">[</span><span class="number">3</span><span class="operator">..</span><span class="number">5</span><span class="operator">]</span><span class="operator">;</span> <span class="comment"># WRONG</span>
     <span class="keyword">printf</span> <span class="string">"Yesterday: %d-%02d-%02d\n"</span><span class="operator">,</span> <span class="variable">$y</span><span class="operator">+</span><span class="number">1900</span><span class="operator">,</span> <span class="variable">$m</span><span class="operator">+</span><span class="number">1</span><span class="operator">,</span> <span class="variable">$d</span><span class="operator">;</span>
</code></code></pre>

<h2 id="Does-Perl-have-a-Year-2000-or-2038-problem-Is-Perl-Y2K-compliant-">Does Perl have a Year 2000 or 2038 problem? Is Perl Y2K compliant?</h2>

<p>(contributed by brian d foy)</p>

<p>Perl itself never had a Y2K problem, although that never stopped people from creating Y2K problems on their own. See the documentation for <code><code>localtime</code></code> for its proper use.</p>

<p>Starting with Perl 5.12, <code><code>localtime</code></code> and <code><code>gmtime</code></code> can handle dates past 03:14:08 January 19, 2038, when a 32-bit based time would overflow. You still might get a warning on a 32-bit <code><code>perl</code></code>:</p>

<pre><code><code>    % perl5.12 -E &#39;say scalar localtime( 0x9FFF_FFFFFFFF )&#39;
    Integer overflow in hexadecimal number at -e line 1.
    Wed Nov  1 19:42:39 5576711</code></code></pre>

<p>On a 64-bit <code><code>perl</code></code>, you can get even larger dates for those really long running projects:</p>

<pre><code><code>    % perl5.12 -E &#39;say scalar gmtime( 0x9FFF_FFFFFFFF )&#39;
    Thu Nov  2 00:42:39 5576711</code></code></pre>

<p>You&#39;re still out of luck if you need to keep track of decaying protons though.</p>

<h1 id="Data:-Strings">Data: Strings</h1>

<h2 id="How-do-I-validate-input-">How do I validate input?</h2>

<p>(contributed by brian d foy)</p>

<p>There are many ways to ensure that values are what you expect or want to accept. Besides the specific examples that we cover in the perlfaq, you can also look at the modules with &quot;Assert&quot; and &quot;Validate&quot; in their names, along with other modules such as <a>Regexp::Common</a>.</p>

<p>Some modules have validation for particular types of input, such as <a>Business::ISBN</a>, <a>Business::CreditCard</a>, <a>Email::Valid</a>, and <a>Data::Validate::IP</a>.</p>

<h2 id="How-do-I-unescape-a-string-">How do I unescape a string?</h2>

<p>It depends just what you mean by &quot;escape&quot;. URL escapes are dealt with in <a href="../../lib/pods/perlfaq9.html">perlfaq9</a>. Shell escapes with the backslash (<code><code>\</code></code>) character are removed with</p>

<pre><code><code>    <span class="regex">s/\\(.)/$1/g</span><span class="operator">;</span>
</code></code></pre>

<p>This won&#39;t expand <code><code>&quot;\n&quot;</code></code> or <code><code>&quot;\t&quot;</code></code> or any other special escapes.</p>

<h2 id="How-do-I-remove-consecutive-pairs-of-characters-">How do I remove consecutive pairs of characters?</h2>

<p>(contributed by brian d foy)</p>

<p>You can use the substitution operator to find pairs of characters (or runs of characters) and replace them with a single instance. In this substitution, we find a character in <code><code>(.)</code></code>. The memory parentheses store the matched character in the back-reference <code><code>\g1</code></code> and we use that to require that the same thing immediately follow it. We replace that part of the string with the character in <code><code>$1</code></code>.</p>

<pre><code><code>    <span class="regex">s/(.)\g1/$1/g</span><span class="operator">;</span>
</code></code></pre>

<p>We can also use the transliteration operator, <code><code>tr///</code></code>. In this example, the search list side of our <code><code>tr///</code></code> contains nothing, but the <code><code>c</code></code> option complements that so it contains everything. The replacement list also contains nothing, so the transliteration is almost a no-op since it won&#39;t do any replacements (or more exactly, replace the character with itself). However, the <code><code>s</code></code> option squashes duplicated and consecutive characters in the string so a character does not show up next to itself</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$str</span> <span class="operator">=</span> <span class="string">'Haarlem'</span><span class="operator">;</span>   <span class="comment"># in the Netherlands</span>
    <span class="variable">$str</span> <span class="operator">=~</span> <span class="regex">tr///cs</span><span class="operator">;</span>       <span class="comment"># Now Harlem, like in New York</span>
</code></code></pre>

<h2 id="How-do-I-expand-function-calls-in-a-string-">How do I expand function calls in a string?</h2>

<p>(contributed by brian d foy)</p>

<p>This is documented in <a href="../../lib/pods/perlref.html">perlref</a>, and although it&#39;s not the easiest thing to read, it does work. In each of these examples, we call the function inside the braces used to dereference a reference. If we have more than one return value, we can construct and dereference an anonymous array. In this case, we call the function in list context.</p>

<pre><code><code>    <span class="keyword">print</span> <span class="string">"The time values are @{ [localtime] }.\n"</span><span class="operator">;</span>
</code></code></pre>

<p>If we want to call the function in scalar context, we have to do a bit more work. We can really have any code we like inside the braces, so we simply have to end with the scalar reference, although how you do that is up to you, and you can use code inside the braces. Note that the use of parens creates a list context, so we need <code><code>scalar</code></code> to force the scalar context on the function:</p>

<pre><code><code>    <span class="keyword">print</span> <span class="string">"The time is ${\(scalar localtime)}.\n"</span>
    
    <span class="keyword">print</span> <span class="string">"The time is ${ my </span><span class="variable">$x</span><span class="string"> = localtime; \$x }.\n"</span><span class="operator">;</span>
</code></code></pre>

<p>If your function already returns a reference, you don&#39;t need to create the reference yourself.</p>

<pre><code><code>    <span class="keyword">sub</span><span class="variable"> timestamp </span><span class="operator">{</span> <span class="keyword">my</span> <span class="variable">$t</span> <span class="operator">=</span> <span class="keyword">localtime</span><span class="operator">;</span> <span class="operator">\</span><span class="variable">$t</span> <span class="operator">}</span>
    
    <span class="keyword">print</span> <span class="string">"The time is ${ timestamp() }.\n"</span><span class="operator">;</span>
</code></code></pre>

<p>The <code><code>Interpolation</code></code> module can also do a lot of magic for you. You can specify a variable name, in this case <code><code>E</code></code>, to set up a tied hash that does the interpolation for you. It has several other methods to do this as well.</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Interpolation</span> <span class="string">E</span> <span class="operator">=&gt;</span> <span class="string">'eval'</span><span class="operator">;</span>
    <span class="keyword">print</span> <span class="string">"The time values are </span><span class="variable">$E</span><span class="string">{localtime()}.\n"</span><span class="operator">;</span>
</code></code></pre>

<p>In most cases, it is probably easier to simply use string concatenation, which also forces scalar context.</p>

<pre><code><code>    <span class="keyword">print</span> <span class="string">"The time is "</span> <span class="operator">.</span> <span class="keyword">localtime</span><span class="operator">()</span> <span class="operator">.</span> <span class="string">".\n"</span><span class="operator">;</span>
</code></code></pre>

<h2 id="How-do-I-find-matching-nesting-anything-">How do I find matching/nesting anything?</h2>

<p>To find something between two single characters, a pattern like <code><code>/x([^x]*)x/</code></code> will get the intervening bits in $1. For multiple ones, then something more like <code><code>/alpha(.*?)omega/</code></code> would be needed. For nested patterns and/or balanced expressions, see the so-called <a href="../../lib/pods/perlre.html#PARNO--PARNO-PARNO-R-0-">(?PARNO)</a> construct (available since perl 5.10). The CPAN module <a>Regexp::Common</a> can help to build such regular expressions (see in particular <a>Regexp::Common::balanced</a> and <a>Regexp::Common::delimited</a>).</p>

<p>More complex cases will require to write a parser, probably using a parsing module from CPAN, like <a>Regexp::Grammars</a>, <a>Parse::RecDescent</a>, <a>Parse::Yapp</a>, <a href="../../lib/Text/Balanced.html">Text::Balanced</a>, or <a>Marpa::XS</a>.</p>

<h2 id="How-do-I-reverse-a-string-">How do I reverse a string?</h2>

<p>Use <code><code>reverse()</code></code> in scalar context, as documented in <a href="../../lib/pods/perlfunc.html#reverse">&quot;reverse&quot; in perlfunc</a>.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$reversed</span> <span class="operator">=</span> <span class="keyword">reverse</span> <span class="variable">$string</span><span class="operator">;</span>
</code></code></pre>

<h2 id="How-do-I-expand-tabs-in-a-string-">How do I expand tabs in a string?</h2>

<p>You can do it yourself:</p>

<pre><code><code>    <span class="number">1</span> <span class="keyword">while</span> <span class="variable">$string</span> <span class="operator">=~</span> <span class="regex">s/\t+/' ' x (length($&amp;) * 8 - length($`) % 8)/e</span><span class="operator">;</span>
</code></code></pre>

<p>Or you can just use the <a href="../../lib/Text/Tabs.html">Text::Tabs</a> module (part of the standard Perl distribution).</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Text::Tabs</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">@expanded_lines</span> <span class="operator">=</span> <span class="variable">expand</span><span class="operator">(</span><span class="variable">@lines_with_tabs</span><span class="operator">);</span>
</code></code></pre>

<h2 id="How-do-I-reformat-a-paragraph-">How do I reformat a paragraph?</h2>

<p>Use <a href="../../lib/Text/Wrap.html">Text::Wrap</a> (part of the standard Perl distribution):</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Text::Wrap</span><span class="operator">;</span>
    <span class="keyword">print</span> <span class="variable">wrap</span><span class="operator">(</span><span class="string">"\t"</span><span class="operator">,</span> <span class="string">'  '</span><span class="operator">,</span> <span class="variable">@paragraphs</span><span class="operator">);</span>
</code></code></pre>

<p>The paragraphs you give to <a href="../../lib/Text/Wrap.html">Text::Wrap</a> should not contain embedded newlines. <a href="../../lib/Text/Wrap.html">Text::Wrap</a> doesn&#39;t justify the lines (flush-right).</p>

<p>Or use the CPAN module <a href="../../lib/Text/Autoformat.html">Text::Autoformat</a>. Formatting files can be easily done by making a shell alias, like so:</p>

<pre><code><code>    <span class="variable">alias</span> <span class="variable">fmt</span><span class="operator">=</span><span class="string">"perl -i -MText::Autoformat -n0777 \
        -e 'print autoformat </span><span class="variable">$_</span><span class="string">, {all=&gt;1}' $*"</span>
</code></code></pre>

<p>See the documentation for <a href="../../lib/Text/Autoformat.html">Text::Autoformat</a> to appreciate its many capabilities.</p>

<h2 id="How-can-I-access-or-change-N-characters-of-a-string-">How can I access or change N characters of a string?</h2>

<p>You can access the first characters of a string with substr(). To get the first character, for example, start at position 0 and grab the string of length 1.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$string</span> <span class="operator">=</span> <span class="string">"Just another Perl Hacker"</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$first_char</span> <span class="operator">=</span> <span class="keyword">substr</span><span class="operator">(</span> <span class="variable">$string</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="number">1</span> <span class="operator">);</span>  <span class="comment">#  'J'</span>
</code></code></pre>

<p>To change part of a string, you can use the optional fourth argument which is the replacement string.</p>

<pre><code><code>    <span class="keyword">substr</span><span class="operator">(</span> <span class="variable">$string</span><span class="operator">,</span> <span class="number">13</span><span class="operator">,</span> <span class="number">4</span><span class="operator">,</span> <span class="string">"Perl 5.8.0"</span> <span class="operator">);</span>
</code></code></pre>

<p>You can also use substr() as an lvalue.</p>

<pre><code><code>    <span class="keyword">substr</span><span class="operator">(</span> <span class="variable">$string</span><span class="operator">,</span> <span class="number">13</span><span class="operator">,</span> <span class="number">4</span> <span class="operator">)</span> <span class="operator">=</span>  <span class="string">"Perl 5.8.0"</span><span class="operator">;</span>
</code></code></pre>

<h2 id="How-do-I-change-the-Nth-occurrence-of-something-">How do I change the Nth occurrence of something?</h2>

<p>You have to keep track of N yourself. For example, let&#39;s say you want to change the fifth occurrence of <code><code>&quot;whoever&quot;</code></code> or <code><code>&quot;whomever&quot;</code></code> into <code><code>&quot;whosoever&quot;</code></code> or <code><code>&quot;whomsoever&quot;</code></code>, case insensitively. These all assume that $_ contains the string to be altered.</p>

<pre><code><code>    <span class="variable">$count</span> <span class="operator">=</span> <span class="number">0</span><span class="operator">;</span>
    <span class="regex">s{((whom?)ever)}{
    ++$count == 5       # is it the 5th?
        ? "${2}soever"  # yes, swap
        : $1            # renege and leave it there
        }ige</span><span class="operator">;</span>
</code></code></pre>

<p>In the more general case, you can use the <code><code>/g</code></code> modifier in a <code><code>while</code></code> loop, keeping count of matches.</p>

<pre><code><code>    <span class="variable">$WANT</span> <span class="operator">=</span> <span class="number">3</span><span class="operator">;</span>
    <span class="variable">$count</span> <span class="operator">=</span> <span class="number">0</span><span class="operator">;</span>
    <span class="variable">$_</span> <span class="operator">=</span> <span class="string">"One fish two fish red fish blue fish"</span><span class="operator">;</span>
    <span class="keyword">while</span> <span class="operator">(</span><span class="regex">/(\w+)\s+fish\b/gi</span><span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">if</span> <span class="operator">(++</span><span class="variable">$count</span> <span class="operator">==</span> <span class="variable">$WANT</span><span class="operator">)</span> <span class="operator">{</span>
            <span class="keyword">print</span> <span class="string">"The third fish is a </span><span class="variable">$1</span><span class="string"> one.\n"</span><span class="operator">;</span>
        <span class="operator">}</span>
    <span class="operator">}</span>
</code></code></pre>

<p>That prints out: <code><code>&quot;The third fish is a red one.&quot;</code></code> You can also use a repetition count and repeated pattern like this:</p>

<pre><code><code>    <span class="regex">/(?:\w+\s+fish\s+){2}(\w+)\s+fish/i</span><span class="operator">;</span>
</code></code></pre>

<h2 id="How-can-I-count-the-number-of-occurrences-of-a-substring-within-a-string-">How can I count the number of occurrences of a substring within a string?</h2>

<p>There are a number of ways, with varying efficiency. If you want a count of a certain single character (X) within a string, you can use the <code><code>tr///</code></code> function like so:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$string</span> <span class="operator">=</span> <span class="string">"ThisXlineXhasXsomeXx'sXinXit"</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$count</span> <span class="operator">=</span> <span class="operator">(</span><span class="variable">$string</span> <span class="operator">=~</span> <span class="regex">tr/X//</span><span class="operator">);</span>
    <span class="keyword">print</span> <span class="string">"There are </span><span class="variable">$count</span><span class="string"> X characters in the string"</span><span class="operator">;</span>
</code></code></pre>

<p>This is fine if you are just looking for a single character. However, if you are trying to count multiple character substrings within a larger string, <code><code>tr///</code></code> won&#39;t work. What you can do is wrap a while() loop around a global pattern match. For example, let&#39;s count negative integers:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$string</span> <span class="operator">=</span> <span class="string">"-9 55 48 -2 23 -76 4 14 -44"</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$count</span> <span class="operator">=</span> <span class="number">0</span><span class="operator">;</span>
    <span class="keyword">while</span> <span class="operator">(</span><span class="variable">$string</span> <span class="operator">=~</span> <span class="regex">/-\d+/g</span><span class="operator">)</span> <span class="operator">{</span> <span class="variable">$count</span><span class="operator">++</span> <span class="operator">}</span>
    <span class="keyword">print</span> <span class="string">"There are </span><span class="variable">$count</span><span class="string"> negative numbers in the string"</span><span class="operator">;</span>
</code></code></pre>

<p>Another version uses a global match in list context, then assigns the result to a scalar, producing a count of the number of matches.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$count</span> <span class="operator">=</span> <span class="operator">()</span> <span class="operator">=</span> <span class="variable">$string</span> <span class="operator">=~</span> <span class="regex">/-\d+/g</span><span class="operator">;</span>
</code></code></pre>

<h2 id="How-do-I-capitalize-all-the-words-on-one-line-">How do I capitalize all the words on one line?    </h2>

<p>(contributed by brian d foy)</p>

<p>Damian Conway&#39;s <a href="../../lib/Text/Autoformat.html">Text::Autoformat</a> handles all of the thinking for you.</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Text::Autoformat</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$x</span> <span class="operator">=</span> <span class="string">"Dr. Strangelove or: How I Learned to Stop "</span><span class="operator">.</span>
      <span class="string">"Worrying and Love the Bomb"</span><span class="operator">;</span>
    
    <span class="keyword">print</span> <span class="variable">$x</span><span class="operator">,</span> <span class="string">"\n"</span><span class="operator">;</span>
    <span class="keyword">for</span> <span class="keyword">my</span> <span class="variable">$style</span> <span class="operator">(</span><span class="string">qw( sentence title highlight )</span><span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">print</span> <span class="variable">autoformat</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="operator">{</span> <span class="string">case</span> <span class="operator">=&gt;</span> <span class="variable">$style</span> <span class="operator">}</span><span class="operator">),</span> <span class="string">"\n"</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>How do you want to capitalize those words?</p>

<pre><code><code>    FRED AND BARNEY&#39;S LODGE        # all uppercase
    Fred And Barney&#39;s Lodge        # title case
    Fred and Barney&#39;s Lodge        # highlight case</code></code></pre>

<p>It&#39;s not as easy a problem as it looks. How many words do you think are in there? Wait for it... wait for it.... If you answered 5 you&#39;re right. Perl words are groups of <code><code>\w+</code></code>, but that&#39;s not what you want to capitalize. How is Perl supposed to know not to capitalize that <code><code>s</code></code> after the apostrophe? You could try a regular expression:</p>

<pre><code><code>    <span class="variable">$string</span> <span class="operator">=~</span> <span class="regex">s/ (
                 (^\w)    #at the beginning of the line
                   |      # or
                 (\s\w)   #preceded by whitespace
                   )
                /\U$1/xg</span><span class="operator">;</span>
    
    <span class="variable">$string</span> <span class="operator">=~</span> <span class="regex">s/([\w']+)/\u\L$1/g</span><span class="operator">;</span>
</code></code></pre>

<p>Now, what if you don&#39;t want to capitalize that &quot;and&quot;? Just use <a href="../../lib/Text/Autoformat.html">Text::Autoformat</a> and get on with the next problem. :)</p>

<h2 id="How-can-I-split-a-character--delimited-string-except-when-inside-character-">How can I split a [character]-delimited string except when inside [character]?</h2>

<p>Several modules can handle this sort of parsing--<a href="../../lib/Text/Balanced.html">Text::Balanced</a>, <a>Text::CSV</a>, <a href="../../lib/Text/CSV_XS.html">Text::CSV_XS</a>, and <a href="../../lib/Text/ParseWords.html">Text::ParseWords</a>, among others.</p>

<p>Take the example case of trying to split a string that is comma-separated into its different fields. You can&#39;t use <code><code>split(/,/)</code></code> because you shouldn&#39;t split if the comma is inside quotes. For example, take a data line like this:</p>

<pre><code><code>    SAR001,&quot;&quot;,&quot;Cimetrix, Inc&quot;,&quot;Bob Smith&quot;,&quot;CAM&quot;,N,8,1,0,7,&quot;Error, Core Dumped&quot;</code></code></pre>

<p>Due to the restriction of the quotes, this is a fairly complex problem. Thankfully, we have Jeffrey Friedl, author of <i>Mastering Regular Expressions</i>, to handle these for us. He suggests (assuming your string is contained in <code><code>$text</code></code>):</p>

<pre><code><code>     <span class="keyword">my</span> <span class="variable">@new</span> <span class="operator">=</span> <span class="operator">();</span>
     <span class="keyword">push</span><span class="operator">(</span><span class="variable">@new</span><span class="operator">,</span> <span class="variable">$+</span><span class="operator">)</span> <span class="keyword">while</span> <span class="variable">$text</span> <span class="operator">=~</span> <span class="regex">m{
         "([^\"\\]*(?:\\.[^\"\\]*)*)",? # groups the phrase inside the quotes
        | ([^,]+),?
        | ,
     }gx</span><span class="operator">;</span>
     <span class="keyword">push</span><span class="operator">(</span><span class="variable">@new</span><span class="operator">,</span> <span class="keyword">undef</span><span class="operator">)</span> <span class="keyword">if</span> <span class="keyword">substr</span><span class="operator">(</span><span class="variable">$text</span><span class="operator">,-</span><span class="number">1</span><span class="operator">,</span><span class="number">1</span><span class="operator">)</span> <span class="keyword">eq</span> <span class="string">','</span><span class="operator">;</span>
</code></code></pre>

<p>If you want to represent quotation marks inside a quotation-mark-delimited field, escape them with backslashes (eg, <code><code>&quot;like \&quot;this\&quot;&quot;</code></code>.</p>

<p>Alternatively, the <a href="../../lib/Text/ParseWords.html">Text::ParseWords</a> module (part of the standard Perl distribution) lets you say:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Text::ParseWords</span><span class="operator">;</span>
    <span class="variable">@new</span> <span class="operator">=</span> <span class="variable">quotewords</span><span class="operator">(</span><span class="string">","</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="variable">$text</span><span class="operator">);</span>
</code></code></pre>

<p>For parsing or generating CSV, though, using <a>Text::CSV</a> rather than implementing it yourself is highly recommended; you&#39;ll save yourself odd bugs popping up later by just using code which has already been tried and tested in production for years.</p>

<h2 id="How-do-I-strip-blank-space-from-the-beginning-end-of-a-string-">How do I strip blank space from the beginning/end of a string?</h2>

<p>(contributed by brian d foy)</p>

<p>A substitution can do this for you. For a single line, you want to replace all the leading or trailing whitespace with nothing. You can do that with a pair of substitutions:</p>

<pre><code><code>    <span class="regex">s/^\s+//</span><span class="operator">;</span>
    <span class="regex">s/\s+$//</span><span class="operator">;</span>
</code></code></pre>

<p>You can also write that as a single substitution, although it turns out the combined statement is slower than the separate ones. That might not matter to you, though:</p>

<pre><code><code>    <span class="regex">s/^\s+|\s+$//g</span><span class="operator">;</span>
</code></code></pre>

<p>In this regular expression, the alternation matches either at the beginning or the end of the string since the anchors have a lower precedence than the alternation. With the <code><code>/g</code></code> flag, the substitution makes all possible matches, so it gets both. Remember, the trailing newline matches the <code><code>\s+</code></code>, and the <code><code>$</code></code> anchor can match to the absolute end of the string, so the newline disappears too. Just add the newline to the output, which has the added benefit of preserving &quot;blank&quot; (consisting entirely of whitespace) lines which the <code><code>^\s+</code></code> would remove all by itself:</p>

<pre><code><code>    <span class="keyword">while</span><span class="operator">(</span> <span class="operator">&lt;&gt;</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="regex">s/^\s+|\s+$//g</span><span class="operator">;</span>
        <span class="keyword">print</span> <span class="string">"</span><span class="variable">$_</span><span class="string">\n"</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>For a multi-line string, you can apply the regular expression to each logical line in the string by adding the <code><code>/m</code></code> flag (for &quot;multi-line&quot;). With the <code><code>/m</code></code> flag, the <code><code>$</code></code> matches <i>before</i> an embedded newline, so it doesn&#39;t remove it. This pattern still removes the newline at the end of the string:</p>

<pre><code><code>    <span class="variable">$string</span> <span class="operator">=~</span> <span class="regex">s/^\s+|\s+$//gm</span><span class="operator">;</span>
</code></code></pre>

<p>Remember that lines consisting entirely of whitespace will disappear, since the first part of the alternation can match the entire string and replace it with nothing. If you need to keep embedded blank lines, you have to do a little more work. Instead of matching any whitespace (since that includes a newline), just match the other whitespace:</p>

<pre><code><code>    <span class="variable">$string</span> <span class="operator">=~</span> <span class="regex">s/^[\t\f ]+|[\t\f ]+$//mg</span><span class="operator">;</span>
</code></code></pre>

<h2 id="How-do-I-pad-a-string-with-blanks-or-pad-a-number-with-zeroes-">How do I pad a string with blanks or pad a number with zeroes?</h2>

<p>In the following examples, <code><code>$pad_len</code></code> is the length to which you wish to pad the string, <code><code>$text</code></code> or <code><code>$num</code></code> contains the string to be padded, and <code><code>$pad_char</code></code> contains the padding character. You can use a single character string constant instead of the <code><code>$pad_char</code></code> variable if you know what it is in advance. And in the same way you can use an integer in place of <code><code>$pad_len</code></code> if you know the pad length in advance.</p>

<p>The simplest method uses the <code><code>sprintf</code></code> function. It can pad on the left or right with blanks and on the left with zeroes and it will not truncate the result. The <code><code>pack</code></code> function can only pad strings on the right with blanks and it will truncate the result to a maximum length of <code><code>$pad_len</code></code>.</p>

<pre><code><code>    <span class="comment"># Left padding a string with blanks (no truncation):</span>
    <span class="keyword">my</span> <span class="variable">$padded</span> <span class="operator">=</span> <span class="keyword">sprintf</span><span class="operator">(</span><span class="string">"%${pad_len}s"</span><span class="operator">,</span> <span class="variable">$text</span><span class="operator">);</span>
    <span class="keyword">my</span> <span class="variable">$padded</span> <span class="operator">=</span> <span class="keyword">sprintf</span><span class="operator">(</span><span class="string">"%*s"</span><span class="operator">,</span> <span class="variable">$pad_len</span><span class="operator">,</span> <span class="variable">$text</span><span class="operator">);</span>  <span class="comment"># same thing</span>
    
    <span class="comment"># Right padding a string with blanks (no truncation):</span>
    <span class="keyword">my</span> <span class="variable">$padded</span> <span class="operator">=</span> <span class="keyword">sprintf</span><span class="operator">(</span><span class="string">"%-${pad_len}s"</span><span class="operator">,</span> <span class="variable">$text</span><span class="operator">);</span>
    <span class="keyword">my</span> <span class="variable">$padded</span> <span class="operator">=</span> <span class="keyword">sprintf</span><span class="operator">(</span><span class="string">"%-*s"</span><span class="operator">,</span> <span class="variable">$pad_len</span><span class="operator">,</span> <span class="variable">$text</span><span class="operator">);</span> <span class="comment"># same thing</span>
    
    <span class="comment"># Left padding a number with 0 (no truncation):</span>
    <span class="keyword">my</span> <span class="variable">$padded</span> <span class="operator">=</span> <span class="keyword">sprintf</span><span class="operator">(</span><span class="string">"%0${pad_len}d"</span><span class="operator">,</span> <span class="variable">$num</span><span class="operator">);</span>
    <span class="keyword">my</span> <span class="variable">$padded</span> <span class="operator">=</span> <span class="keyword">sprintf</span><span class="operator">(</span><span class="string">"%0*d"</span><span class="operator">,</span> <span class="variable">$pad_len</span><span class="operator">,</span> <span class="variable">$num</span><span class="operator">);</span> <span class="comment"># same thing</span>
    
    <span class="comment"># Right padding a string with blanks using pack (will truncate):</span>
    <span class="keyword">my</span> <span class="variable">$padded</span> <span class="operator">=</span> <span class="keyword">pack</span><span class="operator">(</span><span class="string">"A</span><span class="variable">$pad_len</span><span class="string">"</span><span class="operator">,</span><span class="variable">$text</span><span class="operator">);</span>
</code></code></pre>

<p>If you need to pad with a character other than blank or zero you can use one of the following methods. They all generate a pad string with the <code><code>x</code></code> operator and combine that with <code><code>$text</code></code>. These methods do not truncate <code><code>$text</code></code>.</p>

<p>Left and right padding with any character, creating a new string:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$padded</span> <span class="operator">=</span> <span class="variable">$pad_char</span> <span class="operator">x</span> <span class="operator">(</span> <span class="variable">$pad_len</span> <span class="operator">-</span> <span class="keyword">length</span><span class="operator">(</span> <span class="variable">$text</span> <span class="operator">)</span> <span class="operator">)</span> <span class="operator">.</span> <span class="variable">$text</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$padded</span> <span class="operator">=</span> <span class="variable">$text</span> <span class="operator">.</span> <span class="variable">$pad_char</span> <span class="operator">x</span> <span class="operator">(</span> <span class="variable">$pad_len</span> <span class="operator">-</span> <span class="keyword">length</span><span class="operator">(</span> <span class="variable">$text</span> <span class="operator">)</span> <span class="operator">);</span>
</code></code></pre>

<p>Left and right padding with any character, modifying <code><code>$text</code></code> directly:</p>

<pre><code><code>    <span class="keyword">substr</span><span class="operator">(</span> <span class="variable">$text</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="number">0</span> <span class="operator">)</span> <span class="operator">=</span> <span class="variable">$pad_char</span> <span class="operator">x</span> <span class="operator">(</span> <span class="variable">$pad_len</span> <span class="operator">-</span> <span class="keyword">length</span><span class="operator">(</span> <span class="variable">$text</span> <span class="operator">)</span> <span class="operator">);</span>
    <span class="variable">$text</span> <span class="operator">.=</span> <span class="variable">$pad_char</span> <span class="operator">x</span> <span class="operator">(</span> <span class="variable">$pad_len</span> <span class="operator">-</span> <span class="keyword">length</span><span class="operator">(</span> <span class="variable">$text</span> <span class="operator">)</span> <span class="operator">);</span>
</code></code></pre>

<h2 id="How-do-I-extract-selected-columns-from-a-string-">How do I extract selected columns from a string?</h2>

<p>(contributed by brian d foy)</p>

<p>If you know the columns that contain the data, you can use <code><code>substr</code></code> to extract a single column.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$column</span> <span class="operator">=</span> <span class="keyword">substr</span><span class="operator">(</span> <span class="variable">$line</span><span class="operator">,</span> <span class="variable">$start_column</span><span class="operator">,</span> <span class="variable">$length</span> <span class="operator">);</span>
</code></code></pre>

<p>You can use <code><code>split</code></code> if the columns are separated by whitespace or some other delimiter, as long as whitespace or the delimiter cannot appear as part of the data.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$line</span>    <span class="operator">=</span> <span class="string">' fred barney   betty   '</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">@columns</span> <span class="operator">=</span> <span class="keyword">split</span> <span class="regex">/\s+/</span><span class="operator">,</span> <span class="variable">$line</span><span class="operator">;</span>
        <span class="comment"># ( '', 'fred', 'barney', 'betty' );</span>
    
    <span class="keyword">my</span> <span class="variable">$line</span>    <span class="operator">=</span> <span class="string">'fred||barney||betty'</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">@columns</span> <span class="operator">=</span> <span class="keyword">split</span> <span class="regex">/\|/</span><span class="operator">,</span> <span class="variable">$line</span><span class="operator">;</span>
        <span class="comment"># ( 'fred', '', 'barney', '', 'betty' );</span>
</code></code></pre>

<p>If you want to work with comma-separated values, don&#39;t do this since that format is a bit more complicated. Use one of the modules that handle that format, such as <a>Text::CSV</a>, <a href="../../lib/Text/CSV_XS.html">Text::CSV_XS</a>, or <a>Text::CSV_PP</a>.</p>

<p>If you want to break apart an entire line of fixed columns, you can use <code><code>unpack</code></code> with the A (ASCII) format. By using a number after the format specifier, you can denote the column width. See the <code><code>pack</code></code> and <code><code>unpack</code></code> entries in <a href="../../lib/pods/perlfunc.html">perlfunc</a> for more details.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@fields</span> <span class="operator">=</span> <span class="keyword">unpack</span><span class="operator">(</span> <span class="variable">$line</span><span class="operator">,</span> <span class="string">"A8 A8 A8 A16 A4"</span> <span class="operator">);</span>
</code></code></pre>

<p>Note that spaces in the format argument to <code><code>unpack</code></code> do not denote literal spaces. If you have space separated data, you may want <code><code>split</code></code> instead.</p>

<h2 id="How-do-I-find-the-soundex-value-of-a-string-">How do I find the soundex value of a string?</h2>

<p>(contributed by brian d foy)</p>

<p>You can use the <code><code>Text::Soundex</code></code> module. If you want to do fuzzy or close matching, you might also try the <a>String::Approx</a>, and <a>Text::Metaphone</a>, and <a>Text::DoubleMetaphone</a> modules.</p>

<h2 id="How-can-I-expand-variables-in-text-strings-">How can I expand variables in text strings?</h2>

<p>(contributed by brian d foy)</p>

<p>If you can avoid it, don&#39;t, or if you can use a templating system, such as <a>Text::Template</a> or <a href="../../lib/HTML/Template.html">Template</a> Toolkit, do that instead. You might even be able to get the job done with <code><code>sprintf</code></code> or <code><code>printf</code></code>:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$string</span> <span class="operator">=</span> <span class="keyword">sprintf</span> <span class="string">'Say hello to %s and %s'</span><span class="operator">,</span> <span class="variable">$foo</span><span class="operator">,</span> <span class="variable">$bar</span><span class="operator">;</span>
</code></code></pre>

<p>However, for the one-off simple case where I don&#39;t want to pull out a full templating system, I&#39;ll use a string that has two Perl scalar variables in it. In this example, I want to expand <code><code>$foo</code></code> and <code><code>$bar</code></code> to their variable&#39;s values:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$foo</span> <span class="operator">=</span> <span class="string">'Fred'</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$bar</span> <span class="operator">=</span> <span class="string">'Barney'</span><span class="operator">;</span>
    <span class="variable">$string</span> <span class="operator">=</span> <span class="string">'Say hello to $foo and $bar'</span><span class="operator">;</span>
</code></code></pre>

<p>One way I can do this involves the substitution operator and a double <code><code>/e</code></code> flag. The first <code><code>/e</code></code> evaluates <code><code>$1</code></code> on the replacement side and turns it into <code><code>$foo</code></code>. The second /e starts with <code><code>$foo</code></code> and replaces it with its value. <code><code>$foo</code></code>, then, turns into &#39;Fred&#39;, and that&#39;s finally what&#39;s left in the string:</p>

<pre><code><code>    <span class="variable">$string</span> <span class="operator">=~</span> <span class="regex">s/(\$\w+)/$1/eeg</span><span class="operator">;</span> <span class="comment"># 'Say hello to Fred and Barney'</span>
</code></code></pre>

<p>The <code><code>/e</code></code> will also silently ignore violations of strict, replacing undefined variable names with the empty string. Since I&#39;m using the <code><code>/e</code></code> flag (twice even!), I have all of the same security problems I have with <code><code>eval</code></code> in its string form. If there&#39;s something odd in <code><code>$foo</code></code>, perhaps something like <code><code><span class="variable">@</span><span class="operator">{[</span> <span class="keyword">system</span> <span class="string">"rm -rf /"</span> <span class="operator">]}</span>
</code></code>, then I could get myself in trouble.</p>

<p>To get around the security problem, I could also pull the values from a hash instead of evaluating variable names. Using a single <code><code>/e</code></code>, I can check the hash to ensure the value exists, and if it doesn&#39;t, I can replace the missing value with a marker, in this case <code><code>???</code></code> to signal that I missed something:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$string</span> <span class="operator">=</span> <span class="string">'This has $foo and $bar'</span><span class="operator">;</span>
    
    <span class="keyword">my</span> <span class="variable">%Replacements</span> <span class="operator">=</span> <span class="operator">(</span>
        <span class="string">foo</span>  <span class="operator">=&gt;</span> <span class="string">'Fred'</span><span class="operator">,</span>
        <span class="operator">);</span>
    
    <span class="comment"># $string =~ s/\$(\w+)/$Replacements{$1}/g;</span>
    <span class="variable">$string</span> <span class="operator">=~</span> <span class="regex">s/\$(\w+)/
        exists $Replacements{$1} ? $Replacements{$1} : '???'
        /eg</span><span class="operator">;</span>
    
    <span class="keyword">print</span> <span class="variable">$string</span><span class="operator">;</span>
</code></code></pre>

<h2 id="Whats-wrong-with-always-quoting-vars-">What&#39;s wrong with always quoting &quot;$vars&quot;?</h2>

<p>The problem is that those double-quotes force stringification--coercing numbers and references into strings--even when you don&#39;t want them to be strings. Think of it this way: double-quote expansion is used to produce new strings. If you already have a string, why do you need more?</p>

<p>If you get used to writing odd things like these:</p>

<pre><code><code>    <span class="keyword">print</span> <span class="string">"</span><span class="variable">$var</span><span class="string">"</span><span class="operator">;</span>       <span class="comment"># BAD</span>
    <span class="keyword">my</span> <span class="variable">$new</span> <span class="operator">=</span> <span class="string">"</span><span class="variable">$old</span><span class="string">"</span><span class="operator">;</span>       <span class="comment"># BAD</span>
    <span class="variable">somefunc</span><span class="operator">(</span><span class="string">"</span><span class="variable">$var</span><span class="string">"</span><span class="operator">);</span>    <span class="comment"># BAD</span>
</code></code></pre>

<p>You&#39;ll be in trouble. Those should (in 99.8% of the cases) be the simpler and more direct:</p>

<pre><code><code>    <span class="keyword">print</span> <span class="variable">$var</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$new</span> <span class="operator">=</span> <span class="variable">$old</span><span class="operator">;</span>
    <span class="variable">somefunc</span><span class="operator">(</span><span class="variable">$var</span><span class="operator">);</span>
</code></code></pre>

<p>Otherwise, besides slowing you down, you&#39;re going to break code when the thing in the scalar is actually neither a string nor a number, but a reference:</p>

<pre><code><code>    <span class="variable">func</span><span class="operator">(\</span><span class="variable">@array</span><span class="operator">);</span>
    <span class="keyword">sub</span><span class="variable"> func </span><span class="operator">{</span>
        <span class="keyword">my</span> <span class="variable">$aref</span> <span class="operator">=</span> <span class="keyword">shift</span><span class="operator">;</span>
        <span class="keyword">my</span> <span class="variable">$oref</span> <span class="operator">=</span> <span class="string">"</span><span class="variable">$aref</span><span class="string">"</span><span class="operator">;</span>  <span class="comment"># WRONG</span>
    <span class="operator">}</span>
</code></code></pre>

<p>You can also get into subtle problems on those few operations in Perl that actually do care about the difference between a string and a number, such as the magical <code><code>++</code></code> autoincrement operator or the syscall() function.</p>

<p>Stringification also destroys arrays.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@lines</span> <span class="operator">=</span> <span class="string">`command`</span><span class="operator">;</span>
    <span class="keyword">print</span> <span class="string">"</span><span class="variable">@lines</span><span class="string">"</span><span class="operator">;</span>     <span class="comment"># WRONG - extra blanks</span>
    <span class="keyword">print</span> <span class="variable">@lines</span><span class="operator">;</span>       <span class="comment"># right</span>
</code></code></pre>

<h2 id="Why-dont-my-HERE-documents-work-">Why don&#39;t my &lt;&lt;HERE documents work?</h2>

<p>Here documents are found in <a href="../../lib/pods/perlop.html">perlop</a>. Check for these three things:</p>

<dl>

<dt id="There-must-be-no-space-after-the-part.">There must be no space after the &lt;&lt; part.</dt>
<dd>

</dd>
<dt id="There-probably-should-be-a-semicolon-at-the-end-of-the-opening-token">There (probably) should be a semicolon at the end of the opening token</dt>
<dd>

</dd>
<dt id="You-cant-easily-have-any-space-in-front-of-the-tag.">You can&#39;t (easily) have any space in front of the tag.</dt>
<dd>

</dd>
<dt id="There-needs-to-be-at-least-a-line-separator-after-the-end-token.">There needs to be at least a line separator after the end token.</dt>
<dd>

</dd>
</dl>

<p>If you want to indent the text in the here document, you can do this:</p>

<pre><code><code>    <span class="comment"># all in one</span>
    <span class="operator">(</span><span class="keyword">my</span> <span class="variable">$VAR</span> <span class="operator">=</span> <span class="operator">&lt;&lt;</span><span class="default">HERE_TARGET</span><span class="operator">)</span> <span class="operator">=~</span> <span class="regex">s/^\s+//gm</span><span class="operator">;</span><span class="string">
        your text
        goes here
    </span><span class="default">HERE_TARGET</span>
</code></code></pre>

<p>But the HERE_TARGET must still be flush against the margin. If you want that indented also, you&#39;ll have to quote in the indentation.</p>

<pre><code><code>    <span class="operator">(</span><span class="keyword">my</span> <span class="variable">$quote</span> <span class="operator">=</span> <span class="operator">&lt;&lt;</span><span class="default">'    FINIS'</span><span class="operator">)</span> <span class="operator">=~</span> <span class="regex">s/^\s+//gm</span><span class="operator">;</span><span class="string">
            ...we will have peace, when you and all your works have
            perished--and the works of your dark master to whom you
            would deliver us. You are a liar, Saruman, and a corrupter
            of men's hearts. --Theoden in /usr/src/perl/taint.c
    </span><span class="default">    FINIS</span>
    <span class="variable">$quote</span> <span class="operator">=~</span> <span class="regex">s/\s+--/\n--/</span><span class="operator">;</span>
</code></code></pre>

<p>A nice general-purpose fixer-upper function for indented here documents follows. It expects to be called with a here document as its argument. It looks to see whether each line begins with a common substring, and if so, strips that substring off. Otherwise, it takes the amount of leading whitespace found on the first line and removes that much off each subsequent line.</p>

<pre><code><code>    <span class="keyword">sub</span><span class="variable"> fix </span><span class="operator">{</span>
        <span class="keyword">local</span> <span class="variable">$_</span> <span class="operator">=</span> <span class="keyword">shift</span><span class="operator">;</span>
        <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$white</span><span class="operator">,</span> <span class="variable">$leader</span><span class="operator">);</span>  <span class="comment"># common whitespace and common leading string</span>
        <span class="keyword">if</span> <span class="operator">(</span><span class="regex">/^\s*(?:([^\w\s]+)(\s*).*\n)(?:\s*\g1\g2?.*\n)+$/</span><span class="operator">)</span> <span class="operator">{</span>
            <span class="operator">(</span><span class="variable">$white</span><span class="operator">,</span> <span class="variable">$leader</span><span class="operator">)</span> <span class="operator">=</span> <span class="operator">(</span><span class="variable">$2</span><span class="operator">,</span> <span class="keyword">quotemeta</span><span class="operator">(</span><span class="variable">$1</span><span class="operator">));</span>
        <span class="operator">}</span> <span class="keyword">else</span> <span class="operator">{</span>
            <span class="operator">(</span><span class="variable">$white</span><span class="operator">,</span> <span class="variable">$leader</span><span class="operator">)</span> <span class="operator">=</span> <span class="operator">(</span><span class="regex">/^(\s+)/</span><span class="operator">,</span> <span class="string">''</span><span class="operator">);</span>
        <span class="operator">}</span>
        <span class="regex">s/^\s*?</span><span class="variable">$leader</span><span class="regex">(?:</span><span class="variable">$white</span><span class="regex">)?//gm</span><span class="operator">;</span>
        <span class="keyword">return</span> <span class="variable">$_</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>This works with leading special strings, dynamically determined:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$remember_the_main</span> <span class="operator">=</span> <span class="variable">fix</span><span class="operator">&lt;&lt;</span><span class="default">'    MAIN_INTERPRETER_LOOP'</span><span class="operator">;</span><span class="string">
    @@@ int
    @@@ runops() {
    @@@     SAVEI32(runlevel);
    @@@     runlevel++;
    @@@     while ( op = (*op-&gt;op_ppaddr)() );
    @@@     TAINT_NOT;
    @@@     return 0;
    @@@ }
    MAIN_INTERPRETER_LOOP
    </span>
</code></code></pre>

<p>Or with a fixed amount of leading whitespace, with remaining indentation correctly preserved:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$poem</span> <span class="operator">=</span> <span class="variable">fix</span><span class="operator">&lt;&lt;</span><span class="default">EVER_ON_AND_ON</span><span class="operator">;</span><span class="string">
       Now far ahead the Road has gone,
      And I must follow, if I can,
       Pursuing it with eager feet,
      Until it joins some larger way
       Where many paths and errands meet.
      And whither then? I cannot say.
        --Bilbo in /usr/src/perl/pp_ctl.c
    </span><span class="default">EVER_ON_AND_ON</span>
</code></code></pre>

<h1 id="Data:-Arrays">Data: Arrays</h1>

<h2 id="What-is-the-difference-between-a-list-and-an-array-">What is the difference between a list and an array?</h2>

<p>(contributed by brian d foy)</p>

<p>A list is a fixed collection of scalars. An array is a variable that holds a variable collection of scalars. An array can supply its collection for list operations, so list operations also work on arrays:</p>

<pre><code><code>    <span class="comment"># slices</span>
    <span class="operator">(</span> <span class="string">'dog'</span><span class="operator">,</span> <span class="string">'cat'</span><span class="operator">,</span> <span class="string">'bird'</span> <span class="operator">)</span><span class="operator">[</span><span class="number">2</span><span class="operator">,</span><span class="number">3</span><span class="operator">]</span><span class="operator">;</span>
    <span class="variable">@animals</span><span class="operator">[</span><span class="number">2</span><span class="operator">,</span><span class="number">3</span><span class="operator">]</span><span class="operator">;</span>
    
    <span class="comment"># iteration</span>
    <span class="keyword">foreach</span> <span class="operator">(</span> <span class="string">qw( dog cat bird )</span> <span class="operator">)</span> <span class="operator">{</span> <span class="operator">...</span> <span class="operator">}</span>
    <span class="keyword">foreach</span> <span class="operator">(</span> <span class="variable">@animals</span> <span class="operator">)</span> <span class="operator">{</span> <span class="operator">...</span> <span class="operator">}</span>
    
    <span class="keyword">my</span> <span class="variable">@three</span> <span class="operator">=</span> <span class="keyword">grep</span> <span class="operator">{</span> <span class="keyword">length</span> <span class="operator">==</span> <span class="number">3</span> <span class="operator">}</span> <span class="string">qw( dog cat bird )</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">@three</span> <span class="operator">=</span> <span class="keyword">grep</span> <span class="operator">{</span> <span class="keyword">length</span> <span class="operator">==</span> <span class="number">3</span> <span class="operator">}</span> <span class="variable">@animals</span><span class="operator">;</span>
    
    <span class="comment"># supply an argument list</span>
    <span class="variable">wash_animals</span><span class="operator">(</span> <span class="string">qw( dog cat bird )</span> <span class="operator">);</span>
    <span class="variable">wash_animals</span><span class="operator">(</span> <span class="variable">@animals</span> <span class="operator">);</span>
</code></code></pre>

<p>Array operations, which change the scalars, rearranges them, or adds or subtracts some scalars, only work on arrays. These can&#39;t work on a list, which is fixed. Array operations include <code><code>shift</code></code>, <code><code>unshift</code></code>, <code><code>push</code></code>, <code><code>pop</code></code>, and <code><code>splice</code></code>.</p>

<p>An array can also change its length:</p>

<pre><code><code>    <span class="variable">$#animals</span> <span class="operator">=</span> <span class="number">1</span><span class="operator">;</span>  <span class="comment"># truncate to two elements</span>
    <span class="variable">$#animals</span> <span class="operator">=</span> <span class="number">10000</span><span class="operator">;</span> <span class="comment"># pre-extend to 10,001 elements</span>
</code></code></pre>

<p>You can change an array element, but you can&#39;t change a list element:</p>

<pre><code><code>    <span class="variable">$animals</span><span class="operator">[</span><span class="number">0</span><span class="operator">]</span> <span class="operator">=</span> <span class="string">'Rottweiler'</span><span class="operator">;</span>
    <span class="string">qw( dog cat bird )</span><span class="operator">[</span><span class="number">0</span><span class="operator">]</span> <span class="operator">=</span> <span class="string">'Rottweiler'</span><span class="operator">;</span> <span class="comment"># syntax error!</span>
    
    <span class="keyword">foreach</span> <span class="operator">(</span> <span class="variable">@animals</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="regex">s/^d/fr/</span><span class="operator">;</span>  <span class="comment"># works fine</span>
    <span class="operator">}</span>
    
    <span class="keyword">foreach</span> <span class="operator">(</span> <span class="string">qw( dog cat bird )</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="regex">s/^d/fr/</span><span class="operator">;</span>  <span class="comment"># Error! Modification of read only value!</span>
    <span class="operator">}</span>
</code></code></pre>

<p>However, if the list element is itself a variable, it appears that you can change a list element. However, the list element is the variable, not the data. You&#39;re not changing the list element, but something the list element refers to. The list element itself doesn&#39;t change: it&#39;s still the same variable.</p>

<p>You also have to be careful about context. You can assign an array to a scalar to get the number of elements in the array. This only works for arrays, though:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$count</span> <span class="operator">=</span> <span class="variable">@animals</span><span class="operator">;</span>  <span class="comment"># only works with arrays</span>
</code></code></pre>

<p>If you try to do the same thing with what you think is a list, you get a quite different result. Although it looks like you have a list on the righthand side, Perl actually sees a bunch of scalars separated by a comma:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$scalar</span> <span class="operator">=</span> <span class="operator">(</span> <span class="string">'dog'</span><span class="operator">,</span> <span class="string">'cat'</span><span class="operator">,</span> <span class="string">'bird'</span> <span class="operator">);</span>  <span class="comment"># $scalar gets bird</span>
</code></code></pre>

<p>Since you&#39;re assigning to a scalar, the righthand side is in scalar context. The comma operator (yes, it&#39;s an operator!) in scalar context evaluates its lefthand side, throws away the result, and evaluates it&#39;s righthand side and returns the result. In effect, that list-lookalike assigns to <code><code>$scalar</code></code> it&#39;s rightmost value. Many people mess this up because they choose a list-lookalike whose last element is also the count they expect:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$scalar</span> <span class="operator">=</span> <span class="operator">(</span> <span class="number">1</span><span class="operator">,</span> <span class="number">2</span><span class="operator">,</span> <span class="number">3</span> <span class="operator">);</span>  <span class="comment"># $scalar gets 3, accidentally</span>
</code></code></pre>

<h2 id="What-is-the-difference-between-array-1-and-array-1-">What is the difference between $array[1] and @array[1]?</h2>

<p>(contributed by brian d foy)</p>

<p>The difference is the sigil, that special character in front of the array name. The <code><code>$</code></code> sigil means &quot;exactly one item&quot;, while the <code><code>@</code></code> sigil means &quot;zero or more items&quot;. The <code><code>$</code></code> gets you a single scalar, while the <code><code>@</code></code> gets you a list.</p>

<p>The confusion arises because people incorrectly assume that the sigil denotes the variable type.</p>

<p>The <code><code>$array[1]</code></code> is a single-element access to the array. It&#39;s going to return the item in index 1 (or undef if there is no item there). If you intend to get exactly one element from the array, this is the form you should use.</p>

<p>The <code><code>@array[1]</code></code> is an array slice, although it has only one index. You can pull out multiple elements simultaneously by specifying additional indices as a list, like <code><code>@array[1,4,3,0]</code></code>.</p>

<p>Using a slice on the lefthand side of the assignment supplies list context to the righthand side. This can lead to unexpected results. For instance, if you want to read a single line from a filehandle, assigning to a scalar value is fine:</p>

<pre><code><code>    <span class="variable">$array</span><span class="operator">[</span><span class="number">1</span><span class="operator">]</span> <span class="operator">=</span> <span class="operator">&lt;</span><span class="variable">STDIN</span><span class="operator">&gt;;</span>
</code></code></pre>

<p>However, in list context, the line input operator returns all of the lines as a list. The first line goes into <code><code>@array[1]</code></code> and the rest of the lines mysteriously disappear:</p>

<pre><code><code>    <span class="variable">@array</span><span class="operator">[</span><span class="number">1</span><span class="operator">]</span> <span class="operator">=</span> <span class="operator">&lt;</span><span class="variable">STDIN</span><span class="operator">&gt;;</span>  <span class="comment"># most likely not what you want</span>
</code></code></pre>

<p>Either the <code><code>use warnings</code></code> pragma or the <b>-w</b> flag will warn you when you use an array slice with a single index.</p>

<h2 id="How-can-I-remove-duplicate-elements-from-a-list-or-array-">How can I remove duplicate elements from a list or array?</h2>

<p>(contributed by brian d foy)</p>

<p>Use a hash. When you think the words &quot;unique&quot; or &quot;duplicated&quot;, think &quot;hash keys&quot;.</p>

<p>If you don&#39;t care about the order of the elements, you could just create the hash then extract the keys. It&#39;s not important how you create that hash: just that you use <code><code>keys</code></code> to get the unique elements.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">%hash</span>   <span class="operator">=</span> <span class="keyword">map</span> <span class="operator">{</span> <span class="variable">$_</span><span class="operator">,</span> <span class="number">1</span> <span class="operator">}</span> <span class="variable">@array</span><span class="operator">;</span>
    <span class="comment"># or a hash slice: @hash{ @array } = ();</span>
    <span class="comment"># or a foreach: $hash{$_} = 1 foreach ( @array );</span>
    
    <span class="keyword">my</span> <span class="variable">@unique</span> <span class="operator">=</span> <span class="keyword">keys</span> <span class="variable">%hash</span><span class="operator">;</span>
</code></code></pre>

<p>If you want to use a module, try the <code><code>uniq</code></code> function from <a href="../../lib/List/MoreUtils.html">List::MoreUtils</a>. In list context it returns the unique elements, preserving their order in the list. In scalar context, it returns the number of unique elements.</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">List::MoreUtils</span> <span class="string">qw(uniq)</span><span class="operator">;</span>
    
    <span class="keyword">my</span> <span class="variable">@unique</span> <span class="operator">=</span> <span class="variable">uniq</span><span class="operator">(</span> <span class="number">1</span><span class="operator">,</span> <span class="number">2</span><span class="operator">,</span> <span class="number">3</span><span class="operator">,</span> <span class="number">4</span><span class="operator">,</span> <span class="number">4</span><span class="operator">,</span> <span class="number">5</span><span class="operator">,</span> <span class="number">6</span><span class="operator">,</span> <span class="number">5</span><span class="operator">,</span> <span class="number">7</span> <span class="operator">);</span> <span class="comment"># 1,2,3,4,5,6,7</span>
    <span class="keyword">my</span> <span class="variable">$unique</span> <span class="operator">=</span> <span class="variable">uniq</span><span class="operator">(</span> <span class="number">1</span><span class="operator">,</span> <span class="number">2</span><span class="operator">,</span> <span class="number">3</span><span class="operator">,</span> <span class="number">4</span><span class="operator">,</span> <span class="number">4</span><span class="operator">,</span> <span class="number">5</span><span class="operator">,</span> <span class="number">6</span><span class="operator">,</span> <span class="number">5</span><span class="operator">,</span> <span class="number">7</span> <span class="operator">);</span> <span class="comment"># 7</span>
</code></code></pre>

<p>You can also go through each element and skip the ones you&#39;ve seen before. Use a hash to keep track. The first time the loop sees an element, that element has no key in <code><code>%Seen</code></code>. The <code><code>next</code></code> statement creates the key and immediately uses its value, which is <code><code>undef</code></code>, so the loop continues to the <code><code>push</code></code> and increments the value for that key. The next time the loop sees that same element, its key exists in the hash <i>and</i> the value for that key is true (since it&#39;s not 0 or <code><code>undef</code></code>), so the next skips that iteration and the loop goes to the next element.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@unique</span> <span class="operator">=</span> <span class="operator">();</span>
    <span class="keyword">my</span> <span class="variable">%seen</span>   <span class="operator">=</span> <span class="operator">();</span>
    
    <span class="keyword">foreach</span> <span class="keyword">my</span> <span class="variable">$elem</span> <span class="operator">(</span> <span class="variable">@array</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">next</span> <span class="keyword">if</span> <span class="variable">$seen</span><span class="operator">{</span> <span class="variable">$elem</span> <span class="operator">}</span><span class="operator">++;</span>
        <span class="keyword">push</span> <span class="variable">@unique</span><span class="operator">,</span> <span class="variable">$elem</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>You can write this more briefly using a grep, which does the same thing.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">%seen</span> <span class="operator">=</span> <span class="operator">();</span>
    <span class="keyword">my</span> <span class="variable">@unique</span> <span class="operator">=</span> <span class="keyword">grep</span> <span class="operator">{</span> <span class="operator">!</span> <span class="variable">$seen</span><span class="operator">{</span> <span class="variable">$_</span> <span class="operator">}</span><span class="operator">++</span> <span class="operator">}</span> <span class="variable">@array</span><span class="operator">;</span>
</code></code></pre>

<h2 id="How-can-I-tell-whether-a-certain-element-is-contained-in-a-list-or-array-">How can I tell whether a certain element is contained in a list or array?</h2>

<p>(portions of this answer contributed by Anno Siegel and brian d foy)</p>

<p>Hearing the word &quot;in&quot; is an <i>in</i>dication that you probably should have used a hash, not a list or array, to store your data. Hashes are designed to answer this question quickly and efficiently. Arrays aren&#39;t.</p>

<p>That being said, there are several ways to approach this. In Perl 5.10 and later, you can use the smart match operator to check that an item is contained in an array or a hash:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="number">5.010</span><span class="operator">;</span>
    
    <span class="keyword">if</span><span class="operator">(</span> <span class="variable">$item</span> <span class="operator">~~</span> <span class="variable">@array</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">say</span> <span class="string">"The array contains </span><span class="variable">$item</span><span class="string">"</span>
    <span class="operator">}</span>
    
    <span class="keyword">if</span><span class="operator">(</span> <span class="variable">$item</span> <span class="operator">~~</span> <span class="variable">%hash</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">say</span> <span class="string">"The hash contains </span><span class="variable">$item</span><span class="string">"</span>
    <span class="operator">}</span>
</code></code></pre>

<p>With earlier versions of Perl, you have to do a bit more work. If you are going to make this query many times over arbitrary string values, the fastest way is probably to invert the original array and maintain a hash whose keys are the first array&#39;s values:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@blues</span> <span class="operator">=</span> <span class="string">qw/azure cerulean teal turquoise lapis-lazuli/</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">%is_blue</span> <span class="operator">=</span> <span class="operator">();</span>
    <span class="keyword">for</span> <span class="operator">(</span><span class="variable">@blues</span><span class="operator">)</span> <span class="operator">{</span> <span class="variable">$is_blue</span><span class="operator">{</span><span class="variable">$_</span><span class="operator">}</span> <span class="operator">=</span> <span class="number">1</span> <span class="operator">}</span>
</code></code></pre>

<p>Now you can check whether <code><code><span class="variable">$is_blue</span><span class="operator">{</span><span class="variable">$some_color</span><span class="operator">}</span>
</code></code>. It might have been a good idea to keep the blues all in a hash in the first place.</p>

<p>If the values are all small integers, you could use a simple indexed array. This kind of an array will take up less space:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@primes</span> <span class="operator">=</span> <span class="operator">(</span><span class="number">2</span><span class="operator">,</span> <span class="number">3</span><span class="operator">,</span> <span class="number">5</span><span class="operator">,</span> <span class="number">7</span><span class="operator">,</span> <span class="number">11</span><span class="operator">,</span> <span class="number">13</span><span class="operator">,</span> <span class="number">17</span><span class="operator">,</span> <span class="number">19</span><span class="operator">,</span> <span class="number">23</span><span class="operator">,</span> <span class="number">29</span><span class="operator">,</span> <span class="number">31</span><span class="operator">);</span>
    <span class="keyword">my</span> <span class="variable">@is_tiny_prime</span> <span class="operator">=</span> <span class="operator">();</span>
    <span class="keyword">for</span> <span class="operator">(</span><span class="variable">@primes</span><span class="operator">)</span> <span class="operator">{</span> <span class="variable">$is_tiny_prime</span><span class="operator">[</span><span class="variable">$_</span><span class="operator">]</span> <span class="operator">=</span> <span class="number">1</span> <span class="operator">}</span>
    <span class="comment"># or simply  @istiny_prime[@primes] = (1) x @primes;</span>
</code></code></pre>

<p>Now you check whether $is_tiny_prime[$some_number].</p>

<p>If the values in question are integers instead of strings, you can save quite a lot of space by using bit strings instead:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@articles</span> <span class="operator">=</span> <span class="operator">(</span> <span class="number">1</span><span class="operator">..</span><span class="number">10</span><span class="operator">,</span> <span class="number">150</span><span class="operator">..</span><span class="number">2000</span><span class="operator">,</span> <span class="number">2017</span> <span class="operator">);</span>
    <span class="keyword">undef</span> <span class="variable">$read</span><span class="operator">;</span>
    <span class="keyword">for</span> <span class="operator">(</span><span class="variable">@articles</span><span class="operator">)</span> <span class="operator">{</span> <span class="keyword">vec</span><span class="operator">(</span><span class="variable">$read</span><span class="operator">,</span><span class="variable">$_</span><span class="operator">,</span><span class="number">1</span><span class="operator">)</span> <span class="operator">=</span> <span class="number">1</span> <span class="operator">}</span>
</code></code></pre>

<p>Now check whether <code><code>vec($read,$n,1)</code></code> is true for some <code><code>$n</code></code>.</p>

<p>These methods guarantee fast individual tests but require a re-organization of the original list or array. They only pay off if you have to test multiple values against the same array.</p>

<p>If you are testing only once, the standard module <a href="../../lib/List/Util.html">List::Util</a> exports the function <code><code>first</code></code> for this purpose. It works by stopping once it finds the element. It&#39;s written in C for speed, and its Perl equivalent looks like this subroutine:</p>

<pre><code><code>    <span class="keyword">sub</span><span class="variable"> first </span><span class="operator">(</span>&amp;@<span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">my</span> <span class="variable">$code</span> <span class="operator">=</span> <span class="keyword">shift</span><span class="operator">;</span>
        <span class="keyword">foreach</span> <span class="operator">(</span><span class="variable">@_</span><span class="operator">)</span> <span class="operator">{</span>
            <span class="keyword">return</span> <span class="variable">$_</span> <span class="keyword">if</span> <span class="operator">&amp;{</span><span class="variable">$code</span><span class="operator">}();</span>
        <span class="operator">}</span>
        <span class="keyword">undef</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>If speed is of little concern, the common idiom uses grep in scalar context (which returns the number of items that passed its condition) to traverse the entire list. This does have the benefit of telling you how many matches it found, though.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$is_there</span> <span class="operator">=</span> <span class="keyword">grep</span> <span class="variable">$_</span> <span class="keyword">eq</span> <span class="variable">$whatever</span><span class="operator">,</span> <span class="variable">@array</span><span class="operator">;</span>
</code></code></pre>

<p>If you want to actually extract the matching elements, simply use grep in list context.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@matches</span> <span class="operator">=</span> <span class="keyword">grep</span> <span class="variable">$_</span> <span class="keyword">eq</span> <span class="variable">$whatever</span><span class="operator">,</span> <span class="variable">@array</span><span class="operator">;</span>
</code></code></pre>

<h2 id="How-do-I-compute-the-difference-of-two-arrays-How-do-I-compute-the-intersection-of-two-arrays-">How do I compute the difference of two arrays? How do I compute the intersection of two arrays?</h2>

<p>Use a hash. Here&#39;s code to do both and more. It assumes that each element is unique in a given array:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="operator">(</span><span class="variable">@union</span><span class="operator">,</span> <span class="variable">@intersection</span><span class="operator">,</span> <span class="variable">@difference</span><span class="operator">);</span>
    <span class="keyword">my</span> <span class="variable">%count</span> <span class="operator">=</span> <span class="operator">();</span>
    <span class="keyword">foreach</span> <span class="keyword">my</span> <span class="variable">$element</span> <span class="operator">(</span><span class="variable">@array1</span><span class="operator">,</span> <span class="variable">@array2</span><span class="operator">)</span> <span class="operator">{</span> <span class="variable">$count</span><span class="operator">{</span><span class="variable">$element</span><span class="operator">}</span><span class="operator">++</span> <span class="operator">}</span>
    <span class="keyword">foreach</span> <span class="keyword">my</span> <span class="variable">$element</span> <span class="operator">(</span><span class="keyword">keys</span> <span class="variable">%count</span><span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">push</span> <span class="variable">@union</span><span class="operator">,</span> <span class="variable">$element</span><span class="operator">;</span>
        <span class="keyword">push</span> <span class="variable">@</span><span class="operator">{</span> <span class="variable">$count</span><span class="operator">{</span><span class="variable">$element</span><span class="operator">}</span> <span class="operator">&gt;</span> <span class="number">1</span> <span class="operator">?</span> <span class="operator">\</span><span class="variable">@intersection</span> <span class="operator">:</span> <span class="operator">\</span><span class="variable">@difference</span> <span class="operator">}</span><span class="operator">,</span> <span class="variable">$element</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>Note that this is the <i>symmetric difference</i>, that is, all elements in either A or in B but not in both. Think of it as an xor operation.</p>

<h2 id="How-do-I-test-whether-two-arrays-or-hashes-are-equal-">How do I test whether two arrays or hashes are equal?</h2>

<p>With Perl 5.10 and later, the smart match operator can give you the answer with the least amount of work:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="number">5.010</span><span class="operator">;</span>
    
    <span class="keyword">if</span><span class="operator">(</span> <span class="variable">@array1</span> <span class="operator">~~</span> <span class="variable">@array2</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">say</span> <span class="string">"The arrays are the same"</span><span class="operator">;</span>
    <span class="operator">}</span>
    
    <span class="keyword">if</span><span class="operator">(</span> <span class="variable">%hash1</span> <span class="operator">~~</span> <span class="variable">%hash2</span> <span class="operator">)</span> <span class="comment"># doesn't check values!  {</span>
        <span class="keyword">say</span> <span class="string">"The hash keys are the same"</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>The following code works for single-level arrays. It uses a stringwise comparison, and does not distinguish defined versus undefined empty strings. Modify if you have other needs.</p>

<pre><code><code>    <span class="variable">$are_equal</span> <span class="operator">=</span> <span class="variable">compare_arrays</span><span class="operator">(\</span><span class="variable">@frogs</span><span class="operator">,</span> <span class="operator">\</span><span class="variable">@toads</span><span class="operator">);</span>
    
    <span class="keyword">sub</span><span class="variable"> compare_arrays </span><span class="operator">{</span>
        <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$first</span><span class="operator">,</span> <span class="variable">$second</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">@_</span><span class="operator">;</span>
        <span class="keyword">no</span> <span class="variable">warnings</span><span class="operator">;</span>  <span class="comment"># silence spurious -w undef complaints</span>
        <span class="keyword">return</span> <span class="number">0</span> <span class="keyword">unless</span> <span class="variable">@$first</span> <span class="operator">==</span> <span class="variable">@$second</span><span class="operator">;</span>
        <span class="keyword">for</span> <span class="operator">(</span><span class="keyword">my</span> <span class="variable">$i</span> <span class="operator">=</span> <span class="number">0</span><span class="operator">;</span> <span class="variable">$i</span> <span class="operator">&lt;</span> <span class="variable">@$first</span><span class="operator">;</span> <span class="variable">$i</span><span class="operator">++)</span> <span class="operator">{</span>
            <span class="keyword">return</span> <span class="number">0</span> <span class="keyword">if</span> <span class="variable">$first</span><span class="operator">-&gt;</span><span class="operator">[</span><span class="variable">$i</span><span class="operator">]</span> <span class="keyword">ne</span> <span class="variable">$second</span><span class="operator">-&gt;</span><span class="operator">[</span><span class="variable">$i</span><span class="operator">]</span><span class="operator">;</span>
        <span class="operator">}</span>
        <span class="keyword">return</span> <span class="number">1</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>For multilevel structures, you may wish to use an approach more like this one. It uses the CPAN module <a>FreezeThaw</a>:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">FreezeThaw</span> <span class="string">qw(cmpStr)</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">@a</span> <span class="operator">=</span> <span class="keyword">my</span> <span class="variable">@b</span> <span class="operator">=</span> <span class="operator">(</span> <span class="string">"this"</span><span class="operator">,</span> <span class="string">"that"</span><span class="operator">,</span> <span class="operator">[</span> <span class="string">"more"</span><span class="operator">,</span> <span class="string">"stuff"</span> <span class="operator">]</span> <span class="operator">);</span>
    
    <span class="keyword">printf</span> <span class="string">"a and b contain %s arrays\n"</span><span class="operator">,</span>
        <span class="variable">cmpStr</span><span class="operator">(\</span><span class="variable">@a</span><span class="operator">,</span> <span class="operator">\</span><span class="variable">@b</span><span class="operator">)</span> <span class="operator">==</span> <span class="number">0</span>
        <span class="operator">?</span> <span class="string">"the same"</span>
        <span class="operator">:</span> <span class="string">"different"</span><span class="operator">;</span>
</code></code></pre>

<p>This approach also works for comparing hashes. Here we&#39;ll demonstrate two different answers:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">FreezeThaw</span> <span class="string">qw(cmpStr cmpStrHard)</span><span class="operator">;</span>
    
    <span class="keyword">my</span> <span class="variable">%a</span> <span class="operator">=</span> <span class="keyword">my</span> <span class="variable">%b</span> <span class="operator">=</span> <span class="operator">(</span> <span class="string">"this"</span> <span class="operator">=&gt;</span> <span class="string">"that"</span><span class="operator">,</span> <span class="string">"extra"</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">"more"</span><span class="operator">,</span> <span class="string">"stuff"</span> <span class="operator">]</span> <span class="operator">);</span>
    <span class="variable">$a</span><span class="operator">{</span><span class="string">EXTRA</span><span class="operator">}</span> <span class="operator">=</span> <span class="operator">\</span><span class="variable">%b</span><span class="operator">;</span>
    <span class="variable">$b</span><span class="operator">{</span><span class="string">EXTRA</span><span class="operator">}</span> <span class="operator">=</span> <span class="operator">\</span><span class="variable">%a</span><span class="operator">;</span>
    
    <span class="keyword">printf</span> <span class="string">"a and b contain %s hashes\n"</span><span class="operator">,</span>
    <span class="variable">cmpStr</span><span class="operator">(\</span><span class="variable">%a</span><span class="operator">,</span> <span class="operator">\</span><span class="variable">%b</span><span class="operator">)</span> <span class="operator">==</span> <span class="number">0</span> <span class="operator">?</span> <span class="string">"the same"</span> <span class="operator">:</span> <span class="string">"different"</span><span class="operator">;</span>
    
    <span class="keyword">printf</span> <span class="string">"a and b contain %s hashes\n"</span><span class="operator">,</span>
    <span class="variable">cmpStrHard</span><span class="operator">(\</span><span class="variable">%a</span><span class="operator">,</span> <span class="operator">\</span><span class="variable">%b</span><span class="operator">)</span> <span class="operator">==</span> <span class="number">0</span> <span class="operator">?</span> <span class="string">"the same"</span> <span class="operator">:</span> <span class="string">"different"</span><span class="operator">;</span>
</code></code></pre>

<p>The first reports that both those the hashes contain the same data, while the second reports that they do not. Which you prefer is left as an exercise to the reader.</p>

<h2 id="How-do-I-find-the-first-array-element-for-which-a-condition-is-true-">How do I find the first array element for which a condition is true?</h2>

<p>To find the first array element which satisfies a condition, you can use the <code><code>first()</code></code> function in the <a href="../../lib/List/Util.html">List::Util</a> module, which comes with Perl 5.8. This example finds the first element that contains &quot;Perl&quot;.</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">List::Util</span> <span class="string">qw(first)</span><span class="operator">;</span>
    
    <span class="keyword">my</span> <span class="variable">$element</span> <span class="operator">=</span> <span class="variable">first</span> <span class="operator">{</span> <span class="regex">/Perl/</span> <span class="operator">}</span> <span class="variable">@array</span><span class="operator">;</span>
</code></code></pre>

<p>If you cannot use <a href="../../lib/List/Util.html">List::Util</a>, you can make your own loop to do the same thing. Once you find the element, you stop the loop with last.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$found</span><span class="operator">;</span>
    <span class="keyword">foreach</span> <span class="operator">(</span> <span class="variable">@array</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">if</span><span class="operator">(</span> <span class="regex">/Perl/</span> <span class="operator">)</span> <span class="operator">{</span> <span class="variable">$found</span> <span class="operator">=</span> <span class="variable">$_</span><span class="operator">;</span> <span class="keyword">last</span> <span class="operator">}</span>
    <span class="operator">}</span>
</code></code></pre>

<p>If you want the array index, use the <code><code>firstidx()</code></code> function from <code><code>List::MoreUtils</code></code>:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">List::MoreUtils</span> <span class="string">qw(firstidx)</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$index</span> <span class="operator">=</span> <span class="variable">firstidx</span> <span class="operator">{</span> <span class="regex">/Perl/</span> <span class="operator">}</span> <span class="variable">@array</span><span class="operator">;</span>
</code></code></pre>

<p>Or write it yourself, iterating through the indices and checking the array element at each index until you find one that satisfies the condition:</p>

<pre><code><code>    <span class="keyword">my</span><span class="operator">(</span> <span class="variable">$found</span><span class="operator">,</span> <span class="variable">$index</span> <span class="operator">)</span> <span class="operator">=</span> <span class="operator">(</span> <span class="keyword">undef</span><span class="operator">,</span> <span class="operator">-</span><span class="number">1</span> <span class="operator">);</span>
    <span class="keyword">for</span><span class="operator">(</span> <span class="variable">$i</span> <span class="operator">=</span> <span class="number">0</span><span class="operator">;</span> <span class="variable">$i</span> <span class="operator">&lt;</span> <span class="variable">@array</span><span class="operator">;</span> <span class="variable">$i</span><span class="operator">++</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">if</span><span class="operator">(</span> <span class="variable">$array</span><span class="operator">[</span><span class="variable">$i</span><span class="operator">]</span> <span class="operator">=~</span> <span class="regex">/Perl/</span> <span class="operator">)</span> <span class="operator">{</span>
            <span class="variable">$found</span> <span class="operator">=</span> <span class="variable">$array</span><span class="operator">[</span><span class="variable">$i</span><span class="operator">]</span><span class="operator">;</span>
            <span class="variable">$index</span> <span class="operator">=</span> <span class="variable">$i</span><span class="operator">;</span>
            <span class="keyword">last</span><span class="operator">;</span>
        <span class="operator">}</span>
    <span class="operator">}</span>
</code></code></pre>

<h2 id="How-do-I-handle-linked-lists-">How do I handle linked lists?</h2>

<p>(contributed by brian d foy)</p>

<p>Perl&#39;s arrays do not have a fixed size, so you don&#39;t need linked lists if you just want to add or remove items. You can use array operations such as <code><code>push</code></code>, <code><code>pop</code></code>, <code><code>shift</code></code>, <code><code>unshift</code></code>, or <code><code>splice</code></code> to do that.</p>

<p>Sometimes, however, linked lists can be useful in situations where you want to &quot;shard&quot; an array so you have have many small arrays instead of a single big array. You can keep arrays longer than Perl&#39;s largest array index, lock smaller arrays separately in threaded programs, reallocate less memory, or quickly insert elements in the middle of the chain.</p>

<p>Steve Lembark goes through the details in his YAPC::NA 2009 talk &quot;Perly Linked Lists&quot; ( <a href="http://www.slideshare.net/lembark/perly-linked-lists">http://www.slideshare.net/lembark/perly-linked-lists</a> ), although you can just use his <a>LinkedList::Single</a> module.</p>

<h2 id="How-do-I-handle-circular-lists-">How do I handle circular lists?      </h2>

<p>(contributed by brian d foy)</p>

<p>If you want to cycle through an array endlessly, you can increment the index modulo the number of elements in the array:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@array</span> <span class="operator">=</span> <span class="string">qw( a b c )</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$i</span> <span class="operator">=</span> <span class="number">0</span><span class="operator">;</span>
    
    <span class="keyword">while</span><span class="operator">(</span> <span class="number">1</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">print</span> <span class="variable">$array</span><span class="operator">[</span> <span class="variable">$i</span><span class="operator">++</span> <span class="operator">% </span><span class="variable">@array</span> <span class="operator">]</span><span class="operator">,</span> <span class="string">"\n"</span><span class="operator">;</span>
        <span class="keyword">last</span> <span class="keyword">if</span> <span class="variable">$i</span> <span class="operator">&gt;</span> <span class="number">20</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>You can also use <a>Tie::Cycle</a> to use a scalar that always has the next element of the circular array:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Tie::Cycle</span><span class="operator">;</span>
    
    <span class="keyword">tie</span> <span class="keyword">my</span> <span class="variable">$cycle</span><span class="operator">,</span> <span class="string">'Tie::Cycle'</span><span class="operator">,</span> <span class="operator">[</span> <span class="string">qw( FFFFFF 000000 FFFF00 )</span> <span class="operator">]</span><span class="operator">;</span>
    
    <span class="keyword">print</span> <span class="variable">$cycle</span><span class="operator">;</span> <span class="comment"># FFFFFF</span>
    <span class="keyword">print</span> <span class="variable">$cycle</span><span class="operator">;</span> <span class="comment"># 000000</span>
    <span class="keyword">print</span> <span class="variable">$cycle</span><span class="operator">;</span> <span class="comment"># FFFF00</span>
</code></code></pre>

<p>The <a>Array::Iterator::Circular</a> creates an iterator object for circular arrays:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Array::Iterator::Circular</span><span class="operator">;</span>
    
    <span class="keyword">my</span> <span class="variable">$color_iterator</span> <span class="operator">=</span> <span class="variable">Array::Iterator::Circular</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span>
        <span class="string">qw(red green blue orange)</span>
        <span class="operator">);</span>
    
    <span class="keyword">foreach</span> <span class="operator">(</span> <span class="number">1</span> <span class="operator">..</span> <span class="number">20</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">print</span> <span class="variable">$color_iterator</span><span class="operator">-&gt;</span><span class="variable">next</span><span class="operator">,</span> <span class="string">"\n"</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<h2 id="How-do-I-shuffle-an-array-randomly-">How do I shuffle an array randomly?</h2>

<p>If you either have Perl 5.8.0 or later installed, or if you have Scalar-List-Utils 1.03 or later installed, you can say:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">List::Util</span> <span class="string">'shuffle'</span><span class="operator">;</span>
    
    <span class="variable">@shuffled</span> <span class="operator">=</span> <span class="variable">shuffle</span><span class="operator">(</span><span class="variable">@list</span><span class="operator">);</span>
</code></code></pre>

<p>If not, you can use a Fisher-Yates shuffle.</p>

<pre><code><code>    <span class="keyword">sub</span><span class="variable"> fisher_yates_shuffle </span><span class="operator">{</span>
        <span class="keyword">my</span> <span class="variable">$deck</span> <span class="operator">=</span> <span class="keyword">shift</span><span class="operator">;</span>  <span class="comment"># $deck is a reference to an array</span>
        <span class="keyword">return</span> <span class="keyword">unless</span> <span class="variable">@$deck</span><span class="operator">;</span> <span class="comment"># must not be empty!</span>
    
        <span class="keyword">my</span> <span class="variable">$i</span> <span class="operator">=</span> <span class="variable">@$deck</span><span class="operator">;</span>
        <span class="keyword">while</span> <span class="operator">(--</span><span class="variable">$i</span><span class="operator">)</span> <span class="operator">{</span>
            <span class="keyword">my</span> <span class="variable">$j</span> <span class="operator">=</span> <span class="keyword">int</span> <span class="keyword">rand</span> <span class="operator">(</span><span class="variable">$i</span><span class="operator">+</span><span class="number">1</span><span class="operator">);</span>
            <span class="variable">@$deck</span><span class="operator">[</span><span class="variable">$i</span><span class="operator">,</span><span class="variable">$j</span><span class="operator">]</span> <span class="operator">=</span> <span class="variable">@$deck</span><span class="operator">[</span><span class="variable">$j</span><span class="operator">,</span><span class="variable">$i</span><span class="operator">]</span><span class="operator">;</span>
        <span class="operator">}</span>
    <span class="operator">}</span>
    
    <span class="comment"># shuffle my mpeg collection</span>
    <span class="comment">#</span>
    <span class="keyword">my</span> <span class="variable">@mpeg</span> <span class="operator">=</span> <span class="operator">&lt;</span><span class="variable">audio</span><span class="operator">/*</span><span class="regex">/*.mp3&gt;;
    fisher_yates_shuffle( \@mpeg );    # randomize </span><span class="variable">@mpeg</span><span class="regex"> in place
    print </span><span class="variable">@mpeg</span><span class="regex">;
    </span>
</code></code></pre>

<p>Note that the above implementation shuffles an array in place, unlike the <code><code>List::Util::shuffle()</code></code> which takes a list and returns a new shuffled list.</p>

<p>You&#39;ve probably seen shuffling algorithms that work using splice, randomly picking another element to swap the current element with</p>

<pre><code><code>    <span class="keyword">srand</span><span class="operator">;</span>
    <span class="variable">@new</span> <span class="operator">=</span> <span class="operator">();</span>
    <span class="variable">@old</span> <span class="operator">=</span> <span class="number">1</span> <span class="operator">..</span> <span class="number">10</span><span class="operator">;</span>  <span class="comment"># just a demo</span>
    <span class="keyword">while</span> <span class="operator">(</span><span class="variable">@old</span><span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">push</span><span class="operator">(</span><span class="variable">@new</span><span class="operator">,</span> <span class="keyword">splice</span><span class="operator">(</span><span class="variable">@old</span><span class="operator">,</span> <span class="keyword">rand</span> <span class="variable">@old</span><span class="operator">,</span> <span class="number">1</span><span class="operator">));</span>
    <span class="operator">}</span>
</code></code></pre>

<p>This is bad because splice is already O(N), and since you do it N times, you just invented a quadratic algorithm; that is, O(N**2). This does not scale, although Perl is so efficient that you probably won&#39;t notice this until you have rather largish arrays.</p>

<h2 id="How-do-I-process-modify-each-element-of-an-array-">How do I process/modify each element of an array?</h2>

<p>Use <code><code>for</code></code>/<code><code>foreach</code></code>:</p>

<pre><code><code>    <span class="keyword">for</span> <span class="operator">(</span><span class="variable">@lines</span><span class="operator">)</span> <span class="operator">{</span>
        <span class="regex">s/foo/bar/</span><span class="operator">;</span>    <span class="comment"># change that word</span>
        <span class="regex">tr/XZ/ZX/</span><span class="operator">;</span>    <span class="comment"># swap those letters</span>
    <span class="operator">}</span>
</code></code></pre>

<p>Here&#39;s another; let&#39;s compute spherical volumes:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@volumes</span> <span class="operator">=</span> <span class="variable">@radii</span><span class="operator">;</span>
    <span class="keyword">for</span> <span class="operator">(</span><span class="variable">@volumes</span><span class="operator">)</span> <span class="operator">{</span>   <span class="comment"># @volumes has changed parts</span>
        <span class="variable">$_</span> <span class="operator">**=</span> <span class="number">3</span><span class="operator">;</span>
        <span class="variable">$_</span> <span class="operator">*=</span> <span class="operator">(</span><span class="number">4</span><span class="operator">/</span><span class="number">3</span><span class="operator">)</span> <span class="operator">*</span> <span class="number">3.14159</span><span class="operator">;</span>  <span class="comment"># this will be constant folded</span>
    <span class="operator">}</span>
</code></code></pre>

<p>which can also be done with <code><code>map()</code></code> which is made to transform one list into another:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@volumes</span> <span class="operator">=</span> <span class="keyword">map</span> <span class="operator">{</span><span class="variable">$_</span> <span class="operator">**</span> <span class="number">3</span> <span class="operator">*</span> <span class="operator">(</span><span class="number">4</span><span class="operator">/</span><span class="number">3</span><span class="operator">)</span> <span class="operator">*</span> <span class="number">3.14159</span><span class="operator">}</span> <span class="variable">@radii</span><span class="operator">;</span>
</code></code></pre>

<p>If you want to do the same thing to modify the values of the hash, you can use the <code><code>values</code></code> function. As of Perl 5.6 the values are not copied, so if you modify $orbit (in this case), you modify the value.</p>

<pre><code><code>    <span class="keyword">for</span> <span class="keyword">my</span> <span class="variable">$orbit</span> <span class="operator">(</span> <span class="keyword">values</span> <span class="variable">%orbits</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="operator">(</span><span class="variable">$orbit</span> <span class="operator">**=</span> <span class="number">3</span><span class="operator">)</span> <span class="operator">*=</span> <span class="operator">(</span><span class="number">4</span><span class="operator">/</span><span class="number">3</span><span class="operator">)</span> <span class="operator">*</span> <span class="number">3.14159</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>Prior to perl 5.6 <code><code>values</code></code> returned copies of the values, so older perl code often contains constructions such as <code><code><span class="variable">@orbits</span><span class="operator">{</span><span class="keyword">keys</span> <span class="variable">%orbits</span><span class="operator">}</span>
</code></code> instead of <code><code>values %orbits</code></code> where the hash is to be modified.</p>

<h2 id="How-do-I-select-a-random-element-from-an-array-">How do I select a random element from an array?</h2>

<p>Use the <code><code>rand()</code></code> function (see <a href="../../lib/pods/perlfunc.html#rand">&quot;rand&quot; in perlfunc</a>):</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$index</span>   <span class="operator">=</span> <span class="keyword">rand</span> <span class="variable">@array</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$element</span> <span class="operator">=</span> <span class="variable">$array</span><span class="operator">[</span><span class="variable">$index</span><span class="operator">]</span><span class="operator">;</span>
</code></code></pre>

<p>Or, simply:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$element</span> <span class="operator">=</span> <span class="variable">$array</span><span class="operator">[</span> <span class="keyword">rand</span> <span class="variable">@array</span> <span class="operator">]</span><span class="operator">;</span>
</code></code></pre>

<h2 id="How-do-I-permute-N-elements-of-a-list-">How do I permute N elements of a list?      </h2>

<p>Use the <a>List::Permutor</a> module on CPAN. If the list is actually an array, try the <a>Algorithm::Permute</a> module (also on CPAN). It&#39;s written in XS code and is very efficient:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Algorithm::Permute</span><span class="operator">;</span>
    
    <span class="keyword">my</span> <span class="variable">@array</span> <span class="operator">=</span> <span class="string">'a'</span><span class="operator">..</span><span class="string">'d'</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$p_iterator</span> <span class="operator">=</span> <span class="variable">Algorithm::Permute</span><span class="operator">-&gt;</span><span class="variable">new</span> <span class="operator">(</span> <span class="operator">\</span><span class="variable">@array</span> <span class="operator">);</span>
    
    <span class="keyword">while</span> <span class="operator">(</span><span class="keyword">my</span> <span class="variable">@perm</span> <span class="operator">=</span> <span class="variable">$p_iterator</span><span class="operator">-&gt;</span><span class="variable">next</span><span class="operator">)</span> <span class="operator">{</span>
       <span class="keyword">print</span> <span class="string">"next permutation: (</span><span class="variable">@perm</span><span class="string">)\n"</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>For even faster execution, you could do:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Algorithm::Permute</span><span class="operator">;</span>
    
    <span class="keyword">my</span> <span class="variable">@array</span> <span class="operator">=</span> <span class="string">'a'</span><span class="operator">..</span><span class="string">'d'</span><span class="operator">;</span>
    
    <span class="variable">Algorithm::Permute::permute</span> <span class="operator">{</span>
        <span class="keyword">print</span> <span class="string">"next permutation: (</span><span class="variable">@array</span><span class="string">)\n"</span><span class="operator">;</span>
    <span class="operator">}</span> <span class="variable">@array</span><span class="operator">;</span>
</code></code></pre>

<p>Here&#39;s a little program that generates all permutations of all the words on each line of input. The algorithm embodied in the <code><code>permute()</code></code> function is discussed in Volume 4 (still unpublished) of Knuth&#39;s <i>The Art of Computer Programming</i> and will work on any list:</p>

<pre><code><code>    <span class="comment">#!/usr/bin/perl -n</span>
    <span class="comment"># Fischer-Krause ordered permutation generator</span>
    
    <span class="keyword">sub</span><span class="variable"> permute </span><span class="operator">(</span>&amp;@<span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">my</span> <span class="variable">$code</span> <span class="operator">=</span> <span class="keyword">shift</span><span class="operator">;</span>
        <span class="keyword">my</span> <span class="variable">@idx</span> <span class="operator">=</span> <span class="number">0</span><span class="operator">..</span><span class="variable">$#_</span><span class="operator">;</span>
        <span class="keyword">while</span> <span class="operator">(</span> <span class="variable">$code</span><span class="operator">-&gt;(</span><span class="variable">@_</span><span class="operator">[</span><span class="variable">@idx</span><span class="operator">]</span><span class="operator">)</span> <span class="operator">)</span> <span class="operator">{</span>
            <span class="keyword">my</span> <span class="variable">$p</span> <span class="operator">=</span> <span class="variable">$#idx</span><span class="operator">;</span>
            <span class="operator">--</span><span class="variable">$p</span> <span class="keyword">while</span> <span class="variable">$idx</span><span class="operator">[</span><span class="variable">$p</span><span class="operator">-</span><span class="number">1</span><span class="operator">]</span> <span class="operator">&gt;</span> <span class="variable">$idx</span><span class="operator">[</span><span class="variable">$p</span><span class="operator">]</span><span class="operator">;</span>
            <span class="keyword">my</span> <span class="variable">$q</span> <span class="operator">=</span> <span class="variable">$p</span> <span class="keyword">or</span> <span class="keyword">return</span><span class="operator">;</span>
            <span class="keyword">push</span> <span class="variable">@idx</span><span class="operator">,</span> <span class="keyword">reverse</span> <span class="keyword">splice</span> <span class="variable">@idx</span><span class="operator">,</span> <span class="variable">$p</span><span class="operator">;</span>
            <span class="operator">++</span><span class="variable">$q</span> <span class="keyword">while</span> <span class="variable">$idx</span><span class="operator">[</span><span class="variable">$p</span><span class="operator">-</span><span class="number">1</span><span class="operator">]</span> <span class="operator">&gt;</span> <span class="variable">$idx</span><span class="operator">[</span><span class="variable">$q</span><span class="operator">]</span><span class="operator">;</span>
            <span class="variable">@idx</span><span class="operator">[</span><span class="variable">$p</span><span class="operator">-</span><span class="number">1</span><span class="operator">,</span><span class="variable">$q</span><span class="operator">]</span><span class="operator">=</span><span class="variable">@idx</span><span class="operator">[</span><span class="variable">$q</span><span class="operator">,</span><span class="variable">$p</span><span class="operator">-</span><span class="number">1</span><span class="operator">]</span><span class="operator">;</span>
        <span class="operator">}</span>
    <span class="operator">}</span>
    
    <span class="variable">permute</span> <span class="operator">{</span> <span class="keyword">print</span> <span class="string">"</span><span class="variable">@_</span><span class="string">\n"</span> <span class="operator">}</span> <span class="keyword">split</span><span class="operator">;</span>
</code></code></pre>

<p>The <a>Algorithm::Loops</a> module also provides the <code><code>NextPermute</code></code> and <code><code>NextPermuteNum</code></code> functions which efficiently find all unique permutations of an array, even if it contains duplicate values, modifying it in-place: if its elements are in reverse-sorted order then the array is reversed, making it sorted, and it returns false; otherwise the next permutation is returned.</p>

<p><code><code>NextPermute</code></code> uses string order and <code><code>NextPermuteNum</code></code> numeric order, so you can enumerate all the permutations of <code><code>0..9</code></code> like this:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Algorithm::Loops</span> <span class="string">qw(NextPermuteNum)</span><span class="operator">;</span>
    
    <span class="keyword">my</span> <span class="variable">@list</span><span class="operator">=</span> <span class="number">0</span><span class="operator">..</span><span class="number">9</span><span class="operator">;</span>
    <span class="keyword">do</span> <span class="operator">{</span> <span class="keyword">print</span> <span class="string">"</span><span class="variable">@list</span><span class="string">\n"</span> <span class="operator">}</span> <span class="keyword">while</span> <span class="variable">NextPermuteNum</span> <span class="variable">@list</span><span class="operator">;</span>
</code></code></pre>

<h2 id="How-do-I-sort-an-array-by-anything-">How do I sort an array by (anything)?</h2>

<p>Supply a comparison function to sort() (described in <a href="../../lib/pods/perlfunc.html#sort">&quot;sort&quot; in perlfunc</a>):</p>

<pre><code><code>    <span class="variable">@list</span> <span class="operator">=</span> <span class="keyword">sort</span> <span class="operator">{</span> <span class="variable">$a</span> <span class="operator">&lt;=&gt;</span> <span class="variable">$b</span> <span class="operator">}</span> <span class="variable">@list</span><span class="operator">;</span>
</code></code></pre>

<p>The default sort function is cmp, string comparison, which would sort <code><code>(1, 2, 10)</code></code> into <code><code>(1, 10, 2)</code></code>. <code><code>&lt;=&gt;</code></code>, used above, is the numerical comparison operator.</p>

<p>If you have a complicated function needed to pull out the part you want to sort on, then don&#39;t do it inside the sort function. Pull it out first, because the sort BLOCK can be called many times for the same element. Here&#39;s an example of how to pull out the first word after the first number on each item, and then sort those words case-insensitively.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@idx</span><span class="operator">;</span>
    <span class="keyword">for</span> <span class="operator">(</span><span class="variable">@data</span><span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">my</span> <span class="variable">$item</span><span class="operator">;</span>
        <span class="operator">(</span><span class="variable">$item</span><span class="operator">)</span> <span class="operator">=</span> <span class="regex">/\d+\s*(\S+)/</span><span class="operator">;</span>
        <span class="keyword">push</span> <span class="variable">@idx</span><span class="operator">,</span> <span class="keyword">uc</span><span class="operator">(</span><span class="variable">$item</span><span class="operator">);</span>
    <span class="operator">}</span>
    <span class="keyword">my</span> <span class="variable">@sorted</span> <span class="operator">=</span> <span class="variable">@data</span><span class="operator">[</span> <span class="keyword">sort</span> <span class="operator">{</span> <span class="variable">$idx</span><span class="operator">[</span><span class="variable">$a</span><span class="operator">]</span> <span class="keyword">cmp</span> <span class="variable">$idx</span><span class="operator">[</span><span class="variable">$b</span><span class="operator">]</span> <span class="operator">}</span> <span class="number">0</span> <span class="operator">..</span> <span class="variable">$#idx</span> <span class="operator">]</span><span class="operator">;</span>
</code></code></pre>

<p>which could also be written this way, using a trick that&#39;s come to be known as the Schwartzian Transform:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@sorted</span> <span class="operator">=</span> <span class="keyword">map</span>  <span class="operator">{</span> <span class="variable">$_</span><span class="operator">-&gt;</span><span class="operator">[</span><span class="number">0</span><span class="operator">]</span> <span class="operator">}</span>
        <span class="keyword">sort</span> <span class="operator">{</span> <span class="variable">$a</span><span class="operator">-&gt;</span><span class="operator">[</span><span class="number">1</span><span class="operator">]</span> <span class="keyword">cmp</span> <span class="variable">$b</span><span class="operator">-&gt;</span><span class="operator">[</span><span class="number">1</span><span class="operator">]</span> <span class="operator">}</span>
        <span class="keyword">map</span>  <span class="operator">{</span> <span class="operator">[</span> <span class="variable">$_</span><span class="operator">,</span> <span class="keyword">uc</span><span class="operator">(</span> <span class="operator">(</span><span class="regex">/\d+\s*(\S+)/</span><span class="operator">)</span><span class="operator">[</span><span class="number">0</span><span class="operator">]</span><span class="operator">)</span> <span class="operator">]</span> <span class="operator">}</span> <span class="variable">@data</span><span class="operator">;</span>
</code></code></pre>

<p>If you need to sort on several fields, the following paradigm is useful.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@sorted</span> <span class="operator">=</span> <span class="keyword">sort</span> <span class="operator">{</span>
        <span class="variable">field1</span><span class="operator">(</span><span class="variable">$a</span><span class="operator">)</span> <span class="operator">&lt;=&gt;</span> <span class="variable">field1</span><span class="operator">(</span><span class="variable">$b</span><span class="operator">)</span> <span class="operator">||</span>
        <span class="variable">field2</span><span class="operator">(</span><span class="variable">$a</span><span class="operator">)</span> <span class="keyword">cmp</span> <span class="variable">field2</span><span class="operator">(</span><span class="variable">$b</span><span class="operator">)</span> <span class="operator">||</span>
        <span class="variable">field3</span><span class="operator">(</span><span class="variable">$a</span><span class="operator">)</span> <span class="keyword">cmp</span> <span class="variable">field3</span><span class="operator">(</span><span class="variable">$b</span><span class="operator">)</span>
    <span class="operator">}</span> <span class="variable">@data</span><span class="operator">;</span>
</code></code></pre>

<p>This can be conveniently combined with precalculation of keys as given above.</p>

<p>See the <i>sort</i> article in the &quot;Far More Than You Ever Wanted To Know&quot; collection in <a href="http://www.cpan.org/misc/olddoc/FMTEYEWTK.tgz">http://www.cpan.org/misc/olddoc/FMTEYEWTK.tgz</a> for more about this approach.</p>

<p>See also the question later in <a href="../../lib/pods/perlfaq4.html">perlfaq4</a> on sorting hashes.</p>

<h2 id="How-do-I-manipulate-arrays-of-bits-">How do I manipulate arrays of bits?</h2>

<p>Use <code><code>pack()</code></code> and <code><code>unpack()</code></code>, or else <code><code>vec()</code></code> and the bitwise operations.</p>

<p>For example, you don&#39;t have to store individual bits in an array (which would mean that you&#39;re wasting a lot of space). To convert an array of bits to a string, use <code><code>vec()</code></code> to set the right bits. This sets <code><code>$vec</code></code> to have bit N set only if <code><code>$ints[N]</code></code> was set:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@ints</span> <span class="operator">=</span> <span class="operator">(...);</span> <span class="comment"># array of bits, e.g. ( 1, 0, 0, 1, 1, 0 ... )</span>
    <span class="keyword">my</span> <span class="variable">$vec</span> <span class="operator">=</span> <span class="string">''</span><span class="operator">;</span>
    <span class="keyword">foreach</span><span class="operator">(</span> <span class="number">0</span> <span class="operator">..</span> <span class="variable">$#ints</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">vec</span><span class="operator">(</span><span class="variable">$vec</span><span class="operator">,</span><span class="variable">$_</span><span class="operator">,</span><span class="number">1</span><span class="operator">)</span> <span class="operator">=</span> <span class="number">1</span> <span class="keyword">if</span> <span class="variable">$ints</span><span class="operator">[</span><span class="variable">$_</span><span class="operator">]</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>The string <code><code>$vec</code></code> only takes up as many bits as it needs. For instance, if you had 16 entries in <code><code>@ints</code></code>, <code><code>$vec</code></code> only needs two bytes to store them (not counting the scalar variable overhead).</p>

<p>Here&#39;s how, given a vector in <code><code>$vec</code></code>, you can get those bits into your <code><code>@ints</code></code> array:</p>

<pre><code><code>    <span class="keyword">sub</span><span class="variable"> bitvec_to_list </span><span class="operator">{</span>
        <span class="keyword">my</span> <span class="variable">$vec</span> <span class="operator">=</span> <span class="keyword">shift</span><span class="operator">;</span>
        <span class="keyword">my</span> <span class="variable">@ints</span><span class="operator">;</span>
        <span class="comment"># Find null-byte density then select best algorithm</span>
        <span class="keyword">if</span> <span class="operator">(</span><span class="variable">$vec</span> <span class="operator">=~</span> <span class="regex">tr/\0//</span> <span class="operator">/</span> <span class="keyword">length</span> <span class="variable">$vec</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="operator">.</span><span class="number">95</span><span class="operator">)</span> <span class="operator">{</span>
            <span class="keyword">use</span> <span class="variable">integer</span><span class="operator">;</span>
            <span class="keyword">my</span> <span class="variable">$i</span><span class="operator">;</span>
    
            <span class="comment"># This method is faster with mostly null-bytes</span>
            <span class="keyword">while</span><span class="operator">(</span><span class="variable">$vec</span> <span class="operator">=~</span> <span class="regex">/[^\0]/g</span> <span class="operator">)</span> <span class="operator">{</span>
                <span class="variable">$i</span> <span class="operator">=</span> <span class="operator">-</span><span class="number">9</span> <span class="operator">+</span> <span class="number">8</span> <span class="operator">*</span> <span class="keyword">pos</span> <span class="variable">$vec</span><span class="operator">;</span>
                <span class="keyword">push</span> <span class="variable">@ints</span><span class="operator">,</span> <span class="variable">$i</span> <span class="keyword">if</span> <span class="keyword">vec</span><span class="operator">(</span><span class="variable">$vec</span><span class="operator">,</span> <span class="operator">++</span><span class="variable">$i</span><span class="operator">,</span> <span class="number">1</span><span class="operator">);</span>
                <span class="keyword">push</span> <span class="variable">@ints</span><span class="operator">,</span> <span class="variable">$i</span> <span class="keyword">if</span> <span class="keyword">vec</span><span class="operator">(</span><span class="variable">$vec</span><span class="operator">,</span> <span class="operator">++</span><span class="variable">$i</span><span class="operator">,</span> <span class="number">1</span><span class="operator">);</span>
                <span class="keyword">push</span> <span class="variable">@ints</span><span class="operator">,</span> <span class="variable">$i</span> <span class="keyword">if</span> <span class="keyword">vec</span><span class="operator">(</span><span class="variable">$vec</span><span class="operator">,</span> <span class="operator">++</span><span class="variable">$i</span><span class="operator">,</span> <span class="number">1</span><span class="operator">);</span>
                <span class="keyword">push</span> <span class="variable">@ints</span><span class="operator">,</span> <span class="variable">$i</span> <span class="keyword">if</span> <span class="keyword">vec</span><span class="operator">(</span><span class="variable">$vec</span><span class="operator">,</span> <span class="operator">++</span><span class="variable">$i</span><span class="operator">,</span> <span class="number">1</span><span class="operator">);</span>
                <span class="keyword">push</span> <span class="variable">@ints</span><span class="operator">,</span> <span class="variable">$i</span> <span class="keyword">if</span> <span class="keyword">vec</span><span class="operator">(</span><span class="variable">$vec</span><span class="operator">,</span> <span class="operator">++</span><span class="variable">$i</span><span class="operator">,</span> <span class="number">1</span><span class="operator">);</span>
                <span class="keyword">push</span> <span class="variable">@ints</span><span class="operator">,</span> <span class="variable">$i</span> <span class="keyword">if</span> <span class="keyword">vec</span><span class="operator">(</span><span class="variable">$vec</span><span class="operator">,</span> <span class="operator">++</span><span class="variable">$i</span><span class="operator">,</span> <span class="number">1</span><span class="operator">);</span>
                <span class="keyword">push</span> <span class="variable">@ints</span><span class="operator">,</span> <span class="variable">$i</span> <span class="keyword">if</span> <span class="keyword">vec</span><span class="operator">(</span><span class="variable">$vec</span><span class="operator">,</span> <span class="operator">++</span><span class="variable">$i</span><span class="operator">,</span> <span class="number">1</span><span class="operator">);</span>
                <span class="keyword">push</span> <span class="variable">@ints</span><span class="operator">,</span> <span class="variable">$i</span> <span class="keyword">if</span> <span class="keyword">vec</span><span class="operator">(</span><span class="variable">$vec</span><span class="operator">,</span> <span class="operator">++</span><span class="variable">$i</span><span class="operator">,</span> <span class="number">1</span><span class="operator">);</span>
            <span class="operator">}</span>
        <span class="operator">}</span>
        <span class="keyword">else</span> <span class="operator">{</span>
            <span class="comment"># This method is a fast general algorithm</span>
            <span class="keyword">use</span> <span class="variable">integer</span><span class="operator">;</span>
            <span class="keyword">my</span> <span class="variable">$bits</span> <span class="operator">=</span> <span class="keyword">unpack</span> <span class="string">"b*"</span><span class="operator">,</span> <span class="variable">$vec</span><span class="operator">;</span>
            <span class="keyword">push</span> <span class="variable">@ints</span><span class="operator">,</span> <span class="number">0</span> <span class="keyword">if</span> <span class="variable">$bits</span> <span class="operator">=~</span> <span class="regex">s/^(\d)//</span> <span class="operator">&amp;&amp;</span> <span class="variable">$1</span><span class="operator">;</span>
            <span class="keyword">push</span> <span class="variable">@ints</span><span class="operator">,</span> <span class="keyword">pos</span> <span class="variable">$bits</span> <span class="keyword">while</span><span class="operator">(</span><span class="variable">$bits</span> <span class="operator">=~</span> <span class="regex">/1/g</span><span class="operator">);</span>
        <span class="operator">}</span>
    
        <span class="keyword">return</span> <span class="operator">\</span><span class="variable">@ints</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>This method gets faster the more sparse the bit vector is. (Courtesy of Tim Bunce and Winfried Koenig.)</p>

<p>You can make the while loop a lot shorter with this suggestion from Benjamin Goldberg:</p>

<pre><code><code>    <span class="keyword">while</span><span class="operator">(</span><span class="variable">$vec</span> <span class="operator">=~</span> <span class="regex">/[^\0]+/g</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">push</span> <span class="variable">@ints</span><span class="operator">,</span> <span class="keyword">grep</span> <span class="keyword">vec</span><span class="operator">(</span><span class="variable">$vec</span><span class="operator">,</span> <span class="variable">$_</span><span class="operator">,</span> <span class="number">1</span><span class="operator">),</span> <span class="variable">$-</span><span class="operator">[</span><span class="number">0</span><span class="operator">]</span> <span class="operator">*</span> <span class="number">8</span> <span class="operator">..</span> <span class="variable">$+</span><span class="operator">[</span><span class="number">0</span><span class="operator">]</span> <span class="operator">*</span> <span class="number">8</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>Or use the CPAN module <a href="../../lib/Bit/Vector.html">Bit::Vector</a>:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$vector</span> <span class="operator">=</span> <span class="variable">Bit::Vector</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span><span class="variable">$num_of_bits</span><span class="operator">);</span>
    <span class="variable">$vector</span><span class="operator">-&gt;</span><span class="variable">Index_List_Store</span><span class="operator">(</span><span class="variable">@ints</span><span class="operator">);</span>
    <span class="keyword">my</span> <span class="variable">@ints</span> <span class="operator">=</span> <span class="variable">$vector</span><span class="operator">-&gt;</span><span class="variable">Index_List_Read</span><span class="operator">();</span>
</code></code></pre>

<p><a href="../../lib/Bit/Vector.html">Bit::Vector</a> provides efficient methods for bit vector, sets of small integers and &quot;big int&quot; math.</p>

<p>Here&#39;s a more extensive illustration using vec():</p>

<pre><code><code>    <span class="comment"># vec demo</span>
    <span class="keyword">my</span> <span class="variable">$vector</span> <span class="operator">=</span> <span class="string">"\xff\x0f\xef\xfe"</span><span class="operator">;</span>
    <span class="keyword">print</span> <span class="string">"Ilya's string \\xff\\x0f\\xef\\xfe represents the number "</span><span class="operator">,</span>
    <span class="keyword">unpack</span><span class="operator">(</span><span class="string">"N"</span><span class="operator">,</span> <span class="variable">$vector</span><span class="operator">),</span> <span class="string">"\n"</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$is_set</span> <span class="operator">=</span> <span class="keyword">vec</span><span class="operator">(</span><span class="variable">$vector</span><span class="operator">,</span> <span class="number">23</span><span class="operator">,</span> <span class="number">1</span><span class="operator">);</span>
    <span class="keyword">print</span> <span class="string">"Its 23rd bit is "</span><span class="operator">,</span> <span class="variable">$is_set</span> <span class="operator">?</span> <span class="string">"set"</span> <span class="operator">:</span> <span class="string">"clear"</span><span class="operator">,</span> <span class="string">".\n"</span><span class="operator">;</span>
    <span class="variable">pvec</span><span class="operator">(</span><span class="variable">$vector</span><span class="operator">);</span>
    
    <span class="variable">set_vec</span><span class="operator">(</span><span class="number">1</span><span class="operator">,</span><span class="number">1</span><span class="operator">,</span><span class="number">1</span><span class="operator">);</span>
    <span class="variable">set_vec</span><span class="operator">(</span><span class="number">3</span><span class="operator">,</span><span class="number">1</span><span class="operator">,</span><span class="number">1</span><span class="operator">);</span>
    <span class="variable">set_vec</span><span class="operator">(</span><span class="number">23</span><span class="operator">,</span><span class="number">1</span><span class="operator">,</span><span class="number">1</span><span class="operator">);</span>
    
    <span class="variable">set_vec</span><span class="operator">(</span><span class="number">3</span><span class="operator">,</span><span class="number">1</span><span class="operator">,</span><span class="number">3</span><span class="operator">);</span>
    <span class="variable">set_vec</span><span class="operator">(</span><span class="number">3</span><span class="operator">,</span><span class="number">2</span><span class="operator">,</span><span class="number">3</span><span class="operator">);</span>
    <span class="variable">set_vec</span><span class="operator">(</span><span class="number">3</span><span class="operator">,</span><span class="number">4</span><span class="operator">,</span><span class="number">3</span><span class="operator">);</span>
    <span class="variable">set_vec</span><span class="operator">(</span><span class="number">3</span><span class="operator">,</span><span class="number">4</span><span class="operator">,</span><span class="number">7</span><span class="operator">);</span>
    <span class="variable">set_vec</span><span class="operator">(</span><span class="number">3</span><span class="operator">,</span><span class="number">8</span><span class="operator">,</span><span class="number">3</span><span class="operator">);</span>
    <span class="variable">set_vec</span><span class="operator">(</span><span class="number">3</span><span class="operator">,</span><span class="number">8</span><span class="operator">,</span><span class="number">7</span><span class="operator">);</span>
    
    <span class="variable">set_vec</span><span class="operator">(</span><span class="number">0</span><span class="operator">,</span><span class="number">32</span><span class="operator">,</span><span class="number">17</span><span class="operator">);</span>
    <span class="variable">set_vec</span><span class="operator">(</span><span class="number">1</span><span class="operator">,</span><span class="number">32</span><span class="operator">,</span><span class="number">17</span><span class="operator">);</span>
    
    <span class="keyword">sub</span><span class="variable"> set_vec </span><span class="operator">{</span>
        <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$offset</span><span class="operator">,</span> <span class="variable">$width</span><span class="operator">,</span> <span class="variable">$value</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">@_</span><span class="operator">;</span>
        <span class="keyword">my</span> <span class="variable">$vector</span> <span class="operator">=</span> <span class="string">''</span><span class="operator">;</span>
        <span class="keyword">vec</span><span class="operator">(</span><span class="variable">$vector</span><span class="operator">,</span> <span class="variable">$offset</span><span class="operator">,</span> <span class="variable">$width</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">$value</span><span class="operator">;</span>
        <span class="keyword">print</span> <span class="string">"offset=</span><span class="variable">$offset</span><span class="string"> width=</span><span class="variable">$width</span><span class="string"> value=</span><span class="variable">$value</span><span class="string">\n"</span><span class="operator">;</span>
        <span class="variable">pvec</span><span class="operator">(</span><span class="variable">$vector</span><span class="operator">);</span>
    <span class="operator">}</span>
    
    <span class="keyword">sub</span><span class="variable"> pvec </span><span class="operator">{</span>
        <span class="keyword">my</span> <span class="variable">$vector</span> <span class="operator">=</span> <span class="keyword">shift</span><span class="operator">;</span>
        <span class="keyword">my</span> <span class="variable">$bits</span> <span class="operator">=</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">"b*"</span><span class="operator">,</span> <span class="variable">$vector</span><span class="operator">);</span>
        <span class="keyword">my</span> <span class="variable">$i</span> <span class="operator">=</span> <span class="number">0</span><span class="operator">;</span>
        <span class="keyword">my</span> <span class="variable">$BASE</span> <span class="operator">=</span> <span class="number">8</span><span class="operator">;</span>
    
        <span class="keyword">print</span> <span class="string">"vector length in bytes: "</span><span class="operator">,</span> <span class="keyword">length</span><span class="operator">(</span><span class="variable">$vector</span><span class="operator">),</span> <span class="string">"\n"</span><span class="operator">;</span>
        <span class="variable">@bytes</span> <span class="operator">=</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">"A8"</span> <span class="operator">x</span> <span class="keyword">length</span><span class="operator">(</span><span class="variable">$vector</span><span class="operator">),</span> <span class="variable">$bits</span><span class="operator">);</span>
        <span class="keyword">print</span> <span class="string">"bits are: </span><span class="variable">@bytes</span><span class="string">\n\n"</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<h2 id="Why-does-defined-return-true-on-empty-arrays-and-hashes-">Why does defined() return true on empty arrays and hashes?</h2>

<p>The short story is that you should probably only use defined on scalars or functions, not on aggregates (arrays and hashes). See <a href="../../lib/pods/perlfunc.html#defined">&quot;defined&quot; in perlfunc</a> in the 5.004 release or later of Perl for more detail.</p>

<h1 id="Data:-Hashes-Associative-Arrays-">Data: Hashes (Associative Arrays)</h1>

<h2 id="How-do-I-process-an-entire-hash-">How do I process an entire hash?</h2>

<p>(contributed by brian d foy)</p>

<p>There are a couple of ways that you can process an entire hash. You can get a list of keys, then go through each key, or grab a one key-value pair at a time.</p>

<p>To go through all of the keys, use the <code><code>keys</code></code> function. This extracts all of the keys of the hash and gives them back to you as a list. You can then get the value through the particular key you&#39;re processing:</p>

<pre><code><code>    <span class="keyword">foreach</span> <span class="keyword">my</span> <span class="variable">$key</span> <span class="operator">(</span> <span class="keyword">keys</span> <span class="variable">%hash</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">my</span> <span class="variable">$value</span> <span class="operator">=</span> <span class="variable">$hash</span><span class="operator">{</span><span class="variable">$key</span><span class="operator">}</span>
        <span class="operator">...</span>
    <span class="operator">}</span>
</code></code></pre>

<p>Once you have the list of keys, you can process that list before you process the hash elements. For instance, you can sort the keys so you can process them in lexical order:</p>

<pre><code><code>    <span class="keyword">foreach</span> <span class="keyword">my</span> <span class="variable">$key</span> <span class="operator">(</span> <span class="keyword">sort</span> <span class="keyword">keys</span> <span class="variable">%hash</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">my</span> <span class="variable">$value</span> <span class="operator">=</span> <span class="variable">$hash</span><span class="operator">{</span><span class="variable">$key</span><span class="operator">}</span>
        <span class="operator">...</span>
    <span class="operator">}</span>
</code></code></pre>

<p>Or, you might want to only process some of the items. If you only want to deal with the keys that start with <code><code>text:</code></code>, you can select just those using <code><code>grep</code></code>:</p>

<pre><code><code>    <span class="keyword">foreach</span> <span class="keyword">my</span> <span class="variable">$key</span> <span class="operator">(</span> <span class="keyword">grep</span> <span class="regex">/^text:/</span><span class="operator">,</span> <span class="keyword">keys</span> <span class="variable">%hash</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">my</span> <span class="variable">$value</span> <span class="operator">=</span> <span class="variable">$hash</span><span class="operator">{</span><span class="variable">$key</span><span class="operator">}</span>
        <span class="operator">...</span>
    <span class="operator">}</span>
</code></code></pre>

<p>If the hash is very large, you might not want to create a long list of keys. To save some memory, you can grab one key-value pair at a time using <code><code>each()</code></code>, which returns a pair you haven&#39;t seen yet:</p>

<pre><code><code>    <span class="keyword">while</span><span class="operator">(</span> <span class="keyword">my</span><span class="operator">(</span> <span class="variable">$key</span><span class="operator">,</span> <span class="variable">$value</span> <span class="operator">)</span> <span class="operator">=</span> <span class="keyword">each</span><span class="operator">(</span> <span class="variable">%hash</span> <span class="operator">)</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="operator">...</span>
    <span class="operator">}</span>
</code></code></pre>

<p>The <code><code>each</code></code> operator returns the pairs in apparently random order, so if ordering matters to you, you&#39;ll have to stick with the <code><code>keys</code></code> method.</p>

<p>The <code><code>each()</code></code> operator can be a bit tricky though. You can&#39;t add or delete keys of the hash while you&#39;re using it without possibly skipping or re-processing some pairs after Perl internally rehashes all of the elements. Additionally, a hash has only one iterator, so if you mix <code><code>keys</code></code>, <code><code>values</code></code>, or <code><code>each</code></code> on the same hash, you risk resetting the iterator and messing up your processing. See the <code><code>each</code></code> entry in <a href="../../lib/pods/perlfunc.html">perlfunc</a> for more details.</p>

<h2 id="How-do-I-merge-two-hashes-">How do I merge two hashes?   </h2>

<p>(contributed by brian d foy)</p>

<p>Before you decide to merge two hashes, you have to decide what to do if both hashes contain keys that are the same and if you want to leave the original hashes as they were.</p>

<p>If you want to preserve the original hashes, copy one hash (<code><code>%hash1</code></code>) to a new hash (<code><code>%new_hash</code></code>), then add the keys from the other hash (<code><code>%hash2</code></code> to the new hash. Checking that the key already exists in <code><code>%new_hash</code></code> gives you a chance to decide what to do with the duplicates:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">%new_hash</span> <span class="operator">=</span> <span class="variable">%hash1</span><span class="operator">;</span> <span class="comment"># make a copy; leave %hash1 alone</span>
    
    <span class="keyword">foreach</span> <span class="keyword">my</span> <span class="variable">$key2</span> <span class="operator">(</span> <span class="keyword">keys</span> <span class="variable">%hash2</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">if</span><span class="operator">(</span> <span class="keyword">exists</span> <span class="variable">$new_hash</span><span class="operator">{</span><span class="variable">$key2</span><span class="operator">}</span> <span class="operator">)</span> <span class="operator">{</span>
            <span class="keyword">warn</span> <span class="string">"Key [</span><span class="variable">$key2</span><span class="string">] is in both hashes!"</span><span class="operator">;</span>
            <span class="comment"># handle the duplicate (perhaps only warning)</span>
            <span class="operator">...</span>
            <span class="keyword">next</span><span class="operator">;</span>
        <span class="operator">}</span>
        <span class="keyword">else</span> <span class="operator">{</span>
            <span class="variable">$new_hash</span><span class="operator">{</span><span class="variable">$key2</span><span class="operator">}</span> <span class="operator">=</span> <span class="variable">$hash2</span><span class="operator">{</span><span class="variable">$key2</span><span class="operator">}</span><span class="operator">;</span>
        <span class="operator">}</span>
    <span class="operator">}</span>
</code></code></pre>

<p>If you don&#39;t want to create a new hash, you can still use this looping technique; just change the <code><code>%new_hash</code></code> to <code><code>%hash1</code></code>.</p>

<pre><code><code>    <span class="keyword">foreach</span> <span class="keyword">my</span> <span class="variable">$key2</span> <span class="operator">(</span> <span class="keyword">keys</span> <span class="variable">%hash2</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">if</span><span class="operator">(</span> <span class="keyword">exists</span> <span class="variable">$hash1</span><span class="operator">{</span><span class="variable">$key2</span><span class="operator">}</span> <span class="operator">)</span> <span class="operator">{</span>
            <span class="keyword">warn</span> <span class="string">"Key [</span><span class="variable">$key2</span><span class="string">] is in both hashes!"</span><span class="operator">;</span>
            <span class="comment"># handle the duplicate (perhaps only warning)</span>
            <span class="operator">...</span>
            <span class="keyword">next</span><span class="operator">;</span>
        <span class="operator">}</span>
        <span class="keyword">else</span> <span class="operator">{</span>
            <span class="variable">$hash1</span><span class="operator">{</span><span class="variable">$key2</span><span class="operator">}</span> <span class="operator">=</span> <span class="variable">$hash2</span><span class="operator">{</span><span class="variable">$key2</span><span class="operator">}</span><span class="operator">;</span>
        <span class="operator">}</span>
      <span class="operator">}</span>
</code></code></pre>

<p>If you don&#39;t care that one hash overwrites keys and values from the other, you could just use a hash slice to add one hash to another. In this case, values from <code><code>%hash2</code></code> replace values from <code><code>%hash1</code></code> when they have keys in common:</p>

<pre><code><code>    <span class="variable">@hash1</span><span class="operator">{</span> <span class="keyword">keys</span> <span class="variable">%hash2</span> <span class="operator">}</span> <span class="operator">=</span> <span class="keyword">values</span> <span class="variable">%hash2</span><span class="operator">;</span>
</code></code></pre>

<h2 id="What-happens-if-I-add-or-remove-keys-from-a-hash-while-iterating-over-it-">What happens if I add or remove keys from a hash while iterating over it?</h2>

<p>(contributed by brian d foy)</p>

<p>The easy answer is &quot;Don&#39;t do that!&quot;</p>

<p>If you iterate through the hash with each(), you can delete the key most recently returned without worrying about it. If you delete or add other keys, the iterator may skip or double up on them since perl may rearrange the hash table. See the entry for <code><code>each()</code></code> in <a href="../../lib/pods/perlfunc.html">perlfunc</a>.</p>

<h2 id="How-do-I-look-up-a-hash-element-by-value-">How do I look up a hash element by value?</h2>

<p>Create a reverse hash:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">%by_value</span> <span class="operator">=</span> <span class="keyword">reverse</span> <span class="variable">%by_key</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$key</span> <span class="operator">=</span> <span class="variable">$by_value</span><span class="operator">{</span><span class="variable">$value</span><span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

<p>That&#39;s not particularly efficient. It would be more space-efficient to use:</p>

<pre><code><code>    <span class="keyword">while</span> <span class="operator">(</span><span class="keyword">my</span> <span class="operator">(</span><span class="variable">$key</span><span class="operator">,</span> <span class="variable">$value</span><span class="operator">)</span> <span class="operator">=</span> <span class="keyword">each</span> <span class="variable">%by_key</span><span class="operator">)</span> <span class="operator">{</span>
        <span class="variable">$by_value</span><span class="operator">{</span><span class="variable">$value</span><span class="operator">}</span> <span class="operator">=</span> <span class="variable">$key</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>If your hash could have repeated values, the methods above will only find one of the associated keys. This may or may not worry you. If it does worry you, you can always reverse the hash into a hash of arrays instead:</p>

<pre><code><code>    <span class="keyword">while</span> <span class="operator">(</span><span class="keyword">my</span> <span class="operator">(</span><span class="variable">$key</span><span class="operator">,</span> <span class="variable">$value</span><span class="operator">)</span> <span class="operator">=</span> <span class="keyword">each</span> <span class="variable">%by_key</span><span class="operator">)</span> <span class="operator">{</span>
         <span class="keyword">push</span> <span class="variable">@</span><span class="operator">{</span><span class="variable">$key_list_by_value</span><span class="operator">{</span><span class="variable">$value</span><span class="operator">}}</span><span class="operator">,</span> <span class="variable">$key</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<h2 id="How-can-I-know-how-many-entries-are-in-a-hash-">How can I know how many entries are in a hash?</h2>

<p>(contributed by brian d foy)</p>

<p>This is very similar to &quot;How do I process an entire hash?&quot;, also in <a href="../../lib/pods/perlfaq4.html">perlfaq4</a>, but a bit simpler in the common cases.</p>

<p>You can use the <code><code>keys()</code></code> built-in function in scalar context to find out have many entries you have in a hash:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$key_count</span> <span class="operator">=</span> <span class="keyword">keys</span> <span class="variable">%hash</span><span class="operator">;</span> <span class="comment"># must be scalar context!</span>
</code></code></pre>

<p>If you want to find out how many entries have a defined value, that&#39;s a bit different. You have to check each value. A <code><code>grep</code></code> is handy:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$defined_value_count</span> <span class="operator">=</span> <span class="keyword">grep</span> <span class="operator">{</span> <span class="keyword">defined</span> <span class="operator">}</span> <span class="keyword">values</span> <span class="variable">%hash</span><span class="operator">;</span>
</code></code></pre>

<p>You can use that same structure to count the entries any way that you like. If you want the count of the keys with vowels in them, you just test for that instead:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$vowel_count</span> <span class="operator">=</span> <span class="keyword">grep</span> <span class="operator">{</span> <span class="regex">/[aeiou]/</span> <span class="operator">}</span> <span class="keyword">keys</span> <span class="variable">%hash</span><span class="operator">;</span>
</code></code></pre>

<p>The <code><code>grep</code></code> in scalar context returns the count. If you want the list of matching items, just use it in list context instead:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@defined_values</span> <span class="operator">=</span> <span class="keyword">grep</span> <span class="operator">{</span> <span class="keyword">defined</span> <span class="operator">}</span> <span class="keyword">values</span> <span class="variable">%hash</span><span class="operator">;</span>
</code></code></pre>

<p>The <code><code>keys()</code></code> function also resets the iterator, which means that you may see strange results if you use this between uses of other hash operators such as <code><code>each()</code></code>.</p>

<h2 id="How-do-I-sort-a-hash-optionally-by-value-instead-of-key-">How do I sort a hash (optionally by value instead of key)?</h2>

<p>(contributed by brian d foy)</p>

<p>To sort a hash, start with the keys. In this example, we give the list of keys to the sort function which then compares them ASCIIbetically (which might be affected by your locale settings). The output list has the keys in ASCIIbetical order. Once we have the keys, we can go through them to create a report which lists the keys in ASCIIbetical order.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@keys</span> <span class="operator">=</span> <span class="keyword">sort</span> <span class="operator">{</span> <span class="variable">$a</span> <span class="keyword">cmp</span> <span class="variable">$b</span> <span class="operator">}</span> <span class="keyword">keys</span> <span class="variable">%hash</span><span class="operator">;</span>
    
    <span class="keyword">foreach</span> <span class="keyword">my</span> <span class="variable">$key</span> <span class="operator">(</span> <span class="variable">@keys</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">printf</span> <span class="string">"%-20s %6d\n"</span><span class="operator">,</span> <span class="variable">$key</span><span class="operator">,</span> <span class="variable">$hash</span><span class="operator">{</span><span class="variable">$key</span><span class="operator">}</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>We could get more fancy in the <code><code>sort()</code></code> block though. Instead of comparing the keys, we can compute a value with them and use that value as the comparison.</p>

<p>For instance, to make our report order case-insensitive, we use <code><code>lc</code></code> to lowercase the keys before comparing them:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@keys</span> <span class="operator">=</span> <span class="keyword">sort</span> <span class="operator">{</span> <span class="keyword">lc</span> <span class="variable">$a</span> <span class="keyword">cmp</span> <span class="keyword">lc</span> <span class="variable">$b</span> <span class="operator">}</span> <span class="keyword">keys</span> <span class="variable">%hash</span><span class="operator">;</span>
</code></code></pre>

<p>Note: if the computation is expensive or the hash has many elements, you may want to look at the Schwartzian Transform to cache the computation results.</p>

<p>If we want to sort by the hash value instead, we use the hash key to look it up. We still get out a list of keys, but this time they are ordered by their value.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@keys</span> <span class="operator">=</span> <span class="keyword">sort</span> <span class="operator">{</span> <span class="variable">$hash</span><span class="operator">{</span><span class="variable">$a</span><span class="operator">}</span> <span class="operator">&lt;=&gt;</span> <span class="variable">$hash</span><span class="operator">{</span><span class="variable">$b</span><span class="operator">}</span> <span class="operator">}</span> <span class="keyword">keys</span> <span class="variable">%hash</span><span class="operator">;</span>
</code></code></pre>

<p>From there we can get more complex. If the hash values are the same, we can provide a secondary sort on the hash key.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@keys</span> <span class="operator">=</span> <span class="keyword">sort</span> <span class="operator">{</span>
        <span class="variable">$hash</span><span class="operator">{</span><span class="variable">$a</span><span class="operator">}</span> <span class="operator">&lt;=&gt;</span> <span class="variable">$hash</span><span class="operator">{</span><span class="variable">$b</span><span class="operator">}</span>
            <span class="keyword">or</span>
        <span class="string">"\L</span><span class="variable">$a</span><span class="string">"</span> <span class="keyword">cmp</span> <span class="string">"\L</span><span class="variable">$b</span><span class="string">"</span>
    <span class="operator">}</span> <span class="keyword">keys</span> <span class="variable">%hash</span><span class="operator">;</span>
</code></code></pre>

<h2 id="How-can-I-always-keep-my-hash-sorted-">How can I always keep my hash sorted? </h2>

<p>You can look into using the <code><code>DB_File</code></code> module and <code><code>tie()</code></code> using the <code><code>$DB_BTREE</code></code> hash bindings as documented in <a>&quot;In Memory Databases&quot; in DB_File</a>. The <a>Tie::IxHash</a> module from CPAN might also be instructive. Although this does keep your hash sorted, you might not like the slowdown you suffer from the tie interface. Are you sure you need to do this? :)</p>

<h2 id="Whats-the-difference-between-delete-and-undef-with-hashes-">What&#39;s the difference between &quot;delete&quot; and &quot;undef&quot; with hashes?</h2>

<p>Hashes contain pairs of scalars: the first is the key, the second is the value. The key will be coerced to a string, although the value can be any kind of scalar: string, number, or reference. If a key <code><code>$key</code></code> is present in %hash, <code><code><span class="keyword">exists</span><span class="operator">(</span><span class="variable">$hash</span><span class="operator">{</span><span class="variable">$key</span><span class="operator">}</span><span class="operator">)</span>
</code></code> will return true. The value for a given key can be <code><code>undef</code></code>, in which case <code><code><span class="variable">$hash</span><span class="operator">{</span><span class="variable">$key</span><span class="operator">}</span>
</code></code> will be <code><code>undef</code></code> while <code><code><span class="keyword">exists</span> <span class="variable">$hash</span><span class="operator">{</span><span class="variable">$key</span><span class="operator">}</span>
</code></code> will return true. This corresponds to (<code><code>$key</code></code>, <code><code>undef</code></code>) being in the hash.</p>

<p>Pictures help... Here&#39;s the <code><code>%hash</code></code> table:</p>

<pre><code><code>      keys  values
    +------+------+
    |  a   |  3   |
    |  x   |  7   |
    |  d   |  0   |
    |  e   |  2   |
    +------+------+</code></code></pre>

<p>And these conditions hold</p>

<pre><code><code>    <span class="variable">$hash</span><span class="operator">{</span><span class="string">'a'</span><span class="operator">}</span>                       <span class="variable">is</span> <span class="variable">true</span>
    <span class="variable">$hash</span><span class="operator">{</span><span class="string">'d'</span><span class="operator">}</span>                       <span class="variable">is</span> <span class="variable">false</span>
    <span class="keyword">defined</span> <span class="variable">$hash</span><span class="operator">{</span><span class="string">'d'</span><span class="operator">}</span>               <span class="variable">is</span> <span class="variable">true</span>
    <span class="keyword">defined</span> <span class="variable">$hash</span><span class="operator">{</span><span class="string">'a'</span><span class="operator">}</span>               <span class="variable">is</span> <span class="variable">true</span>
    <span class="keyword">exists</span> <span class="variable">$hash</span><span class="operator">{</span><span class="string">'a'</span><span class="operator">}</span>                <span class="variable">is</span> <span class="variable">true</span> <span class="operator">(</span><span class="variable">Perl</span> <span class="number">5</span> <span class="variable">only</span><span class="operator">)</span>
    <span class="keyword">grep</span> <span class="operator">(</span><span class="variable">$_</span> <span class="keyword">eq</span> <span class="string">'a'</span><span class="operator">,</span> <span class="keyword">keys</span> <span class="variable">%hash</span><span class="operator">)</span>     <span class="variable">is</span> <span class="variable">true</span>
</code></code></pre>

<p>If you now say</p>

<pre><code><code>    <span class="keyword">undef</span> <span class="variable">$hash</span><span class="operator">{</span><span class="string">'a'</span><span class="operator">}</span>
</code></code></pre>

<p>your table now reads:</p>

<pre><code><code>      keys  values
    +------+------+
    |  a   | undef|
    |  x   |  7   |
    |  d   |  0   |
    |  e   |  2   |
    +------+------+</code></code></pre>

<p>and these conditions now hold; changes in caps:</p>

<pre><code><code>    <span class="variable">$hash</span><span class="operator">{</span><span class="string">'a'</span><span class="operator">}</span>                       <span class="variable">is</span> <span class="variable">FALSE</span>
    <span class="variable">$hash</span><span class="operator">{</span><span class="string">'d'</span><span class="operator">}</span>                       <span class="variable">is</span> <span class="variable">false</span>
    <span class="keyword">defined</span> <span class="variable">$hash</span><span class="operator">{</span><span class="string">'d'</span><span class="operator">}</span>               <span class="variable">is</span> <span class="variable">true</span>
    <span class="keyword">defined</span> <span class="variable">$hash</span><span class="operator">{</span><span class="string">'a'</span><span class="operator">}</span>               <span class="variable">is</span> <span class="variable">FALSE</span>
    <span class="keyword">exists</span> <span class="variable">$hash</span><span class="operator">{</span><span class="string">'a'</span><span class="operator">}</span>                <span class="variable">is</span> <span class="variable">true</span> <span class="operator">(</span><span class="variable">Perl</span> <span class="number">5</span> <span class="variable">only</span><span class="operator">)</span>
    <span class="keyword">grep</span> <span class="operator">(</span><span class="variable">$_</span> <span class="keyword">eq</span> <span class="string">'a'</span><span class="operator">,</span> <span class="keyword">keys</span> <span class="variable">%hash</span><span class="operator">)</span>     <span class="variable">is</span> <span class="variable">true</span>
</code></code></pre>

<p>Notice the last two: you have an undef value, but a defined key!</p>

<p>Now, consider this:</p>

<pre><code><code>    <span class="keyword">delete</span> <span class="variable">$hash</span><span class="operator">{</span><span class="string">'a'</span><span class="operator">}</span>
</code></code></pre>

<p>your table now reads:</p>

<pre><code><code>      keys  values
    +------+------+
    |  x   |  7   |
    |  d   |  0   |
    |  e   |  2   |
    +------+------+</code></code></pre>

<p>and these conditions now hold; changes in caps:</p>

<pre><code><code>    <span class="variable">$hash</span><span class="operator">{</span><span class="string">'a'</span><span class="operator">}</span>                       <span class="variable">is</span> <span class="variable">false</span>
    <span class="variable">$hash</span><span class="operator">{</span><span class="string">'d'</span><span class="operator">}</span>                       <span class="variable">is</span> <span class="variable">false</span>
    <span class="keyword">defined</span> <span class="variable">$hash</span><span class="operator">{</span><span class="string">'d'</span><span class="operator">}</span>               <span class="variable">is</span> <span class="variable">true</span>
    <span class="keyword">defined</span> <span class="variable">$hash</span><span class="operator">{</span><span class="string">'a'</span><span class="operator">}</span>               <span class="variable">is</span> <span class="variable">false</span>
    <span class="keyword">exists</span> <span class="variable">$hash</span><span class="operator">{</span><span class="string">'a'</span><span class="operator">}</span>                <span class="variable">is</span> <span class="variable">FALSE</span> <span class="operator">(</span><span class="variable">Perl</span> <span class="number">5</span> <span class="variable">only</span><span class="operator">)</span>
    <span class="keyword">grep</span> <span class="operator">(</span><span class="variable">$_</span> <span class="keyword">eq</span> <span class="string">'a'</span><span class="operator">,</span> <span class="keyword">keys</span> <span class="variable">%hash</span><span class="operator">)</span>     <span class="variable">is</span> <span class="variable">FALSE</span>
</code></code></pre>

<p>See, the whole entry is gone!</p>

<h2 id="Why-dont-my-tied-hashes-make-the-defined-exists-distinction-">Why don&#39;t my tied hashes make the defined/exists distinction?</h2>

<p>This depends on the tied hash&#39;s implementation of EXISTS(). For example, there isn&#39;t the concept of undef with hashes that are tied to DBM* files. It also means that exists() and defined() do the same thing with a DBM* file, and what they end up doing is not what they do with ordinary hashes.</p>

<h2 id="How-do-I-reset-an-each-operation-part-way-through-">How do I reset an each() operation part-way through?</h2>

<p>(contributed by brian d foy)</p>

<p>You can use the <code><code>keys</code></code> or <code><code>values</code></code> functions to reset <code><code>each</code></code>. To simply reset the iterator used by <code><code>each</code></code> without doing anything else, use one of them in void context:</p>

<pre><code><code>    <span class="keyword">keys</span> <span class="variable">%hash</span><span class="operator">;</span> <span class="comment"># resets iterator, nothing else.</span>
    <span class="keyword">values</span> <span class="variable">%hash</span><span class="operator">;</span> <span class="comment"># resets iterator, nothing else.</span>
</code></code></pre>

<p>See the documentation for <code><code>each</code></code> in <a href="../../lib/pods/perlfunc.html">perlfunc</a>.</p>

<h2 id="How-can-I-get-the-unique-keys-from-two-hashes-">How can I get the unique keys from two hashes?</h2>

<p>First you extract the keys from the hashes into lists, then solve the &quot;removing duplicates&quot; problem described above. For example:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">%seen</span> <span class="operator">=</span> <span class="operator">();</span>
    <span class="keyword">for</span> <span class="keyword">my</span> <span class="variable">$element</span> <span class="operator">(</span><span class="keyword">keys</span><span class="operator">(</span><span class="variable">%foo</span><span class="operator">),</span> <span class="keyword">keys</span><span class="operator">(</span><span class="variable">%bar</span><span class="operator">))</span> <span class="operator">{</span>
        <span class="variable">$seen</span><span class="operator">{</span><span class="variable">$element</span><span class="operator">}</span><span class="operator">++;</span>
    <span class="operator">}</span>
    <span class="keyword">my</span> <span class="variable">@uniq</span> <span class="operator">=</span> <span class="keyword">keys</span> <span class="variable">%seen</span><span class="operator">;</span>
</code></code></pre>

<p>Or more succinctly:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">@uniq</span> <span class="operator">=</span> <span class="keyword">keys</span> <span class="variable">%</span><span class="operator">{{</span><span class="variable">%foo</span><span class="operator">,</span><span class="variable">%bar</span><span class="operator">}}</span><span class="operator">;</span>
</code></code></pre>

<p>Or if you really want to save space:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">%seen</span> <span class="operator">=</span> <span class="operator">();</span>
    <span class="keyword">while</span> <span class="operator">(</span><span class="keyword">defined</span> <span class="operator">(</span><span class="variable">$key</span> <span class="operator">=</span> <span class="keyword">each</span> <span class="variable">%foo</span><span class="operator">))</span> <span class="operator">{</span>
        <span class="variable">$seen</span><span class="operator">{</span><span class="variable">$key</span><span class="operator">}</span><span class="operator">++;</span>
    <span class="operator">}</span>
    <span class="keyword">while</span> <span class="operator">(</span><span class="keyword">defined</span> <span class="operator">(</span><span class="variable">$key</span> <span class="operator">=</span> <span class="keyword">each</span> <span class="variable">%bar</span><span class="operator">))</span> <span class="operator">{</span>
        <span class="variable">$seen</span><span class="operator">{</span><span class="variable">$key</span><span class="operator">}</span><span class="operator">++;</span>
    <span class="operator">}</span>
    <span class="keyword">my</span> <span class="variable">@uniq</span> <span class="operator">=</span> <span class="keyword">keys</span> <span class="variable">%seen</span><span class="operator">;</span>
</code></code></pre>

<h2 id="How-can-I-store-a-multidimensional-array-in-a-DBM-file-">How can I store a multidimensional array in a DBM file?</h2>

<p>Either stringify the structure yourself (no fun), or else get the MLDBM (which uses Data::Dumper) module from CPAN and layer it on top of either DB_File or GDBM_File. You might also try DBM::Deep, but it can be a bit slow.</p>

<h2 id="How-can-I-make-my-hash-remember-the-order-I-put-elements-into-it-">How can I make my hash remember the order I put elements into it?</h2>

<p>Use the <a>Tie::IxHash</a> from CPAN.</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Tie::IxHash</span><span class="operator">;</span>
    
    <span class="keyword">tie</span> <span class="keyword">my</span> <span class="variable">%myhash</span><span class="operator">,</span> <span class="string">'Tie::IxHash'</span><span class="operator">;</span>
    
    <span class="keyword">for</span> <span class="operator">(</span><span class="keyword">my</span> <span class="variable">$i</span><span class="operator">=</span><span class="number">0</span><span class="operator">;</span> <span class="variable">$i</span><span class="operator">&lt;</span><span class="number">20</span><span class="operator">;</span> <span class="variable">$i</span><span class="operator">++)</span> <span class="operator">{</span>
        <span class="variable">$myhash</span><span class="operator">{</span><span class="variable">$i</span><span class="operator">}</span> <span class="operator">=</span> <span class="number">2</span><span class="operator">*</span><span class="variable">$i</span><span class="operator">;</span>
    <span class="operator">}</span>
    
    <span class="keyword">my</span> <span class="variable">@keys</span> <span class="operator">=</span> <span class="keyword">keys</span> <span class="variable">%myhash</span><span class="operator">;</span>
    <span class="comment"># @keys = (0,1,2,3,...)</span>
</code></code></pre>

<h2 id="Why-does-passing-a-subroutine-an-undefined-element-in-a-hash-create-it-">Why does passing a subroutine an undefined element in a hash create it?</h2>

<p>(contributed by brian d foy)</p>

<p>Are you using a really old version of Perl?</p>

<p>Normally, accessing a hash key&#39;s value for a nonexistent key will <i>not</i> create the key.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">%hash</span>  <span class="operator">=</span> <span class="operator">();</span>
    <span class="keyword">my</span> <span class="variable">$value</span> <span class="operator">=</span> <span class="variable">$hash</span><span class="operator">{</span> <span class="string">'foo'</span> <span class="operator">}</span><span class="operator">;</span>
    <span class="keyword">print</span> <span class="string">"This won't print\n"</span> <span class="keyword">if</span> <span class="keyword">exists</span> <span class="variable">$hash</span><span class="operator">{</span> <span class="string">'foo'</span> <span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

<p>Passing <code><code><span class="variable">$hash</span><span class="operator">{</span> <span class="string">'foo'</span> <span class="operator">}</span>
</code></code> to a subroutine used to be a special case, though. Since you could assign directly to <code><code>$_[0]</code></code>, Perl had to be ready to make that assignment so it created the hash key ahead of time:</p>

<pre><code><code>    <span class="variable">my_sub</span><span class="operator">(</span> <span class="variable">$hash</span><span class="operator">{</span> <span class="string">'foo'</span> <span class="operator">}</span> <span class="operator">);</span>
    <span class="keyword">print</span> <span class="string">"This will print before 5.004\n"</span> <span class="keyword">if</span> <span class="keyword">exists</span> <span class="variable">$hash</span><span class="operator">{</span> <span class="string">'foo'</span> <span class="operator">}</span><span class="operator">;</span>
    
    <span class="keyword">sub</span><span class="variable"> my_sub </span><span class="operator">{</span>
        <span class="comment"># $_[0] = 'bar'; # create hash key in case you do this</span>
        <span class="number">1</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>Since Perl 5.004, however, this situation is a special case and Perl creates the hash key only when you make the assignment:</p>

<pre><code><code>    <span class="variable">my_sub</span><span class="operator">(</span> <span class="variable">$hash</span><span class="operator">{</span> <span class="string">'foo'</span> <span class="operator">}</span> <span class="operator">);</span>
    <span class="keyword">print</span> <span class="string">"This will print, even after 5.004\n"</span> <span class="keyword">if</span> <span class="keyword">exists</span> <span class="variable">$hash</span><span class="operator">{</span> <span class="string">'foo'</span> <span class="operator">}</span><span class="operator">;</span>
    
    <span class="keyword">sub</span><span class="variable"> my_sub </span><span class="operator">{</span>
        <span class="variable">$_</span><span class="operator">[</span><span class="number">0</span><span class="operator">]</span> <span class="operator">=</span> <span class="string">'bar'</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>However, if you want the old behavior (and think carefully about that because it&#39;s a weird side effect), you can pass a hash slice instead. Perl 5.004 didn&#39;t make this a special case:</p>

<pre><code><code>    <span class="variable">my_sub</span><span class="operator">(</span> <span class="variable">@hash</span><span class="operator">{</span> <span class="string">qw/foo/</span> <span class="operator">}</span> <span class="operator">);</span>
</code></code></pre>

<h2 id="How-can-I-make-the-Perl-equivalent-of-a-C-structure-C-class-hash-or-array-of-hashes-or-arrays-">How can I make the Perl equivalent of a C structure/C++ class/hash or array of hashes or arrays?</h2>

<p>Usually a hash ref, perhaps like this:</p>

<pre><code><code>    <span class="variable">$record</span> <span class="operator">=</span> <span class="operator">{</span>
        <span class="string">NAME</span>   <span class="operator">=&gt;</span> <span class="string">"Jason"</span><span class="operator">,</span>
        <span class="string">EMPNO</span>  <span class="operator">=&gt;</span> <span class="number">132</span><span class="operator">,</span>
        <span class="string">TITLE</span>  <span class="operator">=&gt;</span> <span class="string">"deputy peon"</span><span class="operator">,</span>
        <span class="string">AGE</span>    <span class="operator">=&gt;</span> <span class="number">23</span><span class="operator">,</span>
        <span class="string">SALARY</span> <span class="operator">=&gt;</span> <span class="number">37_000</span><span class="operator">,</span>
        <span class="string">PALS</span>   <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">"Norbert"</span><span class="operator">,</span> <span class="string">"Rhys"</span><span class="operator">,</span> <span class="string">"Phineas"</span><span class="operator">]</span><span class="operator">,</span>
    <span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

<p>References are documented in <a href="../../lib/pods/perlref.html">perlref</a> and <a href="../../lib/pods/perlreftut.html">perlreftut</a>. Examples of complex data structures are given in <a href="../../lib/pods/perldsc.html">perldsc</a> and <a href="../../lib/pods/perllol.html">perllol</a>. Examples of structures and object-oriented classes are in <a href="../../lib/pods/perltoot.html">perltoot</a>.</p>

<h2 id="How-can-I-use-a-reference-as-a-hash-key-">How can I use a reference as a hash key?</h2>

<p>(contributed by brian d foy and Ben Morrow)</p>

<p>Hash keys are strings, so you can&#39;t really use a reference as the key. When you try to do that, perl turns the reference into its stringified form (for instance, <code><code>HASH(0xDEADBEEF)</code></code>). From there you can&#39;t get back the reference from the stringified form, at least without doing some extra work on your own.</p>

<p>Remember that the entry in the hash will still be there even if the referenced variable goes out of scope, and that it is entirely possible for Perl to subsequently allocate a different variable at the same address. This will mean a new variable might accidentally be associated with the value for an old.</p>

<p>If you have Perl 5.10 or later, and you just want to store a value against the reference for lookup later, you can use the core Hash::Util::Fieldhash module. This will also handle renaming the keys if you use multiple threads (which causes all variables to be reallocated at new addresses, changing their stringification), and garbage-collecting the entries when the referenced variable goes out of scope.</p>

<p>If you actually need to be able to get a real reference back from each hash entry, you can use the Tie::RefHash module, which does the required work for you.</p>

<h2 id="How-can-I-check-if-a-key-exists-in-a-multilevel-hash-">How can I check if a key exists in a multilevel hash?</h2>

<p>(contributed by brian d foy)</p>

<p>The trick to this problem is avoiding accidental autovivification. If you want to check three keys deep, you might na&iuml;vely try this:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">%hash</span><span class="operator">;</span>
    <span class="keyword">if</span><span class="operator">(</span> <span class="keyword">exists</span> <span class="variable">$hash</span><span class="operator">{</span><span class="string">key1</span><span class="operator">}{</span><span class="string">key2</span><span class="operator">}{</span><span class="string">key3</span><span class="operator">}</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="operator">...;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>Even though you started with a completely empty hash, after that call to <code><code>exists</code></code> you&#39;ve created the structure you needed to check for <code><code>key3</code></code>:</p>

<pre><code><code>    <span class="variable">%hash</span> <span class="operator">=</span> <span class="operator">(</span>
              <span class="string">'key1'</span> <span class="operator">=&gt;</span> <span class="operator">{</span>
                          <span class="string">'key2'</span> <span class="operator">=&gt;</span> <span class="operator">{}</span>
                        <span class="operator">}</span>
            <span class="operator">);</span>
</code></code></pre>

<p>That&#39;s autovivification. You can get around this in a few ways. The easiest way is to just turn it off. The lexical <code><code>autovivification</code></code> pragma is available on CPAN. Now you don&#39;t add to the hash:</p>

<pre><code><code>    <span class="operator">{</span>
        <span class="keyword">no</span> <span class="variable">autovivification</span><span class="operator">;</span>
        <span class="keyword">my</span> <span class="variable">%hash</span><span class="operator">;</span>
        <span class="keyword">if</span><span class="operator">(</span> <span class="keyword">exists</span> <span class="variable">$hash</span><span class="operator">{</span><span class="string">key1</span><span class="operator">}{</span><span class="string">key2</span><span class="operator">}{</span><span class="string">key3</span><span class="operator">}</span> <span class="operator">)</span> <span class="operator">{</span>
            <span class="operator">...;</span>
        <span class="operator">}</span>
    <span class="operator">}</span>
</code></code></pre>

<p>The <a>Data::Diver</a> module on CPAN can do it for you too. Its <code><code>Dive</code></code> subroutine can tell you not only if the keys exist but also get the value:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Data::Diver</span> <span class="string">qw(Dive)</span><span class="operator">;</span>
    
    <span class="keyword">my</span> <span class="variable">@exists</span> <span class="operator">=</span> <span class="variable">Dive</span><span class="operator">(</span> <span class="operator">\</span><span class="variable">%hash</span><span class="operator">,</span> <span class="string">qw(key1 key2 key3)</span> <span class="operator">);</span>
    <span class="keyword">if</span><span class="operator">(</span>  <span class="operator">!</span> <span class="variable">@exists</span>  <span class="operator">)</span> <span class="operator">{</span>
        <span class="operator">...;</span> <span class="comment"># keys do not exist</span>
    <span class="operator">}</span>
    <span class="keyword">elsif</span><span class="operator">(</span>  <span class="operator">!</span> <span class="keyword">defined</span> <span class="variable">$exists</span><span class="operator">[</span><span class="number">0</span><span class="operator">]</span>  <span class="operator">)</span> <span class="operator">{</span>
        <span class="operator">...;</span> <span class="comment"># keys exist but value is undef</span>
    <span class="operator">}</span>
</code></code></pre>

<p>You can easily do this yourself too by checking each level of the hash before you move onto the next level. This is essentially what <a>Data::Diver</a> does for you:</p>

<pre><code><code>    <span class="keyword">if</span><span class="operator">(</span> <span class="variable">check_hash</span><span class="operator">(</span> <span class="operator">\</span><span class="variable">%hash</span><span class="operator">,</span> <span class="string">qw(key1 key2 key3)</span> <span class="operator">)</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="operator">...;</span>
    <span class="operator">}</span>
    
    <span class="keyword">sub</span><span class="variable"> check_hash </span><span class="operator">{</span>
       <span class="keyword">my</span><span class="operator">(</span> <span class="variable">$hash</span><span class="operator">,</span> <span class="variable">@keys</span> <span class="operator">)</span> <span class="operator">=</span> <span class="variable">@_</span><span class="operator">;</span>
    
       <span class="keyword">return</span> <span class="keyword">unless</span> <span class="variable">@keys</span><span class="operator">;</span>
    
       <span class="keyword">foreach</span> <span class="keyword">my</span> <span class="variable">$key</span> <span class="operator">(</span> <span class="variable">@keys</span> <span class="operator">)</span> <span class="operator">{</span>
           <span class="keyword">return</span> <span class="keyword">unless</span> <span class="keyword">eval</span> <span class="operator">{</span> <span class="keyword">exists</span> <span class="variable">$hash</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="variable">$key</span><span class="operator">}</span> <span class="operator">};</span>
           <span class="variable">$hash</span> <span class="operator">=</span> <span class="variable">$hash</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="variable">$key</span><span class="operator">}</span><span class="operator">;</span>
        <span class="operator">}</span>
    
       <span class="keyword">return</span> <span class="number">1</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<h2 id="How-can-I-prevent-addition-of-unwanted-keys-into-a-hash-">How can I prevent addition of unwanted keys into a hash?</h2>

<p>Since version 5.8.0, hashes can be <i>restricted</i> to a fixed number of given keys. Methods for creating and dealing with restricted hashes are exported by the <a href="../../lib/Hash/Util.html">Hash::Util</a> module.</p>

<h1 id="Data:-Misc">Data: Misc</h1>

<h2 id="How-do-I-handle-binary-data-correctly-">How do I handle binary data correctly?</h2>

<p>Perl is binary-clean, so it can handle binary data just fine. On Windows or DOS, however, you have to use <code><code>binmode</code></code> for binary files to avoid conversions for line endings. In general, you should use <code><code>binmode</code></code> any time you want to work with binary data.</p>

<p>Also see <a href="../../lib/pods/perlfunc.html#binmode">&quot;binmode&quot; in perlfunc</a> or <a href="../../lib/pods/perlopentut.html">perlopentut</a>.</p>

<p>If you&#39;re concerned about 8-bit textual data then see <a href="../../lib/pods/perllocale.html">perllocale</a>. If you want to deal with multibyte characters, however, there are some gotchas. See the section on Regular Expressions.</p>

<h2 id="How-do-I-determine-whether-a-scalar-is-a-number-whole-integer-float-">How do I determine whether a scalar is a number/whole/integer/float?</h2>

<p>Assuming that you don&#39;t care about IEEE notations like &quot;NaN&quot; or &quot;Infinity&quot;, you probably just want to use a regular expression:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="number">5.010</span><span class="operator">;</span>
    
    <span class="keyword">given</span><span class="operator">(</span> <span class="variable">$number</span> <span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">when</span><span class="operator">(</span> <span class="regex">/\D/</span> <span class="operator">)</span>
            <span class="operator">{</span> <span class="keyword">say</span> <span class="string">"\thas nondigits"</span><span class="operator">;</span> <span class="keyword">continue</span> <span class="operator">}</span>
        <span class="keyword">when</span><span class="operator">(</span> <span class="regex">/^\d+\z/</span> <span class="operator">)</span>
            <span class="operator">{</span> <span class="keyword">say</span> <span class="string">"\tis a whole number"</span><span class="operator">;</span> <span class="keyword">continue</span> <span class="operator">}</span>
        <span class="keyword">when</span><span class="operator">(</span> <span class="regex">/^-?\d+\z/</span> <span class="operator">)</span>
            <span class="operator">{</span> <span class="keyword">say</span> <span class="string">"\tis an integer"</span><span class="operator">;</span> <span class="keyword">continue</span> <span class="operator">}</span>
        <span class="keyword">when</span><span class="operator">(</span> <span class="regex">/^[+-]?\d+\z/</span> <span class="operator">)</span>
            <span class="operator">{</span> <span class="keyword">say</span> <span class="string">"\tis a +/- integer"</span><span class="operator">;</span> <span class="keyword">continue</span> <span class="operator">}</span>
        <span class="keyword">when</span><span class="operator">(</span> <span class="regex">/^-?(?:\d+\.?|\.\d)\d*\z/</span> <span class="operator">)</span>
            <span class="operator">{</span> <span class="keyword">say</span> <span class="string">"\tis a real number"</span><span class="operator">;</span> <span class="keyword">continue</span> <span class="operator">}</span>
        <span class="keyword">when</span><span class="operator">(</span> <span class="regex">/^[+-]?(?=\.?\d)\d*\.?\d*(?:e[+-]?\d+)?\z/i</span><span class="operator">)</span>
            <span class="operator">{</span> <span class="keyword">say</span> <span class="string">"\tis a C float"</span> <span class="operator">}</span>
    <span class="operator">}</span>
</code></code></pre>

<p>There are also some commonly used modules for the task. <a href="../../lib/Scalar/Util.html">Scalar::Util</a> (distributed with 5.8) provides access to perl&#39;s internal function <code><code>looks_like_number</code></code> for determining whether a variable looks like a number. <a>Data::Types</a> exports functions that validate data types using both the above and other regular expressions. Thirdly, there is <a>Regexp::Common</a> which has regular expressions to match various types of numbers. Those three modules are available from the CPAN.</p>

<p>If you&#39;re on a POSIX system, Perl supports the <code><code>POSIX::strtod</code></code> function for converting strings to doubles (and also <code><code>POSIX::strtol</code></code> for longs). Its semantics are somewhat cumbersome, so here&#39;s a <code><code>getnum</code></code> wrapper function for more convenient access. This function takes a string and returns the number it found, or <code><code>undef</code></code> for input that isn&#39;t a C float. The <code><code>is_numeric</code></code> function is a front end to <code><code>getnum</code></code> if you just want to say, &quot;Is this a float?&quot;</p>

<pre><code><code>    <span class="keyword">sub</span><span class="variable"> getnum </span><span class="operator">{</span>
        <span class="keyword">use</span> <span class="variable">POSIX</span> <span class="string">qw(strtod)</span><span class="operator">;</span>
        <span class="keyword">my</span> <span class="variable">$str</span> <span class="operator">=</span> <span class="keyword">shift</span><span class="operator">;</span>
        <span class="variable">$str</span> <span class="operator">=~</span> <span class="regex">s/^\s+//</span><span class="operator">;</span>
        <span class="variable">$str</span> <span class="operator">=~</span> <span class="regex">s/\s+$//</span><span class="operator">;</span>
        <span class="variable">$!</span> <span class="operator">=</span> <span class="number">0</span><span class="operator">;</span>
        <span class="keyword">my</span><span class="operator">(</span><span class="variable">$num</span><span class="operator">,</span> <span class="variable">$unparsed</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">strtod</span><span class="operator">(</span><span class="variable">$str</span><span class="operator">);</span>
        <span class="keyword">if</span> <span class="operator">((</span><span class="variable">$str</span> <span class="keyword">eq</span> <span class="string">''</span><span class="operator">)</span> <span class="operator">||</span> <span class="operator">(</span><span class="variable">$unparsed</span> <span class="operator">!=</span> <span class="number">0</span><span class="operator">)</span> <span class="operator">||</span> <span class="variable">$!</span><span class="operator">)</span> <span class="operator">{</span>
                <span class="keyword">return</span> <span class="keyword">undef</span><span class="operator">;</span>
        <span class="operator">}</span>
        <span class="keyword">else</span> <span class="operator">{</span>
            <span class="keyword">return</span> <span class="variable">$num</span><span class="operator">;</span>
        <span class="operator">}</span>
    <span class="operator">}</span>
    
    <span class="keyword">sub</span><span class="variable"> is_numeric </span><span class="operator">{</span> <span class="keyword">defined</span> <span class="variable">getnum</span><span class="operator">(</span><span class="variable">$_</span><span class="operator">[</span><span class="number">0</span><span class="operator">]</span><span class="operator">)</span> <span class="operator">}</span>
</code></code></pre>

<p>Or you could check out the <a>String::Scanf</a> module on the CPAN instead.</p>

<h2 id="How-do-I-keep-persistent-data-across-program-calls-">How do I keep persistent data across program calls?</h2>

<p>For some specific applications, you can use one of the DBM modules. See <a href="../../lib/AnyDBM_File.html">AnyDBM_File</a>. More generically, you should consult the <a>FreezeThaw</a> or <a href="../../lib/Storable.html">Storable</a> modules from CPAN. Starting from Perl 5.8, <a href="../../lib/Storable.html">Storable</a> is part of the standard distribution. Here&#39;s one example using <a href="../../lib/Storable.html">Storable</a>&#39;s <code><code>store</code></code> and <code><code>retrieve</code></code> functions:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Storable</span><span class="operator">;</span>
    <span class="variable">store</span><span class="operator">(\</span><span class="variable">%hash</span><span class="operator">,</span> <span class="string">"filename"</span><span class="operator">);</span>
    
    <span class="comment"># later on...</span>
    <span class="variable">$href</span> <span class="operator">=</span> <span class="variable">retrieve</span><span class="operator">(</span><span class="string">"filename"</span><span class="operator">);</span>        <span class="comment"># by ref</span>
    <span class="variable">%hash</span> <span class="operator">=</span> <span class="variable">%</span><span class="operator">{</span> <span class="variable">retrieve</span><span class="operator">(</span><span class="string">"filename"</span><span class="operator">)</span> <span class="operator">}</span><span class="operator">;</span>   <span class="comment"># direct to hash</span>
</code></code></pre>

<h2 id="How-do-I-print-out-or-copy-a-recursive-data-structure-">How do I print out or copy a recursive data structure?</h2>

<p>The <a href="../../lib/Data/Dumper.html">Data::Dumper</a> module on CPAN (or the 5.005 release of Perl) is great for printing out data structures. The <a href="../../lib/Storable.html">Storable</a> module on CPAN (or the 5.8 release of Perl), provides a function called <code><code>dclone</code></code> that recursively copies its argument.</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Storable</span> <span class="string">qw(dclone)</span><span class="operator">;</span>
    <span class="variable">$r2</span> <span class="operator">=</span> <span class="variable">dclone</span><span class="operator">(</span><span class="variable">$r1</span><span class="operator">);</span>
</code></code></pre>

<p>Where <code><code>$r1</code></code> can be a reference to any kind of data structure you&#39;d like. It will be deeply copied. Because <code><code>dclone</code></code> takes and returns references, you&#39;d have to add extra punctuation if you had a hash of arrays that you wanted to copy.</p>

<pre><code><code>    <span class="variable">%newhash</span> <span class="operator">=</span> <span class="variable">%</span><span class="operator">{</span> <span class="variable">dclone</span><span class="operator">(\</span><span class="variable">%oldhash</span><span class="operator">)</span> <span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

<h2 id="How-do-I-define-methods-for-every-class-object-">How do I define methods for every class/object?</h2>

<p>(contributed by Ben Morrow)</p>

<p>You can use the <code><code>UNIVERSAL</code></code> class (see <a href="../../lib/UNIVERSAL.html">UNIVERSAL</a>). However, please be very careful to consider the consequences of doing this: adding methods to every object is very likely to have unintended consequences. If possible, it would be better to have all your object inherit from some common base class, or to use an object system like Moose that supports roles.</p>

<h2 id="How-do-I-verify-a-credit-card-checksum-">How do I verify a credit card checksum?</h2>

<p>Get the <a>Business::CreditCard</a> module from CPAN.</p>

<h2 id="How-do-I-pack-arrays-of-doubles-or-floats-for-XS-code-">How do I pack arrays of doubles or floats for XS code?</h2>

<p>The arrays.h/arrays.c code in the <a>PGPLOT</a> module on CPAN does just this. If you&#39;re doing a lot of float or double processing, consider using the <a>PDL</a> module from CPAN instead--it makes number-crunching easy.</p>

<p>See <a href="http://search.cpan.org/dist/PGPLOT">http://search.cpan.org/dist/PGPLOT</a> for the code.</p>

<h1 id="AUTHOR-AND-COPYRIGHT">AUTHOR AND COPYRIGHT</h1>

<p>Copyright (c) 1997-2010 Tom Christiansen, Nathan Torkington, and other authors as noted. All rights reserved.</p>

<p>This documentation is free; you can redistribute it and/or modify it under the same terms as Perl itself.</p>

<p>Irrespective of its distribution, all code examples in this file are hereby placed into the public domain. You are permitted and encouraged to use this code in your own programs for fun or for profit as you see fit. A simple comment in the code giving credit would be courteous but is not required.</p>


</body>

</html>


