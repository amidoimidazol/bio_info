<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../../displayToc.js"></script>
<script language="JavaScript" src="../../../tocParas.js"></script>
<script language="JavaScript" src="../../../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../../../scineplex.css">
<title></title>
<link rel="stylesheet" href="../../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#Version-0.18">Version 0.18</a>
    <ul>
      <li><a href="#VT_CY-and-VT_DECIMAL-return-values-handled-differently">VT_CY and VT_DECIMAL return values handled differently</a></li>
    </ul>
  </li>
  <li><a href="#Version-0.17">Version 0.17</a>
    <ul>
      <li><a href="#New-nullstring-function-in-Win32::OLE::Variant">New nullstring() function in Win32::OLE::Variant</a></li>
    </ul>
  </li>
  <li><a href="#Version-0.16">Version 0.16</a>
    <ul>
      <li><a href="#Improved-Unicode-support">Improved Unicode support</a></li>
    </ul>
  </li>
  <li><a href="#Version-0.13">Version 0.13</a>
    <ul>
      <li><a href="#New-nothing-function-in-Win32::OLE::Variant">New nothing() function in Win32::OLE::Variant</a></li>
      <li><a href="#New-_NewEnum-and-_Unique-options">New _NewEnum and _Unique options</a></li>
    </ul>
  </li>
  <li><a href="#Version-0.12">Version 0.12</a>
    <ul>
      <li><a href="#Additional-error-handling-functionality">Additional error handling functionality</a></li>
      <li><a href="#Builtin-event-loop">Builtin event loop</a></li>
      <li><a href="#Free-unused-OLE-libraries">Free unused OLE libraries</a></li>
      <li><a href="#The-Win32::OLE-article-from-The-Perl-Journal-10">The &quot;Win32::OLE&quot; article from &quot;The Perl Journal #10&quot;</a></li>
      <li><a href="#VARIANT-Put-bug-fixes">VARIANT-&gt;Put() bug fixes</a></li>
      <li><a href="#Error-message-fixes">Error message fixes</a></li>
      <li><a href="#VT_DATE-and-VT_ERROR-return-values-handled-differently">VT_DATE and VT_ERROR return values handled differently</a></li>
    </ul>
  </li>
  <li><a href="#Version-0.11-changes-since-0.1008-">Version 0.11 (changes since 0.1008)</a>
    <ul>
      <li><a href="#new-DHTML-typelib-browser">new DHTML typelib browser</a></li>
      <li><a href="#VT_DECIMAL-support">VT_DECIMAL support</a></li>
    </ul>
  </li>
  <li><a href="#Version-0.1008">Version 0.1008</a>
    <ul>
      <li><a href="#new-LetProperty-object-method">new LetProperty() object method</a></li>
      <li><a href="#new-HRESULT-function">new HRESULT() function</a></li>
    </ul>
  </li>
  <li><a href="#Version-0.1007-changes-since-0.1005-">Version 0.1007 (changes since 0.1005)</a>
    <ul>
      <li><a href="#OLE-Event-support">OLE Event support</a></li>
      <li><a href="#GetObject-and-GetActiveObject-now-support-optional-DESTRUCTOR-argument">GetObject() and GetActiveObject() now support optional DESTRUCTOR argument</a></li>
      <li><a href="#Remote-object-instantiation-via-DCOM">Remote object instantiation via DCOM</a></li>
      <li><a href="#Enumerate-all-Win32::OLE-objects">Enumerate all Win32::OLE objects</a></li>
      <li><a href="#The-VARIANT-Put-method-now-returns-the-VARIANT-object-itself">The VARIANT-&gt;Put() method now returns the VARIANT object itself</a></li>
      <li><a href="#The-VARIANT-Put-ARRAYREF-form-allows-assignment-to-a-complete-SAFEARRAY">The VARIANT-&gt;Put(ARRAYREF) form allows assignment to a complete SAFEARRAY</a></li>
      <li><a href="#New-Variant-formatting-methods">New Variant formatting methods</a></li>
      <li><a href="#new-Win32::OLE::NLS-methods:-SendSettingChange-and-SetLocaleInfo-">new Win32::OLE::NLS methods: SendSettingChange() and SetLocaleInfo()</a></li>
      <li><a href="#Win32::OLE::Const-now-correctly-treats-version-numbers-as-hex">Win32::OLE::Const now correctly treats version numbers as hex</a></li>
      <li><a href="#more-robust-global-destruction-of-Win32::OLE-objects">more robust global destruction of Win32::OLE objects</a></li>
    </ul>
  </li>
  <li><a href="#Version-0.1005-changes-since-0.1003-">Version 0.1005 (changes since 0.1003)</a>
    <ul>
      <li><a href="#optional-DESTRUCTOR-for-GetActiveObject-GetObject-class-methods">optional DESTRUCTOR for GetActiveObject() GetObject() class methods</a></li>
      <li><a href="#new-Variant-object-method:-object-Copy-">new Variant object method: $object-&gt;Copy()</a></li>
      <li><a href="#new-Win32::OLE-Option-class-method">new Win32::OLE-&gt;Option() class method</a></li>
    </ul>
  </li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Win32::OLE::NEWS - What&#39;s new in Win32::OLE</p>

<p>This file contains a history of user visible changes to the Win32::OLE::* modules. Only new features and major bug fixes that might affect backwards compatibility are included.</p>

<h1 id="Version-0.18">Version 0.18</h1>

<h2 id="VT_CY-and-VT_DECIMAL-return-values-handled-differently">VT_CY and VT_DECIMAL return values handled differently</h2>

<p>The new <code><code>Variant</code></code> option enables values of VT_CY or VT_DECIMAL type to be returned as Win32::OLE::Variant objects instead of being converted into strings and numbers respectively. This is similar to the change in Win32::OLE version 0.12 to VT_DATE and VT_ERROR values. The Win32::OLE::Variant module must be included to make sure that VT_CY and VT_DECIMAL values behave as before in numeric or string contexts.</p>

<p>Because the new behavior is potentially incompatible, it must be explicitly enabled:</p>

<pre><code><code>    <span class="variable">Win32::OLE</span><span class="operator">-&gt;</span><span class="variable">Option</span><span class="operator">(</span><span class="string">Variant</span> <span class="operator">=&gt;</span> <span class="number">1</span><span class="operator">);</span>
</code></code></pre>

<h1 id="Version-0.17">Version 0.17</h1>

<h2 id="New-nullstring-function-in-Win32::OLE::Variant">New nullstring() function in Win32::OLE::Variant</h2>

<p>The nullstring() function returns a VT_BSTR variant containing a NULL string pointer. Note that this is not the same as a VT_BSTR variant containing the empty string &quot;&quot;.</p>

<p>The nullstring() return value is equivalent to the Visual Basic <code><code>vbNullString</code></code> constant.</p>

<h1 id="Version-0.16">Version 0.16</h1>

<h2 id="Improved-Unicode-support">Improved Unicode support</h2>

<p>Passing Unicode strings to methods and properties as well as returning Unicode strings back to Perl works now with both Perl 5.6 and 5.8. Note that the Unicode support in 5.8 is much more complete than in 5.6 or 5.6.1.</p>

<p><code><code>Unicode::String</code></code> objects can now be passed to methods or assigned to properties.</p>

<p>You must enable Unicode support by switching Win32::OLE to the UTF8 codepage:</p>

<pre><code><code>    <span class="variable">Win32::OLE</span><span class="operator">-&gt;</span><span class="variable">Option</span><span class="operator">(</span><span class="string">CP</span> <span class="operator">=&gt;</span> <span class="variable">Win32::OLE::CP_UTF8</span><span class="operator">());</span>
</code></code></pre>

<h1 id="Version-0.13">Version 0.13</h1>

<h2 id="New-nothing-function-in-Win32::OLE::Variant">New nothing() function in Win32::OLE::Variant</h2>

<p>The nothing() function returns an empty VT_DISPATCH variant. It can be used to clear an object reference stored in a property</p>

<pre><code><code>        <span class="keyword">use</span> <span class="variable">Win32::OLE::Variant</span> <span class="string">qw(:DEFAULT nothing)</span><span class="operator">;</span>
        <span class="comment"># ...</span>
        <span class="variable">$object</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">Property</span><span class="operator">}</span> <span class="operator">=</span> <span class="variable">nothing</span><span class="operator">;</span>
</code></code></pre>

<p>This has the same effect as the Visual Basic statement</p>

<pre><code><code>        Set object.Property = Nothing</code></code></pre>

<h2 id="New-_NewEnum-and-_Unique-options">New _NewEnum and _Unique options</h2>

<p>There are two new options available for the Win32::OLE-&gt;Option class method: <code><code>_NewEnum</code></code> provides the elements of a collection object directly as the value of a <code><code>_NewEnum</code></code> property. The <code><code>_Unique</code></code> option guarantees that Win32::OLE will not create multiple proxy objects for the same underlying COM/OLE object.</p>

<p>Both options are only really useful to tree traversal programs or during debugging.</p>

<h1 id="Version-0.12">Version 0.12</h1>

<h2 id="Additional-error-handling-functionality">Additional error handling functionality</h2>

<p>The Warn option can now be set to a CODE reference too. For example,</p>

<pre><code><code>    <span class="variable">Win32::OLE</span><span class="operator">-&gt;</span><span class="variable">Option</span><span class="operator">(</span><span class="string">Warn</span> <span class="operator">=&gt;</span> <span class="number">3</span><span class="operator">);</span>
</code></code></pre>

<p>could now be written as</p>

<pre><code><code>    <span class="variable">Win32::OLE</span><span class="operator">-&gt;</span><span class="variable">Option</span><span class="operator">(</span><span class="string">Warn</span> <span class="operator">=&gt;</span> <span class="operator">\&amp;</span><span class="variable">Carp::croak</span><span class="operator">);</span>
</code></code></pre>

<p>This can even be used to emulate the VisualBasic <code><code>On Error Goto Label</code></code> construct:</p>

<pre><code><code>    <span class="variable">Win32::OLE</span><span class="operator">-&gt;</span><span class="variable">Option</span><span class="operator">(</span><span class="string">Warn</span> <span class="operator">=&gt;</span>  <span class="keyword">sub</span><span class="variable"> </span><span class="operator">{</span><span class="keyword">goto</span> <span class="variable">CheckError</span><span class="operator">});</span>
    <span class="comment"># ... your normal OLE code here ...</span>
    
      <span class="variable">CheckError</span><span class="operator">:</span>
    <span class="comment"># ... your error handling code here ...</span>
</code></code></pre>

<h2 id="Builtin-event-loop">Builtin event loop</h2>

<p>Processing OLE events required a polling loop before, e.g.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$Quit</span><span class="operator">;</span>
    <span class="comment">#...</span>
    <span class="keyword">until</span> <span class="operator">(</span><span class="variable">$Quit</span><span class="operator">)</span> <span class="operator">{</span>
        <span class="variable">Win32::OLE</span><span class="operator">-&gt;</span><span class="variable">SpinMessageLoop</span><span class="operator">;</span>
        <span class="variable">Win32::Sleep</span><span class="operator">(</span><span class="number">100</span><span class="operator">);</span>
    <span class="operator">}</span>
    <span class="keyword">package</span> <span class="variable">BrowserEvents</span><span class="operator">;</span>
    <span class="keyword">sub</span><span class="variable"> OnQuit </span><span class="operator">{</span> <span class="variable">$Quit</span> <span class="operator">=</span> <span class="number">1</span> <span class="operator">}</span>
</code></code></pre>

<p>This is inefficient and a bit odd. This version of Win32::OLE now supports a standard messageloop:</p>

<pre><code><code>    <span class="variable">Win32::OLE</span><span class="operator">-&gt;</span><span class="variable">MessageLoop</span><span class="operator">();</span>
    
    <span class="keyword">package</span> <span class="variable">BrowserEvents</span><span class="operator">;</span>
    <span class="keyword">sub</span><span class="variable"> OnQuit </span><span class="operator">{</span> <span class="variable">Win32::OLE</span><span class="operator">-&gt;</span><span class="variable">QuitMessageLoop</span> <span class="operator">}</span>
</code></code></pre>

<h2 id="Free-unused-OLE-libraries">Free unused OLE libraries</h2>

<p>Previous versions of Win32::OLE would call the CoFreeUnusedLibraries() API whenever an OLE object was destroyed. This made sure that OLE libraries would be unloaded as soon as they were no longer needed. Unfortunately, objects implemented in Visual Basic tend to crash during this call, as they pretend to be ready for unloading, when in fact, they aren&#39;t.</p>

<p>The unloading of object libraries is really only important for long running processes that might instantiate a huge number of <b>different</b> objects over time. Therefore this API is no longer called automatically. The functionality is now available explicitly to those who want or need it by calling a Win32::OLE class method:</p>

<pre><code><code>    <span class="variable">Win32::OLE</span><span class="operator">-&gt;</span><span class="variable">FreeUnusedLibraries</span><span class="operator">();</span>
</code></code></pre>

<h2 id="The-Win32::OLE-article-from-The-Perl-Journal-10">The &quot;Win32::OLE&quot; article from &quot;The Perl Journal #10&quot;</h2>

<p>The article is Copyright 1998 by <i>The Perl Journal</i>. http://www.tpj.com</p>

<p>It originally appeared in <i>The Perl Journal</i> # 10 and appears here courtesy of Jon Orwant and <i>The Perl Journal</i>. The sample code from the article is in the <i>eg/tpj.pl</i> file.</p>

<h2 id="VARIANT-Put-bug-fixes">VARIANT-&gt;Put() bug fixes</h2>

<p>The Put() method didn&#39;t work correctly for arrays of type VT_BSTR, VT_DISPATH or VT_UNKNOWN. This has been fixed.</p>

<h2 id="Error-message-fixes">Error message fixes</h2>

<p>Previous versions of Win32::OLE gave a wrong argument index for some OLE error messages (the number was too large by 1). This should be fixed now.</p>

<h2 id="VT_DATE-and-VT_ERROR-return-values-handled-differently">VT_DATE and VT_ERROR return values handled differently</h2>

<p>Method calls and property accesses returning a VT_DATE or VT_ERROR value would previously translate the value to string or integer format. This has been changed to return a Win32::OLE::Variant object. The return values will behave as before if the Win32::OLE::Variant module is being used. This module overloads the conversion of the objects to strings and numbers.</p>

<h1 id="Version-0.11-changes-since-0.1008-">Version 0.11 (changes since 0.1008)</h1>

<h2 id="new-DHTML-typelib-browser">new DHTML typelib browser</h2>

<p>The Win32::OLE distribution now contains a type library browser. It is written in PerlScript, generating dynamic HTML. It requires Internet Explorer 4.0 or later. You&#39;ll find it in <i>browser/Browser.html</i>. It should be available in the ActivePerl HTML help under Win32::OLE::Browser.</p>

<p>After selecting a library, type or member you can press F1 to call up the corresponding help file at the appropriate location.</p>

<h2 id="VT_DECIMAL-support">VT_DECIMAL support</h2>

<p>The Win32::OLE::Variant module now supports VT_DECIMAL variants too. They are not &quot;officially&quot; allowed in OLE Automation calls, but even Microsoft&#39;s &quot;ActiveX Data Objects&quot; sometimes returns VT_DECIMAL values.</p>

<p>VT_DECIMAL variables are stored as 96-bit integers scaled by a variable power of 10. The power of 10 scaling factor specifies the number of digits to the right of the decimal point, and ranges from 0 to 28. With a scale of 0 (no decimal places), the largest possible value is +/-79,228,162,514,264,337,593,543,950,335. With a 28 decimal places, the largest value is +/-7.9228162514264337593543950335 and the smallest, non-zero value is +/-0.0000000000000000000000000001.</p>

<h1 id="Version-0.1008">Version 0.1008</h1>

<h2 id="new-LetProperty-object-method">new LetProperty() object method</h2>

<p>In Win32::OLE property assignment using the hash syntax is equivalent to the Visual Basic <code><code>Set</code></code> syntax (<i>by reference</i> assignment):</p>

<pre><code><code>  <span class="variable">$Object</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">Property</span><span class="operator">}</span> <span class="operator">=</span> <span class="variable">$OtherObject</span><span class="operator">;</span>
</code></code></pre>

<p>corresponds to this Visual Basic statement:</p>

<pre><code><code>  Set Object.Property = OtherObject</code></code></pre>

<p>To get the <i>by value</i> treatment of the Visual Basic <code><code>Let</code></code> statement</p>

<pre><code><code>  Object.Property = OtherObject</code></code></pre>

<p>you have to use the LetProperty() object method in Perl:</p>

<pre><code><code>  <span class="variable">$Object</span><span class="operator">-&gt;</span><span class="variable">LetProperty</span><span class="operator">(</span><span class="variable">$Property</span><span class="operator">,</span> <span class="variable">$OtherObject</span><span class="operator">);</span>
</code></code></pre>

<h2 id="new-HRESULT-function">new HRESULT() function</h2>

<p>The HRESULT() function converts an unsigned number into a signed HRESULT error value as used by OLE internally. This is necessary because Perl treats all hexadecimal constants as unsigned. To check if the last OLE function returned &quot;Member not found&quot; (0x80020003) you can write:</p>

<pre><code><code>  <span class="keyword">if</span> <span class="operator">(</span><span class="variable">Win32::OLE</span><span class="operator">-&gt;</span><span class="variable">LastError</span> <span class="operator">==</span> <span class="variable">HRESULT</span><span class="operator">(</span><span class="number">0x80020003</span><span class="operator">))</span> <span class="operator">{</span>
      <span class="comment"># your error recovery here</span>
  <span class="operator">}</span>
</code></code></pre>

<h1 id="Version-0.1007-changes-since-0.1005-">Version 0.1007 (changes since 0.1005)</h1>

<h2 id="OLE-Event-support">OLE Event support</h2>

<p>This version of Win32::OLE contains <b>ALPHA</b> level support for OLE events. The userinterface is still subject to change. There are ActiveX objects / controls that don&#39;t fire events under the current implementation.</p>

<p>Events are enabled for a specific object with the Win32::OLE-&gt;WithEvents() class method:</p>

<pre><code><code>  Win32::OLE-&gt;WithEvents(OBJECT, HANDLER, INTERFACE)</code></code></pre>

<p>Please read further documentation in Win32::OLE.</p>

<h2 id="GetObject-and-GetActiveObject-now-support-optional-DESTRUCTOR-argument">GetObject() and GetActiveObject() now support optional DESTRUCTOR argument</h2>

<p>It is now possible to specify a DESTRUCTOR argument to the GetObject() and GetActiveObject() class methods. They work identical to the new() DESTRUCTOR argument.</p>

<h2 id="Remote-object-instantiation-via-DCOM">Remote object instantiation via DCOM</h2>

<p>This has actually been in Win32::OLE since 0.0608, but somehow never got documented. You can provide an array reference in place of the usual PROGID parameter to Win32::OLE-&gt;new():</p>

<pre><code><code>  <span class="variable">OBJ</span> <span class="operator">=</span> <span class="variable">Win32::OLE</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span><span class="operator">[</span><span class="variable">MACHINE</span><span class="operator">,</span> <span class="variable">PRODID</span><span class="operator">]</span><span class="operator">);</span>
</code></code></pre>

<p>The array must contain two elements: the name of the MACHINE and the PROGID. This will try to create the object on the remote MACHINE.</p>

<h2 id="Enumerate-all-Win32::OLE-objects">Enumerate all Win32::OLE objects</h2>

<p>This class method returns the number Win32::OLE objects currently in existance. It will call the optional CALLBACK function for each of these objects:</p>

<pre><code><code>  <span class="variable">$Count</span> <span class="operator">=</span> <span class="variable">Win32::OLE</span><span class="operator">-&gt;</span><span class="variable">EnumAllObjects</span><span class="operator">(</span><span class="keyword">sub</span><span class="variable"> </span><span class="operator">{</span>
      <span class="keyword">my</span> <span class="variable">$Object</span> <span class="operator">=</span> <span class="keyword">shift</span><span class="operator">;</span>
      <span class="keyword">my</span> <span class="variable">$Class</span> <span class="operator">=</span> <span class="variable">Win32::OLE</span><span class="operator">-&gt;</span><span class="variable">QueryObjectType</span><span class="operator">(</span><span class="variable">$Object</span><span class="operator">);</span>
      <span class="keyword">printf</span> <span class="string">"# Object=%s Class=%s\n"</span><span class="operator">,</span> <span class="variable">$Object</span><span class="operator">,</span> <span class="variable">$Class</span><span class="operator">;</span>
  <span class="operator">});</span>
</code></code></pre>

<p>The EnumAllObjects() method is primarily a debugging tool. It can be used e.g. in an END block to check if all external connections have been properly destroyed.</p>

<h2 id="The-VARIANT-Put-method-now-returns-the-VARIANT-object-itself">The VARIANT-&gt;Put() method now returns the VARIANT object itself</h2>

<p>This allows chaining of Put() method calls to set multiple values in an array variant:</p>

<pre><code><code>  <span class="variable">$Array</span><span class="operator">-&gt;</span><span class="variable">Put</span><span class="operator">(</span><span class="number">0</span><span class="operator">,</span><span class="number">0</span><span class="operator">,</span><span class="variable">$First_value</span><span class="operator">)-&gt;</span><span class="variable">Put</span><span class="operator">(</span><span class="number">0</span><span class="operator">,</span><span class="number">1</span><span class="operator">,</span><span class="variable">$Another_value</span><span class="operator">);</span>
</code></code></pre>

<h2 id="The-VARIANT-Put-ARRAYREF-form-allows-assignment-to-a-complete-SAFEARRAY">The VARIANT-&gt;Put(ARRAYREF) form allows assignment to a complete SAFEARRAY</h2>

<p>This allows automatic conversion from a list of lists to a SAFEARRAY. You can now write:</p>

<pre><code><code>  <span class="keyword">my</span> <span class="variable">$Array</span> <span class="operator">=</span> <span class="variable">Variant</span><span class="operator">(</span><span class="variable">VT_ARRAY</span><span class="operator">|</span><span class="variable">VT_R8</span><span class="operator">,</span> <span class="operator">[</span><span class="number">1</span><span class="operator">,</span><span class="number">2</span><span class="operator">]</span><span class="operator">,</span> <span class="number">2</span><span class="operator">);</span>
  <span class="variable">$Array</span><span class="operator">-&gt;</span><span class="variable">Put</span><span class="operator">(</span><span class="operator">[[</span><span class="number">1</span><span class="operator">,</span><span class="number">2</span><span class="operator">]</span><span class="operator">,</span> <span class="operator">[</span><span class="number">3</span><span class="operator">,</span><span class="number">4</span><span class="operator">]]</span><span class="operator">);</span>
</code></code></pre>

<p>instead of the tedious:</p>

<pre><code><code>  <span class="variable">$Array</span><span class="operator">-&gt;</span><span class="variable">Put</span><span class="operator">(</span><span class="number">1</span><span class="operator">,</span><span class="number">0</span><span class="operator">,</span><span class="number">1</span><span class="operator">);</span>
  <span class="variable">$Array</span><span class="operator">-&gt;</span><span class="variable">Put</span><span class="operator">(</span><span class="number">1</span><span class="operator">,</span><span class="number">1</span><span class="operator">,</span><span class="number">2</span><span class="operator">);</span>
  <span class="variable">$Array</span><span class="operator">-&gt;</span><span class="variable">Put</span><span class="operator">(</span><span class="number">2</span><span class="operator">,</span><span class="number">0</span><span class="operator">,</span><span class="number">3</span><span class="operator">);</span>
  <span class="variable">$Array</span><span class="operator">-&gt;</span><span class="variable">Put</span><span class="operator">(</span><span class="number">2</span><span class="operator">,</span><span class="number">1</span><span class="operator">,</span><span class="number">4</span><span class="operator">);</span>
</code></code></pre>

<h2 id="New-Variant-formatting-methods">New Variant formatting methods</h2>

<p>There are four new methods for formatting variant values: Currency(), Date(), Number() and Time(). For example:</p>

<pre><code><code>  <span class="keyword">my</span> <span class="variable">$v</span> <span class="operator">=</span> <span class="variable">Variant</span><span class="operator">(</span><span class="variable">VT_DATE</span><span class="operator">,</span> <span class="string">"April 1 99"</span><span class="operator">);</span>
  <span class="keyword">print</span> <span class="variable">$v</span><span class="operator">-&gt;</span><span class="variable">Date</span><span class="operator">(</span><span class="variable">DATE_LONGDATE</span><span class="operator">),</span> <span class="string">"\n"</span><span class="operator">;</span>
  <span class="keyword">print</span> <span class="variable">$v</span><span class="operator">-&gt;</span><span class="variable">Date</span><span class="operator">(</span><span class="string">"ddd',' MMM dd yy"</span><span class="operator">),</span> <span class="string">"\n"</span><span class="operator">;</span>
</code></code></pre>

<p>will print:</p>

<pre><code><code>  Thursday, April 01, 1999
  Thu, Apr 01 99</code></code></pre>

<h2 id="new-Win32::OLE::NLS-methods:-SendSettingChange-and-SetLocaleInfo-">new Win32::OLE::NLS methods: SendSettingChange() and SetLocaleInfo()</h2>

<p>SendSettingChange() sends a WM_SETTINGCHANGE message to all top level windows.</p>

<p>SetLocaleInfo() allows changing elements in the user override section of the locale database. Unfortunately these changes are not automatically available to further Variant formatting; you have to call SendSettingChange() first.</p>

<h2 id="Win32::OLE::Const-now-correctly-treats-version-numbers-as-hex">Win32::OLE::Const now correctly treats version numbers as hex</h2>

<p>The minor and major version numbers of type libraries have been treated as decimal. This was wrong. They are now correctly decoded as hex.</p>

<h2 id="more-robust-global-destruction-of-Win32::OLE-objects">more robust global destruction of Win32::OLE objects</h2>

<p>The final destruction of Win32::OLE objects has always been somewhat fragile. The reason for this is that Perl doesn&#39;t honour reference counts during global destruction but destroys objects in seemingly random order. This can lead to leaked database connections or unterminated external objects. The only solution was to make all objects lexical and hope that no object would be trapped in a closure. Alternatively all objects could be explicitly set to <code><code>undef</code></code>, which doesn&#39;t work very well with exception handling.</p>

<p>With version 0.1007 of Win32::OLE this problem should be gone: The module keeps a list of active Win32::OLE objects. It uses an END block to destroy all objects at program termination <i>before</i> the Perl&#39;s global destruction starts. Objects still existing at program termination are now destroyed in reverse order of creation. The effect is similar to explicitly calling Win32::OLE-&gt;Uninitialize() just prior to termination.</p>

<h1 id="Version-0.1005-changes-since-0.1003-">Version 0.1005 (changes since 0.1003)</h1>

<p>Win32::OLE 0.1005 has been release with ActivePerl build 509. It is also included in the <i>Perl Resource Kit for Win32</i> Update.</p>

<h2 id="optional-DESTRUCTOR-for-GetActiveObject-GetObject-class-methods">optional DESTRUCTOR for GetActiveObject() GetObject() class methods</h2>

<p>The GetActiveObject() and GetObject() class method now also support an optional DESTRUCTOR parameter just like Win32::OLE-&gt;new(). The DESTRUCTOR is executed when the last reference to this object goes away. It is generally considered <code><code>impolite</code></code> to stop applications that you did not start yourself.</p>

<h2 id="new-Variant-object-method:-object-Copy-">new Variant object method: $object-&gt;Copy()</h2>

<p>See <a href="../../../lib/Win32/OLE/Variant.html#Copy-DIM-">&quot;Copy([DIM])&quot; in Win32::OLE::Variant</a>.</p>

<h2 id="new-Win32::OLE-Option-class-method">new Win32::OLE-&gt;Option() class method</h2>

<p>The Option() class method can be used to inspect and modify <a href="../../../lib/Win32/OLE.html#Module-Options">&quot;Module Options&quot; in Win32::OLE</a>. The single argument form retrieves the value of an option:</p>

<pre><code><code>  <span class="keyword">my</span> <span class="variable">$CP</span> <span class="operator">=</span> <span class="variable">Win32::OLE</span><span class="operator">-&gt;</span><span class="variable">Option</span><span class="operator">(</span><span class="string">'CP'</span><span class="operator">);</span>
</code></code></pre>

<p>A single call can be used to set multiple options simultaneously:</p>

<pre><code><code>  <span class="variable">Win32::OLE</span><span class="operator">-&gt;</span><span class="variable">Option</span><span class="operator">(</span><span class="string">CP</span> <span class="operator">=&gt;</span> <span class="variable">CP_ACP</span><span class="operator">,</span> <span class="string">Warn</span> <span class="operator">=&gt;</span> <span class="number">3</span><span class="operator">);</span>
</code></code></pre>

<p>Currently the following options exist: CP, LCID and <code><code>Warn</code></code>.</p>


</body>

</html>


