<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../displayToc.js"></script>
<script language="JavaScript" src="../../tocParas.js"></script>
<script language="JavaScript" src="../../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../../scineplex.css">
<title></title>
<link rel="stylesheet" href="../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#EXAMPLES">EXAMPLES</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a>
    <ul>
      <li><a href="#The-Registry">The Registry</a></li>
      <li><a href="#Tied-Hashes-Documentation">Tied Hashes Documentation</a>
        <ul>
          <li><a href="#Examples">Examples</a></li>
          <li><a href="#Deleting-items">Deleting items</a></li>
          <li><a href="#Storing-items">Storing items</a></li>
          <li><a href="#More-examples">More examples</a></li>
        </ul>
      </li>
      <li><a href="#Objects-Documentation">Objects Documentation</a></li>
      <li><a href="#Exports-and-">Exports [ and ]</a>
        <ul>
          <li><a href="#Specifying-constants-in-your-Perl-code">Specifying constants in your Perl code</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#SUMMARY">SUMMARY</a>
    <ul>
      <li><a href="#Objects-Summary">Objects Summary</a>
        <ul>
          <li><a href="#Other-Useful-Methods">Other Useful Methods</a></li>
        </ul>
      </li>
      <li><a href="#Tied-Hashes-Summary">Tied Hashes Summary</a>
        <ul>
          <li><a href="#Opening-keys">Opening keys</a></li>
          <li><a href="#Reading-values">Reading values</a></li>
          <li><a href="#Setting-values">Setting values</a></li>
          <li><a href="#Adding-keys">Adding keys</a></li>
          <li><a href="#Listing-all-subkeys-and-values">Listing all subkeys and values</a></li>
          <li><a href="#Deleting-values-or-keys-with-no-subkeys">Deleting values or keys with no subkeys</a></li>
          <li><a href="#Closing-keys">Closing keys</a></li>
        </ul>
      </li>
      <li><a href="#Tie::Registry">Tie::Registry</a></li>
    </ul>
  </li>
  <li><a href="#AUTHOR">AUTHOR</a></li>
  <li><a href="#SEE-ALSO">SEE ALSO</a></li>
  <li><a href="#BUGS">BUGS</a></li>
  <li><a href="#FUTURE-DIRECTIONS">FUTURE DIRECTIONS</a></li>
  <li><a href="#COPYRIGHT">COPYRIGHT</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Win32::TieRegistry - Manipulate the Win32 Registry</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<pre><code><code>  <span class="keyword">use</span> <span class="variable">Win32::TieRegistry</span> <span class="number">0</span><span class="operator">.</span><span class="number">20</span> <span class="operator">(</span> <span class="string">UseOptionName</span><span class="operator">=&gt;</span><span class="variable">UseOptionValue</span><span class="operator">[</span><span class="operator">,...</span><span class="operator">]</span> <span class="operator">);</span>
  
  <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="variable">SomeMethodCall</span><span class="operator">(</span><span class="variable">arg1</span><span class="operator">,...);</span>
  
  <span class="variable">$subKey</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Key\\SubKey\\"</span><span class="operator">}</span><span class="operator">;</span>
  <span class="variable">$valueData</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Key\\SubKey\\\\ValueName"</span><span class="operator">}</span><span class="operator">;</span>
  <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Key\\SubKey\\"</span><span class="operator">}</span><span class="operator">=</span> <span class="operator">{</span> <span class="string">"NewSubKey"</span> <span class="operator">=&gt;</span> <span class="operator">{</span><span class="operator">...</span><span class="operator">}</span> <span class="operator">}</span><span class="operator">;</span>
  <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Key\\SubKey\\\\ValueName"</span><span class="operator">}</span><span class="operator">=</span> <span class="string">"NewValueData"</span><span class="operator">;</span>
  <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"\\ValueName"</span><span class="operator">}</span><span class="operator">=</span> <span class="operator">[</span> <span class="keyword">pack</span><span class="operator">(</span><span class="string">"fmt"</span><span class="operator">,</span><span class="variable">$data</span><span class="operator">),</span> <span class="variable">REG_DATATYPE</span> <span class="operator">]</span><span class="operator">;</span>
</code></code></pre>

<h1 id="EXAMPLES">EXAMPLES</h1>

<pre><code><code>  <span class="keyword">use</span> <span class="variable">Win32::TieRegistry</span><span class="operator">(</span> <span class="string">Delimiter</span><span class="operator">=&gt;</span><span class="string">"#"</span><span class="operator">,</span> <span class="string">ArrayValues</span><span class="operator">=&gt;</span><span class="number">0</span> <span class="operator">);</span>
  <span class="variable">$pound</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="variable">Delimiter</span><span class="operator">(</span><span class="string">"/"</span><span class="operator">);</span>
  <span class="variable">$diskKey</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"LMachine/System/Disk/"</span><span class="operator">}</span>
    <span class="keyword">or</span>  <span class="keyword">die</span> <span class="string">"Can't read LMachine/System/Disk key: $^E\n"</span><span class="operator">;</span>
  <span class="variable">$data</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"/Information"</span><span class="operator">}</span>
    <span class="keyword">or</span>  <span class="keyword">die</span> <span class="string">"Can't read LMachine/System/Disk//Information value: $^E\n"</span><span class="operator">;</span>
  <span class="variable">$remoteKey</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"//ServerA/LMachine/System/"</span><span class="operator">}</span>
    <span class="keyword">or</span>  <span class="keyword">die</span> <span class="string">"Can't read //ServerA/LMachine/System/ key: $^E\n"</span><span class="operator">;</span>
  <span class="variable">$remoteData</span><span class="operator">=</span> <span class="variable">$remoteKey</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Disk//Information"</span><span class="operator">}</span>
    <span class="keyword">or</span>  <span class="keyword">die</span> <span class="string">"Can't read ServerA's System/Disk//Information value: $^E\n"</span><span class="operator">;</span>
  <span class="keyword">foreach</span> <span class="variable">$entry</span> <span class="operator">(</span>  <span class="keyword">keys</span><span class="operator">(</span><span class="variable">%$diskKey</span><span class="operator">)</span>  <span class="operator">)</span> <span class="operator">{</span>
      <span class="operator">...</span>
  <span class="operator">}</span>
  <span class="keyword">foreach</span> <span class="variable">$subKey</span> <span class="operator">(</span>  <span class="variable">$diskKey</span><span class="operator">-&gt;</span><span class="variable">SubKeyNames</span>  <span class="operator">)</span> <span class="operator">{</span>
      <span class="operator">...</span>
  <span class="operator">}</span>
  <span class="variable">$diskKey</span><span class="operator">-&gt;</span><span class="variable">AllowSave</span><span class="operator">(</span> <span class="number">1</span> <span class="operator">);</span>
  <span class="variable">$diskKey</span><span class="operator">-&gt;</span><span class="variable">RegSaveKey</span><span class="operator">(</span> <span class="string">"C:/TEMP/DiskReg"</span><span class="operator">,</span> <span class="operator">[]</span> <span class="operator">);</span>
</code></code></pre>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>The <i>Win32::TieRegistry</i> module lets you manipulate the Registry via objects [as in &quot;object oriented&quot;] or via tied hashes. But you will probably mostly use a combination reference, that is, a reference to a tied hash that has also been made an object so that you can mix both access methods [as shown above].</p>

<p>If you did not get this module as part of <a>libwin32</a>, you might want to get a recent version of <a>libwin32</a> from CPAN which should include this module and the <i>Win32API::Registry</i> module that it uses.</p>

<p>Skip to the <a>SUMMARY</a> section if you just want to dive in and start using the Registry from Perl.</p>

<p>Accessing and manipulating the registry is extremely simple using <i>Win32::TieRegistry</i>. A single, simple expression can return you almost any bit of information stored in the Registry. <i>Win32::TieRegistry</i> also gives you full access to the &quot;raw&quot; underlying API calls so that you can do anything with the Registry in Perl that you could do in C. But the &quot;simple&quot; interface has been carefully designed to handle almost all operations itself without imposing arbitrary limits while providing sensible defaults so you can list only the parameters you care about.</p>

<p>But first, an overview of the Registry itself.</p>

<h2 id="The-Registry">The Registry</h2>

<p>The Registry is a forest: a collection of several tree structures. The root of each tree is a key. These root keys are identified by predefined constants whose names start with &quot;HKEY_&quot;. Although all keys have a few attributes associated with each [a class, a time stamp, and security information], the most important aspect of keys is that each can contain subkeys and can contain values.</p>

<p>Each subkey has a name: a string which cannot be blank and cannot contain the delimiter character [backslash: <code><code>&#39;\\&#39;</code></code>] nor nul [<code><code>&#39;\0&#39;</code></code>]. Each subkey is also a key and so can contain subkeys and values [and has a class, time stamp, and security information].</p>

<p>Each value has a name: a string which <b>can</b> be blank and <b>can</b> contain the delimiter character [backslash: <code><code>&#39;\\&#39;</code></code>] and any character except for null, <code><code>&#39;\0&#39;</code></code>. Each value also has data associated with it. Each value&#39;s data is a contiguous chunk of bytes, which is exactly what a Perl string value is so Perl strings will usually be used to represent value data.</p>

<p>Each value also has a data type which says how to interpret the value data. The primary data types are:</p>

<dl>

<dt id="REG_SZ">REG_SZ</dt>
<dd>

<p>A null-terminated string.</p>

</dd>
<dt id="REG_EXPAND_SZ">REG_EXPAND_SZ</dt>
<dd>

<p>A null-terminated string which contains substrings consisting of a percent sign [<code><code>&#39;%&#39;</code></code>], an environment variable name, then a percent sign, that should be replaced with the value associate with that environment variable. The system does <i>not</i> automatically do this substitution.</p>

</dd>
<dt id="REG_BINARY">REG_BINARY</dt>
<dd>

<p>Some arbitrary binary value. You can think of these as being &quot;packed&quot; into a string.</p>

<p>If your system has the <a>SetDualVar</a> module installed, the <code><code>DualBinVals()</code></code> option wasn&#39;t turned off, and you fetch a <code><code>REG_BINARY</code></code> value of 4 bytes or fewer, then you can use the returned value in a numeric context to get at the &quot;unpacked&quot; numeric value. See <code><code>GetValue()</code></code> for more information.</p>

</dd>
<dt id="REG_MULTI_SZ">REG_MULTI_SZ</dt>
<dd>

<p>Several null-terminated strings concatenated together with an extra trailing <code><code>&#39;\0&#39;</code></code> at the end of the list. Note that the list can include empty strings so use the value&#39;s length to determine the end of the list, not the first occurrence of <code><code>&#39;\0\0&#39;</code></code>. It is best to set the <code><code>SplitMultis()</code></code> option so <i>Win32::TieRegistry</i> will split these values into an array of strings for you.</p>

</dd>
<dt id="REG_DWORD">REG_DWORD</dt>
<dd>

<p>A long [4-byte] integer value. These values are expected either packed into a 4-character string or as a hex string of <b>more than</b> 4 characters [but <i>not</i> as a numeric value, unfortunately, as there is no sure way to tell a numeric value from a packed 4-byte string that just happens to be a string containing a valid numeric value].</p>

<p>How such values are returned depends on the <code><code>DualBinVals()</code></code> and <code><code>DWordsToHex()</code></code> options. See <code><code>GetValue()</code></code> for details.</p>

</dd>
</dl>

<p>In the underlying Registry calls, most places which take a subkey name also allow you to pass in a subkey &quot;path&quot; -- a string of several subkey names separated by the delimiter character, backslash [<code><code>&#39;\\&#39;</code></code>]. For example, doing <code><code>RegOpenKeyEx(HKEY_LOCAL_MACHINE,&quot;SYSTEM\\DISK&quot;,...)</code></code> is much like opening the <code><code>&quot;SYSTEM&quot;</code></code> subkey of <code><code>HKEY_LOCAL_MACHINE</code></code>, then opening its <code><code>&quot;DISK&quot;</code></code> subkey, then closing the <code><code>&quot;SYSTEM&quot;</code></code> subkey.</p>

<p>All of the <i>Win32::TieRegistry</i> features allow you to use your own delimiter in place of the system&#39;s delimiter, [<code><code>&#39;\\&#39;</code></code>]. In most of our examples we will use a forward slash [<code><code>&#39;/&#39;</code></code>] as our delimiter as it is easier to read and less error prone to use when writing Perl code since you have to type two backslashes for each backslash you want in a string. Note that this is true even when using single quotes -- <code><code>&#39;\\HostName\LMachine\&#39;</code></code> is an invalid string and must be written as <code><code>&#39;\\\\HostName\\LMachine\\&#39;</code></code>.</p>

<p>You can also connect to the registry of other computers on your network. This will be discussed more later.</p>

<p>Although the Registry does not have a single root key, the <i>Win32::TieRegistry</i> module creates a virtual root key for you which has all of the <i>HKEY_*</i> keys as subkeys.</p>

<h2 id="Tied-Hashes-Documentation">Tied Hashes Documentation</h2>

<p>Before you can use a tied hash, you must create one. One way to do that is via:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Win32::TieRegistry</span> <span class="operator">(</span> <span class="string">TiedHash</span> <span class="operator">=&gt;</span> <span class="string">'%RegHash'</span> <span class="operator">);</span>
</code></code></pre>

<p>which exports a <code><code>%RegHash</code></code> variable into your package and ties it to the virtual root key of the Registry. An alternate method is:</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">%RegHash</span><span class="operator">;</span>
    <span class="keyword">use</span> <span class="variable">Win32::TieRegistry</span> <span class="operator">(</span> <span class="string">TiedHash</span> <span class="operator">=&gt;</span> <span class="operator">\</span><span class="variable">%RegHash</span> <span class="operator">);</span>
</code></code></pre>

<p>There are also several ways you can tie a hash variable to any other key of the Registry, which are discussed later.</p>

<p>Note that you will most likely use <code><code>$Registry</code></code> instead of using a tied hash. <code><code>$Registry</code></code> is a reference to a hash that has been tied to the virtual root of your computer&#39;s Registry [as if, <code><code>$Registry= \%RegHash</code></code>]. So you would use <code><code><span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">Key</span><span class="operator">}</span>
</code></code> rather than <code><code><span class="variable">$RegHash</span><span class="operator">{</span><span class="string">Key</span><span class="operator">}</span>
</code></code> and use <code><code><span class="keyword">keys</span> <span class="variable">%</span><span class="operator">{</span><span class="variable">$Registry</span><span class="operator">}</span>
</code></code> rather than <code><code>keys %RegHash</code></code>, for example.</p>

<p>For each hash which has been tied to a Registry key, the Perl <code><code>keys</code></code> function will return a list containing the name of each of the key&#39;s subkeys with a delimiter character appended to it and containing the name of each of the key&#39;s values with a delimiter prepended to it. For example:</p>

<pre><code><code>    <span class="keyword">keys</span><span class="operator">(</span> <span class="variable">%</span><span class="operator">{</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"HKEY_CLASSES_ROOT\\batfile\\"</span><span class="operator">}</span> <span class="operator">}</span> <span class="operator">)</span>
</code></code></pre>

<p>might yield the following list value:</p>

<pre><code><code>    ( &quot;DefaultIcon\\&quot;,  # The subkey named &quot;DefaultIcon&quot;
      &quot;shell\\&quot;,        # The subkey named &quot;shell&quot;
      &quot;shellex\\&quot;,      # The subkey named &quot;shellex&quot;
      &quot;\\&quot;,             # The default value [named &quot;&quot;]
      &quot;\\EditFlags&quot; )   # The value named &quot;EditFlags&quot;</code></code></pre>

<p>For the virtual root key, short-hand subkey names are used as shown below. You can use the short-hand name, the regular <i>HKEY_*</i> name, or any numeric value to access these keys, but the short-hand names are all that will be returned by the <code><code>keys</code></code> function.</p>

<dl>

<dt id="Classes-for-HKEY_CLASSES_ROOT">&quot;Classes&quot; for HKEY_CLASSES_ROOT</dt>
<dd>

<p>Contains mappings between file name extensions and the uses for such files along with configuration information for COM [MicroSoft&#39;s Common Object Model] objects. Usually a link to the <code><code>&quot;SOFTWARE\\Classes&quot;</code></code> subkey of the <code><code>HKEY_LOCAL_MACHINE</code></code> key.</p>

</dd>
<dt id="CUser-for-HKEY_CURRENT_USER">&quot;CUser&quot; for HKEY_CURRENT_USER</dt>
<dd>

<p>Contains information specific to the currently logged-in user. Mostly software configuration information. Usually a link to a subkey of the <code><code>HKEY_USERS</code></code> key.</p>

</dd>
<dt id="LMachine-for-HKEY_LOCAL_MACHINE">&quot;LMachine&quot; for HKEY_LOCAL_MACHINE</dt>
<dd>

<p>Contains all manner of information about the computer.</p>

</dd>
<dt id="Users-for-HKEY_USERS">&quot;Users&quot; for HKEY_USERS</dt>
<dd>

<p>Contains one subkey, <code><code>&quot;.DEFAULT&quot;</code></code>, which gets copied to a new subkey whenever a new user is added. Also contains a subkey for each user of the system, though only those for active users [usually only one] are loaded at any given time.</p>

</dd>
<dt id="PerfData-for-HKEY_PERFORMANCE_DATA">&quot;PerfData&quot; for HKEY_PERFORMANCE_DATA</dt>
<dd>

<p>Used to access data about system performance. Access via this key is &quot;special&quot; and all but the most carefully constructed calls will fail, usually with <code><code>ERROR_INSUFFICIENT_BUFFER</code></code>. For example, you can&#39;t enumerate key names without also enumerating values which require huge buffers but the exact buffer size required cannot be determined beforehand because <code><code>RegQueryInfoKey()</code></code> <b>always</b> fails with <code><code>ERROR_INSUFFICIENT_BUFFER</code></code> for <code><code>HKEY_PERFORMANCE_DATA</code></code> no matter how it is called. So it is currently not very useful to tie a hash to this key. You can use it to create an object to use for making carefully constructed calls to the underlying Reg*() routines.</p>

</dd>
<dt id="CConfig-for-HKEY_CURRENT_CONFIG">&quot;CConfig&quot; for HKEY_CURRENT_CONFIG</dt>
<dd>

<p>Contains minimal information about the computer&#39;s current configuration that is required very early in the boot process. For example, setting for the display adapter such as screen resolution and refresh rate are found in here.</p>

</dd>
<dt id="DynData-for-HKEY_DYN_DATA">&quot;DynData&quot; for HKEY_DYN_DATA</dt>
<dd>

<p>Dynamic data. We have found no documentation for this key.</p>

</dd>
</dl>

<p>A tied hash is much like a regular hash variable in Perl -- you give it a key string inside braces, [<code><code><span class="operator">{</span>
</code></code> and <code><code>}</code></code>], and it gives you back a value [or lets you set a value]. For <i>Win32::TieRegistry</i> hashes, there are two types of values that will be returned.</p>

<dl>

<dt id="SubKeys">SubKeys</dt>
<dd>

<p>If you give it a string which represents a subkey, then it will give you back a reference to a hash which has been tied to that subkey. It can&#39;t return the hash itself, so it returns a reference to it. It also blesses that reference so that it is also an object so you can use it to call method functions.</p>

</dd>
<dt id="Values">Values</dt>
<dd>

<p>If you give it a string which is a value name, then it will give you back a string which is the data for that value. Alternately, you can request that it give you both the data value string and the data value type [we discuss how to request this later]. In this case, it would return a reference to an array where the value data string is element <code><code>[0]</code></code> and the value data type is element <code><code>[1]</code></code>.</p>

</dd>
</dl>

<p>The key string which you use in the tied hash must be interpreted to determine whether it is a value name or a key name or a path that combines several of these or even other things. There are two simple rules that make this interpretation easy and unambiguous:</p>

<pre><code><code>    Put a delimiter after each key name.
    Put a delimiter in front of each value name.</code></code></pre>

<p>Exactly how the key string will be intepreted is governed by the following cases, in the order listed. These cases are designed to &quot;do what you mean&quot;. Most of the time you won&#39;t have to think about them, especially if you follow the two simple rules above. After the list of cases we give several examples which should be clear enough so feel free to skip to them unless you are worried about the details.</p>

<dl>

<dt id="Remote-machines">Remote machines</dt>
<dd>

<p>If the hash is tied to the virtual root of the registry [or the virtual root of a remote machine&#39;s registry], then we treat hash key strings which start with the delimiter character specially.</p>

<p>If the hash key string starts with two delimiters in a row, then those should be immediately followed by the name of a remote machine whose registry we wish to connect to. That can be followed by a delimiter and more subkey names, etc. If the machine name is not following by anything, then a virtual root for the remote machine&#39;s registry is created, a hash is tied to it, and a reference to that hash it is returned.</p>

</dd>
<dt id="Hash-key-string-starts-with-the-delimiter">Hash key string starts with the delimiter</dt>
<dd>

<p>If the hash is tied to a virtual root key, then the leading delimiter is ignored. It should be followed by a valid Registry root key name [either a short-hand name like <code><code>&quot;LMachine&quot;</code></code>, an <i>HKEY_*</i> value, or a numeric value]. This alternate notation is allowed in order to be more consistant with the <code><code>Open()</code></code> method function.</p>

<p>For all other Registry keys, the leading delimiter indicates that the rest of the string is a value name. The leading delimiter is stripped and the rest of the string [which can be empty and can contain more delimiters] is used as a value name with no further parsing.</p>

</dd>
<dt id="Exact-match-with-direct-subkey-name-followed-by-delimiter">Exact match with direct subkey name followed by delimiter</dt>
<dd>

<p>If you have already called the Perl <code><code>keys</code></code> function on the tied hash [or have already called <code><code>MemberNames</code></code> on the object] and the hash key string exactly matches one of the strings returned, then no further parsing is done. In other words, if the key string exactly matches the name of a direct subkey with a delimiter appended, then a reference to a hash tied to that subkey is returned [but only if <code><code>keys</code></code> or <code><code>MemberNames</code></code> has already been called for that tied hash].</p>

<p>This is only important if you have selected a delimiter other than the system default delimiter and one of the subkey names contains the delimiter you have chosen. This rule allows you to deal with subkeys which contain your chosen delimiter in their name as long as you only traverse subkeys one level at a time and always enumerate the list of members before doing so.</p>

<p>The main advantage of this is that Perl code which recursively traverses a hash will work on hashes tied to Registry keys even if a non-default delimiter has been selected.</p>

</dd>
<dt id="Hash-key-string-contains-two-delimiters-in-a-row">Hash key string contains two delimiters in a row</dt>
<dd>

<p>If the hash key string contains two [or more] delimiters in a row, then the string is split between the first pair of delimiters. The first part is interpreted as a subkey name or a path of subkey names separated by delimiters and with a trailing delimiter. The second part is interpreted as a value name with one leading delimiter [any extra delimiters are considered part of the value name].</p>

</dd>
<dt id="Hash-key-string-ends-with-a-delimiter">Hash key string ends with a delimiter</dt>
<dd>

<p>If the key string ends with a delimiter, then it is treated as a subkey name or path of subkey names separated by delimiters.</p>

</dd>
<dt id="Hash-key-string-contains-a-delimiter">Hash key string contains a delimiter</dt>
<dd>

<p>If the key string contains a delimiter, then it is split after the last delimiter. The first part is treated as a subkey name or path of subkey names separated by delimiters. The second part is ambiguous and is treated as outlined in the next item.</p>

</dd>
<dt id="Hash-key-string-contains-no-delimiters">Hash key string contains no delimiters</dt>
<dd>

<p>If the hash key string contains no delimiters, then it is ambiguous.</p>

<p>If you are reading from the hash [fetching], then we first use the key string as a value name. If there is a value with a matching name in the Registry key which the hash is tied to, then the value data string [and possibly the value data type] is returned. Otherwise, we retry by using the hash key string as a subkey name. If there is a subkey with a matching name, then we return a reference to a hash tied to that subkey. Otherwise we return <code><code>undef</code></code>.</p>

<p>If you are writing to the hash [storing], then we use the key string as a subkey name only if the value you are storing is a reference to a hash value. Otherwise we use the key string as a value name.</p>

</dd>
</dl>

<h3 id="Examples">Examples</h3>

<p>Here are some examples showing different ways of accessing Registry information using references to tied hashes:</p>

<dl>

<dt id="Canonical-value-fetch">Canonical value fetch</dt>
<dd>

<pre><code><code>    <span class="variable">$tip18</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\"</span>
               <span class="operator">.</span> <span class="string">'Windows\\CurrentVersion\\Explorer\\Tips\\\\18'</span><span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

<p>Should return the text of important tip number 18. Note that two backslashes, <code><code>&quot;\\&quot;</code></code>, are required to get a single backslash into a Perl double-quoted or single-qouted string. Note that <code><code>&quot;\\&quot;</code></code> is appended to each key name [<code><code>&quot;HKEY_LOCAL_MACHINE&quot;</code></code> through <code><code>&quot;Tips&quot;</code></code>] and <code><code>&quot;\\&quot;</code></code> is prepended to the value name, <code><code>&quot;18&quot;</code></code>.</p>

</dd>
<dt id="Changing-your-delimiter">Changing your delimiter</dt>
<dd>

<pre><code><code>    <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="variable">Delimiter</span><span class="operator">(</span><span class="string">"/"</span><span class="operator">);</span>
    <span class="variable">$tip18</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"HKEY_LOCAL_MACHINE/Software/Microsoft/"</span>
               <span class="operator">.</span> <span class="string">'Windows/CurrentVersion/Explorer/Tips//18'</span><span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

<p>This usually makes things easier to read when working in Perl. All remaining examples will assume the delimiter has been changed as above.</p>

</dd>
<dt id="Using-intermediate-keys">Using intermediate keys</dt>
<dd>

<pre><code><code>    <span class="variable">$ms</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"LMachine/Software/Microsoft/"</span><span class="operator">}</span><span class="operator">;</span>
    <span class="variable">$tips</span><span class="operator">=</span> <span class="variable">$ms</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Windows/CurrentVersion/Explorer/Tips/"</span><span class="operator">}</span><span class="operator">;</span>
    <span class="variable">$tip18</span><span class="operator">=</span> <span class="variable">$winlogon</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"/18"</span><span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

<p>Same as above but opens more keys into the Registry which lets you efficiently re-access those intermediate keys. This is slightly less efficient if you never reuse those intermediate keys.</p>

</dd>
<dt id="Chaining-in-a-single-statement">Chaining in a single statement</dt>
<dd>

<pre><code><code>    <span class="variable">$tip18</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"LMachine/Software/Microsoft/"</span><span class="operator">}</span><span class="operator">-&gt;</span>
              <span class="operator">{</span><span class="string">"Windows/CurrentVersion/Explorer/Tips/"</span><span class="operator">}</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"/18"</span><span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

<p>Like above, this creates intermediate key objects then uses them to access other data. Once this statement finishes, the intermediate key objects are destroyed. Several handles into the Registry are opened and closed by this statement so it is less efficient but there are times when this will be useful.</p>

</dd>
<dt id="Even-less-efficient-example-of-chaining">Even less efficient example of chaining</dt>
<dd>

<pre><code><code>    <span class="variable">$tip18</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"LMachine/Software/Microsoft"</span><span class="operator">}</span><span class="operator">-&gt;</span>
              <span class="operator">{</span><span class="string">"Windows/CurrentVersion/Explorer/Tips"</span><span class="operator">}</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"/18"</span><span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

<p>Because we left off the trailing delimiters, <i>Win32::TieRegistry</i> doesn&#39;t know whether final names, <code><code>&quot;Microsoft&quot;</code></code> and <code><code>&quot;Tips&quot;</code></code>, are subkey names or value names. So this statement ends up executing the same code as the next one.</p>

</dd>
<dt id="What-the-above-really-does">What the above really does</dt>
<dd>

<pre><code><code>    <span class="variable">$tip18</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"LMachine/Software/"</span><span class="operator">}</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Microsoft"</span><span class="operator">}</span><span class="operator">-&gt;</span>
              <span class="operator">{</span><span class="string">"Windows/CurrentVersion/Explorer/"</span><span class="operator">}</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Tips"</span><span class="operator">}</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"/18"</span><span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

<p>With more chains to go through, more temporary objects are created and later destroyed than in our first chaining example. Also, when <code><code>&quot;Microsoft&quot;</code></code> is looked up, <i>Win32::TieRegistry</i> first tries to open it as a value and fails then tries it as a subkey. The same is true for when it looks up <code><code>&quot;Tips&quot;</code></code>.</p>

</dd>
<dt id="Getting-all-of-the-tips">Getting all of the tips</dt>
<dd>

<pre><code><code>    <span class="variable">$tips</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"LMachine/Software/Microsoft/"</span><span class="operator">}</span><span class="operator">-&gt;</span>
              <span class="operator">{</span><span class="string">"Windows/CurrentVersion/Explorer/Tips/"</span><span class="operator">}</span>
      <span class="keyword">or</span>  <span class="keyword">die</span> <span class="string">"Can't find the Windows tips: $^E\n"</span><span class="operator">;</span>
    <span class="keyword">foreach</span><span class="operator">(</span>  <span class="keyword">keys</span> <span class="variable">%$tips</span>  <span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">print</span> <span class="string">"</span><span class="variable">$_</span><span class="string">: "</span><span class="operator">,</span> <span class="variable">$tips</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="variable">$_</span><span class="operator">}</span><span class="operator">,</span> <span class="string">"\n"</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>First notice that we actually check for failure for the first time. We are assuming that the <code><code>&quot;Tips&quot;</code></code> key contains no subkeys. Otherwise the <code><code>print</code></code> statement would show something like <code><code>&quot;Win32::TieRegistry=HASH(0xc03ebc)&quot;</code></code> for each subkey.</p>

<p>The output from the above code will start something like:</p>

<pre><code><code>    /0: If you don&#39;t know how to do something,[...]</code></code></pre>

</dd>
</dl>

<h3 id="Deleting-items">Deleting items</h3>

<p>You can use the Perl <code><code>delete</code></code> function to delete a value from a Registry key or to delete a subkey as long that subkey contains no subkeys of its own. See <a href="#More-Examples">&quot;More Examples&quot;</a>, below, for more information.</p>

<h3 id="Storing-items">Storing items</h3>

<p>You can use the Perl assignment operator [<code><code>=</code></code>] to create new keys, create new values, or replace values. The values you store should be in the same format as the values you would fetch from a tied hash. For example, you can use a single assignment statement to copy an entire Registry tree. The following statement:</p>

<pre><code><code>    <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"LMachine/Software/Classes/Tie_Registry/"</span><span class="operator">}</span><span class="operator">=</span>
      <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"LMachine/Software/Classes/batfile/"</span><span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

<p>creates a <code><code>&quot;Tie_Registry&quot;</code></code> subkey under the <code><code>&quot;Software\\Classes&quot;</code></code> subkey of the <code><code>HKEY_LOCAL_MACHINE</code></code> key. Then it populates it with copies of all of the subkeys and values in the <code><code>&quot;batfile&quot;</code></code> subkey and all of its subkeys. Note that you need to have called <code><code>$Registry-&gt;ArrayValues(1)</code></code> for the proper value data type information to be copied. Note also that this release of <i>Win32::TieRegistry</i> does not copy key attributes such as class name and security information [this is planned for a future release].</p>

<p>The following statement creates a whole subtree in the Registry:</p>

<pre><code><code>    <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"LMachine/Software/FooCorp/"</span><span class="operator">}</span><span class="operator">=</span> <span class="operator">{</span>
        <span class="string">"FooWriter/"</span> <span class="operator">=&gt;</span> <span class="operator">{</span>
            <span class="string">"/Version"</span> <span class="operator">=&gt;</span> <span class="string">"4.032"</span><span class="operator">,</span>
            <span class="string">"Startup/"</span> <span class="operator">=&gt;</span> <span class="operator">{</span>
                <span class="string">"/Title"</span> <span class="operator">=&gt;</span> <span class="string">"Foo Writer Deluxe ]["</span><span class="operator">,</span>
                <span class="string">"/WindowSize"</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="keyword">pack</span><span class="operator">(</span><span class="string">"LL"</span><span class="operator">,</span><span class="variable">$wid</span><span class="operator">,</span><span class="variable">$ht</span><span class="operator">),</span> <span class="string">"REG_BINARY"</span> <span class="operator">]</span><span class="operator">,</span>
                <span class="string">"/TaskBarIcon"</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">"0x0001"</span><span class="operator">,</span> <span class="string">"REG_DWORD"</span> <span class="operator">]</span><span class="operator">,</span>
            <span class="operator">}</span><span class="operator">,</span>
            <span class="string">"Compatibility/"</span> <span class="operator">=&gt;</span> <span class="operator">{</span>
                <span class="string">"/AutoConvert"</span> <span class="operator">=&gt;</span> <span class="string">"Always"</span><span class="operator">,</span>
                <span class="string">"/Default Palette"</span> <span class="operator">=&gt;</span> <span class="string">"Windows Colors"</span><span class="operator">,</span>
            <span class="operator">}</span><span class="operator">,</span>
        <span class="operator">}</span><span class="operator">,</span>
        <span class="string">"/License"</span><span class="operator">,</span> <span class="operator">=&gt;</span> <span class="string">"0123-9C8EF1-09-FC"</span><span class="operator">,</span>
    <span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

<p>Note that all but the last Registry key used on the left-hand side of the assignment [that is, &quot;LMachine/Software/&quot; but not &quot;FooCorp/&quot;] must already exist for this statement to succeed.</p>

<p>By using the leading a trailing delimiters on each subkey name and value name, <i>Win32::TieRegistry</i> will tell you if you try to assign subkey information to a value or visa-versa.</p>

<h3 id="More-examples">More examples</h3>

<dl>

<dt id="Adding-a-new-tip">Adding a new tip</dt>
<dd>

<pre><code><code>    <span class="variable">$tips</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"LMachine/Software/Microsoft/"</span><span class="operator">}</span><span class="operator">-&gt;</span>
              <span class="operator">{</span><span class="string">"Windows/CurrentVersion/Explorer/Tips/"</span><span class="operator">}</span>
      <span class="keyword">or</span>  <span class="keyword">die</span> <span class="string">"Can't find the Windows tips: $^E\n"</span><span class="operator">;</span>
    <span class="variable">$tips</span><span class="operator">{</span><span class="string">'/186'</span><span class="operator">}</span><span class="operator">=</span> <span class="string">"Be very careful when making changes to the Registry!"</span><span class="operator">;</span>
</code></code></pre>

</dd>
<dt id="Deleting-our-new-tip">Deleting our new tip</dt>
<dd>

<pre><code><code>    <span class="variable">$tips</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"LMachine/Software/Microsoft/"</span><span class="operator">}</span><span class="operator">-&gt;</span>
              <span class="operator">{</span><span class="string">"Windows/CurrentVersion/Explorer/Tips/"</span><span class="operator">}</span>
      <span class="keyword">or</span>  <span class="keyword">die</span> <span class="string">"Can't find the Windows tips: $^E\n"</span><span class="operator">;</span>
    <span class="variable">$tip186</span><span class="operator">=</span> <span class="keyword">delete</span> <span class="variable">$tips</span><span class="operator">{</span><span class="string">'/186'</span><span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

<p>Note that Perl&#39;s <code><code>delete</code></code> function returns the value that was deleted.</p>

</dd>
<dt id="Adding-a-new-tip-differently">Adding a new tip differently</dt>
<dd>

<pre><code><code>    <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"LMachine/Software/Microsoft/"</span> <span class="operator">.</span>
                <span class="string">"Windows/CurrentVersion/Explorer/Tips//186"</span><span class="operator">}</span><span class="operator">=</span>
      <span class="string">"Be very careful when making changes to the Registry!"</span><span class="operator">;</span>
</code></code></pre>

</dd>
<dt id="Deleting-differently">Deleting differently</dt>
<dd>

<pre><code><code>    <span class="variable">$tip186</span><span class="operator">=</span> <span class="keyword">delete</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"LMachine/Software/Microsoft/Windows/"</span> <span class="operator">.</span>
                                <span class="string">"CurrentVersion/Explorer/Tips//186"</span><span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

<p>Note that this only deletes the tail of what we looked up, the <code><code>&quot;186&quot;</code></code> value, not any of the keys listed.</p>

</dd>
<dt id="Deleting-a-key">Deleting a key</dt>
<dd>

<p>WARNING: The following code will delete all information about the current user&#39;s tip preferences. Actually executing this command would probably cause the user to see the Welcome screen the next time they log in and may cause more serious problems. This statement is shown as an example only and should not be used when experimenting.</p>

<pre><code><code>    <span class="variable">$tips</span><span class="operator">=</span> <span class="keyword">delete</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"CUser/Software/Microsoft/Windows/"</span> <span class="operator">.</span>
                              <span class="string">"CurrentVersion/Explorer/Tips/"</span><span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

<p>This deletes the <code><code>&quot;Tips&quot;</code></code> key and the values it contains. The <code><code>delete</code></code> function will return a reference to a hash [not a tied hash] containing the value names and value data that were deleted.</p>

<p>The information to be returned is copied from the Registry into a regular Perl hash before the key is deleted. If the key has many subkeys, this copying could take a significant amount of memory and/or processor time. So you can disable this process by calling the <code><code>FastDelete</code></code> member function:</p>

<pre><code><code>    <span class="variable">$prevSetting</span><span class="operator">=</span> <span class="variable">$regKey</span><span class="operator">-&gt;</span><span class="variable">FastDelete</span><span class="operator">(</span><span class="number">1</span><span class="operator">);</span>
</code></code></pre>

<p>which will cause all subsequent delete operations via <code><code>$regKey</code></code> to simply return a true value if they succeed. This optimization is automatically done if you use <code><code>delete</code></code> in a void context.</p>

</dd>
<dt id="Technical-notes-on-deleting">Technical notes on deleting</dt>
<dd>

<p>If you use <code><code>delete</code></code> to delete a Registry key or value and use the return value, then <i>Win32::TieRegistry</i> usually looks up the current contents of that key or value so they can be returned if the deletion is successful. If the deletion succeeds but the attempt to lookup the old contents failed, then the return value of <code><code>delete</code></code> will be <code><code>$^E</code></code> from the failed part of the operation.</p>

</dd>
<dt id="Undeleting-a-key">Undeleting a key</dt>
<dd>

<pre><code><code>    <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"LMachine/Software/Microsoft/Windows/"</span> <span class="operator">.</span>
                <span class="string">"CurrentVersion/Explorer/Tips/"</span><span class="operator">}</span><span class="operator">=</span> <span class="variable">$tips</span><span class="operator">;</span>
</code></code></pre>

<p>This adds back what we just deleted. Note that this version of <i>Win32::TieRegistry</i> will use defaults for the key attributes [such as class name and security] and will not restore the previous attributes.</p>

</dd>
<dt id="Not-deleting-a-key">Not deleting a key</dt>
<dd>

<p>WARNING: Actually executing the following code could cause serious problems. This statement is shown as an example only and should not be used when experimenting.</p>

<pre><code><code>    <span class="variable">$res</span><span class="operator">=</span> <span class="keyword">delete</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"CUser/Software/Microsoft/Windows/"</span><span class="operator">}</span>
    <span class="keyword">defined</span><span class="operator">(</span><span class="variable">$res</span><span class="operator">)</span>  <span class="operator">||</span>  <span class="keyword">die</span> <span class="string">"Can't delete URL key: $^E\n"</span><span class="operator">;</span>
</code></code></pre>

<p>Since the &quot;Windows&quot; key should contain subkeys, that <code><code>delete</code></code> statement should make no changes to the Registry, return <code><code>undef</code></code>, and set <code><code>$^E</code></code> to &quot;Access is denied&quot;.</p>

</dd>
<dt id="Not-deleting-again">Not deleting again</dt>
<dd>

<pre><code><code>    <span class="variable">$tips</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"CUser/Software/Microsoft/Windows/"</span> <span class="operator">.</span>
                       <span class="string">"CurrentVersion/Explorer/Tips/"</span><span class="operator">}</span><span class="operator">;</span>
    <span class="keyword">delete</span> <span class="variable">$tips</span><span class="operator">;</span>
</code></code></pre>

<p>The Perl <code><code>delete</code></code> function requires that its argument be an expression that ends in a hash element lookup [or hash slice], which is not the case here. The <code><code>delete</code></code> function doesn&#39;t know which hash $tips came from and so can&#39;t delete it.</p>

</dd>
</dl>

<h2 id="Objects-Documentation">Objects Documentation</h2>

<p>The following member functions are defined for use on <i>Win32::TieRegistry</i> objects:</p>

<dl>

<dt id="new">new</dt>
<dd>

<p>The <code><code>new</code></code> method creates a new <i>Win32::TieRegistry</i> object. <code><code>new</code></code> is mostly a synonym for <code><code>Open()</code></code> so see <code><code>Open()</code></code> below for information on what arguments to pass in. Examples:</p>

<pre><code><code>    <span class="variable">$machKey</span><span class="operator">=</span> <span class="variable">new</span> <span class="variable">Win32::TieRegistry</span> <span class="string">"LMachine"</span>
      <span class="keyword">or</span>  <span class="keyword">die</span> <span class="string">"Can't access HKEY_LOCAL_MACHINE key: $^E\n"</span><span class="operator">;</span>
    <span class="variable">$userKey</span><span class="operator">=</span> <span class="variable">Win32::TieRegistry</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span><span class="string">"CUser"</span><span class="operator">)</span>
      <span class="keyword">or</span>  <span class="keyword">die</span> <span class="string">"Can't access HKEY_CURRENT_USER key: $^E\n"</span><span class="operator">;</span>
</code></code></pre>

<p>Note that calling <code><code>new</code></code> via a reference to a tied hash returns a simple object, not a reference to a tied hash.</p>

</dd>
<dt id="Open">Open</dt>
<dd>

</dd>
<dt id="subKey-key-Open-sSubKey-rhOptions-">$subKey= $key-&gt;Open( $sSubKey, $rhOptions )</dt>
<dd>

<p>The <code><code>Open</code></code> method opens a Registry key and returns a new <i>Win32::TieRegistry</i> object associated with that Registry key. If <code><code>Open</code></code> is called via a reference to a tied hash, then <code><code>Open</code></code> returns another reference to a tied hash. Otherwise <code><code>Open</code></code> returns a simple object and you should then use <code><code>TiedRef</code></code> to get a reference to a tied hash.</p>

<p><code><code>$sSubKey</code></code> is a string specifying a subkey to be opened. Alternately <code><code>$sSubKey</code></code> can be a reference to an array value containing the list of increasingly deep subkeys specifying the path to the subkey to be opened.</p>

<p><code><code>$rhOptions</code></code> is an optional reference to a hash containing extra options. The <code><code>Open</code></code> method supports two options, <code><code>&quot;Delimiter&quot;</code></code> and <code><code>&quot;Access&quot;</code></code>, and <code><code>$rhOptions</code></code> should have only have zero or more of these strings as keys. See the &quot;Examples&quot; section below for more information.</p>

<p>The <code><code>&quot;Delimiter&quot;</code></code> option specifies what string [usually a single character] will be used as the delimiter to be appended to subkey names and prepended to value names. If this option is not specified, the new key [<code><code>$subKey</code></code>] inherits the delimiter of the old key [<code><code>$key</code></code>].</p>

<p>The <code><code>&quot;Access&quot;</code></code> option specifies what level of access to the Registry key you wish to have once it has been opened. If this option is not specified, the new key [<code><code>$subKey</code></code>] is opened with the same access level used when the old key [<code><code>$key</code></code>] was opened. The virtual root of the Registry pretends it was opened with access <code><code>KEY_READ()|KEY_WRITE()</code></code> so this is the default access when opening keys directory via <code><code>$Registry</code></code>. If you don&#39;t plan on modifying a key, you should open it with <code><code>KEY_READ</code></code> access as you may not have <code><code>KEY_WRITE</code></code> access to it or some of its subkeys.</p>

<p>If the <code><code>&quot;Access&quot;</code></code> option value is a string that starts with <code><code>&quot;KEY_&quot;</code></code>, then it should match <b>one</b> of the predefined access levels [probably <code><code>&quot;KEY_READ&quot;</code></code>, <code><code>&quot;KEY_WRITE&quot;</code></code>, or <code><code>&quot;KEY_ALL_ACCESS&quot;</code></code>] exported by the <i>Win32API::Registry</i> module. Otherwise, a numeric value is expected. For maximum flexibility, include <code><code><span class="keyword">use</span> <span class="variable">Win32::TieRegistry</span> <span class="string">qw(:KEY_)</span><span class="operator">;</span>
</code></code>, for example, near the top of your script so you can specify more complicated access levels such as <code><code>KEY_READ()|KEY_WRITE()</code></code>.</p>

<p>If <code><code>$sSubKey</code></code> does not begin with the delimiter [or <code><code>$sSubKey</code></code> is an array reference], then the path to the subkey to be opened will be relative to the path of the original key [<code><code>$key</code></code>]. If <code><code>$sSubKey</code></code> begins with a single delimiter, then the path to the subkey to be opened will be relative to the virtual root of the Registry on whichever machine the original key resides. If <code><code>$sSubKey</code></code> begins with two consectutive delimiters, then those must be followed by a machine name which causes the <code><code>Connect()</code></code> method function to be called.</p>

<p>Examples:</p>

<pre><code><code>    <span class="variable">$machKey</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="variable">Open</span><span class="operator">(</span> <span class="string">"LMachine"</span><span class="operator">,</span> <span class="operator">{</span><span class="string">Access</span><span class="operator">=&gt;</span><span class="variable">KEY_READ</span><span class="operator">(),</span><span class="string">Delimiter</span><span class="operator">=&gt;</span><span class="string">"/"</span><span class="operator">}</span> <span class="operator">)</span>
      <span class="keyword">or</span>  <span class="keyword">die</span> <span class="string">"Can't open HKEY_LOCAL_MACHINE key: $^E\n"</span><span class="operator">;</span>
    <span class="variable">$swKey</span><span class="operator">=</span> <span class="variable">$machKey</span><span class="operator">-&gt;</span><span class="variable">Open</span><span class="operator">(</span> <span class="string">"Software"</span> <span class="operator">);</span>
    <span class="variable">$logonKey</span><span class="operator">=</span> <span class="variable">$swKey</span><span class="operator">-&gt;</span><span class="variable">Open</span><span class="operator">(</span> <span class="string">"Microsoft/Windows NT/CurrentVersion/Winlogon/"</span> <span class="operator">);</span>
    <span class="variable">$NTversKey</span><span class="operator">=</span> <span class="variable">$swKey</span><span class="operator">-&gt;</span><span class="variable">Open</span><span class="operator">(</span> <span class="operator">[</span><span class="string">"Microsoft"</span><span class="operator">,</span><span class="string">"Windows NT"</span><span class="operator">,</span><span class="string">"CurrentVersion"</span><span class="operator">]</span> <span class="operator">);</span>
    <span class="variable">$versKey</span><span class="operator">=</span> <span class="variable">$swKey</span><span class="operator">-&gt;</span><span class="variable">Open</span><span class="operator">(</span> <span class="string">qw(Microsoft Windows CurrentVersion)</span> <span class="operator">);</span>
    
    <span class="variable">$remoteKey</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="variable">Open</span><span class="operator">(</span> <span class="string">"//HostA/LMachine/System/"</span><span class="operator">,</span> <span class="operator">{</span><span class="string">Delimiter</span><span class="operator">=&gt;</span><span class="string">"/"</span><span class="operator">}</span> <span class="operator">)</span>
      <span class="keyword">or</span>  <span class="keyword">die</span> <span class="string">"Can't connect to HostA or can't open subkey: $^E\n"</span><span class="operator">;</span>
</code></code></pre>

</dd>
<dt id="Clone">Clone</dt>
<dd>

</dd>
<dt id="copy-key-Clone">$copy= $key-&gt;Clone</dt>
<dd>

<p>Creates a new object that is associated with the same Registry key as the invoking object.</p>

</dd>
<dt id="Connect">Connect</dt>
<dd>

</dd>
<dt id="remoteKey-Registry-Connect-sMachineName-sKeyPath-rhOptions-">$remoteKey= $Registry-&gt;Connect( $sMachineName, $sKeyPath, $rhOptions )</dt>
<dd>

<p>The <code><code>Connect</code></code> method connects to the Registry of a remote machine, and opens a key within it, then returns a new <i>Win32::TieRegistry</i> object associated with that remote Registry key. If <code><code>Connect</code></code> was called using a reference to a tied hash, then the return value will also be a reference to a tied hash [or <code><code>undef</code></code>]. Otherwise, if you wish to use the returned object as a tied hash [not just as an object], then use the <code><code>TiedRef</code></code> method function after <code><code>Connect</code></code>.</p>

<p><code><code>$sMachineName</code></code> is the name of the remote machine. You don&#39;t have to preceed the machine name with two delimiter characters.</p>

<p><code><code>$sKeyPath</code></code> is a string specifying the remote key to be opened. Alternately <code><code>$sKeyPath</code></code> can be a reference to an array value containing the list of increasingly deep keys specifying the path to the key to be opened.</p>

<p><code><code>$rhOptions</code></code> is an optional reference to a hash containing extra options. The <code><code>Connect</code></code> method supports two options, <code><code>&quot;Delimiter&quot;</code></code> and <code><code>&quot;Access&quot;</code></code>. See the <code><code>Open</code></code> method documentation for more information on these options.</p>

<p><code><code>$sKeyPath</code></code> is already relative to the virtual root of the Registry of the remote machine. A single leading delimiter on <code><code>sKeyPath</code></code> will be ignored and is not required.</p>

<p><code><code>$sKeyPath</code></code> can be empty in which case <code><code>Connect</code></code> will return an object representing the virtual root key of the remote Registry. Each subsequent use of <code><code>Open</code></code> on this virtual root key will call the system <code><code>RegConnectRegistry</code></code> function.</p>

<p>The <code><code>Connect</code></code> method can be called via any <i>Win32::TieRegistry</i> object, not just <code><code>$Registry</code></code>. Attributes such as the desired level of access and the delimiter will be inherited from the object used but the <code><code>$sKeyPath</code></code> will always be relative to the virtual root of the remote machine&#39;s registry.</p>

<p>Examples:</p>

<pre><code><code>    <span class="variable">$remMachKey</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="variable">Connect</span><span class="operator">(</span> <span class="string">"HostA"</span><span class="operator">,</span> <span class="string">"LMachine"</span><span class="operator">,</span> <span class="operator">{</span><span class="variable">Delimiter</span><span class="operator">-&gt;</span>"<span class="operator">/</span><span class="string">"} )
      or  die "</span><span class="variable">Can't</span> <span class="keyword">connect</span> <span class="variable">to</span> <span class="variable">HostA's</span> <span class="variable">HKEY_LOCAL_MACHINE</span> <span class="variable">key</span><span class="operator">:</span> <span class="variable">$^E</span><span class="operator">\</span><span class="variable">n</span><span class="string">";
    
    </span><span class="variable">$remVersKey</span><span class="string">= </span><span class="variable">$remMachKey</span><span class="string">-&gt;Connect( "</span><span class="variable">www</span><span class="operator">.</span><span class="variable">microsoft</span><span class="operator">.</span><span class="variable">com</span><span class="string">",
                   "</span><span class="variable">LMachine</span><span class="operator">/</span><span class="variable">Software</span><span class="operator">/</span><span class="variable">Microsoft</span><span class="operator">/</span><span class="variable">Inetsrv</span><span class="operator">/</span><span class="variable">CurrentVersion</span><span class="operator">/</span><span class="string">",
                   { Access=&gt;KEY_READ, Delimiter=&gt;"</span><span class="operator">/</span><span class="string">" } )
      or  die "</span><span class="variable">Can't</span> <span class="variable">check</span> <span class="variable">what</span> <span class="variable">version</span> <span class="variable">of</span> <span class="variable">IIS</span> <span class="variable">Microsoft</span> <span class="variable">is</span> <span class="variable">running</span><span class="operator">:</span> <span class="variable">$^E</span><span class="operator">\</span><span class="variable">n</span><span class="string">";
    
    </span><span class="variable">$remVersKey</span><span class="string">= </span><span class="variable">$remMachKey</span><span class="string">-&gt;Connect( "</span><span class="variable">www</span><span class="string">",
                   qw(LMachine Software Microsoft Inetsrv CurrentVersion) )
      or  die "</span><span class="variable">Can't</span> <span class="variable">check</span> <span class="variable">what</span> <span class="variable">version</span> <span class="variable">of</span> <span class="variable">IIS</span> <span class="variable">we</span> <span class="variable">are</span> <span class="variable">running</span><span class="operator">:</span> <span class="variable">$^E</span><span class="operator">\</span><span class="variable">n</span><span class="string">";
    </span>
</code></code></pre>

</dd>
<dt id="ObjectRef">ObjectRef</dt>
<dd>

</dd>
<dt id="object_ref-obj_or_hash_ref-ObjectRef">$object_ref= $obj_or_hash_ref-&gt;ObjectRef</dt>
<dd>

<p>For a simple object, just returns itself [<code><code>$obj == $obj-</code></code>ObjectRef&gt;].</p>

<p>For a reference to a tied hash [if it is also an object], <code><code>ObjectRef</code></code> returns the simple object that the hash is tied to.</p>

<p>This is primarilly useful when debugging since typing <code><code>x $Registry</code></code> will try to display your <i>entire</i> registry contents to your screen. But the debugger command <code><code>x $Registry-</code></code>ObjectRef&gt; will just dump the implementation details of the underlying object to your screen.</p>

</dd>
<dt id="Flush-bFlush-">Flush( $bFlush )</dt>
<dd>

<p>Flushes all cached information about the Registry key so that future uses will get fresh data from the Registry.</p>

<p>If the optional <code><code>$bFlush</code></code> is specified and a true value, then <code><code>RegFlushKey()</code></code> will be called, which is almost never necessary.</p>

</dd>
<dt id="GetValue">GetValue</dt>
<dd>

</dd>
<dt id="ValueData-key-GetValue-sValueName-">$ValueData= $key-&gt;GetValue( $sValueName )</dt>
<dd>

</dd>
<dt id="ValueData-ValueType-key-GetValue-sValueName-">($ValueData,$ValueType)= $key-&gt;GetValue( $sValueName )</dt>
<dd>

<p>Gets a Registry value&#39;s data and data type.</p>

<p><code><code>$ValueData</code></code> is usually just a Perl string that contains the value data [packed into it]. For certain types of data, however, <code><code>$ValueData</code></code> may be processed as described below.</p>

<p><code><code>$ValueType</code></code> is the <code><code>REG_*</code></code> constant describing the type of value data stored in <code><code>$ValueData</code></code>. If the <code><code>DualTypes()</code></code> option is on, then <code><code>$ValueType</code></code> will be a dual value. That is, when used in a numeric context, <code><code>$ValueType</code></code> will give the numeric value of a <code><code>REG_*</code></code> constant. However, when used in a non-numeric context, <code><code>$ValueType</code></code> will return the name of the <code><code>REG_*</code></code> constant, for example <code><code>&quot;REG_SZ&quot;</code></code> [note the quotes]. So both of the following can be true at the same time:</p>

<pre><code><code>    $ValueType == REG_SZ()
    $ValueType eq &quot;REG_SZ&quot;</code></code></pre>

<dl>

<dt id="REG_SZ-and-REG_EXPAND_SZ">REG_SZ and REG_EXPAND_SZ</dt>
<dd>

<p>If the <code><code>FixSzNulls()</code></code> option is on, then the trailing <code><code>&#39;\0&#39;</code></code> will be stripped [unless there isn&#39;t one] before values of type <code><code>REG_SZ</code></code> and <code><code>REG_EXPAND_SZ</code></code> are returned. Note that <code><code>SetValue()</code></code> will add a trailing <code><code>&#39;\0&#39;</code></code> under similar circumstances.</p>

</dd>
<dt id="REG_MULTI_SZ1">REG_MULTI_SZ</dt>
<dd>

<p>If the <code><code>SplitMultis()</code></code> option is on, then values of this type are returned as a reference to an array containing the strings. For example, a value that, with <code><code>SplitMultis()</code></code> off, would be returned as:</p>

<pre><code><code>    &quot;Value1\000Value2\000\000&quot;</code></code></pre>

<p>would be returned, with <code><code>SplitMultis()</code></code> on, as:</p>

<pre><code><code>    [ &quot;Value1&quot;, &quot;Value2&quot; ]</code></code></pre>

</dd>
<dt id="REG_DWORD1">REG_DWORD</dt>
<dd>

<p>If the <code><code>DualBinVals()</code></code> option is on, then the value is returned as a scalar containing both a string and a number [much like the <code><code>$!</code></code> variable -- see the <a>SetDualVar</a> module for more information] where the number part is the &quot;unpacked&quot; value. Use the returned value in a numeric context to access this part of the value. For example:</p>

<pre><code><code>    <span class="variable">$num</span><span class="operator">=</span> <span class="number">0</span> <span class="operator">+</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"CUser/Console//ColorTable01"</span><span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

<p>If the <code><code>DWordsToHex()</code></code> option is off, the string part of the returned value is a packed, 4-byte string [use <code><code>unpack(&quot;L&quot;,$value)</code></code> to get the numeric value.</p>

<p>If <code><code>DWordsToHex()</code></code> is on, the string part of the returned value is a 10-character hex strings [with leading &quot;0x&quot;]. You can use <code><code>hex($value)</code></code> to get the numeric value.</p>

<p>Note that <code><code>SetValue()</code></code> will properly understand each of these returned value formats no matter how <code><code>DualBinVals()</code></code> is set.</p>

</dd>
</dl>

</dd>
<dt id="ValueNames">ValueNames</dt>
<dd>

</dd>
<dt id="names-key-ValueNames">@names= $key-&gt;ValueNames</dt>
<dd>

<p>Returns the list of value names stored directly in a Registry key. Note that the names returned do <i>not</i> have a delimiter prepended to them like with <code><code>MemberNames()</code></code> and tied hashes.</p>

<p>Once you request this information, it is cached in the object and future requests will always return the same list unless <code><code>Flush()</code></code> has been called.</p>

</dd>
<dt id="SubKeyNames">SubKeyNames</dt>
<dd>

</dd>
<dt id="key_names-key-SubKeyNames">@key_names= $key-&gt;SubKeyNames</dt>
<dd>

<p>Returns the list of subkey names stored directly in a Registry key. Note that the names returned do <i>not</i> have a delimiter appended to them like with <code><code>MemberNames()</code></code> and tied hashes.</p>

<p>Once you request this information, it is cached in the object and future requests will always return the same list unless <code><code>Flush()</code></code> has been called.</p>

</dd>
<dt id="SubKeyClasses">SubKeyClasses</dt>
<dd>

</dd>
<dt id="classes-key-SubKeyClasses">@classes= $key-&gt;SubKeyClasses</dt>
<dd>

<p>Returns the list of classes for subkeys stored directly in a Registry key. The classes are returned in the same order as the subkey names returned by <code><code>SubKeyNames()</code></code>.</p>

</dd>
<dt id="SubKeyTimes">SubKeyTimes</dt>
<dd>

</dd>
<dt id="times-key-SubKeyTimes">@times= $key-&gt;SubKeyTimes</dt>
<dd>

<p>Returns the list of last-modified times for subkeys stored directly in a Registry key. The times are returned in the same order as the subkey names returned by <code><code>SubKeyNames()</code></code>. Each time is a <code><code>FILETIME</code></code> structure packed into a Perl string.</p>

<p>Once you request this information, it is cached in the object and future requests will always return the same list unless <code><code>Flush()</code></code> has been called.</p>

</dd>
<dt id="MemberNames">MemberNames</dt>
<dd>

</dd>
<dt id="members-key-MemberNames">@members= $key-&gt;MemberNames</dt>
<dd>

<p>Returns the list of subkey names and value names stored directly in a Registry key. Subkey names have a delimiter appended to the end and value names have a delimiter prepended to the front.</p>

<p>Note that a value name could end in a delimiter [or could be <code><code>&quot;&quot;</code></code> so that the member name returned is just a delimiter] so the presence or absence of the leading delimiter is what should be used to determine whether a particular name is for a subkey or a value, not the presence or absence of a trailing delimiter.</p>

<p>Once you request this information, it is cached in the object and future requests will always return the same list unless <code><code>Flush()</code></code> has been called.</p>

</dd>
<dt id="Information">Information</dt>
<dd>

</dd>
<dt id="info-key-Information">%info= $key-&gt;Information</dt>
<dd>

</dd>
<dt id="items-key-Information-itemNames-">@items= $key-&gt;Information( @itemNames );</dt>
<dd>

<p>Returns the following information about a Registry key:</p>

<dl>

<dt id="LastWrite">LastWrite</dt>
<dd>

<p>A <code><code>FILETIME</code></code> structure indicating when the key was last modified and packed into a Perl string.</p>

</dd>
<dt id="CntSubKeys">CntSubKeys</dt>
<dd>

<p>The number of subkeys stored directly in this key.</p>

</dd>
<dt id="CntValues">CntValues</dt>
<dd>

<p>The number of values stored directly in this key.</p>

</dd>
<dt id="SecurityLen">SecurityLen</dt>
<dd>

<p>The length [in bytes] of the largest[?] <code><code>SECURITY_DESCRIPTOR</code></code> associated with the Registry key.</p>

</dd>
<dt id="MaxValDataLen">MaxValDataLen</dt>
<dd>

<p>The length [in bytes] of the longest value data associated with a value stored in this key.</p>

</dd>
<dt id="MaxSubKeyLen">MaxSubKeyLen</dt>
<dd>

<p>The length [in chars] of the longest subkey name associated with a subkey stored in this key.</p>

</dd>
<dt id="MaxSubClassLen">MaxSubClassLen</dt>
<dd>

<p>The length [in chars] of the longest class name associated with a subkey stored directly in this key.</p>

</dd>
<dt id="MaxValNameLen">MaxValNameLen</dt>
<dd>

<p>The length [in chars] of the longest value name associated with a value stored in this key.</p>

</dd>
</dl>

<p>With no arguments, returns a hash [not a reference to a hash] where the keys are the names for the items given above and the values are the information describe above. For example:</p>

<pre><code><code>    <span class="variable">%info</span><span class="operator">=</span> <span class="operator">(</span> <span class="string">"CntValues"</span> <span class="operator">=&gt;</span> <span class="number">25</span><span class="operator">,</span>         <span class="comment"># Key contains 25 values.</span>
             <span class="string">"MaxValNameLen"</span> <span class="operator">=&gt;</span> <span class="number">20</span><span class="operator">,</span>     <span class="comment"># One of which has a 20-char name.</span>
             <span class="string">"MaxValDataLen"</span> <span class="operator">=&gt;</span> <span class="number">42</span><span class="operator">,</span>     <span class="comment"># One of which has a 42-byte value.</span>
             <span class="string">"CntSubKeys"</span> <span class="operator">=&gt;</span> <span class="number">1</span><span class="operator">,</span>         <span class="comment"># Key has 1 immediate subkey.</span>
             <span class="string">"MaxSubKeyLen"</span> <span class="operator">=&gt;</span> <span class="number">13</span><span class="operator">,</span>      <span class="comment"># One of which has a 12-char name.</span>
             <span class="string">"MaxSubClassLen"</span> <span class="operator">=&gt;</span> <span class="number">0</span><span class="operator">,</span>     <span class="comment"># All of which have class names of "".</span>
             <span class="string">"SecurityLen"</span> <span class="operator">=&gt;</span> <span class="number">232</span><span class="operator">,</span>      <span class="comment"># One SECURITY_DESCRIPTOR is 232 bytes.</span>
             <span class="string">"LastWrite"</span> <span class="operator">=&gt;</span> <span class="string">"\x90mZ\cX{\xA3\xBD\cA\c@\cA"</span>
                           <span class="comment"># Key was last modifed 1998/06/01 16:29:32 GMT</span>
           <span class="operator">);</span>
</code></code></pre>

<p>With arguments, each one must be the name of a item given above. The return value is the information associated with the listed names. In other words:</p>

<pre><code><code>    <span class="keyword">return</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">Information</span><span class="operator">(</span> <span class="variable">@names</span> <span class="operator">);</span>
</code></code></pre>

<p>returns the same list as:</p>

<pre><code><code>    <span class="variable">%info</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">Information</span><span class="operator">;</span>
    <span class="keyword">return</span> <span class="variable">@info</span><span class="operator">{</span><span class="variable">@names</span><span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

</dd>
<dt id="Delimiter">Delimiter</dt>
<dd>

</dd>
<dt id="oldDelim-key-Delimiter">$oldDelim= $key-&gt;Delimiter</dt>
<dd>

</dd>
<dt id="oldDelim-key-Delimiter-newDelim-">$oldDelim= $key-&gt;Delimiter( $newDelim )</dt>
<dd>

<p>Gets and possibly changes the delimiter used for this object. The delimiter is appended to subkey names and prepended to value names in many return values. It is also used when parsing keys passed to tied hashes.</p>

<p>The delimiter defaults to backslash (<code><code>&#39;\\&#39;</code></code>) but is inherited from the object used to create a new object and can be specified by an option when a new object is created.</p>

</dd>
<dt id="Handle">Handle</dt>
<dd>

</dd>
<dt id="handle-key-Handle">$handle= $key-&gt;Handle</dt>
<dd>

<p>Returns the raw <code><code>HKEY</code></code> handle for the associated Registry key as an integer value. This value can then be used to Reg*() calls from <i>Win32API::Registry</i>. However, it is usually easier to just call the <i>Win32API::Registry</i> calls directly via:</p>

<pre><code><code>    <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">RegNotifyChangeKeyValue</span><span class="operator">(</span> <span class="operator">...</span> <span class="operator">);</span>
</code></code></pre>

<p>For the virtual root of the local or a remote Registry, <code><code>Handle()</code></code> return <code><code>&quot;NONE&quot;</code></code>.</p>

</dd>
<dt id="Path">Path</dt>
<dd>

</dd>
<dt id="path-key-Path">$path= $key-&gt;Path</dt>
<dd>

<p>Returns a string describing the path of key names to this Registry key. The string is built so that if it were passed to <code><code>$Registry-</code></code>Open()&gt;, it would reopen the same Registry key [except in the rare case where one of the key names contains <code><code>$key-</code></code>Delimiter&gt;].</p>

</dd>
<dt id="Machine">Machine</dt>
<dd>

</dd>
<dt id="computerName-key-Machine">$computerName= $key-&gt;Machine</dt>
<dd>

<p>Returns the name of the computer [or &quot;machine&quot;] on which this Registry key resides. Returns <code><code>&quot;&quot;</code></code> for local Registry keys.</p>

</dd>
<dt id="Access">Access</dt>
<dd>

<p>Returns the numeric value of the bit mask used to specify the types of access requested when this Registry key was opened. Can be compared to <code><code>KEY_*</code></code> values.</p>

</dd>
<dt id="OS_Delimiter">OS_Delimiter</dt>
<dd>

<p>Returns the delimiter used by the operating system&#39;s RegOpenKeyEx() call. For Win32, this is always backslash (<code><code>&quot;\\&quot;</code></code>).</p>

</dd>
<dt id="Roots">Roots</dt>
<dd>

<p>Returns the mapping from root key names like <code><code>&quot;LMachine&quot;</code></code> to their associated <code><code>HKEY_*</code></code> constants. Primarily for internal use and subject to change.</p>

</dd>
<dt id="Tie">Tie</dt>
<dd>

</dd>
<dt id="key-Tie-hash-">$key-&gt;Tie( \%hash );</dt>
<dd>

<p>Ties the referenced hash to that Registry key. Pretty much the same as</p>

<pre><code><code>    <span class="keyword">tie</span> <span class="variable">%hash</span><span class="operator">,</span> <span class="keyword">ref</span><span class="operator">(</span><span class="variable">$key</span><span class="operator">),</span> <span class="variable">$key</span><span class="operator">;</span>
</code></code></pre>

<p>Since <code><code>ref($key)</code></code> is the class [package] to tie the hash to and <code><code>TIEHASH()</code></code> just returns its argument, <code><code>$key</code></code>, [without calling <code><code>new()</code></code>] when it sees that it is already a blessed object.</p>

</dd>
<dt id="TiedRef">TiedRef</dt>
<dd>

</dd>
<dt id="TiedHashRef-hash_or_obj_ref-TiedRef">$TiedHashRef= $hash_or_obj_ref-&gt;TiedRef</dt>
<dd>

<p>For a simple object, returns a reference to a hash tied to the object. Used to promote a simple object into a combined object and hash ref.</p>

<p>If already a reference to a tied hash [that is also an object], it just returns itself [<code><code>$ref == $ref-</code></code>TiedRef&gt;].</p>

<p>Mostly used internally.</p>

</dd>
<dt id="ArrayValues">ArrayValues</dt>
<dd>

</dd>
<dt id="oldBool-key-ArrayValues">$oldBool= $key-&gt;ArrayValues</dt>
<dd>

</dd>
<dt id="oldBool-key-ArrayValues-newBool-">$oldBool= $key-&gt;ArrayValues( $newBool )</dt>
<dd>

<p>Gets the current setting of the <code><code>ArrayValues</code></code> option and possibly turns it on or off.</p>

<p>When off, Registry values fetched via a tied hash are returned as just a value scalar [the same as <code><code>GetValue()</code></code> in a scalar context]. When on, they are returned as a reference to an array containing the value data as the <code><code>[0]</code></code> element and the data type as the <code><code>[1]</code></code> element.</p>

</dd>
<dt id="TieValues">TieValues</dt>
<dd>

</dd>
<dt id="oldBool-TieValues">$oldBool= TieValues</dt>
<dd>

</dd>
<dt id="oldBool-TieValues-newBool-">$oldBool= TieValues( $newBool )</dt>
<dd>

<p>Gets the current setting of the <code><code>TieValues</code></code> option and possibly turns it on or off.</p>

<p>Turning this option on is not yet supported in this release of <i>Win32::TieRegistry</i>. In a future release, turning this option on will cause Registry values returned from a tied hash to be a tied array that you can use to modify the value in the Registry.</p>

</dd>
<dt id="FastDelete">FastDelete</dt>
<dd>

</dd>
<dt id="oldBool-key-FastDelete">$oldBool= $key-&gt;FastDelete</dt>
<dd>

</dd>
<dt id="oldBool-key-FastDelete-newBool-">$oldBool= $key-&gt;FastDelete( $newBool )</dt>
<dd>

<p>Gets the current setting of the <code><code>FastDelete</code></code> option and possibly turns it on or off.</p>

<p>When on, successfully deleting a Registry key [via a tied hash] simply returns <code><code>1</code></code>.</p>

<p>When off, successfully deleting a Registry key [via a tied hash and not in a void context] returns a reference to a hash that contains the values present in the key when it was deleted. This hash is just like that returned when referencing the key before it was deleted except that it is an ordinary hash, not one tied to the <i>Win32::TieRegistry</i> package.</p>

<p>Note that deleting either a Registry key or value via a tied hash <i>in a void context</i> prevents any overhead in trying to build an appropriate return value.</p>

<p>Note that deleting a Registry <i>value</i> via a tied hash [not in a void context] returns the value data even if &lt;FastDelete&gt; is on.</p>

</dd>
<dt id="SplitMultis">SplitMultis</dt>
<dd>

</dd>
<dt id="oldBool-key-SplitMultis">$oldBool= $key-&gt;SplitMultis</dt>
<dd>

</dd>
<dt id="oldBool-key-SplitMultis-newBool-">$oldBool= $key-&gt;SplitMultis( $newBool )</dt>
<dd>

<p>Gets the current setting of the <code><code>SplitMultis</code></code> option and possibly turns it on or off.</p>

<p>If on, Registry values of type <code><code>REG_MULTI_SZ</code></code> are returned as a reference to an array of strings. See <code><code>GetValue()</code></code> for more information.</p>

</dd>
<dt id="DWordsToHex">DWordsToHex</dt>
<dd>

</dd>
<dt id="oldBool-key-DWordsToHex">$oldBool= $key-&gt;DWordsToHex</dt>
<dd>

</dd>
<dt id="oldBool-key-DWordsToHex-newBool-">$oldBool= $key-&gt;DWordsToHex( $newBool )</dt>
<dd>

<p>Gets the current setting of the <code><code>DWordsToHex</code></code> option and possibly turns it on or off.</p>

<p>If on, Registry values of type <code><code>REG_DWORD</code></code> are returned as a hex string with leading <code><code>&quot;0x&quot;</code></code> and longer than 4 characters. See <code><code>GetValue()</code></code> for more information.</p>

</dd>
<dt id="FixSzNulls">FixSzNulls</dt>
<dd>

</dd>
<dt id="oldBool-key-FixSzNulls">$oldBool= $key-&gt;FixSzNulls</dt>
<dd>

</dd>
<dt id="oldBool-key-FixSzNulls-newBool-">$oldBool= $key-&gt;FixSzNulls( $newBool )</dt>
<dd>

<p>Gets the current setting of the <code><code>FixSzNulls</code></code> option and possibly turns it on or off.</p>

<p>If on, Registry values of type <code><code>REG_SZ</code></code> and <code><code>REG_EXPAND_SZ</code></code> have trailing <code><code>&#39;\0&#39;</code></code>s added before they are set and stripped before they are returned. See <code><code>GetValue()</code></code> and <code><code>SetValue()</code></code> for more information.</p>

</dd>
<dt id="DualTypes">DualTypes</dt>
<dd>

</dd>
<dt id="oldBool-key-DualTypes">$oldBool= $key-&gt;DualTypes</dt>
<dd>

</dd>
<dt id="oldBool-key-DualTypes-newBool-">$oldBool= $key-&gt;DualTypes( $newBool )</dt>
<dd>

<p>Gets the current setting of the <code><code>DualTypes</code></code> option and possibly turns it on or off.</p>

<p>If on, data types are returned as a combined numeric/string value holding both the numeric value of a <code><code>REG_*</code></code> constant and the string value of the constant&#39;s name. See <code><code>GetValue()</code></code> for more information.</p>

</dd>
<dt id="DualBinVals">DualBinVals</dt>
<dd>

</dd>
<dt id="oldBool-key-DualBinVals">$oldBool= $key-&gt;DualBinVals</dt>
<dd>

</dd>
<dt id="oldBool-key-DualBinVals-newBool-">$oldBool= $key-&gt;DualBinVals( $newBool )</dt>
<dd>

<p>Gets the current setting of the <code><code>DualBinVals</code></code> option and possibly turns it on or off.</p>

<p>If on, Registry value data of type <code><code>REG_BINARY</code></code> and no more than 4 bytes long and Registry values of type <code><code>REG_DWORD</code></code> are returned as a combined numeric/string value where the numeric value is the &quot;unpacked&quot; binary value as returned by:</p>

<pre><code><code>        hex reverse unpack( &quot;h*&quot;, $valData )</code></code></pre>

<p>on a &quot;little-endian&quot; computer. [Would be <code><code>hex unpack(&quot;H*&quot;,$valData)</code></code> on a &quot;big-endian&quot; computer if this module is ever ported to one.]</p>

<p>See <code><code>GetValue()</code></code> for more information.</p>

</dd>
<dt id="GetOptions">GetOptions</dt>
<dd>

</dd>
<dt id="oldOptValues-key-GetOptions-optionNames-">@oldOptValues= $key-&gt;GetOptions( @optionNames )</dt>
<dd>

</dd>
<dt id="refHashOfOldOpts-key-GetOptions-">$refHashOfOldOpts= $key-&gt;GetOptions()</dt>
<dd>

</dd>
<dt id="key-GetOptions-hashForOldOpts-">$key-&gt;GetOptions( \%hashForOldOpts )</dt>
<dd>

<p>Returns the current setting of any of the following options:</p>

<pre><code><code>    Delimiter     FixSzNulls    DWordsToHex
    ArrayValues   SplitMultis   DualBinVals
    TieValues     FastDelete    DualTypes</code></code></pre>

<p>Pass in one or more of the above names (as strings) to get back an array of the corresponding current settings in the same order:</p>

<pre><code><code>  <span class="keyword">my</span><span class="operator">(</span> <span class="variable">$fastDel</span><span class="operator">,</span> <span class="variable">$delim</span> <span class="operator">)=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">GetOptions</span><span class="operator">(</span><span class="string">"FastDelete"</span><span class="operator">,</span><span class="string">"Delimiter"</span><span class="operator">);</span>
</code></code></pre>

<p>Pass in no arguments to get back a reference to a hash where the above option names are the keys and the values are the corresponding current settings for each option:</p>

<pre><code><code>  <span class="keyword">my</span> <span class="variable">$href</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">GetOptions</span><span class="operator">();</span>
  <span class="keyword">my</span> <span class="variable">$delim</span><span class="operator">=</span> <span class="variable">$href</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">Delimiter</span><span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

<p>Pass in a single reference to a hash to have the above key/value pairs <i>added</i> to the referenced hash. For this case, the return value is the original object so further methods can be chained after the call to GetOptions:</p>

<pre><code><code>  <span class="keyword">my</span> <span class="variable">%oldOpts</span><span class="operator">;</span>
  <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">GetOptions</span><span class="operator">(</span> <span class="operator">\</span><span class="variable">%oldOpts</span> <span class="operator">)-&gt;</span><span class="variable">SetOptions</span><span class="operator">(</span> <span class="string">Delimiter</span> <span class="operator">=&gt;</span> <span class="string">"/"</span> <span class="operator">);</span>
</code></code></pre>

</dd>
<dt id="SetOptions">SetOptions</dt>
<dd>

</dd>
<dt id="oldOpts-key-SetOptions-optNames-optValue-...-">@oldOpts= $key-&gt;SetOptions( optNames=&gt;$optValue,... )</dt>
<dd>

<p>Changes the current setting of any of the following options, returning the previous setting(s):</p>

<pre><code><code>    Delimiter     FixSzNulls    DWordsToHex   AllowLoad
    ArrayValues   SplitMultis   DualBinVals   AllowSave
    TieValues     FastDelete    DualTypes</code></code></pre>

<p>For <code><code>AllowLoad</code></code> and <code><code>AllowSave</code></code>, instead of the previous setting, <code><code>SetOptions</code></code> returns whether or not the change was successful.</p>

<p>In a scalar context, returns only the last item. The last option can also be specified as <code><code>&quot;ref&quot;</code></code> or <code><code>&quot;r&quot;</code></code> [which doesn&#39;t need to be followed by a value] to allow chaining:</p>

<pre><code><code>    $key-&gt;SetOptions(AllowSave=&gt;1,&quot;ref&quot;)-&gt;RegSaveKey(...)</code></code></pre>

</dd>
<dt id="SetValue">SetValue</dt>
<dd>

</dd>
<dt id="okay-key-SetValue-ValueName-ValueData-">$okay= $key-&gt;SetValue( $ValueName, $ValueData );</dt>
<dd>

</dd>
<dt id="okay-key-SetValue-ValueName-ValueData-ValueType-">$okay= $key-&gt;SetValue( $ValueName, $ValueData, $ValueType );</dt>
<dd>

<p>Adds or replaces a Registry value. Returns a true value if successfully, false otherwise.</p>

<p><code><code>$ValueName</code></code> is the name of the value to add or replace and should <i>not</i> have a delimiter prepended to it. Case is ignored.</p>

<p><code><code>$ValueType</code></code> is assumed to be <code><code>REG_SZ</code></code> if it is omitted. Otherwise, it should be one the <code><code>REG_*</code></code> constants.</p>

<p><code><code>$ValueData</code></code> is the data to be stored in the value, probably packed into a Perl string. Other supported formats for value data are listed below for each posible <code><code>$ValueType</code></code>.</p>

<dl>

<dt id="REG_SZ-or-REG_EXPAND_SZ">REG_SZ or REG_EXPAND_SZ</dt>
<dd>

<p>The only special processing for these values is the addition of the required trailing <code><code>&#39;\0&#39;</code></code> if it is missing. This can be turned off by disabling the <code><code>FixSzNulls</code></code> option.</p>

</dd>
<dt id="REG_MULTI_SZ2">REG_MULTI_SZ</dt>
<dd>

<p>These values can also be specified as a reference to a list of strings. For example, the following two lines are equivalent:</p>

<pre><code><code>    <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">SetValue</span><span class="operator">(</span> <span class="string">"Val1\000Value2\000LastVal\000\000"</span><span class="operator">,</span> <span class="string">"REG_MULTI_SZ"</span> <span class="operator">);</span>
    <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">SetValue</span><span class="operator">(</span> <span class="operator">[</span><span class="string">"Val1"</span><span class="operator">,</span><span class="string">"Value2"</span><span class="operator">,</span><span class="string">"LastVal"</span><span class="operator">]</span><span class="operator">,</span> <span class="string">"REG_MULTI_SZ"</span> <span class="operator">);</span>
</code></code></pre>

<p>Note that if the required two trailing nulls (<code><code>&quot;\000\000&quot;</code></code>) are missing, then this release of <code><code>SetValue()</code></code> will <i>not</i> add them.</p>

</dd>
<dt id="REG_DWORD2">REG_DWORD</dt>
<dd>

<p>These values can also be specified as a hex value with the leading <code><code>&quot;0x&quot;</code></code> included and totaling <i>more than</i> 4 bytes. These will be packed into a 4-byte string via:</p>

<pre><code><code>    <span class="variable">$data</span><span class="operator">=</span> <span class="keyword">pack</span><span class="operator">(</span> <span class="string">"L"</span><span class="operator">,</span> <span class="keyword">hex</span><span class="operator">(</span><span class="variable">$data</span><span class="operator">)</span> <span class="operator">);</span>
</code></code></pre>

</dd>
<dt id="REG_BINARY1">REG_BINARY</dt>
<dd>

<p>This value type is listed just to emphasize that no alternate format is supported for it. In particular, you should <i>not</i> pass in a numeric value for this type of data. <code><code>SetValue()</code></code> cannot distinguish such from a packed string that just happens to match a numeric value and so will treat it as a packed string.</p>

</dd>
</dl>

<p>An alternate calling format:</p>

<pre><code><code>    <span class="variable">$okay</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">SetValue</span><span class="operator">(</span> <span class="variable">$ValueName</span><span class="operator">,</span> <span class="operator">[</span> <span class="variable">$ValueData</span><span class="operator">,</span> <span class="variable">$ValueType</span> <span class="operator">]</span> <span class="operator">);</span>
</code></code></pre>

<p>[two arguments, the second of which is a reference to an array containing the value data and value type] is supported to ease using tied hashes with <code><code>SetValue()</code></code>.</p>

</dd>
<dt id="CreateKey">CreateKey</dt>
<dd>

</dd>
<dt id="newKey-key-CreateKey-subKey-">$newKey= $key-&gt;CreateKey( $subKey );</dt>
<dd>

</dd>
<dt id="newKey-key-CreateKey-subKey-Option-OptVal-...-">$newKey= $key-&gt;CreateKey( $subKey, { Option=&gt;OptVal,... } );</dt>
<dd>

<p>Creates a Registry key or just updates attributes of one. Calls <code><code>RegCreateKeyEx()</code></code> then, if it succeeded, creates an object associated with the [possibly new] subkey.</p>

<p><code><code>$subKey</code></code> is the name of a subkey [or a path to one] to be created or updated. It can also be a reference to an array containing a list of subkey names.</p>

<p>The second argument, if it exists, should be a reference to a hash specifying options either to be passed to <code><code>RegCreateKeyEx()</code></code> or to be used when creating the associated object. The following items are the supported keys for this options hash:</p>

<dl>

<dt id="Delimiter1">Delimiter</dt>
<dd>

<p>Specifies the delimiter to be used to parse <code><code>$subKey</code></code> and to be used in the new object. Defaults to <code><code>$key-</code></code>Delimiter&gt;.</p>

</dd>
<dt id="Access1">Access</dt>
<dd>

<p>Specifies the types of access requested when the subkey is opened. Should be a numeric bit mask that combines one or more <code><code>KEY_*</code></code> constant values.</p>

</dd>
<dt id="Class">Class</dt>
<dd>

<p>The name to assign as the class of the new or updated subkey. Defaults to <code><code>&quot;&quot;</code></code> as we have never seen a use for this information.</p>

</dd>
<dt id="Disposition">Disposition</dt>
<dd>

<p>Lets you specify a reference to a scalar where, upon success, will be stored either <code><code>REG_CREATED_NEW_KEY()</code></code> or <code><code>REG_OPENED_EXISTING_KEY()</code></code> depending on whether a new key was created or an existing key was opened.</p>

<p>If you, for example, did <code><code>use Win32::TieRegistry qw(REG_CREATED_NEW_KEY)</code></code> then you can use <code><code>REG_CREATED_NEW_KEY()</code></code> to compare against the numeric value stored in the referenced scalar.</p>

<p>If the <code><code>DualTypes</code></code> option is enabled, then in addition to the numeric value described above, the referenced scalar will also have a string value equal to either <code><code>&quot;REG_CREATED_NEW_KEY&quot;</code></code> or <code><code>&quot;REG_OPENED_EXISTING_KEY&quot;</code></code>, as appropriate.</p>

</dd>
<dt id="Security">Security</dt>
<dd>

<p>Lets you specify a <code><code>SECURITY_ATTRIBUTES</code></code> structure packed into a Perl string. See <code><code>Win32API::Registry::RegCreateKeyEx()</code></code> for more information.</p>

</dd>
<dt id="Volatile">Volatile</dt>
<dd>

<p>If true, specifies that the new key should be volatile, that is, stored only in memory and not backed by a hive file [and not saved if the computer is rebooted]. This option is ignored under Windows 95. Specifying <code><code>Volatile=&gt;1</code></code> is the same as specifying <code><code>Options=&gt;REG_OPTION_VOLATILE</code></code>.</p>

</dd>
<dt id="Backup">Backup</dt>
<dd>

<p>If true, specifies that the new key should be opened for backup/restore access. The <code><code>Access</code></code> option is ignored. If the calling process has enabled <code><code>&quot;SeBackupPrivilege&quot;</code></code>, then the subkey is opened with <code><code>KEY_READ</code></code> access as the <code><code>&quot;LocalSystem&quot;</code></code> user which should have access to all subkeys. If the calling process has enabled <code><code>&quot;SeRestorePrivilege&quot;</code></code>, then the subkey is opened with <code><code>KEY_WRITE</code></code> access as the <code><code>&quot;LocalSystem&quot;</code></code> user which should have access to all subkeys.</p>

<p>This option is ignored under Windows 95. Specifying <code><code>Backup=&gt;1</code></code> is the same as specifying <code><code>Options=&gt;REG_OPTION_BACKUP_RESTORE</code></code>.</p>

</dd>
<dt id="Options">Options</dt>
<dd>

<p>Lets you specify options to the <code><code>RegOpenKeyEx()</code></code> call. The value for this option should be a numeric value combining zero or more of the <code><code>REG_OPTION_*</code></code> bit masks. You may with to used the <code><code>Volatile</code></code> and/or <code><code>Backup</code></code> options instead of this one.</p>

</dd>
</dl>

</dd>
<dt id="StoreKey">StoreKey</dt>
<dd>

</dd>
<dt id="newKey-key-StoreKey-subKey-Contents-">$newKey= $key-&gt;StoreKey( $subKey, \%Contents );</dt>
<dd>

<p>Primarily for internal use.</p>

<p>Used to create or update a Registry key and any number of subkeys or values under it or its subkeys.</p>

<p><code><code>$subKey</code></code> is the name of a subkey to be created [or a path of subkey names separated by delimiters]. If that subkey already exists, then it is updated.</p>

<p><code><code>\%Contents</code></code> is a reference to a hash containing pairs of value names with value data and/or subkey names with hash references similar to <code><code>\%Contents</code></code>. Each of these cause a value or subkey of <code><code>$subKey</code></code> to be created or updated.</p>

<p>If <code><code><span class="variable">$Contents</span><span class="operator">{</span><span class="string">""</span><span class="operator">}</span>
</code></code> exists and is a reference to a hash, then it used as the options argument when <code><code>CreateKey()</code></code> is called for <code><code>$subKey</code></code>. This allows you to specify ...</p>

<pre><code><code>    <span class="keyword">if</span><span class="operator">(</span>  <span class="keyword">defined</span><span class="operator">(</span> <span class="variable">$$data</span><span class="operator">{</span><span class="string">""</span><span class="operator">}</span> <span class="operator">)</span>  <span class="operator">&amp;&amp;</span>  <span class="string">"HASH"</span> <span class="keyword">eq</span> <span class="keyword">ref</span><span class="operator">(</span><span class="variable">$$data</span><span class="operator">{</span><span class="string">""</span><span class="operator">}</span><span class="operator">)</span>  <span class="operator">)</span> <span class="operator">{</span>
        <span class="variable">$self</span><span class="operator">=</span> <span class="variable">$this</span><span class="operator">-&gt;</span><span class="variable">CreateKey</span><span class="operator">(</span> <span class="variable">$subKey</span><span class="operator">,</span> <span class="keyword">delete</span> <span class="variable">$$data</span><span class="operator">{</span><span class="string">""</span><span class="operator">}</span> <span class="operator">);</span>
</code></code></pre>

</dd>
<dt id="Load">Load</dt>
<dd>

</dd>
<dt id="newKey-key-Load-file-">$newKey= $key-&gt;Load( $file )</dt>
<dd>

</dd>
<dt id="newKey-key-Load-file-newSubKey-">$newKey= $key-&gt;Load( $file, $newSubKey )</dt>
<dd>

</dd>
<dt id="newKey-key-Load-file-newSubKey-Option-OptVal...-">$newKey= $key-&gt;Load( $file, $newSubKey, { Option=&gt;OptVal... } )</dt>
<dd>

</dd>
<dt id="newKey-key-Load-file-Option-OptVal...-">$newKey= $key-&gt;Load( $file, { Option=&gt;OptVal... } )</dt>
<dd>

<p>Loads a hive file into a Registry. That is, creates a new subkey and associates a hive file with it.</p>

<p><code><code>$file</code></code> is a hive file, that is a file created by calling <code><code>RegSaveKey()</code></code>. The <code><code>$file</code></code> path is interpreted relative to <code><code>%SystemRoot%/System32/config</code></code> on the machine where <code><code>$key</code></code> resides.</p>

<p><code><code>$newSubKey</code></code> is the name to be given to the new subkey. If <code><code>$newSubKey</code></code> is specified, then <code><code>$key</code></code> must be <code><code>HKEY_LOCAL_MACHINE</code></code> or <code><code>HKEY_USERS</code></code> of the local computer or a remote computer and <code><code>$newSubKey</code></code> should not contain any occurrences of either the delimiter or the OS delimiter.</p>

<p>If <code><code>$newSubKey</code></code> is not specified, then it is as if <code><code>$key</code></code> was <code><code><span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">LMachine</span><span class="operator">}</span>
</code></code> and <code><code>$newSubKey</code></code> is <code><code>&quot;PerlTie:999&quot;</code></code> where <code><code>&quot;999&quot;</code></code> is actually a sequence number incremented each time this process calls <code><code>Load()</code></code>.</p>

<p>You can specify as the last argument a reference to a hash containing options. You can specify the same options that you can specify to <code><code>Open()</code></code>. See <code><code>Open()</code></code> for more information on those. In addition, you can specify the option <code><code>&quot;NewSubKey&quot;</code></code>. The value of this option is interpretted exactly as if it was specified as the <code><code>$newSubKey</code></code> parameter and overrides the <code><code>$newSubKey</code></code> if one was specified.</p>

<p>The hive is automatically unloaded when the returned object [<code><code>$newKey</code></code>] is destroyed. Registry key objects opened within the hive will keep a reference to the <code><code>$newKey</code></code> object so that it will not be destroyed before these keys are closed.</p>

</dd>
<dt id="UnLoad">UnLoad</dt>
<dd>

</dd>
<dt id="okay-key-UnLoad">$okay= $key-&gt;UnLoad</dt>
<dd>

<p>Unloads a hive that was loaded via <code><code>Load()</code></code>. Cannot unload other hives. <code><code>$key</code></code> must be the return from a previous call to <code><code>Load()</code></code>. <code><code>$key</code></code> is closed and then the hive is unloaded.</p>

</dd>
<dt id="AllowSave">AllowSave</dt>
<dd>

</dd>
<dt id="okay-AllowSave-bool-">$okay= AllowSave( $bool )</dt>
<dd>

<p>Enables or disables the <code><code>&quot;ReBackupPrivilege&quot;</code></code> privilege for the current process. You will probably have to enable this privilege before you can use <code><code>RegSaveKey()</code></code>.</p>

<p>The return value indicates whether the operation succeeded, not whether the privilege was previously enabled.</p>

</dd>
<dt id="AllowLoad">AllowLoad</dt>
<dd>

</dd>
<dt id="okay-AllowLoad-bool-">$okay= AllowLoad( $bool )</dt>
<dd>

<p>Enables or disables the <code><code>&quot;ReRestorePrivilege&quot;</code></code> privilege for the current process. You will probably have to enable this privilege before you can use <code><code>RegLoadKey()</code></code>, <code><code>RegUnLoadKey()</code></code>, <code><code>RegReplaceKey()</code></code>, or <code><code>RegRestoreKey</code></code> and thus <code><code>Load()</code></code> and <code><code>UnLoad()</code></code>.</p>

<p>The return value indicates whether the operation succeeded, not whether the privilege was previously enabled.</p>

</dd>
</dl>

<h2 id="Exports-and-">Exports [<code><code>use</code></code> and <code><code>import()</code></code>]</h2>

<p>To have nothing imported into your package, use something like:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Win32::TieRegistry</span> <span class="number">0</span><span class="operator">.</span><span class="number">20</span> <span class="operator">();</span>
</code></code></pre>

<p>which would verify that you have at least version 0.20 but wouldn&#39;t call <code><code>import()</code></code>. The <i>Changes</i> file can be useful in figuring out which, if any, prior versions of <i>Win32::TieRegistry</i> you want to support in your script.</p>

<p>The code</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Win32::TieRegistry</span><span class="operator">;</span>
</code></code></pre>

<p>imports the variable <code><code>$Registry</code></code> into your package and sets it to be a reference to a hash tied to a copy of the master Registry virtual root object with the default options. One disadvantage to this &quot;default&quot; usage is that Perl does not support checking the module version when you use it.</p>

<p>Alternately, you can specify a list of arguments on the <code><code>use</code></code> line that will be passed to the <code><code>Win32::TieRegistry-</code></code>import()&gt; method to control what items to import into your package. These arguments fall into the following broad categories:</p>

<dl>

<dt id="Import-a-reference-to-a-hash-tied-to-a-Registry-virtual-root">Import a reference to a hash tied to a Registry virtual root</dt>
<dd>

<p>You can request that a scalar variable be imported (possibly) and set to be a reference to a hash tied to a Registry virtual root using any of the following types of arguments or argument pairs:</p>

<dl>

<dt id="TiedRef-scalar">&quot;TiedRef&quot;, &#39;$scalar&#39;</dt>
<dd>

</dd>
<dt id="TiedRef-pack::scalar">&quot;TiedRef&quot;, &#39;$pack::scalar&#39;</dt>
<dd>

</dd>
<dt id="TiedRef-scalar1">&quot;TiedRef&quot;, &#39;scalar&#39;</dt>
<dd>

</dd>
<dt id="TiedRef-pack::scalar1">&quot;TiedRef&quot;, &#39;pack::scalar&#39;</dt>
<dd>

<p>All of the above import a scalar named <code><code>$scalar</code></code> into your package (or the package named &quot;pack&quot;) and then sets it.</p>

</dd>
<dt id="scalar">&#39;$scalar&#39;</dt>
<dd>

</dd>
<dt id="pack::scalar">&#39;$pack::scalar&#39;</dt>
<dd>

<p>These are equivalent to the previous items to support a more traditional appearance to the list of exports. Note that the scalar name cannot be &quot;RegObj&quot; here.</p>

</dd>
<dt id="TiedRef-scalar2">&quot;TiedRef&quot;, \$scalar</dt>
<dd>

</dd>
<dt id="scalar1">\$scalar</dt>
<dd>

<p>These versions don&#39;t import anything but set the referenced <code><code>$scalar</code></code>.</p>

</dd>
</dl>

</dd>
<dt id="Import-a-hash-tied-to-the-Registry-virtual-root">Import a hash tied to the Registry virtual root</dt>
<dd>

<p>You can request that a hash variable be imported (possibly) and tied to a Registry virtual root using any of the following types of arguments or argument pairs:</p>

<dl>

<dt id="TiedHash-hash">&quot;TiedHash&quot;, &#39;%hash&#39;</dt>
<dd>

</dd>
<dt id="TiedHash-pack::hash">&quot;TiedHash&quot;, &#39;%pack::hash&#39;</dt>
<dd>

</dd>
<dt id="TiedHash-hash1">&quot;TiedHash&quot;, &#39;hash&#39;</dt>
<dd>

</dd>
<dt id="TiedHash-pack::hash1">&quot;TiedHash&quot;, &#39;pack::hash&#39;</dt>
<dd>

<p>All of the above import a hash named <code><code>%hash</code></code> into your package (or the package named &quot;pack&quot;) and then sets it.</p>

</dd>
<dt id="hash">&#39;%hash&#39;</dt>
<dd>

</dd>
<dt id="pack::hash">&#39;%pack::hash&#39;</dt>
<dd>

<p>These are equivalent to the previous items to support a more traditional appearance to the list of exports.</p>

</dd>
<dt id="TiedHash-hash2">&quot;TiedHash&quot;, \%hash</dt>
<dd>

</dd>
<dt id="hash1">\%hash</dt>
<dd>

<p>These versions don&#39;t import anything but set the referenced <code><code>%hash</code></code>.</p>

</dd>
</dl>

</dd>
<dt id="Import-a-Registry-virtual-root-object">Import a Registry virtual root object</dt>
<dd>

<p>You can request that a scalar variable be imported (possibly) and set to be a Registry virtual root object using any of the following types of arguments or argument pairs:</p>

<dl>

<dt id="ObjectRef-scalar">&quot;ObjectRef&quot;, &#39;$scalar&#39;</dt>
<dd>

</dd>
<dt id="ObjectRef-pack::scalar">&quot;ObjectRef&quot;, &#39;$pack::scalar&#39;</dt>
<dd>

</dd>
<dt id="ObjectRef-scalar1">&quot;ObjectRef&quot;, &#39;scalar&#39;</dt>
<dd>

</dd>
<dt id="ObjectRef-pack::scalar1">&quot;ObjectRef&quot;, &#39;pack::scalar&#39;</dt>
<dd>

<p>All of the above import a scalar named <code><code>$scalar</code></code> into your package (or the package named &quot;pack&quot;) and then sets it.</p>

</dd>
<dt id="RegObj">&#39;$RegObj&#39;</dt>
<dd>

<p>This is equivalent to the previous items for backward compatibility.</p>

</dd>
<dt id="ObjectRef-scalar2">&quot;ObjectRef&quot;, \$scalar</dt>
<dd>

<p>This version doesn&#39;t import anything but sets the referenced <code><code>$scalar</code></code>.</p>

</dd>
</dl>

</dd>
<dt id="Import-constant-s-exported-by-Win32API::Registry">Import constant(s) exported by <i>Win32API::Registry</i></dt>
<dd>

<p>You can list any constants that are exported by <i>Win32API::Registry</i> to have them imported into your package. These constants have names starting with &quot;KEY_&quot; or &quot;REG_&quot; (or even &quot;HKEY_&quot;).</p>

<p>You can also specify <code><code>&quot;:KEY_&quot;</code></code>, <code><code>&quot;:REG_&quot;</code></code>, and even <code><code>&quot;:HKEY_&quot;</code></code> to import a whole set of constants.</p>

<p>See <i>Win32API::Registry</i> documentation for more information.</p>

</dd>
<dt id="Options1">Options</dt>
<dd>

<p>You can list any option names that can be listed in the <code><code>SetOptions()</code></code> method call, each folowed by the value to use for that option. A Registry virtual root object is created, all of these options are set for it, then each variable to be imported/set is associated with this object.</p>

<p>In addition, the following special options are supported:</p>

<dl>

<dt id="ExportLevel">ExportLevel</dt>
<dd>

<p>Whether to import variables into your package or some package that uses your package. Defaults to the value of <code><code>$Exporter::ExportLevel</code></code> and has the same meaning. See the <a href="../../lib/Exporter.html">Exporter</a> module for more information.</p>

</dd>
<dt id="ExportTo">ExportTo</dt>
<dd>

<p>The name of the package to import variables and constants into. Overrides <i>ExportLevel</i>.</p>

</dd>
</dl>

</dd>
</dl>

<h3 id="Specifying-constants-in-your-Perl-code">Specifying constants in your Perl code</h3>

<p>This module was written with a strong emphasis on the convenience of the module user. Therefore, most places where you can specify a constant like <code><code>REG_SZ()</code></code> also allow you to specify a string containing the name of the constant, <code><code>&quot;REG_SZ&quot;</code></code>. This is convenient because you may not have imported that symbolic constant.</p>

<p>Perl also emphasizes programmer convenience so the code <code><code>REG_SZ</code></code> can be used to mean <code><code>REG_SZ()</code></code> or <code><code>&quot;REG_SZ&quot;</code></code> or be illegal. Note that using <code><code>&amp;REG_SZ</code></code> (as we&#39;ve seen in much Win32 Perl code) is not a good idea since it passes the current <code><code>@_</code></code> to the <code><code>constant()</code></code> routine of the module which, at the least, can give you a warning under <b>-w</b>.</p>

<p>Although greatly a matter of style, the &quot;safest&quot; practice is probably to specifically list all constants in the <code><code>use Win32::TieRegistry</code></code> statement, specify <code><code>use strict</code></code> [or at least <code><code>use strict qw(subs)</code></code>], and use bare constant names when you want the numeric value. This will detect mispelled constant names at compile time.</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">strict</span><span class="operator">;</span>
    <span class="keyword">my</span> <span class="variable">$Registry</span><span class="operator">;</span>
    <span class="keyword">use</span> <span class="variable">Win32::TieRegistry</span> <span class="number">0</span><span class="operator">.</span><span class="number">20</span> <span class="operator">(</span>
        <span class="string">TiedRef</span> <span class="operator">=&gt;</span> <span class="operator">\</span><span class="variable">$Registry</span><span class="operator">,</span>  <span class="string">Delimiter</span> <span class="operator">=&gt;</span> <span class="string">"/"</span><span class="operator">,</span>  <span class="string">ArrayValues</span> <span class="operator">=&gt;</span> <span class="number">1</span><span class="operator">,</span>
        <span class="string">SplitMultis</span> <span class="operator">=&gt;</span> <span class="number">1</span><span class="operator">,</span>  <span class="string">AllowLoad</span> <span class="operator">=&gt;</span> <span class="number">1</span><span class="operator">,</span>
        <span class="string">qw( REG_SZ REG_EXPAND_SZ REG_DWORD REG_BINARY REG_MULTI_SZ
            KEY_READ KEY_WRITE KEY_ALL_ACCESS )</span><span class="operator">,</span>
    <span class="operator">);</span>
    <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"LMachine/Software/FooCorp/"</span><span class="operator">}</span><span class="operator">=</span> <span class="operator">{</span>
        <span class="string">"FooWriter/"</span> <span class="operator">=&gt;</span> <span class="operator">{</span>
            <span class="string">"/Fonts"</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="operator">[</span><span class="string">"Times"</span><span class="operator">,</span><span class="string">"Courier"</span><span class="operator">,</span><span class="string">"Lucinda"</span><span class="operator">]</span><span class="operator">,</span> <span class="variable">REG_MULTI_SZ</span> <span class="operator">]</span><span class="operator">,</span>
            <span class="string">"/WindowSize"</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="keyword">pack</span><span class="operator">(</span><span class="string">"LL"</span><span class="operator">,</span><span class="number">24</span><span class="operator">,</span><span class="number">80</span><span class="operator">),</span> <span class="variable">REG_BINARY</span> <span class="operator">]</span><span class="operator">,</span>
            <span class="string">"/TaskBarIcon"</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">"0x0001"</span><span class="operator">,</span> <span class="variable">REG_DWORD</span> <span class="operator">]</span><span class="operator">,</span>
        <span class="operator">}</span><span class="operator">,</span>
    <span class="operator">}</span>  <span class="keyword">or</span>  <span class="keyword">die</span> <span class="string">"Can't create Software/FooCorp/: $^E\n"</span><span class="operator">;</span>
</code></code></pre>

<p>If you don&#39;t want to <code><code>use strict qw(subs)</code></code>, the second safest practice is similar to the above but use the <code><code>REG_SZ()</code></code> form for constants when possible and quoted constant names when required. Note that <code><code>qw()</code></code> is a form of quoting.</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Win32::TieRegistry</span> <span class="number">0</span><span class="operator">.</span><span class="number">20</span> <span class="string">qw(
        TiedRef $Registry
        Delimiter /  ArrayValues 1  SplitMultis 1  AllowLoad 1
        REG_SZ REG_EXPAND_SZ REG_DWORD REG_BINARY REG_MULTI_SZ
        KEY_READ KEY_WRITE KEY_ALL_ACCESS
    )</span><span class="operator">;</span>
    <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"LMachine/Software/FooCorp/"</span><span class="operator">}</span><span class="operator">=</span> <span class="operator">{</span>
        <span class="string">"FooWriter/"</span> <span class="operator">=&gt;</span> <span class="operator">{</span>
            <span class="string">"/Fonts"</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="operator">[</span><span class="string">"Times"</span><span class="operator">,</span><span class="string">"Courier"</span><span class="operator">,</span><span class="string">"Lucinda"</span><span class="operator">]</span><span class="operator">,</span> <span class="variable">REG_MULTI_SZ</span><span class="operator">()</span> <span class="operator">]</span><span class="operator">,</span>
            <span class="string">"/WindowSize"</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="keyword">pack</span><span class="operator">(</span><span class="string">"LL"</span><span class="operator">,</span><span class="number">24</span><span class="operator">,</span><span class="number">80</span><span class="operator">),</span> <span class="variable">REG_BINARY</span><span class="operator">()</span> <span class="operator">]</span><span class="operator">,</span>
            <span class="string">"/TaskBarIcon"</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">"0x0001"</span><span class="operator">,</span> <span class="variable">REG_DWORD</span><span class="operator">()</span> <span class="operator">]</span><span class="operator">,</span>
        <span class="operator">}</span><span class="operator">,</span>
    <span class="operator">}</span>  <span class="keyword">or</span>  <span class="keyword">die</span> <span class="string">"Can't create Software/FooCorp/: $^E\n"</span><span class="operator">;</span>
</code></code></pre>

<p>The examples in this document mostly use quoted constant names (<code><code>&quot;REG_SZ&quot;</code></code>) since that works regardless of which constants you imported and whether or not you have <code><code>use strict</code></code> in your script. It is not the best choice for you to use for real scripts (vs. examples) because it is less efficient and is not supported by most other similar modules.</p>

<h1 id="SUMMARY">SUMMARY</h1>

<p>Most things can be done most easily via tied hashes. Skip down to the the <a href="#Tied-Hashes-Summary">&quot;Tied Hashes Summary&quot;</a> to get started quickly.</p>

<h2 id="Objects-Summary">Objects Summary</h2>

<p>Here are quick examples that document the most common functionality of all of the method functions [except for a few almost useless ones].</p>

<pre><code><code>    <span class="comment"># Just another way of saying Open():</span>
    <span class="variable">$key</span><span class="operator">=</span> <span class="variable">new</span> <span class="variable">Win32::TieRegistry</span> <span class="string">"LMachine\\Software\\"</span><span class="operator">,</span>
      <span class="operator">{</span> <span class="string">Access</span><span class="operator">=&gt;</span><span class="variable">KEY_READ</span><span class="operator">()|</span><span class="variable">KEY_WRITE</span><span class="operator">(),</span> <span class="string">Delimiter</span><span class="operator">=&gt;</span><span class="string">"\\"</span> <span class="operator">}</span><span class="operator">;</span>
    
    <span class="comment"># Open a Registry key:</span>
    <span class="variable">$subKey</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">Open</span><span class="operator">(</span> <span class="string">"SubKey/SubSubKey/"</span><span class="operator">,</span>
      <span class="operator">{</span> <span class="string">Access</span><span class="operator">=&gt;</span><span class="variable">KEY_ALL_ACCESS</span><span class="operator">,</span> <span class="string">Delimiter</span><span class="operator">=&gt;</span><span class="string">"/"</span> <span class="operator">}</span> <span class="operator">);</span>
    
    <span class="comment"># Connect to a remote Registry key:</span>
    <span class="variable">$remKey</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="variable">Connect</span><span class="operator">(</span> <span class="string">"MachineName"</span><span class="operator">,</span> <span class="string">"LMachine/"</span><span class="operator">,</span>
      <span class="operator">{</span> <span class="string">Access</span><span class="operator">=&gt;</span><span class="variable">KEY_READ</span><span class="operator">,</span> <span class="string">Delimiter</span><span class="operator">=&gt;</span><span class="string">"/"</span> <span class="operator">}</span> <span class="operator">);</span>
    
    <span class="comment"># Get value data:</span>
    <span class="variable">$valueString</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">GetValue</span><span class="operator">(</span><span class="string">"ValueName"</span><span class="operator">);</span>
    <span class="operator">(</span> <span class="variable">$valueString</span><span class="operator">,</span> <span class="variable">$valueType</span> <span class="operator">)=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">GetValue</span><span class="operator">(</span><span class="string">"ValueName"</span><span class="operator">);</span>
    
    <span class="comment"># Get list of value names:</span>
    <span class="variable">@valueNames</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">ValueNames</span><span class="operator">;</span>
    
    <span class="comment"># Get list of subkey names:</span>
    <span class="variable">@subKeyNames</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">SubKeyNames</span><span class="operator">;</span>
    
    <span class="comment"># Get combined list of value names (with leading delimiters)</span>
    <span class="comment"># and subkey names (with trailing delimiters):</span>
    <span class="variable">@memberNames</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">MemberNames</span><span class="operator">;</span>
    
    <span class="comment"># Get all information about a key:</span>
    <span class="variable">%keyInfo</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">Information</span><span class="operator">;</span>
    <span class="comment"># keys(%keyInfo)= qw( Class LastWrite SecurityLen</span>
    <span class="comment">#   CntSubKeys MaxSubKeyLen MaxSubClassLen</span>
    <span class="comment">#   CntValues MaxValNameLen MaxValDataLen );</span>
    
    <span class="comment"># Get selected information about a key:</span>
    <span class="operator">(</span> <span class="variable">$class</span><span class="operator">,</span> <span class="variable">$cntSubKeys</span> <span class="operator">)=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">Information</span><span class="operator">(</span> <span class="string">"Class"</span><span class="operator">,</span> <span class="string">"CntSubKeys"</span> <span class="operator">);</span>
    
    <span class="comment"># Get and/or set delimiter:</span>
    <span class="variable">$delim</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">Delimiter</span><span class="operator">;</span>
    <span class="variable">$oldDelim</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">Delimiter</span><span class="operator">(</span> <span class="variable">$newDelim</span> <span class="operator">);</span>
    
    <span class="comment"># Get "path" for an open key:</span>
    <span class="variable">$path</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">Path</span><span class="operator">;</span>
    <span class="comment"># For example, "/CUser/Control Panel/Mouse/"</span>
    <span class="comment"># or "//HostName/LMachine/System/DISK/".</span>
    
    <span class="comment"># Get name of machine where key is from:</span>
    <span class="variable">$mach</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">Machine</span><span class="operator">;</span>
    <span class="comment"># Will usually be "" indicating key is on local machine.</span>
    
    <span class="comment"># Control different options (see main documentation for descriptions):</span>
    <span class="variable">$oldBool</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">ArrayValues</span><span class="operator">(</span> <span class="variable">$newBool</span> <span class="operator">);</span>
    <span class="variable">$oldBool</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">FastDelete</span><span class="operator">(</span> <span class="variable">$newBool</span> <span class="operator">);</span>
    <span class="variable">$oldBool</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">FixSzNulls</span><span class="operator">(</span> <span class="variable">$newBool</span> <span class="operator">);</span>
    <span class="variable">$oldBool</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">SplitMultis</span><span class="operator">(</span> <span class="variable">$newBool</span> <span class="operator">);</span>
    <span class="variable">$oldBool</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">DWordsToHex</span><span class="operator">(</span> <span class="variable">$newBool</span> <span class="operator">);</span>
    <span class="variable">$oldBool</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">DualBinVals</span><span class="operator">(</span> <span class="variable">$newBool</span> <span class="operator">);</span>
    <span class="variable">$oldBool</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">DualTypes</span><span class="operator">(</span> <span class="variable">$newBool</span> <span class="operator">);</span>
    <span class="variable">@oldBools</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">SetOptions</span><span class="operator">(</span> <span class="string">ArrayValues</span><span class="operator">=&gt;</span><span class="number">1</span><span class="operator">,</span> <span class="string">FastDelete</span><span class="operator">=&gt;</span><span class="number">1</span><span class="operator">,</span> <span class="string">FixSzNulls</span><span class="operator">=&gt;</span><span class="number">0</span><span class="operator">,</span>
      <span class="string">Delimiter</span><span class="operator">=&gt;</span><span class="string">"/"</span><span class="operator">,</span> <span class="string">AllowLoad</span><span class="operator">=&gt;</span><span class="number">1</span><span class="operator">,</span> <span class="string">AllowSave</span><span class="operator">=&gt;</span><span class="number">1</span> <span class="operator">);</span>
    <span class="variable">@oldBools</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">GetOptions</span><span class="operator">(</span> <span class="variable">ArrayValues</span><span class="operator">,</span> <span class="variable">FastDelete</span><span class="operator">,</span> <span class="variable">FixSzNulls</span> <span class="operator">);</span>
    
    <span class="comment"># Add or set a value:</span>
    <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">SetValue</span><span class="operator">(</span> <span class="string">"ValueName"</span><span class="operator">,</span> <span class="variable">$valueDataString</span> <span class="operator">);</span>
    <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">SetValue</span><span class="operator">(</span> <span class="string">"ValueName"</span><span class="operator">,</span> <span class="keyword">pack</span><span class="operator">(</span><span class="variable">$format</span><span class="operator">,</span><span class="variable">$valueData</span><span class="operator">),</span> <span class="string">"REG_BINARY"</span> <span class="operator">);</span>
    
    <span class="comment"># Add or set a key:</span>
    <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">CreateKey</span><span class="operator">(</span> <span class="string">"SubKeyName"</span> <span class="operator">);</span>
    <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">CreateKey</span><span class="operator">(</span> <span class="string">"SubKeyName"</span><span class="operator">,</span>
      <span class="operator">{</span> <span class="string">Access</span><span class="operator">=&gt;</span><span class="string">"KEY_ALL_ACCESS"</span><span class="operator">,</span> <span class="string">Class</span><span class="operator">=&gt;</span><span class="string">"ClassName"</span><span class="operator">,</span>
        <span class="string">Delimiter</span><span class="operator">=&gt;</span><span class="string">"/"</span><span class="operator">,</span> <span class="string">Volatile</span><span class="operator">=&gt;</span><span class="number">1</span><span class="operator">,</span> <span class="string">Backup</span><span class="operator">=&gt;</span><span class="number">1</span> <span class="operator">}</span> <span class="operator">);</span>
    
    <span class="comment"># Load an off-line Registry hive file into the on-line Registry:</span>
    <span class="variable">$newKey</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="variable">Load</span><span class="operator">(</span> <span class="string">"C:/Path/To/Hive/FileName"</span> <span class="operator">);</span>
    <span class="variable">$newKey</span><span class="operator">=</span> <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">Load</span><span class="operator">(</span> <span class="string">"C:/Path/To/Hive/FileName"</span><span class="operator">,</span> <span class="string">"NewSubKeyName"</span><span class="operator">,</span>
                     <span class="operator">{</span> <span class="string">Access</span><span class="operator">=&gt;</span><span class="string">"KEY_READ"</span> <span class="operator">}</span> <span class="operator">);</span>
    <span class="comment"># Unload a Registry hive file loaded via the Load() method:</span>
    <span class="variable">$newKey</span><span class="operator">-&gt;</span><span class="variable">UnLoad</span><span class="operator">;</span>
    
    <span class="comment"># (Dis)Allow yourself to load Registry hive files:</span>
    <span class="variable">$success</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="variable">AllowLoad</span><span class="operator">(</span> <span class="variable">$bool</span> <span class="operator">);</span>
    
    <span class="comment"># (Dis)Allow yourself to save a Registry key to a hive file:</span>
    <span class="variable">$success</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="variable">AllowSave</span><span class="operator">(</span> <span class="variable">$bool</span> <span class="operator">);</span>
    
    <span class="comment"># Save a Registry key to a new hive file:</span>
    <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">RegSaveKey</span><span class="operator">(</span> <span class="string">"C:/Path/To/Hive/FileName"</span><span class="operator">,</span> <span class="operator">[]</span> <span class="operator">);</span>
</code></code></pre>

<h3 id="Other-Useful-Methods">Other Useful Methods</h3>

<p>See <i>Win32API::Registry</i> for more information on these methods. These methods are provided for coding convenience and are identical to the <i>Win32API::Registry</i> functions except that these don&#39;t take a handle to a Registry key, instead getting the handle from the invoking object [<code><code>$key</code></code>].</p>

<pre><code><code>    <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">RegGetKeySecurity</span><span class="operator">(</span> <span class="variable">$iSecInfo</span><span class="operator">,</span> <span class="variable">$sSecDesc</span><span class="operator">,</span> <span class="variable">$lenSecDesc</span> <span class="operator">);</span>
    <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">RegLoadKey</span><span class="operator">(</span> <span class="variable">$sSubKeyName</span><span class="operator">,</span> <span class="variable">$sPathToFile</span> <span class="operator">);</span>
    <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">RegNotifyChangeKeyValue</span><span class="operator">(</span>
      <span class="variable">$bWatchSubtree</span><span class="operator">,</span> <span class="variable">$iNotifyFilter</span><span class="operator">,</span> <span class="variable">$hEvent</span><span class="operator">,</span> <span class="variable">$bAsync</span> <span class="operator">);</span>
    <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">RegQueryMultipleValues</span><span class="operator">(</span>
      <span class="variable">$structValueEnts</span><span class="operator">,</span> <span class="variable">$cntValueEnts</span><span class="operator">,</span> <span class="variable">$Buffer</span><span class="operator">,</span> <span class="variable">$lenBuffer</span> <span class="operator">);</span>
    <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">RegReplaceKey</span><span class="operator">(</span> <span class="variable">$sSubKeyName</span><span class="operator">,</span> <span class="variable">$sPathToNewFile</span><span class="operator">,</span> <span class="variable">$sPathToBackupFile</span> <span class="operator">);</span>
    <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">RegRestoreKey</span><span class="operator">(</span> <span class="variable">$sPathToFile</span><span class="operator">,</span> <span class="variable">$iFlags</span> <span class="operator">);</span>
    <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">RegSetKeySecurity</span><span class="operator">(</span> <span class="variable">$iSecInfo</span><span class="operator">,</span> <span class="variable">$sSecDesc</span> <span class="operator">);</span>
    <span class="variable">$key</span><span class="operator">-&gt;</span><span class="variable">RegUnLoadKey</span><span class="operator">(</span> <span class="variable">$sSubKeyName</span> <span class="operator">);</span>
</code></code></pre>

<h2 id="Tied-Hashes-Summary">Tied Hashes Summary</h2>

<p>For fast learners, this may be the only section you need to read. Always append one delimiter to the end of each Registry key name and prepend one delimiter to the front of each Registry value name.</p>

<h3 id="Opening-keys">Opening keys</h3>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Win32::TieRegistry</span> <span class="operator">(</span> <span class="string">Delimiter</span><span class="operator">=&gt;</span><span class="string">"/"</span><span class="operator">,</span> <span class="string">ArrayValues</span><span class="operator">=&gt;</span><span class="number">1</span> <span class="operator">);</span>
    <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="variable">Delimiter</span><span class="operator">(</span><span class="string">"/"</span><span class="operator">);</span>                  <span class="comment"># Set delimiter to "/".</span>
    <span class="variable">$swKey</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"LMachine/Software/"</span><span class="operator">}</span><span class="operator">;</span>
    <span class="variable">$winKey</span><span class="operator">=</span> <span class="variable">$swKey</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Microsoft/Windows/CurrentVersion/"</span><span class="operator">}</span><span class="operator">;</span>
    <span class="variable">$userKey</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span>
      <span class="operator">{</span><span class="string">"CUser/Software/Microsoft/Windows/CurrentVersion/"</span><span class="operator">}</span><span class="operator">;</span>
    <span class="variable">$remoteKey</span><span class="operator">=</span> <span class="variable">$Registry</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"//HostName/LMachine/"</span><span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

<h3 id="Reading-values">Reading values</h3>

<pre><code><code>    <span class="variable">$progDir</span><span class="operator">=</span> <span class="variable">$winKey</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"/ProgramFilesDir"</span><span class="operator">}</span><span class="operator">;</span>    <span class="comment"># "C:\\Program Files"</span>
    <span class="variable">$tip21</span><span class="operator">=</span> <span class="variable">$winKey</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Explorer/Tips//21"</span><span class="operator">}</span><span class="operator">;</span>     <span class="comment"># Text of tip #21.</span>
    
    <span class="variable">$winKey</span><span class="operator">-&gt;</span><span class="variable">ArrayValues</span><span class="operator">(</span><span class="number">1</span><span class="operator">);</span>
    <span class="operator">(</span> <span class="variable">$devPath</span><span class="operator">,</span> <span class="variable">$type</span> <span class="operator">)=</span> <span class="variable">$winKey</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"/DevicePath"</span><span class="operator">}</span><span class="operator">;</span>
    <span class="comment"># $devPath eq "%SystemRoot%\\inf"</span>
    <span class="comment"># $type eq "REG_EXPAND_SZ"  [if you have SetDualVar.pm installed]</span>
    <span class="comment"># $type == REG_EXPAND_SZ()  [if did C&lt;use Win32::TieRegistry qw(:REG_)&gt;]</span>
</code></code></pre>

<h3 id="Setting-values">Setting values</h3>

<pre><code><code>    <span class="variable">$winKey</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Setup//SourcePath"</span><span class="operator">}</span><span class="operator">=</span> <span class="string">"\\\\SwServer\\SwShare\\Windows"</span><span class="operator">;</span>
    <span class="comment"># Simple.  Assumes data type of REG_SZ.</span>
    
    <span class="variable">$winKey</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Setup//Installation Sources"</span><span class="operator">}</span><span class="operator">=</span>
      <span class="operator">[</span> <span class="string">"D:\x00\\\\SwServer\\SwShare\\Windows\0\0"</span><span class="operator">,</span> <span class="string">"REG_MULTI_SZ"</span> <span class="operator">]</span><span class="operator">;</span>
    <span class="comment"># "\x00" and "\0" used to mark ends of each string and end of list.</span>
    
    <span class="variable">$winKey</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Setup//Installation Sources"</span><span class="operator">}</span><span class="operator">=</span>
      <span class="operator">[</span> <span class="operator">[</span><span class="string">"D:"</span><span class="operator">,</span><span class="string">"\\\\SwServer\\SwShare\\Windows"</span><span class="operator">]</span><span class="operator">,</span> <span class="string">"REG_MULTI_SZ"</span> <span class="operator">]</span><span class="operator">;</span>
    <span class="comment"># Alternate method that is easier to read.</span>
    
    <span class="variable">$userKey</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Explorer/Tips//DisplayInitialTipWindow"</span><span class="operator">}</span><span class="operator">=</span>
      <span class="operator">[</span> <span class="keyword">pack</span><span class="operator">(</span><span class="string">"L"</span><span class="operator">,</span><span class="number">0</span><span class="operator">),</span> <span class="string">"REG_DWORD"</span> <span class="operator">]</span><span class="operator">;</span>
    <span class="variable">$userKey</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Explorer/Tips//Next"</span><span class="operator">}</span><span class="operator">=</span> <span class="operator">[</span> <span class="keyword">pack</span><span class="operator">(</span><span class="string">"S"</span><span class="operator">,</span><span class="number">3</span><span class="operator">),</span> <span class="string">"REG_BINARY"</span> <span class="operator">]</span><span class="operator">;</span>
    <span class="variable">$userKey</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Explorer/Tips//Show"</span><span class="operator">}</span><span class="operator">=</span> <span class="operator">[</span> <span class="keyword">pack</span><span class="operator">(</span><span class="string">"L"</span><span class="operator">,</span><span class="number">0</span><span class="operator">),</span> <span class="string">"REG_BINARY"</span> <span class="operator">]</span><span class="operator">;</span>
</code></code></pre>

<h3 id="Adding-keys">Adding keys</h3>

<pre><code><code>    <span class="variable">$swKey</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"FooCorp/"</span><span class="operator">}</span><span class="operator">=</span> <span class="operator">{</span>
        <span class="string">"FooWriter/"</span> <span class="operator">=&gt;</span> <span class="operator">{</span>
            <span class="string">"/Version"</span> <span class="operator">=&gt;</span> <span class="string">"4.032"</span><span class="operator">,</span>
            <span class="string">"Startup/"</span> <span class="operator">=&gt;</span> <span class="operator">{</span>
                <span class="string">"/Title"</span> <span class="operator">=&gt;</span> <span class="string">"Foo Writer Deluxe ]["</span><span class="operator">,</span>
                <span class="string">"/WindowSize"</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="keyword">pack</span><span class="operator">(</span><span class="string">"LL"</span><span class="operator">,</span><span class="variable">$wid</span><span class="operator">,</span><span class="variable">$ht</span><span class="operator">),</span> <span class="string">"REG_BINARY"</span> <span class="operator">]</span><span class="operator">,</span>
                <span class="string">"/TaskBarIcon"</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">"0x0001"</span><span class="operator">,</span> <span class="string">"REG_DWORD"</span> <span class="operator">]</span><span class="operator">,</span>
            <span class="operator">}</span><span class="operator">,</span>
            <span class="string">"Compatibility/"</span> <span class="operator">=&gt;</span> <span class="operator">{</span>
                <span class="string">"/AutoConvert"</span> <span class="operator">=&gt;</span> <span class="string">"Always"</span><span class="operator">,</span>
                <span class="string">"/Default Palette"</span> <span class="operator">=&gt;</span> <span class="string">"Windows Colors"</span><span class="operator">,</span>
            <span class="operator">}</span><span class="operator">,</span>
        <span class="operator">}</span><span class="operator">,</span>
        <span class="string">"/License"</span><span class="operator">,</span> <span class="operator">=&gt;</span> <span class="string">"0123-9C8EF1-09-FC"</span><span class="operator">,</span>
    <span class="operator">}</span><span class="operator">;</span>
</code></code></pre>

<h3 id="Listing-all-subkeys-and-values">Listing all subkeys and values</h3>

<pre><code><code>    <span class="variable">@members</span><span class="operator">=</span> <span class="keyword">keys</span><span class="operator">(</span> <span class="variable">%</span><span class="operator">{</span><span class="variable">$swKey</span><span class="operator">}</span> <span class="operator">);</span>
    <span class="variable">@subKeys</span><span class="operator">=</span> <span class="keyword">grep</span><span class="operator">(</span>  <span class="regex">m#^/#</span><span class="operator">,</span>  <span class="keyword">keys</span><span class="operator">(</span> <span class="variable">%</span><span class="operator">{</span><span class="variable">$swKey</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Classes/batfile/"</span><span class="operator">}}</span> <span class="operator">)</span>  <span class="operator">);</span>
    <span class="comment"># @subKeys= ( "/", "/EditFlags" );</span>
    <span class="variable">@valueNames</span><span class="operator">=</span> <span class="keyword">grep</span><span class="operator">(</span>  <span class="operator">!</span> <span class="regex">m#^/#</span><span class="operator">,</span>  <span class="keyword">keys</span><span class="operator">(</span> <span class="variable">%</span><span class="operator">{</span><span class="variable">$swKey</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Classes/batfile/"</span><span class="operator">}}</span> <span class="operator">)</span>  <span class="operator">);</span>
    <span class="comment"># @valueNames= ( "DefaultIcon/", "shell/", "shellex/" );</span>
</code></code></pre>

<h3 id="Deleting-values-or-keys-with-no-subkeys">Deleting values or keys with no subkeys</h3>

<pre><code><code>    <span class="variable">$oldValue</span><span class="operator">=</span> <span class="keyword">delete</span> <span class="variable">$userKey</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Explorer/Tips//Next"</span><span class="operator">}</span><span class="operator">;</span>
    
    <span class="variable">$oldValues</span><span class="operator">=</span> <span class="keyword">delete</span> <span class="variable">$userKey</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">"Explorer/Tips/"</span><span class="operator">}</span><span class="operator">;</span>
    <span class="comment"># $oldValues will be reference to hash containing deleted keys values.</span>
</code></code></pre>

<h3 id="Closing-keys">Closing keys</h3>

<pre><code><code>    <span class="keyword">undef</span> <span class="variable">$swKey</span><span class="operator">;</span>               <span class="comment"># Explicit way to close a key.</span>
    <span class="variable">$winKey</span><span class="operator">=</span> <span class="string">"Anything else"</span><span class="operator">;</span>   <span class="comment"># Implicitly closes a key.</span>
    <span class="keyword">exit</span> <span class="number">0</span><span class="operator">;</span>                     <span class="comment"># Implicitly closes all keys.</span>
</code></code></pre>

<h2 id="Tie::Registry">Tie::Registry</h2>

<p>This module was originally called <i>Tie::Registry</i>. Changing code that used <i>Tie::Registry</i> over to <i>Win32::TieRegistry</i> is trivial as the module name should only be mentioned once, in the <code><code>use</code></code> line. However, finding all of the places that used <i>Tie::Registry</i> may not be completely trivial so we have included <i>Tie/Registry.pm</i> which you can install to provide backward compatibility.</p>

<h1 id="AUTHOR">AUTHOR</h1>

<p>Tye McQueen. See http://www.metronet.com/~tye/ or e-mail tye@metronet.com with bug reports.</p>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<p><i>Win32API::Registry</i> - Provides access to <code><code>Reg*()</code></code>, <code><code>HKEY_*</code></code>, <code><code>KEY_*</code></code>, <code><code>REG_*</code></code> [required].</p>

<p><i>Win32::WinError</i> - Defines <code><code>ERROR_*</code></code> values [optional].</p>

<p><a>SetDualVar</a> - For returning <code><code>REG_*</code></code> values as combined string/integer values [optional].</p>

<h1 id="BUGS">BUGS</h1>

<p>Perl5.004_02 has bugs that make <i>Win32::TieRegistry</i> fail in strange and subtle ways.</p>

<p>Using <i>Win32::TieRegistry</i> with versions of Perl prior to 5.005 can be tricky or impossible. Most notes about this have been removed from the documentation (they get rather complicated and confusing). This includes references to <code><code>$^E</code></code> perhaps not being meaningful.</p>

<p>Because Perl hashes are case sensitive, certain lookups are also case sensistive. In particular, the root keys (&quot;Classes&quot;, &quot;CUser&quot;, &quot;LMachine&quot;, &quot;Users&quot;, &quot;PerfData&quot;, &quot;CConfig&quot;, &quot;DynData&quot;, and HKEY_*) must always be entered without changing between upper and lower case letters. Also, the special rule for matching subkey names that contain the user-selected delimiter only works if case is matched. All other key name and value name lookups should be case insensitive because the underlying Reg*() calls ignore case.</p>

<p>Information about each key is cached when using a tied hash. This cache is not flushed nor updated when changes are made, <i>even when the same tied hash is used</i> to make the changes.</p>

<p>Current implementations of Perl&#39;s &quot;global destruction&quot; phase can cause objects returned by <code><code>Load()</code></code> to be destroyed while keys within the hive are still open, if the objects still exist when the script starts to exit. When this happens, the automatic <code><code>UnLoad()</code></code> will report a failure and the hive will remain loaded in the Registry.</p>

<p>Trying to <code><code>Load()</code></code> a hive file that is located on a remote network share may silently delete all data from the hive. This is a bug in the Win32 APIs, not any Perl code or modules. This module does not try to protect you from this bug.</p>

<p>There is no test suite.</p>

<h1 id="FUTURE-DIRECTIONS">FUTURE DIRECTIONS</h1>

<p>The following items are desired by the author and may appear in a future release of this module.</p>

<dl>

<dt id="TieValues-option">TieValues option</dt>
<dd>

<p>Currently described in main documentation but no yet implemented.</p>

</dd>
<dt id="AutoRefresh-option">AutoRefresh option</dt>
<dd>

<p>Trigger use of <code><code>RegNotifyChangeKeyValue()</code></code> to keep tied hash caches up-to-date even when other programs make changes.</p>

</dd>
<dt id="Error-options">Error options</dt>
<dd>

<p>Allow the user to have unchecked calls (calls in a &quot;void context&quot;) to automatically report errors via <code><code>warn</code></code> or <code><code>die</code></code>.</p>

<p>For complex operations, such a copying an entire subtree, provide access to detailed information about errors (and perhaps some warnings) that were encountered. Let the user control whether the complex operation continues in spite of errors.</p>

</dd>
</dl>

<h1 id="COPYRIGHT">COPYRIGHT</h1>

<p>Copyright 1999 - 2006 Tye McQueen.</p>

<p>Some parts copyright 2007 - 2009 Adam Kennedy.</p>

<p>This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>


</body>

</html>


