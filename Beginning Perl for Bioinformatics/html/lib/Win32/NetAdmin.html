<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../displayToc.js"></script>
<script language="JavaScript" src="../../tocParas.js"></script>
<script language="JavaScript" src="../../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../../scineplex.css">
<title></title>
<link rel="stylesheet" href="../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#FUNCTIONS">FUNCTIONS</a>
    <ul>
      <li><a href="#NOTE">NOTE</a></li>
    </ul>
  </li>
  <li><a href="#EXAMPLE">EXAMPLE</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Win32::NetAdmin - Manage network groups and users in Perl</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<pre><code><code>        <span class="keyword">use</span> <span class="variable">Win32::NetAdmin</span><span class="operator">;</span>
</code></code></pre>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>This module offers control over the administration of groups and users over a network.</p>

<h1 id="FUNCTIONS">FUNCTIONS</h1>

<h2 id="NOTE">NOTE</h2>

<p>All of the functions return false if they fail, unless otherwise noted. When a function fails call Win32::NetAdmin::GetError() rather than GetLastError() or $^E to retrieve the error code.</p>

<p><code><code>server</code></code> is optional for all the calls below. If not given the local machine is assumed.</p>

<dl>

<dt id="GetError-">GetError()</dt>
<dd>

<p>Returns the error code of the last call to this module.</p>

</dd>
<dt id="GetDomainController-server-domain-returnedName-">GetDomainController(server, domain, returnedName)</dt>
<dd>

<p>Returns the name of the domain controller for server.</p>

</dd>
<dt id="GetAnyDomainController-server-domain-returnedName-">GetAnyDomainController(server, domain, returnedName)</dt>
<dd>

<p>Returns the name of any domain controller for a domain that is directly trusted by the server.</p>

</dd>
<dt id="UserCreate-server-userName-password-passwordAge-privilege-homeDir-comment-flags-scriptPath-">UserCreate(server, userName, password, passwordAge, privilege, homeDir, comment, flags, scriptPath)</dt>
<dd>

<p>Creates a user on server with password, passwordAge, privilege, homeDir, comment, flags, and scriptPath.</p>

</dd>
<dt id="UserDelete-server-user-">UserDelete(server, user)</dt>
<dd>

<p>Deletes a user from server.</p>

</dd>
<dt id="UserGetAttributes-server-userName-password-passwordAge-privilege-homeDir-comment-flags-scriptPath-">UserGetAttributes(server, userName, password, passwordAge, privilege, homeDir, comment, flags, scriptPath)</dt>
<dd>

<p>Gets password, passwordAge, privilege, homeDir, comment, flags, and scriptPath for user.</p>

</dd>
<dt id="UserSetAttributes-server-userName-password-passwordAge-privilege-homeDir-comment-flags-scriptPath-">UserSetAttributes(server, userName, password, passwordAge, privilege, homeDir, comment, flags, scriptPath)</dt>
<dd>

<p>Sets password, passwordAge, privilege, homeDir, comment, flags, and scriptPath for user.</p>

</dd>
<dt id="UserChangePassword-domainname-username-oldpassword-newpassword-">UserChangePassword(domainname, username, oldpassword, newpassword)</dt>
<dd>

<p>Changes a users password. Can be run under any account.</p>

</dd>
<dt id="UsersExist-server-userName-">UsersExist(server, userName)</dt>
<dd>

<p>Checks if a user exists.</p>

</dd>
<dt id="GetUsers-server-filter-userRef-">GetUsers(server, filter, userRef)</dt>
<dd>

<p>Fills userRef with user names if it is an array reference and with the user names and the full names if it is a hash reference.</p>

</dd>
<dt id="GroupCreate-server-group-comment-">GroupCreate(server, group, comment)</dt>
<dd>

<p>Creates a group.</p>

</dd>
<dt id="GroupDelete-server-group-">GroupDelete(server, group)</dt>
<dd>

<p>Deletes a group.</p>

</dd>
<dt id="GroupGetAttributes-server-groupName-comment-">GroupGetAttributes(server, groupName, comment)</dt>
<dd>

<p>Gets the comment.</p>

</dd>
<dt id="GroupSetAttributes-server-groupName-comment-">GroupSetAttributes(server, groupName, comment)</dt>
<dd>

<p>Sets the comment.</p>

</dd>
<dt id="GroupAddUsers-server-groupName-users-">GroupAddUsers(server, groupName, users)</dt>
<dd>

<p>Adds a user to a group.</p>

</dd>
<dt id="GroupDeleteUsers-server-groupName-users-">GroupDeleteUsers(server, groupName, users)</dt>
<dd>

<p>Deletes a users from a group.</p>

</dd>
<dt id="GroupIsMember-server-groupName-user-">GroupIsMember(server, groupName, user)</dt>
<dd>

<p>Returns TRUE if user is a member of groupName.</p>

</dd>
<dt id="GroupGetMembers-server-groupName-userArrayRef-">GroupGetMembers(server, groupName, userArrayRef)</dt>
<dd>

<p>Fills userArrayRef with the members of groupName.</p>

</dd>
<dt id="LocalGroupCreate-server-group-comment-">LocalGroupCreate(server, group, comment)</dt>
<dd>

<p>Creates a local group.</p>

</dd>
<dt id="LocalGroupDelete-server-group-">LocalGroupDelete(server, group)</dt>
<dd>

<p>Deletes a local group.</p>

</dd>
<dt id="LocalGroupGetAttributes-server-groupName-comment-">LocalGroupGetAttributes(server, groupName, comment)</dt>
<dd>

<p>Gets the comment.</p>

</dd>
<dt id="LocalGroupSetAttributes-server-groupName-comment-">LocalGroupSetAttributes(server, groupName, comment)</dt>
<dd>

<p>Sets the comment.</p>

</dd>
<dt id="LocalGroupIsMember-server-groupName-user-">LocalGroupIsMember(server, groupName, user)</dt>
<dd>

<p>Returns TRUE if user is a member of groupName.</p>

</dd>
<dt id="LocalGroupGetMembers-server-groupName-userArrayRef-">LocalGroupGetMembers(server, groupName, userArrayRef)</dt>
<dd>

<p>Fills userArrayRef with the members of groupName.</p>

</dd>
<dt id="LocalGroupGetMembersWithDomain-server-groupName-userRef-">LocalGroupGetMembersWithDomain(server, groupName, userRef)</dt>
<dd>

<p>This function is similar LocalGroupGetMembers but accepts an array or a hash reference. Unlike LocalGroupGetMembers it returns each user name as <code><code>DOMAIN\USERNAME</code></code>. If a hash reference is given, the function returns to each user or group name the type (group, user, alias etc.). The possible types are as follows:</p>

<pre><code><code>  <span class="variable">$SidTypeUser</span> <span class="operator">=</span> <span class="number">1</span><span class="operator">;</span>
  <span class="variable">$SidTypeGroup</span> <span class="operator">=</span> <span class="number">2</span><span class="operator">;</span>
  <span class="variable">$SidTypeDomain</span> <span class="operator">=</span> <span class="number">3</span><span class="operator">;</span>
  <span class="variable">$SidTypeAlias</span> <span class="operator">=</span> <span class="number">4</span><span class="operator">;</span>
  <span class="variable">$SidTypeWellKnownGroup</span> <span class="operator">=</span> <span class="number">5</span><span class="operator">;</span>
  <span class="variable">$SidTypeDeletedAccount</span> <span class="operator">=</span> <span class="number">6</span><span class="operator">;</span>
  <span class="variable">$SidTypeInvalid</span> <span class="operator">=</span> <span class="number">7</span><span class="operator">;</span>
  <span class="variable">$SidTypeUnknown</span> <span class="operator">=</span> <span class="number">8</span><span class="operator">;</span>
</code></code></pre>

</dd>
<dt id="LocalGroupAddUsers-server-groupName-users-">LocalGroupAddUsers(server, groupName, users)</dt>
<dd>

<p>Adds a user to a group.</p>

</dd>
<dt id="LocalGroupDeleteUsers-server-groupName-users-">LocalGroupDeleteUsers(server, groupName, users)</dt>
<dd>

<p>Deletes a users from a group.</p>

</dd>
<dt id="GetServers-server-domain-flags-serverRef-">GetServers(server, domain, flags, serverRef)</dt>
<dd>

<p>Gets an array of server names or an hash with the server names and the comments as seen in the Network Neighborhood or the server manager. For flags, see SV_TYPE_* constants.</p>

</dd>
<dt id="GetTransports-server-transportRef-">GetTransports(server, transportRef)</dt>
<dd>

<p>Enumerates the network transports of a computer. If transportRef is an array reference, it is filled with the transport names. If transportRef is a hash reference then a hash of hashes is filled with the data for the transports.</p>

</dd>
<dt id="LoggedOnUsers-server-userRef-">LoggedOnUsers(server, userRef)</dt>
<dd>

<p>Gets an array or hash with the users logged on at the specified computer. If userRef is a hash reference, the value is a semikolon separated string of username, logon domain and logon server.</p>

</dd>
<dt id="GetAliasFromRID-server-RID-returnedName-">GetAliasFromRID(server, RID, returnedName)</dt>
<dd>

</dd>
<dt id="GetUserGroupFromRID-server-RID-returnedName-">GetUserGroupFromRID(server, RID, returnedName)</dt>
<dd>

<p>Retrieves the name of an alias (i.e local group) or a user group for a RID from the specified server. These functions can be used for example to get the account name for the administrator account if it is renamed or localized.</p>

<p>Possible values for <code><code>RID</code></code>:</p>

<pre><code><code>  DOMAIN_ALIAS_RID_ACCOUNT_OPS
  DOMAIN_ALIAS_RID_ADMINS
  DOMAIN_ALIAS_RID_BACKUP_OPS
  DOMAIN_ALIAS_RID_GUESTS
  DOMAIN_ALIAS_RID_POWER_USERS
  DOMAIN_ALIAS_RID_PRINT_OPS
  DOMAIN_ALIAS_RID_REPLICATOR
  DOMAIN_ALIAS_RID_SYSTEM_OPS
  DOMAIN_ALIAS_RID_USERS
  DOMAIN_GROUP_RID_ADMINS
  DOMAIN_GROUP_RID_GUESTS
  DOMAIN_GROUP_RID_USERS
  DOMAIN_USER_RID_ADMIN
  DOMAIN_USER_RID_GUEST</code></code></pre>

</dd>
<dt id="GetServerDisks-server-arrayRef-">GetServerDisks(server, arrayRef)</dt>
<dd>

<p>Returns an array with the disk drives of the specified server. The array contains two-character strings (drive letter followed by a colon).</p>

</dd>
</dl>

<h1 id="EXAMPLE">EXAMPLE</h1>

<pre><code><code>    <span class="comment"># Simple script using Win32::NetAdmin to set the login script for</span>
    <span class="comment"># all members of the NT group "Domain Users".  Only works if you</span>
    <span class="comment"># run it on the PDC. (From Robert Spier &lt;rspier@seas.upenn.edu&gt;)</span>
    <span class="comment">#</span>
    <span class="comment"># FILTER_TEMP_DUPLICATE_ACCOUNTS</span>
    <span class="comment">#   Enumerates local user account data on a domain controller.</span>
    <span class="comment">#</span>
    <span class="comment"># FILTER_NORMAL_ACCOUNT</span>
    <span class="comment">#   Enumerates global user account data on a computer.</span>
    <span class="comment">#</span>
    <span class="comment"># FILTER_INTERDOMAIN_TRUST_ACCOUNT</span>
    <span class="comment">#   Enumerates domain trust account data on a domain controller.</span>
    <span class="comment">#</span>
    <span class="comment"># FILTER_WORKSTATION_TRUST_ACCOUNT</span>
    <span class="comment">#   Enumerates workstation or member server account data on a domain</span>
    <span class="comment">#   controller.</span>
    <span class="comment">#</span>
    <span class="comment"># FILTER_SERVER_TRUST_ACCOUNT</span>
    <span class="comment">#   Enumerates domain controller account data on a domain controller.</span>
    
    
    <span class="keyword">use</span> <span class="variable">Win32::NetAdmin</span> <span class="string">qw(GetUsers GroupIsMember
                           UserGetAttributes UserSetAttributes)</span><span class="operator">;</span>
    
    <span class="keyword">my</span> <span class="variable">%hash</span><span class="operator">;</span>
    <span class="variable">GetUsers</span><span class="operator">(</span><span class="string">""</span><span class="operator">,</span> <span class="variable">FILTER_NORMAL_ACCOUNT</span> <span class="operator">,</span> <span class="operator">\</span><span class="variable">%hash</span><span class="operator">)</span>
        <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"GetUsers() failed: $^E"</span><span class="operator">;</span>
    
    <span class="keyword">foreach</span> <span class="operator">(</span><span class="keyword">keys</span> <span class="variable">%hash</span><span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$password</span><span class="operator">,</span> <span class="variable">$passwordAge</span><span class="operator">,</span> <span class="variable">$privilege</span><span class="operator">,</span>
            <span class="variable">$homeDir</span><span class="operator">,</span> <span class="variable">$comment</span><span class="operator">,</span> <span class="variable">$flags</span><span class="operator">,</span> <span class="variable">$scriptPath</span><span class="operator">);</span>
        <span class="keyword">if</span> <span class="operator">(</span><span class="variable">GroupIsMember</span><span class="operator">(</span><span class="string">""</span><span class="operator">,</span> <span class="string">"Domain Users"</span><span class="operator">,</span> <span class="variable">$_</span><span class="operator">))</span> <span class="operator">{</span>
            <span class="keyword">print</span> <span class="string">"Updating </span><span class="variable">$_</span><span class="string"> (</span><span class="variable">$hash</span><span class="string">{</span><span class="variable">$_</span><span class="string">})\n"</span><span class="operator">;</span>
            <span class="variable">UserGetAttributes</span><span class="operator">(</span><span class="string">""</span><span class="operator">,</span> <span class="variable">$_</span><span class="operator">,</span> <span class="variable">$password</span><span class="operator">,</span> <span class="variable">$passwordAge</span><span class="operator">,</span> <span class="variable">$privilege</span><span class="operator">,</span>
                              <span class="variable">$homeDir</span><span class="operator">,</span> <span class="variable">$comment</span><span class="operator">,</span> <span class="variable">$flags</span><span class="operator">,</span> <span class="variable">$scriptPath</span><span class="operator">)</span>
                <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"UserGetAttributes() failed: $^E"</span><span class="operator">;</span>
            <span class="variable">$scriptPath</span> <span class="operator">=</span> <span class="string">"dnx_login.bat"</span><span class="operator">;</span> <span class="comment"># this is the new login script</span>
            <span class="variable">UserSetAttributes</span><span class="operator">(</span><span class="string">""</span><span class="operator">,</span> <span class="variable">$_</span><span class="operator">,</span> <span class="variable">$password</span><span class="operator">,</span> <span class="variable">$passwordAge</span><span class="operator">,</span> <span class="variable">$privilege</span><span class="operator">,</span>
                              <span class="variable">$homeDir</span><span class="operator">,</span> <span class="variable">$comment</span><span class="operator">,</span> <span class="variable">$flags</span><span class="operator">,</span> <span class="variable">$scriptPath</span><span class="operator">)</span>
                <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"UserSetAttributes() failed: $^E"</span><span class="operator">;</span>
        <span class="operator">}</span>
    <span class="operator">}</span>
</code></code></pre>


</body>

</html>


