<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../displayToc.js"></script>
<script language="JavaScript" src="../../tocParas.js"></script>
<script language="JavaScript" src="../../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../../scineplex.css">
<title></title>
<link rel="stylesheet" href="../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a>
    <ul>
      <li><a href="#High-level-functions-for-accessing-web-servers">High level functions for accessing web servers</a>
        <ul>
          <li><a href="#Basic-set-of-functions">Basic set of functions</a></li>
          <li><a href="#Alternate-versions-of-high-level-API">Alternate versions of high-level API</a></li>
          <li><a href="#Using-client-certificates">Using client certificates</a></li>
          <li><a href="#Working-through-a-web-proxy">Working through a web proxy</a></li>
          <li><a href="#HTTP-without-S-API">HTTP (without S) API</a></li>
        </ul>
      </li>
      <li><a href="#Certificate-verification-and-Certificate-Revocation-Lists-CRLs-">Certificate verification and Certificate Revocation Lists (CRLs)</a></li>
      <li><a href="#Using-Net::SSLeay-in-multi-threaded-applications">Using Net::SSLeay in multi-threaded applications</a>
        <ul>
          <li><a href="#Initialization">Initialization</a></li>
          <li><a href="#Using-callbacks">Using callbacks</a></li>
          <li><a href="#Using-openssl-elements">Using openssl elements</a></li>
          <li><a href="#Using-other-perl-modules-based-on-Net::SSLeay">Using other perl modules based on Net::SSLeay</a></li>
          <li><a href="#Combining-Net::SSLeay-with-other-modules-linked-with-openssl">Combining Net::SSLeay with other modules linked with openssl</a></li>
          <li><a href="#Threading-with-get_https-and-friends">Threading with get_https and friends</a></li>
        </ul>
      </li>
      <li><a href="#Convenience-routines">Convenience routines</a></li>
      <li><a href="#Initialization1">Initialization</a></li>
      <li><a href="#Error-handling-functions">Error handling functions</a></li>
      <li><a href="#Sockets">Sockets</a></li>
      <li><a href="#Callbacks">Callbacks</a></li>
      <li><a href="#Low-level-API">Low level API</a>
        <ul>
          <li><a href="#Low-level-API:-Version-related-functions">Low level API: Version related functions</a></li>
          <li><a href="#Low-level-API:-Initialization-related-functions">Low level API: Initialization related functions</a></li>
          <li><a href="#Low-level-API:-ERR_-and-SSL_alert_-related-functions">Low level API: ERR_* and SSL_alert_* related functions</a></li>
          <li><a href="#Low-level-API:-SSL_METHOD_-related-functions">Low level API: SSL_METHOD_* related functions</a></li>
          <li><a href="#Low-level-API:-ENGINE_-related-functions">Low level API: ENGINE_* related functions</a></li>
          <li><a href="#Low-level-API:-EVP_PKEY_-related-functions">Low level API: EVP_PKEY_* related functions</a></li>
          <li><a href="#Low-level-API:-PEM_-related-functions">Low level API: PEM_* related functions</a></li>
          <li><a href="#Low-level-API:-d2i_-DER-format-related-functions">Low level API: d2i_* (DER format) related functions</a></li>
          <li><a href="#Low-level-API:-PKCS12-related-functions">Low level API: PKCS12 related functions</a></li>
          <li><a href="#Low-level-API:-SESSION_-related-functions">Low level API: SESSION_* related functions</a></li>
          <li><a href="#Low-level-API:-SSL_CTX_-related-functions">Low level API: SSL_CTX_* related functions</a></li>
          <li><a href="#Low-level-API:-SSL_-related-functions">Low level API: SSL_* related functions</a></li>
          <li><a href="#Low-level-API:-RAND_-related-functions">Low level API: RAND_* related functions</a></li>
          <li><a href="#Low-level-API:-OBJ_-related-functions">Low level API: OBJ_* related functions</a></li>
          <li><a href="#Low-level-API:-ASN1_INTEGER_-related-functions">Low level API: ASN1_INTEGER_* related functions</a></li>
          <li><a href="#Low-level-API:-ASN1_STRING_-related-functions">Low level API: ASN1_STRING_* related functions</a></li>
          <li><a href="#Low-level-API:-ASN1_TIME_-related-functions">Low level API: ASN1_TIME_* related functions</a></li>
          <li><a href="#Low-level-API:-X509_-related-functions">Low level API: X509_* related functions</a></li>
          <li><a href="#Low-level-API:-X509_REQ_-related-functions">Low level API: X509_REQ_* related functions</a></li>
          <li><a href="#Low-level-API:-X509_CRL_-related-functions">Low level API: X509_CRL_* related functions</a></li>
          <li><a href="#Low-level-API:-X509_EXTENSION_-related-functions">Low level API: X509_EXTENSION_* related functions</a></li>
          <li><a href="#Low-level-API:-X509_NAME_-related-functions">Low level API: X509_NAME_* related functions</a></li>
          <li><a href="#Low-level-API:-X509_STORE_-related-functions">Low level API: X509_STORE_* related functions</a></li>
          <li><a href="#Low-level-API:-X509_VERIFY_PARAM_-related-functions">Low level API: X509_VERIFY_PARAM_* related functions</a></li>
          <li><a href="#Low-level-API:-Cipher-EVP_CIPHER_-related-functions">Low level API: Cipher (EVP_CIPHER_*) related functions</a></li>
          <li><a href="#Low-level-API:-Digest-EVP_MD_-related-functions">Low level API: Digest (EVP_MD_*) related functions</a></li>
          <li><a href="#Low-level-API:-CIPHER_-related-functions">Low level API: CIPHER_* related functions</a></li>
          <li><a href="#Low-level-API:-RSA_-related-functions">Low level API: RSA_* related functions</a></li>
          <li><a href="#Low-level-API:-BIO_-related-functions">Low level API: BIO_* related functions</a></li>
          <li><a href="#Low-level-API:-NPN-next-protocol-negotiation-related-functions">Low level API: NPN (next protocol negotiation) related functions</a></li>
          <li><a href="#Low-level-API:-Other-functions">Low level API: Other functions</a></li>
        </ul>
      </li>
      <li><a href="#Constants">Constants</a></li>
      <li><a href="#INTERNAL-ONLY-functions-do-not-use-these-">INTERNAL ONLY functions (do not use these)</a></li>
    </ul>
  </li>
  <li><a href="#EXAMPLES">EXAMPLES</a></li>
  <li><a href="#LIMITATIONS">LIMITATIONS</a></li>
  <li><a href="#KNOWN-BUGS-AND-CAVEATS">KNOWN BUGS AND CAVEATS</a></li>
  <li><a href="#DIAGNOSTICS">DIAGNOSTICS</a></li>
  <li><a href="#SECURITY">SECURITY</a>
    <ul>
      <li><a href="#BEAST-Attack">BEAST Attack</a></li>
      <li><a href="#Session-Resumption">Session Resumption</a></li>
      <li><a href="#Secure-Renegotiation-and-DoS-Attack">Secure Renegotiation and DoS Attack</a></li>
    </ul>
  </li>
  <li><a href="#BUGS-AND-SUPPORT">BUGS AND SUPPORT</a></li>
  <li><a href="#AUTHOR">AUTHOR</a></li>
  <li><a href="#COPYRIGHT">COPYRIGHT</a></li>
  <li><a href="#SEE-ALSO">SEE ALSO</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Net::SSLeay - Perl extension for using OpenSSL</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<pre><code><code>  <span class="keyword">use</span> <span class="variable">Net::SSLeay</span> <span class="string">qw(get_https post_https sslcat make_headers make_form)</span><span class="operator">;</span>
  
  <span class="operator">(</span><span class="variable">$page</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">get_https</span><span class="operator">(</span><span class="string">'www.bacus.pt'</span><span class="operator">,</span> <span class="number">443</span><span class="operator">,</span> <span class="string">'/'</span><span class="operator">);</span>                 <span class="comment"># Case 1</span>
  
  <span class="operator">(</span><span class="variable">$page</span><span class="operator">,</span> <span class="variable">$response</span><span class="operator">,</span> <span class="variable">%reply_headers</span><span class="operator">)</span>
         <span class="operator">=</span> <span class="variable">get_https</span><span class="operator">(</span><span class="string">'www.bacus.pt'</span><span class="operator">,</span> <span class="number">443</span><span class="operator">,</span> <span class="string">'/'</span><span class="operator">,</span>                   <span class="comment"># Case 2</span>
                <span class="variable">make_headers</span><span class="operator">(</span><span class="variable">User</span><span class="operator">-</span><span class="string">Agent</span> <span class="operator">=&gt;</span> <span class="string">'Cryptozilla/5.0b1'</span><span class="operator">,</span>
                             <span class="string">Referer</span>    <span class="operator">=&gt;</span> <span class="string">'https://www.bacus.pt'</span>
                <span class="operator">));</span>
  
  <span class="operator">(</span><span class="variable">$page</span><span class="operator">,</span> <span class="variable">$result</span><span class="operator">,</span> <span class="variable">%headers</span><span class="operator">)</span> <span class="operator">=</span>                                   <span class="comment"># Case 2b</span>
         <span class="operator">=</span> <span class="variable">get_https</span><span class="operator">(</span><span class="string">'www.bacus.pt'</span><span class="operator">,</span> <span class="number">443</span><span class="operator">,</span> <span class="string">'/protected.html'</span><span class="operator">,</span>
              <span class="variable">make_headers</span><span class="operator">(</span><span class="string">Authorization</span> <span class="operator">=&gt;</span>
                           <span class="string">'Basic '</span> <span class="operator">.</span> <span class="variable">MIME::Base64::encode</span><span class="operator">(</span><span class="string">"</span><span class="variable">$user</span><span class="string">:</span><span class="variable">$pass</span><span class="string">"</span><span class="operator">,</span><span class="string">''</span><span class="operator">))</span>
              <span class="operator">);</span>
  
  <span class="operator">(</span><span class="variable">$page</span><span class="operator">,</span> <span class="variable">$response</span><span class="operator">,</span> <span class="variable">%reply_headers</span><span class="operator">)</span>
         <span class="operator">=</span> <span class="variable">post_https</span><span class="operator">(</span><span class="string">'www.bacus.pt'</span><span class="operator">,</span> <span class="number">443</span><span class="operator">,</span> <span class="string">'/foo.cgi'</span><span class="operator">,</span> <span class="string">''</span><span class="operator">,</span>       <span class="comment"># Case 3</span>
                <span class="variable">make_form</span><span class="operator">(</span><span class="string">OK</span>   <span class="operator">=&gt;</span> <span class="string">'1'</span><span class="operator">,</span>
                          <span class="string">name</span> <span class="operator">=&gt;</span> <span class="string">'Sampo'</span>
                <span class="operator">));</span>
  
  <span class="variable">$reply</span> <span class="operator">=</span> <span class="variable">sslcat</span><span class="operator">(</span><span class="variable">$host</span><span class="operator">,</span> <span class="variable">$port</span><span class="operator">,</span> <span class="variable">$request</span><span class="operator">);</span>                       <span class="comment"># Case 4</span>
  
  <span class="operator">(</span><span class="variable">$reply</span><span class="operator">,</span> <span class="variable">$err</span><span class="operator">,</span> <span class="variable">$server_cert</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">sslcat</span><span class="operator">(</span><span class="variable">$host</span><span class="operator">,</span> <span class="variable">$port</span><span class="operator">,</span> <span class="variable">$request</span><span class="operator">);</span> <span class="comment"># Case 5</span>
  
  <span class="variable">$Net::SSLeay::trace</span> <span class="operator">=</span> <span class="number">2</span><span class="operator">;</span>  <span class="comment"># 0=no debugging, 1=ciphers, 2=trace, 3=dump data</span>
  
  <span class="variable">Net::SSLeay::initialize</span><span class="operator">();</span> <span class="comment"># Initialize ssl library once</span>
</code></code></pre>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p><a href="../../lib/Net/SSLeay.html">Net::SSLeay</a> module contains perl bindings to openssl (<a href="http://www.openssl.org">http://www.openssl.org</a>) library.</p>

<p><b>COMPATIBILITY NOTE:</b> <a href="../../lib/Net/SSLeay.html">Net::SSLeay</a> cannot be built with pre-0.9.3 openssl. It is strongly recommended to use at least 0.9.7 (as older versions are not tested during development). Some low level API functions may be available with certain openssl versions.</p>

<p><a href="../../lib/Net/SSLeay.html">Net::SSLeay</a> module basically comprise of:</p>

<ul>

<li><p>High level functions for accessing web servers (by using HTTP/HTTPS)</p>

</li>
<li><p>Low level API (mostly mapped 1:1 to openssl&#39;s C functions)</p>

</li>
<li><p>Convenience functions (related to low level API but with more perl friendly interface)</p>

</li>
</ul>

<p>There is also a related module called <a href="../../lib/Net/SSLeay/Handle.html">Net::SSLeay::Handle</a> included in this distribution that you might want to use instead. It has its own pod documentation.</p>

<h2 id="High-level-functions-for-accessing-web-servers">High level functions for accessing web servers</h2>

<p>This module offers some high level convenience functions for accessing web pages on SSL servers (for symmetry, the same API is offered for accessing http servers, too), an <code><code>sslcat()</code></code> function for writing your own clients, and finally access to the SSL api of the SSLeay/OpenSSL package so you can write servers or clients for more complicated applications.</p>

<p>For high level functions it is most convenient to import them into your main namespace as indicated in the synopsis.</p>

<h3 id="Basic-set-of-functions">Basic set of functions</h3>

<ul>

<li><p>get_https</p>

</li>
<li><p>post_https</p>

</li>
<li><p>put_https</p>

</li>
<li><p>head_https</p>

</li>
<li><p>do_https</p>

</li>
<li><p>sslcat</p>

</li>
<li><p>https_cat</p>

</li>
<li><p>make_form</p>

</li>
<li><p>make_headers</p>

</li>
</ul>

<p><b>Case 1 (in SYNOPSIS)</b> demonstrates the typical invocation of get_https() to fetch an HTML page from secure server. The first argument provides the hostname or IP in dotted decimal notation of the remote server to contact. The second argument is the TCP port at the remote end (your own port is picked arbitrarily from high numbered ports as usual for TCP). The third argument is the URL of the page without the host name part. If in doubt consult the HTTP specifications at <a href="http://www.w3c.org">http://www.w3c.org</a>.</p>

<p><b>Case 2 (in SYNOPSIS)</b> demonstrates full fledged use of <code><code>get_https()</code></code>. As can be seen, <code><code>get_https()</code></code> parses the response and response headers and returns them as a list, which can be captured in a hash for later reference. Also a fourth argument to <code><code>get_https()</code></code> is used to insert some additional headers in the request. <code><code>make_headers()</code></code> is a function that will convert a list or hash to such headers. By default <code><code>get_https()</code></code> supplies <code><code>Host</code></code> (to make virtual hosting easy) and <code><code>Accept</code></code> (reportedly needed by IIS) headers.</p>

<p><b>Case 2b (in SYNOPSIS)</b> demonstrates how to get a password protected page. Refer to the HTTP protocol specifications for further details (e.g. RFC-2617).</p>

<p><b>Case 3 (in SYNOPSIS)</b> invokes <code><code>post_https()</code></code> to submit a HTML/CGI form to a secure server. The first four arguments are equal to <code><code>get_https()</code></code> (note that the empty string (<code><code>&#39;&#39;</code></code>) is passed as header argument). The fifth argument is the contents of the form formatted according to CGI specification. In this case the helper function <code><code>make_https()</code></code> is used to do the formatting, but you could pass any string. <code><code>post_https()</code></code> automatically adds <code><code>Content-Type</code></code> and <code><code>Content-Length</code></code> headers to the request.</p>

<p><b>Case 4 (in SYNOPSIS)</b> shows the fundamental <code><code>sslcat()</code></code> function (inspired in spirit by the <code><code>netcat</code></code> utility :-). It&#39;s your swiss army knife that allows you to easily contact servers, send some data, and then get the response. You are responsible for formatting the data and parsing the response - <code><code>sslcat()</code></code> is just a transport.</p>

<p><b>Case 5 (in SYNOPSIS)</b> is a full invocation of <code><code>sslcat()</code></code> which allows the return of errors as well as the server (peer) certificate.</p>

<p>The <code><code>$trace</code></code> global variable can be used to control the verbosity of the high level functions. Level 0 guarantees silence, level 1 (the default) only emits error messages.</p>

<h3 id="Alternate-versions-of-high-level-API">Alternate versions of high-level API</h3>

<ul>

<li><p>get_https3</p>

</li>
<li><p>post_https3</p>

</li>
<li><p>put_https3</p>

</li>
<li><p>get_https4</p>

</li>
<li><p>post_https4</p>

</li>
<li><p>put_https4</p>

</li>
</ul>

<p>The above mentioned functions actually return the response headers as a list, which only gets converted to hash upon assignment (this assignment looses information if the same header occurs twice, as may be the case with cookies). There are also other variants of the functions that return unprocessed headers and that return a reference to a hash.</p>

<pre><code><code>  <span class="operator">(</span><span class="variable">$page</span><span class="operator">,</span> <span class="variable">$response</span><span class="operator">,</span> <span class="variable">@headers</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">get_https</span><span class="operator">(</span><span class="string">'www.bacus.pt'</span><span class="operator">,</span> <span class="number">443</span><span class="operator">,</span> <span class="string">'/'</span><span class="operator">);</span>
  <span class="keyword">for</span> <span class="operator">(</span><span class="variable">$i</span> <span class="operator">=</span> <span class="number">0</span><span class="operator">;</span> <span class="variable">$i</span> <span class="operator">&lt;</span> <span class="variable">$#headers</span><span class="operator">;</span> <span class="variable">$i</span><span class="operator">+=</span><span class="number">2</span><span class="operator">)</span> <span class="operator">{</span>
      <span class="keyword">print</span> <span class="string">"</span><span class="variable">$headers</span><span class="string">[</span><span class="variable">$i</span><span class="string">] = "</span> <span class="operator">.</span> <span class="variable">$headers</span><span class="operator">[</span><span class="variable">$i</span><span class="operator">+</span><span class="number">1</span><span class="operator">]</span> <span class="operator">.</span> <span class="string">"\n"</span><span class="operator">;</span>
  <span class="operator">}</span>
  
  <span class="operator">(</span><span class="variable">$page</span><span class="operator">,</span> <span class="variable">$response</span><span class="operator">,</span> <span class="variable">$headers</span><span class="operator">,</span> <span class="variable">$server_cert</span><span class="operator">)</span>
    <span class="operator">=</span> <span class="variable">get_https3</span><span class="operator">(</span><span class="string">'www.bacus.pt'</span><span class="operator">,</span> <span class="number">443</span><span class="operator">,</span> <span class="string">'/'</span><span class="operator">);</span>
  <span class="keyword">print</span> <span class="string">"</span><span class="variable">$headers</span><span class="string">\n"</span><span class="operator">;</span>
  
  <span class="operator">(</span><span class="variable">$page</span><span class="operator">,</span> <span class="variable">$response</span><span class="operator">,</span> <span class="variable">$headers_ref</span><span class="operator">)</span>
    <span class="operator">=</span> <span class="variable">get_https4</span><span class="operator">(</span><span class="string">'www.bacus.pt'</span><span class="operator">,</span> <span class="number">443</span><span class="operator">,</span> <span class="string">'/'</span><span class="operator">);</span>
  <span class="keyword">for</span> <span class="variable">$k</span> <span class="operator">(</span><span class="keyword">sort</span> <span class="keyword">keys</span> <span class="variable">%</span><span class="operator">{</span><span class="variable">$headers_ref</span><span class="operator">}</span><span class="operator">)</span> <span class="operator">{</span>
      <span class="keyword">for</span> <span class="variable">$v</span> <span class="operator">(</span><span class="variable">@</span><span class="operator">{</span><span class="variable">$$headers_ref</span><span class="operator">{</span><span class="variable">$k</span><span class="operator">}}</span><span class="operator">)</span> <span class="operator">{</span>
          <span class="keyword">print</span> <span class="string">"</span><span class="variable">$k</span><span class="string"> = </span><span class="variable">$v</span><span class="string">\n"</span><span class="operator">;</span>
      <span class="operator">}</span>
  <span class="operator">}</span>
</code></code></pre>

<p>All of the above code fragments accomplish the same thing: display all values of all headers. The API functions ending in &quot;3&quot; return the headers simply as a scalar string and it is up to the application to split them up. The functions ending in &quot;4&quot; return a reference to a hash of arrays (see <a href="../../lib/pods/perlref.html">perlref</a> and <a href="../../lib/pods/perllol.html">perllol</a> if you are not familiar with complex perl data structures). To access a single value of such a header hash you would do something like</p>

<pre><code><code>  <span class="keyword">print</span> <span class="variable">$$headers_ref</span><span class="operator">{</span><span class="string">COOKIE</span><span class="operator">}[</span><span class="number">0</span><span class="operator">]</span><span class="operator">;</span>
</code></code></pre>

<p>Variants 3 and 4 also allow you to discover the server certificate in case you would like to store or display it, e.g.</p>

<pre><code><code>  <span class="operator">(</span><span class="variable">$p</span><span class="operator">,</span> <span class="variable">$resp</span><span class="operator">,</span> <span class="variable">$hdrs</span><span class="operator">,</span> <span class="variable">$server_cert</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">get_https3</span><span class="operator">(</span><span class="string">'www.bacus.pt'</span><span class="operator">,</span> <span class="number">443</span><span class="operator">,</span> <span class="string">'/'</span><span class="operator">);</span>
  <span class="keyword">if</span> <span class="operator">(!</span><span class="keyword">defined</span><span class="operator">(</span><span class="variable">$server_cert</span><span class="operator">)</span> <span class="operator">||</span> <span class="operator">(</span><span class="variable">$server_cert</span> <span class="operator">==</span> <span class="number">0</span><span class="operator">))</span> <span class="operator">{</span>
      <span class="keyword">warn</span> <span class="string">"Subject Name: undefined, Issuer  Name: undefined"</span><span class="operator">;</span>
  <span class="operator">}</span> <span class="keyword">else</span> <span class="operator">{</span>
      <span class="keyword">warn</span> <span class="string">'Subject Name: '</span>
          <span class="operator">.</span> <span class="variable">Net::SSLeay::X509_NAME_oneline</span><span class="operator">(</span>
                 <span class="variable">Net::SSLeay::X509_get_subject_name</span><span class="operator">(</span><span class="variable">$server_cert</span><span class="operator">))</span>
              <span class="operator">.</span> <span class="string">'Issuer  Name: '</span>
                  <span class="operator">.</span> <span class="variable">Net::SSLeay::X509_NAME_oneline</span><span class="operator">(</span>
                         <span class="variable">Net::SSLeay::X509_get_issuer_name</span><span class="operator">(</span><span class="variable">$server_cert</span><span class="operator">));</span>
  <span class="operator">}</span>
</code></code></pre>

<p>Beware that this method only allows after the fact verification of the certificate: by the time <code><code>get_https3()</code></code> has returned the https request has already been sent to the server, whether you decide to trust it or not. To do the verification correctly you must either employ the OpenSSL certificate verification framework or use the lower level API to first connect and verify the certificate and only then send the http data. See the implementation of <code><code>ds_https3()</code></code> for guidance on how to do this.</p>

<h3 id="Using-client-certificates">Using client certificates</h3>

<p>Secure web communications are encrypted using symmetric crypto keys exchanged using encryption based on the certificate of the server. Therefore in all SSL connections the server must have a certificate. This serves both to authenticate the server to the clients and to perform the key exchange.</p>

<p>Sometimes it is necessary to authenticate the client as well. Two options are available: HTTP basic authentication and a client side certificate. The basic authentication over HTTPS is actually quite safe because HTTPS guarantees that the password will not travel in the clear. Never-the-less, problems like easily guessable passwords remain. The client certificate method involves authentication of the client at the SSL level using a certificate. For this to work, both the client and the server have certificates (which typically are different) and private keys.</p>

<p>The API functions outlined above accept additional arguments that allow one to supply the client side certificate and key files. The format of these files is the same as used for server certificates and the caveat about encrypting private keys applies.</p>

<pre><code><code>  <span class="operator">(</span><span class="variable">$page</span><span class="operator">,</span> <span class="variable">$result</span><span class="operator">,</span> <span class="variable">%headers</span><span class="operator">)</span> <span class="operator">=</span>                                   <span class="comment"># 2c</span>
         <span class="operator">=</span> <span class="variable">get_https</span><span class="operator">(</span><span class="string">'www.bacus.pt'</span><span class="operator">,</span> <span class="number">443</span><span class="operator">,</span> <span class="string">'/protected.html'</span><span class="operator">,</span>
              <span class="variable">make_headers</span><span class="operator">(</span><span class="string">Authorization</span> <span class="operator">=&gt;</span>
                           <span class="string">'Basic '</span> <span class="operator">.</span> <span class="variable">MIME::Base64::encode</span><span class="operator">(</span><span class="string">"</span><span class="variable">$user</span><span class="string">:</span><span class="variable">$pass</span><span class="string">"</span><span class="operator">,</span><span class="string">''</span><span class="operator">)),</span>
              <span class="string">''</span><span class="operator">,</span> <span class="variable">$mime_type6</span><span class="operator">,</span> <span class="variable">$path_to_crt7</span><span class="operator">,</span> <span class="variable">$path_to_key8</span><span class="operator">);</span>
  
  <span class="operator">(</span><span class="variable">$page</span><span class="operator">,</span> <span class="variable">$response</span><span class="operator">,</span> <span class="variable">%reply_headers</span><span class="operator">)</span>
         <span class="operator">=</span> <span class="variable">post_https</span><span class="operator">(</span><span class="string">'www.bacus.pt'</span><span class="operator">,</span> <span class="number">443</span><span class="operator">,</span> <span class="string">'/foo.cgi'</span><span class="operator">,</span>           <span class="comment"># 3b</span>
              <span class="variable">make_headers</span><span class="operator">(</span><span class="string">'Authorization'</span> <span class="operator">=&gt;</span>
                           <span class="string">'Basic '</span> <span class="operator">.</span> <span class="variable">MIME::Base64::encode</span><span class="operator">(</span><span class="string">"</span><span class="variable">$user</span><span class="string">:</span><span class="variable">$pass</span><span class="string">"</span><span class="operator">,</span><span class="string">''</span><span class="operator">)),</span>
              <span class="variable">make_form</span><span class="operator">(</span><span class="string">OK</span>   <span class="operator">=&gt;</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">name</span> <span class="operator">=&gt;</span> <span class="string">'Sampo'</span><span class="operator">),</span>
              <span class="variable">$mime_type6</span><span class="operator">,</span> <span class="variable">$path_to_crt7</span><span class="operator">,</span> <span class="variable">$path_to_key8</span><span class="operator">);</span>
</code></code></pre>

<p><b>Case 2c (in SYNOPSIS)</b> demonstrates getting a password protected page that also requires a client certificate, i.e. it is possible to use both authentication methods simultaneously.</p>

<p><b>Case 3b (in SYNOPSIS)</b> is a full blown POST to a secure server that requires both password authentication and a client certificate, just like in case 2c.</p>

<p>Note: The client will not send a certificate unless the server requests one. This is typically achieved by setting the verify mode to <code><code>VERIFY_PEER</code></code> on the server:</p>

<pre><code><code>  <span class="variable">Net::SSLeay::set_verify</span><span class="operator">(</span><span class="variable">ssl</span><span class="operator">,</span> <span class="variable">Net::SSLeay::VERIFY_PEER</span><span class="operator">,</span> <span class="number">0</span><span class="operator">);</span>
</code></code></pre>

<p>See <code><code>perldoc ~openssl/doc/ssl/SSL_CTX_set_verify.pod</code></code> for a full description.</p>

<h3 id="Working-through-a-web-proxy">Working through a web proxy</h3>

<ul>

<li><p>set_proxy</p>

</li>
</ul>

<p><code><code>Net::SSLeay</code></code> can use a web proxy to make its connections. You need to first set the proxy host and port using <code><code>set_proxy()</code></code> and then just use the normal API functions, e.g:</p>

<pre><code><code>  <span class="variable">Net::SSLeay::set_proxy</span><span class="operator">(</span><span class="string">'gateway.myorg.com'</span><span class="operator">,</span> <span class="number">8080</span><span class="operator">);</span>
  <span class="operator">(</span><span class="variable">$page</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">get_https</span><span class="operator">(</span><span class="string">'www.bacus.pt'</span><span class="operator">,</span> <span class="number">443</span><span class="operator">,</span> <span class="string">'/'</span><span class="operator">);</span>
</code></code></pre>

<p>If your proxy requires authentication, you can supply a username and password as well</p>

<pre><code><code>  <span class="variable">Net::SSLeay::set_proxy</span><span class="operator">(</span><span class="string">'gateway.myorg.com'</span><span class="operator">,</span> <span class="number">8080</span><span class="operator">,</span> <span class="string">'joe'</span><span class="operator">,</span> <span class="string">'salainen'</span><span class="operator">);</span>
  <span class="operator">(</span><span class="variable">$page</span><span class="operator">,</span> <span class="variable">$result</span><span class="operator">,</span> <span class="variable">%headers</span><span class="operator">)</span> <span class="operator">=</span>
         <span class="operator">=</span> <span class="variable">get_https</span><span class="operator">(</span><span class="string">'www.bacus.pt'</span><span class="operator">,</span> <span class="number">443</span><span class="operator">,</span> <span class="string">'/protected.html'</span><span class="operator">,</span>
              <span class="variable">make_headers</span><span class="operator">(</span><span class="string">Authorization</span> <span class="operator">=&gt;</span>
                           <span class="string">'Basic '</span> <span class="operator">.</span> <span class="variable">MIME::Base64::encode</span><span class="operator">(</span><span class="string">"susie:pass"</span><span class="operator">,</span><span class="string">''</span><span class="operator">))</span>
              <span class="operator">);</span>
</code></code></pre>

<p>This example demonstrates the case where we authenticate to the proxy as <code><code>&quot;joe&quot;</code></code> and to the final web server as <code><code>&quot;susie&quot;</code></code>. Proxy authentication requires the <code><code>MIME::Base64</code></code> module to work.</p>

<h3 id="HTTP-without-S-API">HTTP (without S) API</h3>

<ul>

<li><p>get_http</p>

</li>
<li><p>post_http</p>

</li>
<li><p>tcpcat</p>

</li>
<li><p>get_httpx</p>

</li>
<li><p>post_httpx</p>

</li>
<li><p>tcpxcat</p>

</li>
</ul>

<p>Over the years it has become clear that it would be convenient to use the light-weight flavour API of <code><code>Net::SSLeay</code></code> for normal HTTP as well (see <code><code>LWP</code></code> for the heavy-weight object-oriented approach). In fact it would be nice to be able to flip https on and off on the fly. Thus regular HTTP support was evolved.</p>

<pre><code><code>  <span class="keyword">use</span> <span class="variable">Net::SSLeay</span> <span class="string">qw(get_http post_http tcpcat
                      get_httpx post_httpx tcpxcat
                      make_headers make_form)</span><span class="operator">;</span>
  
  <span class="operator">(</span><span class="variable">$page</span><span class="operator">,</span> <span class="variable">$result</span><span class="operator">,</span> <span class="variable">%headers</span><span class="operator">)</span>
         <span class="operator">=</span> <span class="variable">get_http</span><span class="operator">(</span><span class="string">'www.bacus.pt'</span><span class="operator">,</span> <span class="number">443</span><span class="operator">,</span> <span class="string">'/protected.html'</span><span class="operator">,</span>
              <span class="variable">make_headers</span><span class="operator">(</span><span class="string">Authorization</span> <span class="operator">=&gt;</span>
                           <span class="string">'Basic '</span> <span class="operator">.</span> <span class="variable">MIME::Base64::encode</span><span class="operator">(</span><span class="string">"</span><span class="variable">$user</span><span class="string">:</span><span class="variable">$pass</span><span class="string">"</span><span class="operator">,</span><span class="string">''</span><span class="operator">))</span>
              <span class="operator">);</span>
  
  <span class="operator">(</span><span class="variable">$page</span><span class="operator">,</span> <span class="variable">$response</span><span class="operator">,</span> <span class="variable">%reply_headers</span><span class="operator">)</span>
         <span class="operator">=</span> <span class="variable">post_http</span><span class="operator">(</span><span class="string">'www.bacus.pt'</span><span class="operator">,</span> <span class="number">443</span><span class="operator">,</span> <span class="string">'/foo.cgi'</span><span class="operator">,</span> <span class="string">''</span><span class="operator">,</span>
                <span class="variable">make_form</span><span class="operator">(</span><span class="string">OK</span>   <span class="operator">=&gt;</span> <span class="string">'1'</span><span class="operator">,</span>
                          <span class="string">name</span> <span class="operator">=&gt;</span> <span class="string">'Sampo'</span>
                <span class="operator">));</span>
  
  <span class="operator">(</span><span class="variable">$reply</span><span class="operator">,</span> <span class="variable">$err</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">tcpcat</span><span class="operator">(</span><span class="variable">$host</span><span class="operator">,</span> <span class="variable">$port</span><span class="operator">,</span> <span class="variable">$request</span><span class="operator">);</span>
  
  <span class="operator">(</span><span class="variable">$page</span><span class="operator">,</span> <span class="variable">$result</span><span class="operator">,</span> <span class="variable">%headers</span><span class="operator">)</span>
         <span class="operator">=</span> <span class="variable">get_httpx</span><span class="operator">(</span><span class="variable">$usessl</span><span class="operator">,</span> <span class="string">'www.bacus.pt'</span><span class="operator">,</span> <span class="number">443</span><span class="operator">,</span> <span class="string">'/protected.html'</span><span class="operator">,</span>
              <span class="variable">make_headers</span><span class="operator">(</span><span class="string">Authorization</span> <span class="operator">=&gt;</span>
                           <span class="string">'Basic '</span> <span class="operator">.</span> <span class="variable">MIME::Base64::encode</span><span class="operator">(</span><span class="string">"</span><span class="variable">$user</span><span class="string">:</span><span class="variable">$pass</span><span class="string">"</span><span class="operator">,</span><span class="string">''</span><span class="operator">))</span>
              <span class="operator">);</span>
  
  <span class="operator">(</span><span class="variable">$page</span><span class="operator">,</span> <span class="variable">$response</span><span class="operator">,</span> <span class="variable">%reply_headers</span><span class="operator">)</span>
         <span class="operator">=</span> <span class="variable">post_httpx</span><span class="operator">(</span><span class="variable">$usessl</span><span class="operator">,</span> <span class="string">'www.bacus.pt'</span><span class="operator">,</span> <span class="number">443</span><span class="operator">,</span> <span class="string">'/foo.cgi'</span><span class="operator">,</span> <span class="string">''</span><span class="operator">,</span>
                <span class="variable">make_form</span><span class="operator">(</span><span class="string">OK</span>   <span class="operator">=&gt;</span> <span class="string">'1'</span><span class="operator">,</span>  <span class="string">name</span> <span class="operator">=&gt;</span> <span class="string">'Sampo'</span> <span class="operator">));</span>
  
  <span class="operator">(</span><span class="variable">$reply</span><span class="operator">,</span> <span class="variable">$err</span><span class="operator">,</span> <span class="variable">$server_cert</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">tcpxcat</span><span class="operator">(</span><span class="variable">$usessl</span><span class="operator">,</span> <span class="variable">$host</span><span class="operator">,</span> <span class="variable">$port</span><span class="operator">,</span> <span class="variable">$request</span><span class="operator">);</span>
</code></code></pre>

<p>As can be seen, the <code><code>&quot;x&quot;</code></code> family of APIs takes as the first argument a flag which indicates whether SSL is used or not.</p>

<h2 id="Certificate-verification-and-Certificate-Revocation-Lists-CRLs-">Certificate verification and Certificate Revocation Lists (CRLs)</h2>

<p>OpenSSL supports the ability to verify peer certificates. It can also optionally check the peer certificate against a Certificate Revocation List (CRL) from the certificates issuer. A CRL is a file, created by the certificate issuer that lists all the certificates that it previously signed, but which it now revokes. CRLs are in PEM format.</p>

<p>You can enable <code><code>Net::SSLeay CRL</code></code> checking like this:</p>

<pre><code><code>            <span class="operator">&amp;</span><span class="variable">Net::SSLeay::X509_STORE_set_flags</span>
                <span class="operator">(&amp;</span><span class="variable">Net::SSLeay::CTX_get_cert_store</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">),</span>
                 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::X509_V_FLAG_CRL_CHECK</span><span class="operator">);</span>
</code></code></pre>

<p>After setting this flag, if OpenSSL checks a peer&#39;s certificate, then it will attempt to find a CRL for the issuer. It does this by looking for a specially named file in the search directory specified by CTX_load_verify_locations. CRL files are named with the hash of the issuer&#39;s subject name, followed by <code><code>.r0</code></code>, <code><code>.r1</code></code> etc. For example <code><code>ab1331b2.r0</code></code>, <code><code>ab1331b2.r1</code></code>. It will read all the .r files for the issuer, and then check for a revocation of the peer certificate in all of them. (You can also force it to look in a specific named CRL file., see below). You can find out the hash of the issuer subject name in a CRL with</p>

<pre><code><code>        openssl crl -in crl.pem -hash -noout</code></code></pre>

<p>If the peer certificate does not pass the revocation list, or if no CRL is found, then the handshaking fails with an error.</p>

<p>You can also force OpenSSL to look for CRLs in one or more arbitrarily named files.</p>

<pre><code><code>    <span class="keyword">my</span> <span class="variable">$bio</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_new_file</span><span class="operator">(</span><span class="variable">$crlfilename</span><span class="operator">,</span> <span class="string">'r'</span><span class="operator">);</span>
    <span class="keyword">my</span> <span class="variable">$crl</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::PEM_read_bio_X509_CRL</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">);</span>
    <span class="keyword">if</span> <span class="operator">(</span><span class="variable">$crl</span><span class="operator">)</span> <span class="operator">{</span>
        <span class="variable">Net::SSLeay::X509_STORE_add_crl</span><span class="operator">(</span>
             <span class="variable">Net::SSLeay::CTX_get_cert_store</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$crl</span><span class="operator">)</span>
        <span class="operator">);</span>
    <span class="operator">}</span> <span class="keyword">else</span> <span class="operator">{</span>
        <span class="variable">error</span> <span class="variable">reading</span> <span class="variable">CRL</span><span class="operator">....</span>
    <span class="operator">}</span>
</code></code></pre>

<h2 id="Using-Net::SSLeay-in-multi-threaded-applications">Using Net::SSLeay in multi-threaded applications</h2>

<p><b>IMPORTANT: versions 1.42 or earlier are not thread-safe!</b></p>

<p>Net::SSLeay module implements all necessary stuff to be ready for multi-threaded environment - it requires openssl-0.9.7 or newer. The implementation fully follows thread safety related requirements of openssl library(see <a href="http://www.openssl.org/docs/crypto/threads.html">http://www.openssl.org/docs/crypto/threads.html</a>).</p>

<p>If you are about to use Net::SSLeay (or any other module based on Net::SSLeay) in multi-threaded perl application it is recommended to follow this best-practice:</p>

<h3 id="Initialization">Initialization</h3>

<p>Load and initialize Net::SSLeay module in the main thread:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">threads</span><span class="operator">;</span>
    <span class="keyword">use</span> <span class="variable">Net::SSLeay</span><span class="operator">;</span>
    
    <span class="variable">Net::SSLeay::load_error_strings</span><span class="operator">();</span>
    <span class="variable">Net::SSLeay::SSLeay_add_ssl_algorithms</span><span class="operator">();</span>
    <span class="variable">Net::SSLeay::randomize</span><span class="operator">();</span>
    
    <span class="keyword">sub</span><span class="variable"> do_master_job </span><span class="operator">{</span>
      <span class="comment">#... call whatever from Net::SSLeay</span>
    <span class="operator">}</span>
    
    <span class="keyword">sub</span><span class="variable"> do_worker_job </span><span class="operator">{</span>
      <span class="comment">#... call whatever from Net::SSLeay</span>
    <span class="operator">}</span>
    
    <span class="comment">#start threads</span>
    <span class="keyword">my</span> <span class="variable">$master</span>  <span class="operator">=</span> <span class="variable">threads</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(\&amp;</span><span class="variable">do_master_job</span><span class="operator">,</span> <span class="string">'param1'</span><span class="operator">,</span> <span class="string">'param2'</span><span class="operator">);</span>
    <span class="keyword">my</span> <span class="variable">@workers</span> <span class="operator">=</span> <span class="variable">threads</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(\&amp;</span><span class="variable">do_worker_job</span><span class="operator">,</span> <span class="string">'arg1'</span><span class="operator">,</span> <span class="string">'arg2'</span><span class="operator">)</span> <span class="keyword">for</span> <span class="operator">(</span><span class="number">1</span><span class="operator">..</span><span class="number">10</span><span class="operator">);</span>
    
    <span class="comment">#waiting for all threads to finish</span>
    <span class="variable">$_</span><span class="operator">-&gt;</span><span class="variable">join</span><span class="operator">()</span> <span class="keyword">for</span> <span class="operator">(</span><span class="variable">threads</span><span class="operator">-&gt;</span><span class="variable">list</span><span class="operator">);</span>
</code></code></pre>

<p>NOTE: Openssl&#39;s <code><code>int SSL_library_init(void)</code></code> function (which is also aliased as <code><code>SSLeay_add_ssl_algorithms</code></code>, <code><code>OpenSSL_add_ssl_algorithms</code></code> and <code><code>add_ssl_algorithms</code></code>) is not re-entrant and multiple calls can cause a crash in threaded application. Net::SSLeay implements flags preventing repeated calls to this function, therefore even multiple initialization via Net::SSLeay::SSLeay_add_ssl_algorithms() should work without trouble.</p>

<h3 id="Using-callbacks">Using callbacks</h3>

<p>Do not use callbacks across threads (the module blocks cross-thread callback operations and throws a warning). Allways do the callback setup, callback use and callback destruction within the same thread.</p>

<h3 id="Using-openssl-elements">Using openssl elements</h3>

<p>All openssl elements (X509, SSL_CTX, ...) can be directly passed between threads.</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">threads</span><span class="operator">;</span>
    <span class="keyword">use</span> <span class="variable">Net::SSLeay</span><span class="operator">;</span>
    
    <span class="variable">Net::SSLeay::load_error_strings</span><span class="operator">();</span>
    <span class="variable">Net::SSLeay::SSLeay_add_ssl_algorithms</span><span class="operator">();</span>
    <span class="variable">Net::SSLeay::randomize</span><span class="operator">();</span>
    
    <span class="keyword">sub</span><span class="variable"> do_job </span><span class="operator">{</span>
      <span class="keyword">my</span> <span class="variable">$context</span> <span class="operator">=</span> <span class="keyword">shift</span><span class="operator">;</span>
      <span class="variable">Net::SSLeay::CTX_set_default_passwd_cb</span><span class="operator">(</span><span class="variable">$context</span><span class="operator">,</span> <span class="keyword">sub</span><span class="variable"> </span><span class="operator">{</span> <span class="string">"secret"</span> <span class="operator">});</span>
      <span class="comment">#...</span>
    <span class="operator">}</span>
    
    <span class="keyword">my</span> <span class="variable">$c</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_new</span><span class="operator">();</span>
    <span class="variable">threads</span><span class="operator">-&gt;</span><span class="variable">create</span><span class="operator">(\&amp;</span><span class="variable">do_job</span><span class="operator">,</span> <span class="variable">$c</span><span class="operator">);</span>
</code></code></pre>

<p>Or:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">threads</span><span class="operator">;</span>
    <span class="keyword">use</span> <span class="variable">Net::SSLeay</span><span class="operator">;</span>
    
    <span class="keyword">my</span> <span class="variable">$context</span><span class="operator">;</span> <span class="comment">#does not need to be 'shared'</span>
    
    <span class="variable">Net::SSLeay::load_error_strings</span><span class="operator">();</span>
    <span class="variable">Net::SSLeay::SSLeay_add_ssl_algorithms</span><span class="operator">();</span>
    <span class="variable">Net::SSLeay::randomize</span><span class="operator">();</span>
    
    <span class="keyword">sub</span><span class="variable"> do_job </span><span class="operator">{</span>
      <span class="variable">Net::SSLeay::CTX_set_default_passwd_cb</span><span class="operator">(</span><span class="variable">$context</span><span class="operator">,</span> <span class="keyword">sub</span><span class="variable"> </span><span class="operator">{</span> <span class="string">"secret"</span> <span class="operator">});</span>
      <span class="comment">#...</span>
    <span class="operator">}</span>
    
    <span class="variable">$context</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_new</span><span class="operator">();</span>
    <span class="variable">threads</span><span class="operator">-&gt;</span><span class="variable">create</span><span class="operator">(\&amp;</span><span class="variable">do_job</span><span class="operator">);</span>
</code></code></pre>

<h3 id="Using-other-perl-modules-based-on-Net::SSLeay">Using other perl modules based on Net::SSLeay</h3>

<p>It should be fine to use any other module based on <a href="../../lib/Net/SSLeay.html">Net::SSLeay</a> (like <a href="../../lib/IO/Socket/SSL.html">IO::Socket::SSL</a>) in multi-threaded applications. It is generally recommended to do any global initialization of such a module in the main thread before calling <code><code>threads-&gt;new(..)</code></code> or <code><code>threads-&gt;create(..)</code></code> but it might differ module by module.</p>

<p>To be play safe you can load and init Net::SSLeay explicitly in the main thread:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Net::SSLeay</span><span class="operator">;</span>
    <span class="keyword">use</span> <span class="variable">Other::SSLeay::Based::Module</span><span class="operator">;</span>
    
    <span class="variable">Net::SSLeay::load_error_strings</span><span class="operator">();</span>
    <span class="variable">Net::SSLeay::SSLeay_add_ssl_algorithms</span><span class="operator">();</span>
    <span class="variable">Net::SSLeay::randomize</span><span class="operator">();</span><span class="variable">Net::SSLeay::initialize</span><span class="operator">();</span>
    <span class="variable">Net::SSLeay::initialize</span><span class="operator">();</span>
</code></code></pre>

<p>Or even safer:</p>

<pre><code><code>    <span class="keyword">use</span> <span class="variable">Net::SSLeay</span><span class="operator">;</span>
    <span class="keyword">use</span> <span class="variable">Other::SSLeay::Based::Module</span><span class="operator">;</span>
    
    <span class="keyword">BEGIN</span> <span class="operator">{</span>
      <span class="variable">Net::SSLeay::load_error_strings</span><span class="operator">();</span>
      <span class="variable">Net::SSLeay::SSLeay_add_ssl_algorithms</span><span class="operator">();</span>
      <span class="variable">Net::SSLeay::randomize</span><span class="operator">();</span><span class="variable">Net::SSLeay::initialize</span><span class="operator">();</span>
    <span class="operator">}</span>
</code></code></pre>

<h3 id="Combining-Net::SSLeay-with-other-modules-linked-with-openssl">Combining Net::SSLeay with other modules linked with openssl</h3>

<p><b>BEWARE: This might be a big trouble! This is not guaranteed be thread-safe!</b></p>

<p>There are many other (XS) modules linked directly to openssl library (like <a>Crypt::SSLeay</a>).</p>

<p>As it is expected that also &quot;another&quot; module will call <code><code>SSLeay_add_ssl_algorithms</code></code> at some point we have again a trouble with multiple openssl initialization by Net::SSLeay and &quot;another&quot; module.</p>

<p>As you can expect Net::SSLeay is not able to avoid multiple initialization of openssl library called by &quot;another&quot; module, thus you have to handle this on your own (in some cases it might not be possible at all to avoid this).</p>

<h3 id="Threading-with-get_https-and-friends">Threading with get_https and friends</h3>

<p>The convenience functions get_https, post_https etc all initialize the SSL library by calling Net::SSLeay::initialize which does the conventional library initialization:</p>

<pre><code><code>    <span class="variable">Net::SSLeay::load_error_strings</span><span class="operator">();</span>
    <span class="variable">Net::SSLeay::SSLeay_add_ssl_algorithms</span><span class="operator">();</span>
    <span class="variable">Net::SSLeay::randomize</span><span class="operator">();</span>
</code></code></pre>

<p>Net::SSLeay::initialize initializes the SSL library at most once. You can override the Net::SSLeay::initialize function if you desire some other type of initialization behaviour by get_https and friends. You can call Net::SSLeay::initialize from your own code if you desire this conventional library initialization.</p>

<h2 id="Convenience-routines">Convenience routines</h2>

<p>To be used with Low level API</p>

<pre><code><code>    <span class="variable">Net::SSLeay::randomize</span><span class="operator">(</span><span class="variable">$rn_seed_file</span><span class="operator">,</span><span class="variable">$additional_seed</span><span class="operator">);</span>
    <span class="variable">Net::SSLeay::set_cert_and_key</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$cert_path</span><span class="operator">,</span> <span class="variable">$key_path</span><span class="operator">);</span>
    <span class="variable">$cert</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::dump_peer_certificate</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
    <span class="variable">Net::SSLeay::ssl_write_all</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$message</span><span class="operator">)</span> <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"ssl write failure"</span><span class="operator">;</span>
    <span class="variable">$got</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::ssl_read_all</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">)</span> <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"ssl read failure"</span><span class="operator">;</span>
    
    <span class="variable">$got</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::ssl_read_CRLF</span><span class="operator">(</span><span class="variable">$ssl</span> <span class="operator">[</span><span class="operator">,</span> <span class="variable">$max_length</span><span class="operator">]</span><span class="operator">);</span>
    <span class="variable">$got</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::ssl_read_until</span><span class="operator">(</span><span class="variable">$ssl</span> <span class="operator">[</span><span class="operator">,</span> <span class="variable">$delimit</span> <span class="operator">[</span><span class="operator">,</span> <span class="variable">$max_length</span><span class="operator">]]</span><span class="operator">);</span>
    <span class="variable">Net::SSLeay::ssl_write_CRLF</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$message</span><span class="operator">);</span>
</code></code></pre>

<ul>

<li><p>randomize</p>

<p>seeds the openssl PRNG with <code><code>/dev/urandom</code></code> (see the top of <code><code>SSLeay.pm</code></code> for how to change or configure this) and optionally with user provided data. It is very important to properly seed your random numbers, so do not forget to call this. The high level API functions automatically call <code><code>randomize()</code></code> so it is not needed with them. See also caveats.</p>

</li>
<li><p>set_cert_and_key</p>

<p>takes two file names as arguments and sets the certificate and private key to those. This can be used to set either server certificates or client certificates.</p>

</li>
<li><p>dump_peer_certificate</p>

<p>allows you to get a plaintext description of the certificate the peer (usually the server) presented to us.</p>

</li>
<li><p>ssl_read_all</p>

<p>see ssl_write_all (below)</p>

</li>
<li><p>ssl_write_all</p>

<p><code><code>ssl_read_all()</code></code> and <code><code>ssl_write_all()</code></code> provide true blocking semantics for these operations (see limitation, below, for explanation). These are much preferred to the low level API equivalents (which implement BSD blocking semantics). The message argument to <code><code>ssl_write_all()</code></code> can be a reference. This is helpful to avoid unnecessary copying when writing something big, e.g:</p>

<pre><code><code>    <span class="variable">$data</span> <span class="operator">=</span> <span class="string">'A'</span> <span class="operator">x</span> <span class="number">1000000000</span><span class="operator">;</span>
    <span class="variable">Net::SSLeay::ssl_write_all</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="operator">\</span><span class="variable">$data</span><span class="operator">)</span> <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"ssl write failed"</span><span class="operator">;</span>
</code></code></pre>

</li>
<li><p>ssl_read_CRLF</p>

<p>uses <code><code>ssl_read_all()</code></code> to read in a line terminated with a carriage return followed by a linefeed (CRLF). The CRLF is included in the returned scalar.</p>

</li>
<li><p>ssl_read_until</p>

<p>uses <code><code>ssl_read_all()</code></code> to read from the SSL input stream until it encounters a programmer specified delimiter. If the delimiter is undefined, <code><code>$/</code></code> is used. If <code><code>$/</code></code> is undefined, <code><code>\n</code></code> is used. One can optionally set a maximum length of bytes to read from the SSL input stream.</p>

</li>
<li><p>ssl_write_CRLF</p>

<p>writes <code><code>$message</code></code> and appends CRLF to the SSL output stream.</p>

</li>
</ul>

<h2 id="Initialization1">Initialization</h2>

<p>In order to use the low level API you should start your programs with the following incantation:</p>

<pre><code><code>        <span class="keyword">use</span> <span class="variable">Net::SSLeay</span> <span class="string">qw(die_now die_if_ssl_error)</span><span class="operator">;</span>
        <span class="variable">Net::SSLeay::load_error_strings</span><span class="operator">();</span>
        <span class="variable">Net::SSLeay::SSLeay_add_ssl_algorithms</span><span class="operator">();</span>    <span class="comment"># Important!</span>
        <span class="variable">Net::SSLeay::ENGINE_load_builtin_engines</span><span class="operator">();</span>  <span class="comment"># If you want built-in engines</span>
        <span class="variable">Net::SSLeay::ENGINE_register_all_complete</span><span class="operator">();</span> <span class="comment"># If you want built-in engines</span>
        <span class="variable">Net::SSLeay::randomize</span><span class="operator">();</span>
</code></code></pre>

<h2 id="Error-handling-functions">Error handling functions</h2>

<p>I can not emphasize the need to check for error enough. Use these functions even in the most simple programs, they will reduce debugging time greatly. Do not ask questions on the mailing list without having first sprinkled these in your code.</p>

<ul>

<li><p>die_now</p>

</li>
<li><p>die_if_ssl_error</p>

<p><code><code>die_now()</code></code> and <code><code>die_if_ssl_error()</code></code> are used to conveniently print the SSLeay error stack when something goes wrong:</p>

<pre><code><code>        <span class="variable">Net::SSLeay::connect</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">)</span> <span class="keyword">or</span> <span class="variable">die_now</span><span class="operator">(</span><span class="string">"Failed SSL connect ($!)"</span><span class="operator">);</span>
        
        
        <span class="variable">Net::SSLeay::write</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="string">"foo"</span><span class="operator">)</span> <span class="keyword">or</span> <span class="variable">die_if_ssl_error</span><span class="operator">(</span><span class="string">"SSL write ($!)"</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>print_errs</p>

<p>You can also use <code><code>Net::SSLeay::print_errs()</code></code> to dump the error stack without exiting the program. As can be seen, your code becomes much more readable if you import the error reporting functions into your main name space.</p>

</li>
</ul>

<h2 id="Sockets">Sockets</h2>

<p>Perl uses file handles for all I/O. While SSLeay has a quite flexible BIO mechanism and perl has an evolved PerlIO mechanism, this module still sticks to using file descriptors. Thus to attach SSLeay to a socket you should use <code><code>fileno()</code></code> to extract the underlying file descriptor:</p>

<pre><code><code>    <span class="variable">Net::SSLeay::set_fd</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="keyword">fileno</span><span class="operator">(</span><span class="variable">S</span><span class="operator">));</span>   <span class="comment"># Must use fileno</span>
</code></code></pre>

<p>You should also set <code><code>$|</code></code> to 1 to eliminate STDIO buffering so you do not get confused if you use perl I/O functions to manipulate your socket handle.</p>

<p>If you need to <code><code>select(2)</code></code> on the socket, go right ahead, but be warned that OpenSSL does some internal buffering so SSL_read does not always return data even if the socket selected for reading (just keep on selecting and trying to read). <code><code>Net::SSLeay</code></code> is no different from the C language OpenSSL in this respect.</p>

<h2 id="Callbacks">Callbacks</h2>

<p>You can establish a per-context verify callback function something like this:</p>

<pre><code><code>        <span class="keyword">sub</span><span class="variable"> verify </span><span class="operator">{</span>
            <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$ok</span><span class="operator">,</span> <span class="variable">$x509_store_ctx</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">@_</span><span class="operator">;</span>
            <span class="keyword">print</span> <span class="string">"Verifying certificate...\n"</span><span class="operator">;</span>
                <span class="operator">...</span>
            <span class="keyword">return</span> <span class="variable">$ok</span><span class="operator">;</span>
        <span class="operator">}</span>
</code></code></pre>

<p>It is used like this:</p>

<pre><code><code>        <span class="variable">Net::SSLeay::set_verify</span> <span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">Net::SSLeay::VERIFY_PEER</span><span class="operator">,</span> <span class="operator">\&amp;</span><span class="variable">verify</span><span class="operator">);</span>
</code></code></pre>

<p>Per-context callbacks for decrypting private keys are implemented.</p>

<pre><code><code>        <span class="variable">Net::SSLeay::CTX_set_default_passwd_cb</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="keyword">sub</span><span class="variable"> </span><span class="operator">{</span> <span class="string">"top-secret"</span> <span class="operator">});</span>
        <span class="variable">Net::SSLeay::CTX_use_PrivateKey_file</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="string">"key.pem"</span><span class="operator">,</span>
                                             <span class="variable">Net::SSLeay::FILETYPE_PEM</span><span class="operator">)</span>
            <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"Error reading private key"</span><span class="operator">;</span>
        <span class="variable">Net::SSLeay::CTX_set_default_passwd_cb</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="keyword">undef</span><span class="operator">);</span>
</code></code></pre>

<p>If Hello Extensions are supported by your OpenSSL, a session secret callback can be set up to be called when a session secret is set by openssl.</p>

<p>Establish it like this: Net::SSLeay::set_session_secret_cb($ssl, \&amp;session_secret_cb, $somedata);</p>

<p>It will be called like this:</p>

<pre><code><code>    <span class="keyword">sub</span><span class="variable"> session_secret_cb
    </span><span class="operator">{</span>
        <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$secret</span><span class="operator">,</span> <span class="operator">\</span><span class="variable">@cipherlist</span><span class="operator">,</span> <span class="operator">\</span><span class="variable">$preferredcipher</span><span class="operator">,</span> <span class="variable">$somedata</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">@_</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>No other callbacks are implemented. You do not need to use any callback for simple (i.e. normal) cases where the SSLeay built-in verify mechanism satisfies your needs.</p>

<p>It is required to reset these callbacks to undef immediately after use to prevent memory leaks, thread safety problems and crashes on exit that can occur if different threads set different callbacks.</p>

<p>If you want to use callback stuff, see examples/callback.pl! It&#39;s the only one I am able to make work reliably.</p>

<h2 id="Low-level-API">Low level API</h2>

<p>In addition to the high level functions outlined above, this module contains straight-forward access to CRYPTO and SSL parts of OpenSSL C API.</p>

<p>See the <code><code>*.h</code></code> headers from OpenSSL C distribution for a list of low level SSLeay functions to call (check SSLeay.xs to see if some function has been implemented). The module strips the initial <code><code>&quot;SSL_&quot;</code></code> off of the SSLeay names. Generally you should use <code><code>Net::SSLeay::</code></code> in its place.</p>

<p>Note that some functions are prefixed with <code><code>&quot;P_&quot;</code></code> - these are very close to the original API however contain some kind of a wrapper making its interface more perl friendly.</p>

<p>For example:</p>

<p>In C:</p>

<pre><code><code>        <span class="comment">#include &lt;ssl.h&gt;</span>
        
        <span class="variable">err</span> <span class="operator">=</span> <span class="variable">SSL_set_verify</span> <span class="operator">(</span><span class="variable">ssl</span><span class="operator">,</span> <span class="variable">SSL_VERIFY_CLIENT_ONCE</span><span class="operator">,</span>
                                   <span class="operator">&amp;</span><span class="variable">your_call_back_here</span><span class="operator">);</span>
</code></code></pre>

<p>In Perl:</p>

<pre><code><code>        <span class="keyword">use</span> <span class="variable">Net::SSLeay</span><span class="operator">;</span>
        
        <span class="variable">$err</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set_verify</span> <span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span>
                                        <span class="variable">Net::SSLeay::VERIFY_CLIENT_ONCE</span><span class="operator">,</span>
                                        <span class="operator">\&amp;</span><span class="variable">your_call_back_here</span><span class="operator">);</span>
</code></code></pre>

<p>If the function does not start with <code><code>SSL_</code></code> you should use the full function name, e.g.:</p>

<pre><code><code>        <span class="variable">$err</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::ERR_get_error</span><span class="operator">;</span>
</code></code></pre>

<p>The following new functions behave in perlish way:</p>

<pre><code><code>        <span class="variable">$got</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::read</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
                                    <span class="comment"># Performs SSL_read, but returns $got</span>
                                    <span class="comment"># resized according to data received.</span>
                                    <span class="comment"># Returns undef on failure.</span>
        
        <span class="variable">Net::SSLeay::write</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$foo</span><span class="operator">)</span> <span class="operator">||</span> <span class="keyword">die</span><span class="operator">;</span>
                                    <span class="comment"># Performs SSL_write, but automatically</span>
                                    <span class="comment"># figures out the size of $foo</span>
</code></code></pre>

<h3 id="Low-level-API:-Version-related-functions">Low level API: Version related functions</h3>

<ul>

<li><p>SSLeay</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before</p>

<p>Gives version number (numeric) of underlaying openssl library.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$ver_number</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SSLeay</span><span class="operator">();</span>
 <span class="comment"># returns: the number identifying the openssl release</span>
 <span class="comment">#</span>
 <span class="comment"># 0x00903100 =&gt; openssl-0.9.3</span>
 <span class="comment"># 0x00904100 =&gt; openssl-0.9.4</span>
 <span class="comment"># 0x00905100 =&gt; openssl-0.9.5</span>
 <span class="comment"># 0x0090600f =&gt; openssl-0.9.6</span>
 <span class="comment"># 0x0090601f =&gt; openssl-0.9.6a</span>
 <span class="comment"># 0x0090602f =&gt; openssl-0.9.6b</span>
 <span class="comment"># ...</span>
 <span class="comment"># 0x009060df =&gt; openssl-0.9.6m</span>
 <span class="comment"># 0x0090700f =&gt; openssl-0.9.7</span>
 <span class="comment"># 0x0090701f =&gt; openssl-0.9.7a</span>
 <span class="comment"># 0x0090702f =&gt; openssl-0.9.7b</span>
 <span class="comment"># ...</span>
 <span class="comment"># 0x009070df =&gt; openssl-0.9.7m</span>
 <span class="comment"># 0x0090800f =&gt; openssl-0.9.8</span>
 <span class="comment"># 0x0090801f =&gt; openssl-0.9.8a</span>
 <span class="comment"># 0x0090802f =&gt; openssl-0.9.8b</span>
 <span class="comment"># ...</span>
 <span class="comment"># 0x0090814f =&gt; openssl-0.9.8t</span>
 <span class="comment"># 0x1000000f =&gt; openssl-1.0.0</span>
 <span class="comment"># 0x1000004f =&gt; openssl-1.0.0d</span>
 <span class="comment"># 0x1000007f =&gt; openssl-1.0.0g</span>
</code></code></pre>

<p>You can use it like this:</p>

<pre><code><code>  <span class="keyword">if</span> <span class="operator">(</span><span class="variable">Net::SSLeay::SSLeay</span><span class="operator">()</span> <span class="operator">&lt;</span> <span class="number">0x0090800f</span><span class="operator">)</span> <span class="operator">{</span>
    <span class="keyword">die</span> <span class="string">"you need openssl-0.9.8 or higher"</span><span class="operator">;</span>
  <span class="operator">}</span>
</code></code></pre>

</li>
<li><p>SSLeay_version</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before</p>

<p>Gives version number (string) of underlaying openssl library.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$ver_string</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SSLeay_version</span><span class="operator">(</span><span class="variable">$type</span><span class="operator">);</span>
 <span class="comment"># $type</span>
 <span class="comment">#   0 (=SSLEAY_VERSION) - e.g. 'OpenSSL 1.0.0d 8 Feb 2011'</span>
 <span class="comment">#   2 (=SSLEAY_CFLAGS)  - e.g. 'compiler: gcc -D_WINDLL -DOPENSSL_USE_APPLINK .....'</span>
 <span class="comment">#   3 (=SSLEAY_BUILT_ON)- e.g. 'built on: Fri May  6 00:00:46 GMT 2011'</span>
 <span class="comment">#   4 (=SSLEAY_PLATFORM)- e.g. 'platform: mingw'</span>
 <span class="comment">#</span>
 <span class="comment"># returns: string</span>
 
 <span class="variable">Net::SSLeay::SSLeay_version</span><span class="operator">();</span>
 <span class="comment">#is equivalent to</span>
 <span class="variable">Net::SSLeay::SSLeay_version</span><span class="operator">(</span><span class="number">0</span><span class="operator">);</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/SSLeay_version.html">http://www.openssl.org/docs/crypto/SSLeay_version.html</a></p>

</li>
</ul>

<h3 id="Low-level-API:-Initialization-related-functions">Low level API: Initialization related functions</h3>

<ul>

<li><p>library_init</p>

<p>Initialize SSL library by registering algorithms.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::library_init</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: always 1</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_library_init.html">http://www.openssl.org/docs/ssl/SSL_library_init.html</a></p>

</li>
<li><p>add_ssl_algorithms</p>

<p>The alias for <a href="#library_init">&quot;library_init&quot;</a></p>

<pre><code><code> <span class="variable">Net::SSLeay::add_ssl_algorithms</span><span class="operator">();</span>
</code></code></pre>

</li>
<li><p>OpenSSL_add_ssl_algorithms</p>

<p>The alias for <a href="#library_init">&quot;library_init&quot;</a></p>

<pre><code><code> <span class="variable">Net::SSLeay::OpenSSL_add_ssl_algorithms</span><span class="operator">();</span>
</code></code></pre>

</li>
<li><p>SSLeay_add_ssl_algorithms</p>

<p>The alias for <a href="#library_init">&quot;library_init&quot;</a></p>

<pre><code><code> <span class="variable">Net::SSLeay::SSLeay_add_ssl_algorithms</span><span class="operator">();</span>
</code></code></pre>

</li>
<li><p>load_error_strings</p>

<p>Registers the error strings for all libcrypto + libssl related functions.</p>

<pre><code><code> <span class="variable">Net::SSLeay::load_error_strings</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/ERR_load_crypto_strings.html">http://www.openssl.org/docs/crypto/ERR_load_crypto_strings.html</a></p>

</li>
<li><p>ERR_load_crypto_strings</p>

<p>Registers the error strings for all libcrypto functions. No need to call this function if you have already called <a href="#load_error_strings">&quot;load_error_strings&quot;</a>.</p>

<pre><code><code> <span class="variable">Net::SSLeay::ERR_load_crypto_strings</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/ERR_load_crypto_strings.html">http://www.openssl.org/docs/crypto/ERR_load_crypto_strings.html</a></p>

</li>
<li><p>ERR_load_RAND_strings</p>

<p>Registers the error strings for RAND related functions. No need to call this function if you have already called <a href="#load_error_strings">&quot;load_error_strings&quot;</a>.</p>

<pre><code><code> <span class="variable">Net::SSLeay::ERR_load_RAND_strings</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

</li>
<li><p>ERR_load_SSL_strings</p>

<p>Registers the error strings for SSL related functions. No need to call this function if you have already called <a href="#load_error_strings">&quot;load_error_strings&quot;</a>.</p>

<pre><code><code> <span class="variable">Net::SSLeay::ERR_load_SSL_strings</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

</li>
<li><p>OpenSSL_add_all_algorithms</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Add algorithms to internal table.</p>

<pre><code><code> <span class="variable">Net::SSLeay::OpenSSL_add_all_algorithms</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/OpenSSL_add_all_algorithms.html">http://www.openssl.org/docs/crypto/OpenSSL_add_all_algorithms.html</a></p>

</li>
<li><p>OPENSSL_add_all_algorithms_conf</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Similar to <a href="#OpenSSL_add_all_algorithms">&quot;OpenSSL_add_all_algorithms&quot;</a> - will ALWAYS load the config file</p>

<pre><code><code> <span class="variable">Net::SSLeay::OPENSSL_add_all_algorithms_conf</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

</li>
<li><p>OPENSSL_add_all_algorithms_noconf</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Similar to <a href="#OpenSSL_add_all_algorithms">&quot;OpenSSL_add_all_algorithms&quot;</a> - will NEVER load the config file</p>

<pre><code><code> <span class="variable">Net::SSLeay::OPENSSL_add_all_algorithms_noconf</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

</li>
</ul>

<h3 id="Low-level-API:-ERR_-and-SSL_alert_-related-functions">Low level API: ERR_* and SSL_alert_* related functions</h3>

<p><b>NOTE:</b> Please note that SSL_alert_* function have &quot;SSL_&quot; part stripped from their names.</p>

<ul>

<li><p>ERR_clear_error</p>

<p>Clear the error queue.</p>

<pre><code><code> <span class="variable">Net::SSLeay::ERR_clear_error</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/ERR_clear_error.html">http://www.openssl.org/docs/crypto/ERR_clear_error.html</a></p>

</li>
<li><p>ERR_error_string</p>

<p>Generates a human-readable string representing the error code $error.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::ERR_error_string</span><span class="operator">(</span><span class="variable">$error</span><span class="operator">);</span>
 <span class="comment"># $error - (unsigned integer) error code</span>
 <span class="comment">#</span>
 <span class="comment"># returns: string</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/ERR_error_string.html">http://www.openssl.org/docs/crypto/ERR_error_string.html</a></p>

</li>
<li><p>ERR_get_error</p>

<p>Returns the earliest error code from the thread&#39;s error queue and removes the entry. This function can be called repeatedly until there are no more error codes to return.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::ERR_get_error</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (unsigned integer) error code</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/ERR_get_error.html">http://www.openssl.org/docs/crypto/ERR_get_error.html</a></p>

</li>
<li><p>ERR_peek_error</p>

<p>Returns the earliest error code from the thread&#39;s error queue without modifying it.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::ERR_peek_error</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (unsigned integer) error code</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/ERR_get_error.html">http://www.openssl.org/docs/crypto/ERR_get_error.html</a></p>

</li>
<li><p>ERR_put_error</p>

<p>Adds an error code to the thread&#39;s error queue. It signals that the error of $reason code reason occurred in function $func of library $lib, in line number $line of $file.</p>

<pre><code><code> <span class="variable">Net::SSLeay::ERR_put_error</span><span class="operator">(</span><span class="variable">$lib</span><span class="operator">,</span> <span class="variable">$func</span><span class="operator">,</span> <span class="variable">$reason</span><span class="operator">,</span> <span class="variable">$file</span><span class="operator">,</span> <span class="variable">$line</span><span class="operator">);</span>
 <span class="comment"># $lib - (integer) library id (check openssl/err.h for constants e.g. ERR_LIB_SSL)</span>
 <span class="comment"># $func - (integer) function id (check openssl/ssl.h for constants e.g. SSL_F_SSL23_READ)</span>
 <span class="comment"># $reason - (integer) reason id (check openssl/ssl.h for constants e.g. SSL_R_SSL_HANDSHAKE_FAILURE)</span>
 <span class="comment"># $file - (string) file name</span>
 <span class="comment"># $line - (integer) line number in $file</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/ERR_put_error.html">http://www.openssl.org/docs/crypto/ERR_put_error.html</a> and <a href="http://www.openssl.org/docs/crypto/err.html">http://www.openssl.org/docs/crypto/err.html</a></p>

</li>
<li><p>alert_desc_string</p>

<p>Returns a two letter string as a short form describing the reason of the alert specified by value.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::alert_desc_string</span><span class="operator">(</span><span class="variable">$value</span><span class="operator">);</span>
 <span class="comment"># $value - (integer) allert id (check openssl/ssl.h for SSL3_AD_* and TLS1_AD_* constants)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: description string (2 letters)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_alert_type_string.html">http://www.openssl.org/docs/ssl/SSL_alert_type_string.html</a></p>

</li>
<li><p>alert_desc_string_long</p>

<p>Returns a string describing the reason of the alert specified by value.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::alert_desc_string_long</span><span class="operator">(</span><span class="variable">$value</span><span class="operator">);</span>
 <span class="comment"># $value - (integer) allert id (check openssl/ssl.h for SSL3_AD_* and TLS1_AD_* constants)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: description string</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_alert_type_string.html">http://www.openssl.org/docs/ssl/SSL_alert_type_string.html</a></p>

</li>
<li><p>alert_type_string</p>

<p>Returns a one letter string indicating the type of the alert specified by value.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::alert_type_string</span><span class="operator">(</span><span class="variable">$value</span><span class="operator">);</span>
 <span class="comment"># $value - (integer) allert id (check openssl/ssl.h for SSL3_AD_* and TLS1_AD_* constants)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: string (1 letter)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_alert_type_string.html">http://www.openssl.org/docs/ssl/SSL_alert_type_string.html</a></p>

</li>
<li><p>alert_type_string_long</p>

<p>Returns a string indicating the type of the alert specified by value.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::alert_type_string_long</span><span class="operator">(</span><span class="variable">$value</span><span class="operator">);</span>
 <span class="comment"># $value - (integer) allert id (check openssl/ssl.h for SSL3_AD_* and TLS1_AD_* constants)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: string</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_alert_type_string.html">http://www.openssl.org/docs/ssl/SSL_alert_type_string.html</a></p>

</li>
</ul>

<h3 id="Low-level-API:-SSL_METHOD_-related-functions">Low level API: SSL_METHOD_* related functions</h3>

<ul>

<li><p>SSLv2_method</p>

<p>Returns SSL_METHOD structure corresponding to SSLv2 method, the return value can be later used as a param of <a href="#CTX_new_with_method">&quot;CTX_new_with_method&quot;</a>.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SSLv2_method</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's SSL_METHOD structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>SSLv3_method</p>

<p>Returns SSL_METHOD structure corresponding to SSLv3 method, the return value can be later used as a param of <a href="#CTX_new_with_method">&quot;CTX_new_with_method&quot;</a>.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SSLv3_method</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's SSL_METHOD structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_new.html">http://www.openssl.org/docs/ssl/SSL_CTX_new.html</a></p>

</li>
<li><p>TLSv1_method</p>

<p>Returns SSL_METHOD structure corresponding to TLSv1 method, the return value can be later used as a param of <a href="#CTX_new_with_method">&quot;CTX_new_with_method&quot;</a>.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::TLSv1_method</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's SSL_METHOD structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_new.html">http://www.openssl.org/docs/ssl/SSL_CTX_new.html</a></p>

</li>
</ul>

<h3 id="Low-level-API:-ENGINE_-related-functions">Low level API: ENGINE_* related functions</h3>

<ul>

<li><p>ENGINE_load_builtin_engines</p>

<p>Load all bundled ENGINEs into memory and make them visible.</p>

<pre><code><code> <span class="variable">Net::SSLeay::ENGINE_load_builtin_engines</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/engine.html">http://www.openssl.org/docs/crypto/engine.html</a></p>

</li>
<li><p>ENGINE_register_all_complete</p>

<p>Register all loaded ENGINEs for every algorithm they collectively implement.</p>

<pre><code><code> <span class="variable">Net::SSLeay::ENGINE_register_all_complete</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/engine.html">http://www.openssl.org/docs/crypto/engine.html</a></p>

</li>
<li><p>ENGINE_set_default</p>

<p>Set default engine to $e + set its flags to $flags.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::ENGINE_set_default</span><span class="operator">(</span><span class="variable">$e</span><span class="operator">,</span> <span class="variable">$flags</span><span class="operator">);</span>
 <span class="comment"># $e - value corresponding to openssl's ENGINE structure</span>
 <span class="comment"># $flags - (integer) engine flags</span>
 <span class="comment">#          flags value can be made by bitwise "OR"ing:</span>
 <span class="comment">#          0x0001 - ENGINE_METHOD_RSA</span>
 <span class="comment">#          0x0002 - ENGINE_METHOD_DSA</span>
 <span class="comment">#          0x0004 - ENGINE_METHOD_DH</span>
 <span class="comment">#          0x0008 - ENGINE_METHOD_RAND</span>
 <span class="comment">#          0x0010 - ENGINE_METHOD_ECDH</span>
 <span class="comment">#          0x0020 - ENGINE_METHOD_ECDSA</span>
 <span class="comment">#          0x0040 - ENGINE_METHOD_CIPHERS</span>
 <span class="comment">#          0x0080 - ENGINE_METHOD_DIGESTS</span>
 <span class="comment">#          0x0100 - ENGINE_METHOD_STORE</span>
 <span class="comment">#          0x0200 - ENGINE_METHOD_PKEY_METHS</span>
 <span class="comment">#          0x0400 - ENGINE_METHOD_PKEY_ASN1_METHS</span>
 <span class="comment">#          Obvious all-or-nothing cases:</span>
 <span class="comment">#          0xFFFF - ENGINE_METHOD_ALL</span>
 <span class="comment">#          0x0000 - ENGINE_METHOD_NONE</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/engine.html">http://www.openssl.org/docs/crypto/engine.html</a></p>

</li>
<li><p>ENGINE_by_id</p>

<p>Get ENGINE by its identification $id.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::ENGINE_by_id</span><span class="operator">(</span><span class="variable">$id</span><span class="operator">);</span>
 <span class="comment"># $id - (string) engine identification e.g. "dynamic"</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ENGINE structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/engine.html">http://www.openssl.org/docs/crypto/engine.html</a></p>

</li>
</ul>

<h3 id="Low-level-API:-EVP_PKEY_-related-functions">Low level API: EVP_PKEY_* related functions</h3>

<ul>

<li><p>EVP_PKEY_copy_parameters</p>

<p>Copies the parameters from key $from to key $to.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_PKEY_copy_parameters</span><span class="operator">(</span><span class="variable">$to</span><span class="operator">,</span> <span class="variable">$from</span><span class="operator">);</span>
 <span class="comment"># $to - value corresponding to openssl's EVP_PKEY structure</span>
 <span class="comment"># $from - value corresponding to openssl's EVP_PKEY structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/EVP_PKEY_cmp.html">http://www.openssl.org/docs/crypto/EVP_PKEY_cmp.html</a></p>

</li>
<li><p>EVP_PKEY_new</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Creates a new EVP_PKEY structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_PKEY_new</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's EVP_PKEY structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/EVP_PKEY_new.html">http://www.openssl.org/docs/crypto/EVP_PKEY_new.html</a></p>

</li>
<li><p>EVP_PKEY_free</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Free an allocated EVP_PKEY structure.</p>

<pre><code><code> <span class="variable">Net::SSLeay::EVP_PKEY_free</span><span class="operator">(</span><span class="variable">$pkey</span><span class="operator">);</span>
 <span class="comment"># $pkey - value corresponding to openssl's EVP_PKEY structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/EVP_PKEY_new.html">http://www.openssl.org/docs/crypto/EVP_PKEY_new.html</a></p>

</li>
<li><p>EVP_PKEY_assign_RSA</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Set the key referenced by $pkey to $key</p>

<p><b>NOTE:</b> In accordance with the OpenSSL naming convention the $key assigned to the $pkey using the &quot;1&quot; functions must be freed as well as $pkey.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_PKEY_assign_RSA</span><span class="operator">(</span><span class="variable">$pkey</span><span class="operator">,</span> <span class="variable">$key</span><span class="operator">);</span>
 <span class="comment"># $pkey - value corresponding to openssl's EVP_PKEY structure</span>
 <span class="comment"># $key - value corresponding to openssl's RSA structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/EVP_PKEY_set1_RSA.html">http://www.openssl.org/docs/crypto/EVP_PKEY_set1_RSA.html</a></p>

</li>
<li><p>EVP_PKEY_bits</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns the size of the key $pkey in bits.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_PKEY_bits</span><span class="operator">(</span><span class="variable">$pkey</span><span class="operator">);</span>
 <span class="comment"># $pkey - value corresponding to openssl's EVP_PKEY structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: size in bits</span>
</code></code></pre>

</li>
<li><p>EVP_PKEY_size</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns the maximum size of a signature in bytes. The actual signature may be smaller.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_PKEY_size</span><span class="operator">(</span><span class="variable">$pkey</span><span class="operator">);</span>
 <span class="comment"># $pkey - value corresponding to openssl's EVP_PKEY structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: the maximum size in bytes</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/EVP_SignInit.html">http://www.openssl.org/docs/crypto/EVP_SignInit.html</a></p>

</li>
<li><p>EVP_PKEY_id</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-1.0.0</p>

<p>Returns $pkey type (integer value of corresponding NID).</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_PKEY_id</span><span class="operator">(</span><span class="variable">$pkey</span><span class="operator">);</span>
 <span class="comment"># $pkey - value corresponding to openssl's EVP_PKEY structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) key type</span>
</code></code></pre>

<p>Example:</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$pubkey</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_get_pubkey</span><span class="operator">(</span><span class="variable">$x509</span><span class="operator">);</span>
 <span class="keyword">my</span> <span class="variable">$type</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_PKEY_id</span><span class="operator">(</span><span class="variable">$pubkey</span><span class="operator">);</span>
 <span class="keyword">print</span> <span class="variable">Net::SSLeay::OBJ_nid2sn</span><span class="operator">(</span><span class="variable">$type</span><span class="operator">);</span>             <span class="comment">#prints e.g. 'rsaEncryption'</span>
</code></code></pre>

</li>
</ul>

<h3 id="Low-level-API:-PEM_-related-functions">Low level API: PEM_* related functions</h3>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/pem.html">http://www.openssl.org/docs/crypto/pem.html</a></p>

<ul>

<li><p>PEM_read_bio_X509</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Loads PEM formated X509 certificate via given BIO structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::PEM_read_bio_X509</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">);</span>
 <span class="comment"># $bio - value corresponding to openssl's BIO structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509 structure (0 on failure)</span>
</code></code></pre>

<p>Example:</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$bio</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_new_file</span><span class="operator">(</span><span class="variable">$filename</span><span class="operator">,</span> <span class="string">'r'</span><span class="operator">);</span>
 <span class="keyword">my</span> <span class="variable">$x509</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::PEM_read_bio_X509</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">);</span>
 <span class="variable">Net::SSLeay::BIO_free</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>PEM_read_bio_X509_REQ</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Loads PEM formated X509_REQ object via given BIO structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::PEM_read_bio_X509_REQ</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">,</span> <span class="variable">$x</span><span class="operator">=</span><span class="variable">NULL</span><span class="operator">,</span> <span class="variable">$cb</span><span class="operator">=</span><span class="variable">NULL</span><span class="operator">,</span> <span class="variable">$u</span><span class="operator">=</span><span class="variable">NULL</span><span class="operator">);</span>
 <span class="comment"># $bio - value corresponding to openssl's BIO structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_REQ structure (0 on failure)</span>
</code></code></pre>

<p>Example:</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$bio</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_new_file</span><span class="operator">(</span><span class="variable">$filename</span><span class="operator">,</span> <span class="string">'r'</span><span class="operator">);</span>
 <span class="keyword">my</span> <span class="variable">$x509_req</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::PEM_read_bio_X509_REQ</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">);</span>
 <span class="variable">Net::SSLeay::BIO_free</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>PEM_read_bio_DHparams</p>

<p>Reads DH structure from BIO.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::PEM_read_bio_DHparams</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">);</span>
 <span class="comment"># $bio - value corresponding to openssl's BIO structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's DH structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>PEM_read_bio_X509_CRL</p>

<p>Reads X509_CRL structure from BIO.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::PEM_read_bio_X509_CRL</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">);</span>
 <span class="comment"># $bio - value corresponding to openssl's BIO structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_CRL structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>PEM_read_bio_PrivateKey</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Loads PEM formated private key via given BIO structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::PEM_read_bio_PrivateKey</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">,</span> <span class="variable">$cb</span><span class="operator">,</span> <span class="variable">$data</span><span class="operator">);</span>
 <span class="comment"># $bio - value corresponding to openssl's BIO structure</span>
 <span class="comment"># $cb - reference to perl callback function</span>
 <span class="comment"># $data - data that will be passed to callback function (see examples below)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's EVP_PKEY structure (0 on failure)</span>
</code></code></pre>

<p>Example:</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$bio</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_new_file</span><span class="operator">(</span><span class="variable">$filename</span><span class="operator">,</span> <span class="string">'r'</span><span class="operator">);</span>
 <span class="keyword">my</span> <span class="variable">$privkey</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::PEM_read_bio_PrivateKey</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">);</span> <span class="comment">#ask for password if needed</span>
 <span class="variable">Net::SSLeay::BIO_free</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">);</span>
</code></code></pre>

<p>To use password you have the following options:</p>

<pre><code><code> <span class="variable">$privkey</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::PEM_read_bio_PrivateKey</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">,</span> <span class="operator">\&amp;</span><span class="variable">callback_func</span><span class="operator">);</span> <span class="comment"># use callback func for getting password</span>
 <span class="variable">$privkey</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::PEM_read_bio_PrivateKey</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">,</span> <span class="operator">\&amp;</span><span class="variable">callback_func</span><span class="operator">,</span> <span class="variable">$data</span><span class="operator">);</span> <span class="comment"># use callback_func + pass $data to callback_func</span>
 <span class="variable">$privkey</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::PEM_read_bio_PrivateKey</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">,</span> <span class="keyword">undef</span><span class="operator">,</span> <span class="string">"secret"</span><span class="operator">);</span> <span class="comment"># use password "secret"</span>
 <span class="variable">$privkey</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::PEM_read_bio_PrivateKey</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">,</span> <span class="keyword">undef</span><span class="operator">,</span> <span class="string">""</span><span class="operator">);</span>       <span class="comment"># use empty password</span>
</code></code></pre>

<p>Callback function signature:</p>

<pre><code><code> <span class="keyword">sub</span><span class="variable"> callback_func </span><span class="operator">{</span>
   <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$max_passwd_size</span><span class="operator">,</span> <span class="variable">$rwflag</span><span class="operator">,</span> <span class="variable">$data</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">@_</span><span class="operator">;</span>
   <span class="comment"># $max_passwd_size - maximum size of returned password (longer values will be discarded)</span>
   <span class="comment"># $rwflag - indicates whether we are loading (0) or storing (1) - for PEM_read_bio_PrivateKey always 0</span>
   <span class="comment"># $data - the data passed to PEM_read_bio_PrivateKey as 3rd parameter</span>
 
   <span class="keyword">return</span> <span class="string">"secret"</span><span class="operator">;</span>
 <span class="operator">}</span>
</code></code></pre>

</li>
<li><p>PEM_get_string_X509</p>

<p><b>NOTE:</b> Does not exactly correspond to any low level API function</p>

<p>Converts/exports X509 certificate to string (PEM format).</p>

<pre><code><code> <span class="variable">Net::SSLeay::PEM_get_string_X509</span><span class="operator">(</span><span class="variable">$x509</span><span class="operator">);</span>
 <span class="comment"># $x509 - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: string with $x509 in PEM format</span>
</code></code></pre>

</li>
<li><p>PEM_get_string_PrivateKey</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Converts public key $pk into PEM formated string (optionally protected with password).</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::PEM_get_string_PrivateKey</span><span class="operator">(</span><span class="variable">$pk</span><span class="operator">,</span> <span class="variable">$passwd</span><span class="operator">,</span> <span class="variable">$enc_alg</span><span class="operator">);</span>
 <span class="comment"># $pk - value corresponding to openssl's EVP_PKEY structure</span>
 <span class="comment"># $passwd - [optional] (string) password to use for key encryption</span>
 <span class="comment"># $enc_alg - [optional] algorithm to use for key encryption (default: DES_CBC) - value corresponding to openssl's EVP_CIPHER structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: PEM formated string</span>
</code></code></pre>

<p>Examples:</p>

<pre><code><code> <span class="variable">$pem_privkey</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::PEM_get_string_PrivateKey</span><span class="operator">(</span><span class="variable">$pk</span><span class="operator">);</span>
 <span class="variable">$pem_privkey</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::PEM_get_string_PrivateKey</span><span class="operator">(</span><span class="variable">$pk</span><span class="operator">,</span> <span class="string">"secret"</span><span class="operator">);</span>
 <span class="variable">$pem_privkey</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::PEM_get_string_PrivateKey</span><span class="operator">(</span><span class="variable">$pk</span><span class="operator">,</span> <span class="string">"secret"</span><span class="operator">,</span> <span class="variable">Net::SSLeay::EVP_get_cipherbyname</span><span class="operator">(</span><span class="string">"DES-EDE3-CBC"</span><span class="operator">));</span>
</code></code></pre>

</li>
<li><p>PEM_get_string_X509_CRL</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Converts X509_CRL object $x509_crl into PEM formated string.</p>

<pre><code><code> <span class="variable">Net::SSLeay::PEM_get_string_X509_CRL</span><span class="operator">(</span><span class="variable">$x509_crl</span><span class="operator">);</span>
 <span class="comment"># $x509_crl - value corresponding to openssl's X509_CRL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

</li>
<li><p>PEM_get_string_X509_REQ</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Converts X509_REQ object $x509_crl into PEM formated string.</p>

<pre><code><code> <span class="variable">Net::SSLeay::PEM_get_string_X509_REQ</span><span class="operator">(</span><span class="variable">$x509_req</span><span class="operator">);</span>
 <span class="comment"># $x509_req - value corresponding to openssl's X509_REQ structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

</li>
</ul>

<h3 id="Low-level-API:-d2i_-DER-format-related-functions">Low level API: d2i_* (DER format) related functions</h3>

<ul>

<li><p>d2i_X509_bio</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Loads DER formated X509 certificate via given BIO structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::d2i_X509_bio</span><span class="operator">(</span><span class="variable">$bp</span><span class="operator">);</span>
 <span class="comment"># $bp - value corresponding to openssl's BIO structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509 structure (0 on failure)</span>
</code></code></pre>

<p>Example:</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$bio</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_new_file</span><span class="operator">(</span><span class="variable">$filename</span><span class="operator">,</span> <span class="string">'rb'</span><span class="operator">);</span>
 <span class="keyword">my</span> <span class="variable">$x509</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::d2i_X509_bio</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">);</span>
 <span class="variable">Net::SSLeay::BIO_free</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">);</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/d2i_X509.html">http://www.openssl.org/docs/crypto/d2i_X509.html</a></p>

</li>
<li><p>d2i_X509_CRL_bio</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Loads DER formated X509_CRL object via given BIO structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::d2i_X509_CRL_bio</span><span class="operator">(</span><span class="variable">$bp</span><span class="operator">);</span>
 <span class="comment"># $bp - value corresponding to openssl's BIO structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_CRL structure (0 on failure)</span>
</code></code></pre>

<p>Example:</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$bio</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_new_file</span><span class="operator">(</span><span class="variable">$filename</span><span class="operator">,</span> <span class="string">'rb'</span><span class="operator">);</span>
 <span class="keyword">my</span> <span class="variable">$x509_crl</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::d2i_X509_CRL_bio</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">);</span>
 <span class="variable">Net::SSLeay::BIO_free</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>d2i_X509_REQ_bio</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Loads DER formated X509_REQ object via given BIO structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::d2i_X509_REQ_bio</span><span class="operator">(</span><span class="variable">$bp</span><span class="operator">);</span>
 <span class="comment"># $bp - value corresponding to openssl's BIO structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_REQ structure (0 on failure)</span>
</code></code></pre>

<p>Example:</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$bio</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_new_file</span><span class="operator">(</span><span class="variable">$filename</span><span class="operator">,</span> <span class="string">'rb'</span><span class="operator">);</span>
 <span class="keyword">my</span> <span class="variable">$x509_req</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::d2i_X509_REQ_bio</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">);</span>
 <span class="variable">Net::SSLeay::BIO_free</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">);</span>
</code></code></pre>

</li>
</ul>

<h3 id="Low-level-API:-PKCS12-related-functions">Low level API: PKCS12 related functions</h3>

<ul>

<li><p>P_PKCS12_load_file</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Loads X509 certificate + private key + certificates of CA chain (if present in PKCS12 file).</p>

<pre><code><code> <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$privkey</span><span class="operator">,</span> <span class="variable">$cert</span><span class="operator">,</span> <span class="variable">@cachain</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_PKCS12_load_file</span><span class="operator">(</span><span class="variable">$filename</span><span class="operator">,</span> <span class="variable">$load_chain</span><span class="operator">,</span> <span class="variable">$password</span><span class="operator">);</span>
 <span class="comment"># $filename - name of PKCS12 file</span>
 <span class="comment"># $load_chain - [optional] whether load (1) or not(0) CA chain (default: 0)</span>
 <span class="comment"># $password - [optional] password for private key</span>
 <span class="comment">#</span>
 <span class="comment"># returns: triplet ($privkey, $cert, @cachain)</span>
 <span class="comment">#          $privkey - value corresponding to openssl's EVP_PKEY structure</span>
 <span class="comment">#          $cert - value corresponding to openssl's X509 structure</span>
 <span class="comment">#          @cachain - array of values corresponding to openssl's X509 structure (empty if no CA chain in PKCS12)</span>
</code></code></pre>

<p><b>IMPORTANT NOTE:</b> after you do the job you need to call X509_free() on $privkey + all members of @cachain and EVP_PKEY_free() on $privkey.</p>

<p>Examples:</p>

<pre><code><code> <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$privkey</span><span class="operator">,</span> <span class="variable">$cert</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_PKCS12_load_file</span><span class="operator">(</span><span class="variable">$filename</span><span class="operator">);</span>
 <span class="comment">#or</span>
 <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$privkey</span><span class="operator">,</span> <span class="variable">$cert</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_PKCS12_load_file</span><span class="operator">(</span><span class="variable">$filename</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="variable">$password</span><span class="operator">);</span>
 <span class="comment">#or</span>
 <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$privkey</span><span class="operator">,</span> <span class="variable">$cert</span><span class="operator">,</span> <span class="variable">@cachain</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_PKCS12_load_file</span><span class="operator">(</span><span class="variable">$filename</span><span class="operator">,</span> <span class="number">1</span><span class="operator">);</span>
 <span class="comment">#or</span>
 <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$privkey</span><span class="operator">,</span> <span class="variable">$cert</span><span class="operator">,</span> <span class="variable">@cachain</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_PKCS12_load_file</span><span class="operator">(</span><span class="variable">$filename</span><span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="variable">$password</span><span class="operator">);</span>
 
 <span class="comment">#BEWARE: THIS IS WRONG - MEMORY LEAKS! (you cannot free @cachain items)</span>
 <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$privkey</span><span class="operator">,</span> <span class="variable">$cert</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_PKCS12_load_file</span><span class="operator">(</span><span class="variable">$filename</span><span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="variable">$password</span><span class="operator">);</span>
</code></code></pre>

</li>
</ul>

<h3 id="Low-level-API:-SESSION_-related-functions">Low level API: SESSION_* related functions</h3>

<ul>

<li><p>d2i_SSL_SESSION</p>

<p>Transforms the external ASN1 representation of an SSL/TLS session, stored as binary data at location pp with length length, into an SSL_SESSION object.</p>

<p>??? (does this function really work?)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::d2i_SSL_SESSION</span><span class="operator">(</span><span class="variable">$a</span><span class="operator">,</span> <span class="variable">$pp</span><span class="operator">,</span> <span class="variable">$length</span><span class="operator">);</span>
 <span class="comment"># $a - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment"># $pp - pointer/buffer ???</span>
 <span class="comment"># $length - ???</span>
 <span class="comment">#</span>
 <span class="comment"># returns: ???</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/d2i_SSL_SESSION.html">http://www.openssl.org/docs/ssl/d2i_SSL_SESSION.html</a></p>

</li>
<li><p>i2d_SSL_SESSION</p>

<p>Transforms the SSL_SESSION object in into the ASN1 representation and stores it into the memory location pointed to by pp. The length of the resulting ASN1 representation is returned.</p>

<p>??? (does this function really work?)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::i2d_SSL_SESSION</span><span class="operator">(</span><span class="variable">$in</span><span class="operator">,</span> <span class="variable">$pp</span><span class="operator">);</span>
 <span class="comment"># $in - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment"># $pp - pointer/data ???</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/d2i_SSL_SESSION.html">http://www.openssl.org/docs/ssl/d2i_SSL_SESSION.html</a></p>

</li>
<li><p>SESSION_new</p>

<p>Creates a new SSL_SESSION structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SESSION_new</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's SSL_SESSION structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>SESSION_free</p>

<p>Free an allocated SSL_SESSION structure.</p>

<pre><code><code> <span class="variable">Net::SSLeay::SESSION_free</span><span class="operator">(</span><span class="variable">$ses</span><span class="operator">);</span>
 <span class="comment"># $ses - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_SESSION_free.html">http://www.openssl.org/docs/ssl/SSL_SESSION_free.html</a></p>

</li>
<li><p>SESSION_cmp</p>

<p>Compare two SSL_SESSION structures.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SESSION_cmp</span><span class="operator">(</span><span class="variable">$sesa</span><span class="operator">,</span> <span class="variable">$sesb</span><span class="operator">);</span>
 <span class="comment"># $sesa - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment"># $sesb - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 0 if the two structures are the same</span>
</code></code></pre>

<p><b>NOTE:</b> Not available in openssl 1.0 or later</p>

</li>
<li><p>SESSION_get_app_data</p>

<p>Can be used to get application defined value/data.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SESSION_get_app_data</span><span class="operator">(</span><span class="variable">$ses</span><span class="operator">);</span>
 <span class="comment"># $ses - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: string/buffer/pointer ???</span>
</code></code></pre>

</li>
<li><p>SESSION_set_app_data</p>

<p>Can be used to set some application defined value/data.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SESSION_set_app_data</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">,</span> <span class="variable">$a</span><span class="operator">);</span>
 <span class="comment"># $s - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment"># $a - (string/buffer/pointer ???) data</span>
 <span class="comment">#</span>
 <span class="comment"># returns: ???</span>
</code></code></pre>

</li>
<li><p>SESSION_get_ex_data</p>

<p>Is used to retrieve the information for $idx from session $ses.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SESSION_get_ex_data</span><span class="operator">(</span><span class="variable">$ses</span><span class="operator">,</span> <span class="variable">$idx</span><span class="operator">);</span>
 <span class="comment"># $ses - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment"># $idx - (integer) index for application specific data</span>
 <span class="comment">#</span>
 <span class="comment"># returns: pointer to ???</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_SESSION_get_ex_new_index.html">http://www.openssl.org/docs/ssl/SSL_SESSION_get_ex_new_index.html</a></p>

</li>
<li><p>SESSION_set_ex_data</p>

<p>Is used to store application data at arg for idx into the session object.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SESSION_set_ex_data</span><span class="operator">(</span><span class="variable">$ss</span><span class="operator">,</span> <span class="variable">$idx</span><span class="operator">,</span> <span class="variable">$data</span><span class="operator">);</span>
 <span class="comment"># $ss - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment"># $idx - (integer) ???</span>
 <span class="comment"># $data - (pointer) ???</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_SESSION_get_ex_new_index.html">http://www.openssl.org/docs/ssl/SSL_SESSION_get_ex_new_index.html</a></p>

</li>
<li><p>SESSION_get_ex_new_index</p>

<p>Is used to register a new index for application specific data.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SESSION_get_ex_new_index</span><span class="operator">(</span><span class="variable">$argl</span><span class="operator">,</span> <span class="variable">$argp</span><span class="operator">,</span> <span class="variable">$new_func</span><span class="operator">,</span> <span class="variable">$dup_func</span><span class="operator">,</span> <span class="variable">$free_func</span><span class="operator">);</span>
 <span class="comment"># $argl - (long) ???</span>
 <span class="comment"># $argp - (pointer) ???</span>
 <span class="comment"># $new_func - function pointer ??? (CRYPTO_EX_new *)</span>
 <span class="comment"># $dup_func - function pointer ??? (CRYPTO_EX_dup *)</span>
 <span class="comment"># $free_func - function pointer ??? (CRYPTO_EX_free *)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) ???</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_SESSION_get_ex_new_index.html">http://www.openssl.org/docs/ssl/SSL_SESSION_get_ex_new_index.html</a></p>

</li>
<li><p>SESSION_get_master_key</p>

<p><b>NOTE:</b> Does not exactly correspond to any low level API function</p>

<p>Returns &#39;master_key&#39; value from SSL_SESSION structure $s</p>

<pre><code><code> <span class="variable">Net::SSLeay::SESSION_get_master_key</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">);</span>
 <span class="comment"># $s - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: master key (binary data)</span>
</code></code></pre>

</li>
<li><p>SESSION_set_master_key</p>

<p>Sets &#39;master_key&#39; value for SSL_SESSION structure $s</p>

<pre><code><code> <span class="variable">Net::SSLeay::SESSION_set_master_key</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">,</span> <span class="variable">$key</span><span class="operator">);</span>
 <span class="comment"># $s - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment"># $key - master key (binary data)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

</li>
<li><p>SESSION_get_time</p>

<p>Returns the time at which the session s was established. The time is given in seconds since 1.1.1970.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SESSION_get_time</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">);</span>
 <span class="comment"># $s - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: timestamp (seconds since 1.1.1970)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_SESSION_get_time.html">http://www.openssl.org/docs/ssl/SSL_SESSION_get_time.html</a></p>

</li>
<li><p>get_time</p>

<p>Technically the same functionality as <a href="#SESSION_get_time">&quot;SESSION_get_time&quot;</a>.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_time</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>SESSION_get_timeout</p>

<p>Returns the timeout value set for session $s in seconds.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SESSION_get_timeout</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">);</span>
 <span class="comment"># $s - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: timeout (in seconds)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_SESSION_get_time.html">http://www.openssl.org/docs/ssl/SSL_SESSION_get_time.html</a></p>

</li>
<li><p>get_timeout</p>

<p>Technically the same functionality as <a href="#SESSION_get_timeout">&quot;SESSION_get_timeout&quot;</a>.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_timeout</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>SESSION_print</p>

<p><b>NOTE:</b> Does not exactly correspond to any low level API function</p>

<p>Prints session details (e.g. protocol version, ciprher, session-id ...) to BIO.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SESSION_print</span><span class="operator">(</span><span class="variable">$fp</span><span class="operator">,</span> <span class="variable">$ses</span><span class="operator">);</span>
 <span class="comment"># $fp - value corresponding to openssl's BIO structure</span>
 <span class="comment"># $ses - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>You have to use necessary BIO functions like this:</p>

<pre><code><code> <span class="comment"># let us have $ssl corresponding to openssl's SSL structure</span>
 <span class="keyword">my</span> <span class="variable">$ses</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_session</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="keyword">my</span> <span class="variable">$bio</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_new</span><span class="operator">(&amp;</span><span class="variable">Net::SSLeay::BIO_s_mem</span><span class="operator">);</span>
 <span class="variable">Net::SSLeay::SESSION_print</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">,</span> <span class="variable">$ses</span><span class="operator">);</span>
 <span class="keyword">print</span> <span class="variable">Net::SSLeay::BIO_read</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>SESSION_print_fp</p>

<p>Prints session details (e.g. protocol version, ciprher, session-id ...) to file handle.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SESSION_print_fp</span><span class="operator">(</span><span class="variable">$fp</span><span class="operator">,</span> <span class="variable">$ses</span><span class="operator">);</span>
 <span class="comment"># $fp - perl file handle</span>
 <span class="comment"># $ses - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Example:</p>

<pre><code><code> <span class="comment"># let us have $ssl corresponding to openssl's SSL structure</span>
 <span class="keyword">my</span> <span class="variable">$ses</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_session</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="keyword">open</span> <span class="keyword">my</span> <span class="variable">$fh</span><span class="operator">,</span> <span class="string">"&gt;"</span><span class="operator">,</span> <span class="string">"output.txt"</span><span class="operator">;</span>
 <span class="variable">Net::SSLeay::SESSION_print_fp</span><span class="operator">(</span><span class="variable">$fh</span><span class="operator">,</span><span class="variable">$ses</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>SESSION_set_time</p>

<p>Replaces the creation time of the session s with the chosen value $t (seconds since 1.1.1970).</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SESSION_set_time</span><span class="operator">(</span><span class="variable">$ses</span><span class="operator">,</span> <span class="variable">$t</span><span class="operator">);</span>
 <span class="comment"># $ses - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment"># $t - time value</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_SESSION_get_time.html">http://www.openssl.org/docs/ssl/SSL_SESSION_get_time.html</a></p>

</li>
<li><p>set_time</p>

<p>Technically the same functionality as <a href="#SESSION_set_time">&quot;SESSION_set_time&quot;</a>.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set_time</span><span class="operator">(</span><span class="variable">$ses</span><span class="operator">,</span> <span class="variable">$t</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>SESSION_set_timeout</p>

<p>Sets the timeout value for session s in seconds to $t.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SESSION_set_timeout</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">,</span> <span class="variable">$t</span><span class="operator">);</span>
 <span class="comment"># $s - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment"># $t - timeout (in seconds)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_SESSION_get_time.html">http://www.openssl.org/docs/ssl/SSL_SESSION_get_time.html</a></p>

</li>
<li><p>set_timeout</p>

<p>Technically the same functionality as <a href="#SESSION_set_timeout">&quot;SESSION_set_timeout&quot;</a>.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set_timeout</span><span class="operator">(</span><span class="variable">$ses</span><span class="operator">,</span> <span class="variable">$t</span><span class="operator">);</span>
</code></code></pre>

</li>
</ul>

<h3 id="Low-level-API:-SSL_CTX_-related-functions">Low level API: SSL_CTX_* related functions</h3>

<p><b>NOTE:</b> Please note that the function described in this chapter have &quot;SSL_&quot; part stripped from their original openssl names.</p>

<ul>

<li><p>CTX_add_client_CA</p>

<p>Adds the CA name extracted from $cacert to the list of CAs sent to the client when requesting a client certificate for $ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_add_client_CA</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$cacert</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $cacert - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_client_CA_list.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_client_CA_list.html</a></p>

</li>
<li><p>CTX_add_extra_chain_cert</p>

<p>Adds the certificate $x509 to the certificate chain presented together with the certificate. Several certificates can be added one after the other.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_add_extra_chain_cert</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$x509</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $x509 - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, check out the error stack to find out the reason for failure otherwise</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_add_extra_chain_cert.html">http://www.openssl.org/docs/ssl/SSL_CTX_add_extra_chain_cert.html</a></p>

</li>
<li><p>CTX_add_session</p>

<p>Adds the session $ses to the context $ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_add_session</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$ses</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $ses - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_add_session.html">http://www.openssl.org/docs/ssl/SSL_CTX_add_session.html</a></p>

</li>
<li><p>CTX_callback_ctrl</p>

<p>??? (more info needed)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_callback_ctrl</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$cmd</span><span class="operator">,</span> <span class="variable">$fp</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $cmd - (integer) command id</span>
 <span class="comment"># $fp - (function pointer) ???</span>
 <span class="comment">#</span>
 <span class="comment"># returns: ???</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_ctrl.html">http://www.openssl.org/docs/ssl/SSL_CTX_ctrl.html</a></p>

</li>
<li><p>CTX_check_private_key</p>

<p>Checks the consistency of a private key with the corresponding certificate loaded into $ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_check_private_key</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, otherwise check out the error stack to find out the reason</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html">http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html</a></p>

</li>
<li><p>CTX_ctrl</p>

<p>Internal handling function for SSL_CTX objects.</p>

<p><b>BEWARE:</b> openssl doc says: This function should never be called directly!</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_ctrl</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$cmd</span><span class="operator">,</span> <span class="variable">$larg</span><span class="operator">,</span> <span class="variable">$parg</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $cmd - (integer) command id</span>
 <span class="comment"># $larg - (integer) long ???</span>
 <span class="comment"># $parg - (string/pointer) ???</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (long) result of given command ???</span>
 
 <span class="comment">#valid $cmd values</span>
  <span class="number">1</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_NEED_TMP_RSA</span>
  <span class="number">2</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TMP_RSA</span>
  <span class="number">3</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TMP_DH</span>
  <span class="number">4</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TMP_ECDH</span>
  <span class="number">5</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TMP_RSA_CB</span>
  <span class="number">6</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TMP_DH_CB</span>
  <span class="number">7</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TMP_ECDH_CB</span>
  <span class="number">8</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_GET_SESSION_REUSED</span>
  <span class="number">9</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_GET_CLIENT_CERT_REQUEST</span>
 <span class="number">10</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_GET_NUM_RENEGOTIATIONS</span>
 <span class="number">11</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_CLEAR_NUM_RENEGOTIATIONS</span>
 <span class="number">12</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_GET_TOTAL_RENEGOTIATIONS</span>
 <span class="number">13</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_GET_FLAGS</span>
 <span class="number">14</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_EXTRA_CHAIN_CERT</span>
 <span class="number">15</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_MSG_CALLBACK</span>
 <span class="number">16</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_MSG_CALLBACK_ARG</span>
 <span class="number">17</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_MTU</span>
 <span class="number">20</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SESS_NUMBER</span>
 <span class="number">21</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SESS_CONNECT</span>
 <span class="number">22</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SESS_CONNECT_GOOD</span>
 <span class="number">23</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SESS_CONNECT_RENEGOTIATE</span>
 <span class="number">24</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SESS_ACCEPT</span>
 <span class="number">25</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SESS_ACCEPT_GOOD</span>
 <span class="number">26</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SESS_ACCEPT_RENEGOTIATE</span>
 <span class="number">27</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SESS_HIT</span>
 <span class="number">28</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SESS_CB_HIT</span>
 <span class="number">29</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SESS_MISSES</span>
 <span class="number">30</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SESS_TIMEOUTS</span>
 <span class="number">31</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SESS_CACHE_FULL</span>
 <span class="number">32</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_OPTIONS</span>
 <span class="number">33</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_MODE</span>
 <span class="number">40</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_GET_READ_AHEAD</span>
 <span class="number">41</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_READ_AHEAD</span>
 <span class="number">42</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_SESS_CACHE_SIZE</span>
 <span class="number">43</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_GET_SESS_CACHE_SIZE</span>
 <span class="number">44</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_SESS_CACHE_MODE</span>
 <span class="number">45</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_GET_SESS_CACHE_MODE</span>
 <span class="number">50</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_GET_MAX_CERT_LIST</span>
 <span class="number">51</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_MAX_CERT_LIST</span>
 <span class="number">52</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_MAX_SEND_FRAGMENT</span>
 <span class="number">53</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TLSEXT_SERVERNAME_CB</span>
 <span class="number">54</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TLSEXT_SERVERNAME_ARG</span>
 <span class="number">55</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TLSEXT_HOSTNAME</span>
 <span class="number">56</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TLSEXT_DEBUG_CB</span>
 <span class="number">57</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TLSEXT_DEBUG_ARG</span>
 <span class="number">58</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_GET_TLSEXT_TICKET_KEYS</span>
 <span class="number">59</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TLSEXT_TICKET_KEYS</span>
 <span class="number">60</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TLSEXT_OPAQUE_PRF_INPUT</span>
 <span class="number">61</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TLSEXT_OPAQUE_PRF_INPUT_CB</span>
 <span class="number">62</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TLSEXT_OPAQUE_PRF_INPUT_CB_ARG</span>
 <span class="number">63</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TLSEXT_STATUS_REQ_CB</span>
 <span class="number">64</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TLSEXT_STATUS_REQ_CB_ARG</span>
 <span class="number">65</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TLSEXT_STATUS_REQ_TYPE</span>
 <span class="number">66</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_GET_TLSEXT_STATUS_REQ_EXTS</span>
 <span class="number">67</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TLSEXT_STATUS_REQ_EXTS</span>
 <span class="number">68</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_GET_TLSEXT_STATUS_REQ_IDS</span>
 <span class="number">69</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TLSEXT_STATUS_REQ_IDS</span>
 <span class="number">70</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_GET_TLSEXT_STATUS_REQ_OCSP_RESP</span>
 <span class="number">71</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TLSEXT_STATUS_REQ_OCSP_RESP</span>
 <span class="number">72</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_SET_TLSEXT_TICKET_KEY_CB</span>
 <span class="number">73</span> <span class="operator">-</span> <span class="variable">DTLS_CTRL_GET_TIMEOUT</span>
 <span class="number">74</span> <span class="operator">-</span> <span class="variable">DTLS_CTRL_HANDLE_TIMEOUT</span>
 <span class="number">75</span> <span class="operator">-</span> <span class="variable">DTLS_CTRL_LISTEN</span>
 <span class="number">76</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_GET_RI_SUPPORT</span>
 <span class="number">77</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_CLEAR_OPTIONS</span>
 <span class="number">78</span> <span class="operator">-</span> <span class="variable">SSL_CTRL_CLEAR_MODE</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_ctrl.html">http://www.openssl.org/docs/ssl/SSL_CTX_ctrl.html</a></p>

</li>
<li><p>CTX_flush_sessions</p>

<p>Causes a run through the session cache of $ctx to remove sessions expired at time $tm.</p>

<pre><code><code> <span class="variable">Net::SSLeay::CTX_flush_sessions</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$tm</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $tm - specifies the time which should be used for the expiration test (seconds since 1.1.1970)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_flush_sessions.html">http://www.openssl.org/docs/ssl/SSL_CTX_flush_sessions.html</a></p>

</li>
<li><p>CTX_free</p>

<p>Free an allocated SSL_CTX object.</p>

<pre><code><code> <span class="variable">Net::SSLeay::CTX_free</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_free.html">http://www.openssl.org/docs/ssl/SSL_CTX_free.html</a></p>

</li>
<li><p>CTX_get_app_data</p>

<p>Can be used to get application defined value/data.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_get_app_data</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: string/buffer/pointer ???</span>
</code></code></pre>

</li>
<li><p>CTX_set_app_data</p>

<p>Can be used to set some application defined value/data.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_set_app_data</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$arg</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $arg - (string/buffer/pointer ???) data</span>
 <span class="comment">#</span>
 <span class="comment"># returns: ???</span>
</code></code></pre>

</li>
<li><p>CTX_get_cert_store</p>

<p>Returns the current certificate verification storage.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_get_cert_store</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_STORE structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_cert_store.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_cert_store.html</a></p>

</li>
<li><p>CTX_get_client_CA_list</p>

<p>Returns the list of client CAs explicitly set for $ctx using <a href="#CTX_set_client_CA_list">&quot;CTX_set_client_CA_list&quot;</a>.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_get_client_CA_list</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_NAME_STACK structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_get_client_CA_list.html">http://www.openssl.org/docs/ssl/SSL_get_client_CA_list.html</a></p>

</li>
<li><p>CTX_get_ex_data</p>

<p>Is used to retrieve the information for index $idx from $ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_get_ex_data</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$idx</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $idx - (integer) index for application specific data</span>
 <span class="comment">#</span>
 <span class="comment"># returns: pointer to ???</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_get_ex_new_index.html">http://www.openssl.org/docs/ssl/SSL_CTX_get_ex_new_index.html</a></p>

</li>
<li><p>CTX_get_ex_new_index</p>

<p>Is used to register a new index for application specific data.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_get_ex_new_index</span><span class="operator">(</span><span class="variable">$argl</span><span class="operator">,</span> <span class="variable">$argp</span><span class="operator">,</span> <span class="variable">$new_func</span><span class="operator">,</span> <span class="variable">$dup_func</span><span class="operator">,</span> <span class="variable">$free_func</span><span class="operator">);</span>
 <span class="comment"># $argl - (long) ???</span>
 <span class="comment"># $argp - (pointer) ???</span>
 <span class="comment"># $new_func - function pointer ??? (CRYPTO_EX_new *)</span>
 <span class="comment"># $dup_func - function pointer ??? (CRYPTO_EX_dup *)</span>
 <span class="comment"># $free_func - function pointer ??? (CRYPTO_EX_free *)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) ???</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_get_ex_new_index.html">http://www.openssl.org/docs/ssl/SSL_CTX_get_ex_new_index.html</a></p>

</li>
<li><p>CTX_get_mode</p>

<p>Returns the mode set for ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_get_mode</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: mode (bitmask)</span>
 
 <span class="comment">#to decode the return value (bitmask) use:</span>
 <span class="number">0x00000001</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_MODE_ENABLE_PARTIAL_WRITE</span>
 <span class="number">0x00000002</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_MODE_ACCEPT_MOVING_WRITE_BUFFER</span>
 <span class="number">0x00000004</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_MODE_AUTO_RETRY</span>
 <span class="number">0x00000008</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_MODE_NO_AUTO_CHAIN</span>
 <span class="number">0x00000010</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_MODE_RELEASE_BUFFERS</span>
 <span class="operator">(</span><span class="variable">note</span><span class="operator">:</span> <span class="variable">some</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">bits</span> <span class="variable">might</span> <span class="keyword">not</span> <span class="variable">be</span> <span class="variable">supported</span> <span class="variable">by</span> <span class="variable">older</span> <span class="variable">openssl</span> <span class="variable">versions</span><span class="operator">)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_mode.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_mode.html</a></p>

</li>
<li><p>CTX_set_mode</p>

<p>Adds the mode set via bitmask in $mode to $ctx. Options already set before are not cleared.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_set_mode</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$mode</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $mode - mode bitmask</span>
 <span class="comment">#</span>
 <span class="comment"># returns: the new mode bitmask after adding $mode</span>
</code></code></pre>

<p>For bitmask details see <a href="#CTX_get_mode">&quot;CTX_get_mode&quot;</a> (above).</p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_mode.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_mode.html</a></p>

</li>
<li><p>CTX_get_options</p>

<p>Returns the options (bitmask) set for $ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_get_options</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: options (bitmask)</span>
 
 <span class="comment">#to decode the return value (bitmask) use:</span>
 <span class="number">0x00000001</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_MICROSOFT_SESS_ID_BUG</span>
 <span class="number">0x00000002</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_NETSCAPE_CHALLENGE_BUG</span>
 <span class="number">0x00000004</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_LEGACY_SERVER_CONNECT</span>
 <span class="number">0x00000008</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG</span>
 <span class="number">0x00000010</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG</span>
 <span class="number">0x00000020</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER</span>
 <span class="number">0x00000040</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_MSIE_SSLV2_RSA_PADDING</span>
 <span class="number">0x00000080</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_SSLEAY_080_CLIENT_DH_BUG</span>
 <span class="number">0x00000100</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_TLS_D5_BUG</span>
 <span class="number">0x00000200</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_TLS_BLOCK_PADDING_BUG</span>
 <span class="number">0x00000800</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS</span>
 <span class="number">0x80000FFF</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_ALL</span>
 <span class="number">0x00001000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_NO_QUERY_MTU</span>
 <span class="number">0x00002000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_COOKIE_EXCHANGE</span>
 <span class="number">0x00004000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_NO_TICKET</span>
 <span class="number">0x00008000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_CISCO_ANYCONNECT</span>
 <span class="number">0x00010000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION</span>
 <span class="number">0x00020000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_NO_COMPRESSION</span>
 <span class="number">0x00040000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION</span>
 <span class="number">0x00080000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_SINGLE_ECDH_USE</span>
 <span class="number">0x00100000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_SINGLE_DH_USE</span>
 <span class="number">0x00200000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_EPHEMERAL_RSA</span>
 <span class="number">0x00400000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_CIPHER_SERVER_PREFERENCE</span>
 <span class="number">0x00800000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_TLS_ROLLBACK_BUG</span>
 <span class="number">0x01000000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_NO_SSLv2</span>
 <span class="number">0x02000000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_NO_SSLv3</span>
 <span class="number">0x04000000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_NO_TLSv1</span>
 <span class="number">0x08000000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_PKCS1_CHECK_1</span>
 <span class="number">0x10000000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_PKCS1_CHECK_2</span>
 <span class="number">0x20000000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_NETSCAPE_CA_DN_BUG</span>
 <span class="number">0x40000000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG</span>
 <span class="number">0x80000000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_OP_CRYPTOPRO_TLSEXT_BUG</span>
 <span class="operator">(</span><span class="variable">note</span><span class="operator">:</span> <span class="variable">some</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">bits</span> <span class="variable">might</span> <span class="keyword">not</span> <span class="variable">be</span> <span class="variable">supported</span> <span class="variable">by</span> <span class="variable">older</span> <span class="variable">openssl</span> <span class="variable">versions</span><span class="operator">)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_options.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_options.html</a></p>

</li>
<li><p>CTX_set_options</p>

<p>Adds the options set via bitmask in $options to ctx. Options already set before are not cleared.</p>

<pre><code><code> <span class="variable">Net::SSLeay::CTX_set_options</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$options</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $options - options bitmask</span>
 <span class="comment">#</span>
 <span class="comment"># returns: the new options bitmask after adding $options</span>
</code></code></pre>

<p>For bitmask details see <a href="#CTX_get_options">&quot;CTX_get_options&quot;</a> (above).</p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_options.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_options.html</a></p>

</li>
<li><p>CTX_get_quiet_shutdown</p>

<p>Returns the &#39;quiet shutdown&#39; setting of $ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_get_quiet_shutdown</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) the current setting</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_quiet_shutdown.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_quiet_shutdown.html</a></p>

</li>
<li><p>CTX_get_read_ahead</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_get_read_ahead</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) read_ahead value</span>
</code></code></pre>

</li>
<li><p>CTX_get_session_cache_mode</p>

<p>Returns the currently used cache mode (bitmask).</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_get_session_cache_mode</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: mode (bitmask)</span>
 
 <span class="comment">#to decode the return value (bitmask) use:</span>
 <span class="number">0x0000</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_SESS_CACHE_OFF</span>
 <span class="number">0x0001</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_SESS_CACHE_CLIENT</span>
 <span class="number">0x0002</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_SESS_CACHE_SERVER</span>
 <span class="number">0x0080</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_SESS_CACHE_NO_AUTO_CLEAR</span>
 <span class="number">0x0100</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_SESS_CACHE_NO_INTERNAL_LOOKUP</span>
 <span class="number">0x0200</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_SESS_CACHE_NO_INTERNAL_STORE</span>
 <span class="operator">(</span><span class="variable">note</span><span class="operator">:</span> <span class="variable">some</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">bits</span> <span class="variable">might</span> <span class="keyword">not</span> <span class="variable">be</span> <span class="variable">supported</span> <span class="variable">by</span> <span class="variable">older</span> <span class="variable">openssl</span> <span class="variable">versions</span><span class="operator">)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_session_cache_mode.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_session_cache_mode.html</a></p>

</li>
<li><p>CTX_set_session_cache_mode</p>

<p>Enables/disables session caching by setting the operational mode for $ctx to $mode.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_set_session_cache_mode</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$mode</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $mode - mode (bitmask)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: previously set cache mode</span>
</code></code></pre>

<p>For bitmask details see <a href="#CTX_get_session_cache_mode">&quot;CTX_get_session_cache_mode&quot;</a> (above).</p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_session_cache_mode.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_session_cache_mode.html</a></p>

</li>
<li><p>CTX_get_timeout</p>

<p>Returns the currently set timeout value for $ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_get_timeout</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: timeout in seconds</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_timeout.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_timeout.html</a></p>

</li>
<li><p>CTX_get_verify_depth</p>

<p>Returns the verification depth limit currently set in $ctx. If no limit has been explicitly set, -1 is returned and the default value will be used.&quot;,</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_get_verify_depth</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: depth limit currently set in $ctx, -1 if no limit has been explicitly set</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_get_verify_mode.html">http://www.openssl.org/docs/ssl/SSL_CTX_get_verify_mode.html</a></p>

</li>
<li><p>CTX_get_verify_mode</p>

<p>Returns the verification mode (bitmask) currently set in $ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_get_verify_mode</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: mode (bitmask)</span>
 
 <span class="comment">#to decode the return value (bitmask) use:</span>
 <span class="number">0x00</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_VERIFY_NONE</span>
 <span class="number">0x01</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_VERIFY_PEER</span>
 <span class="number">0x02</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_VERIFY_FAIL_IF_NO_PEER_CERT</span>
 <span class="number">0x04</span> <span class="variable">corresponds</span> <span class="variable">to</span> <span class="variable">SSL_VERIFY_CLIENT_ONCE</span>
 <span class="operator">(</span><span class="variable">note</span><span class="operator">:</span> <span class="variable">some</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">bits</span> <span class="variable">might</span> <span class="keyword">not</span> <span class="variable">be</span> <span class="variable">supported</span> <span class="variable">by</span> <span class="variable">older</span> <span class="variable">openssl</span> <span class="variable">versions</span><span class="operator">)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_get_verify_mode.html">http://www.openssl.org/docs/ssl/SSL_CTX_get_verify_mode.html</a></p>

</li>
<li><p>CTX_set_verify</p>

<p>Sets the verification flags for $ctx to be $mode and specifies the verify_callback function to be used.</p>

<pre><code><code> <span class="variable">Net::SSLeay::CTX_set_verify</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$mode</span><span class="operator">,</span> <span class="variable">$callback</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $mode - mode (bitmask)</span>
 <span class="comment"># $callback - [optional] reference to perl callback function</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>For bitmask details see <a href="#CTX_get_verify_mode">&quot;CTX_get_verify_mode&quot;</a> (above).</p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_verify.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_verify.html</a></p>

</li>
<li><p>CTX_load_verify_locations</p>

<p>Specifies the locations for $ctx, at which CA certificates for verification purposes are located. The certificates available via $CAfile and $CApath are trusted.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_load_verify_locations</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$CAfile</span><span class="operator">,</span> <span class="variable">$CApath</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $CAfile - (string) file of CA certificates in PEM format, the file can contain several CA certificates (or '')</span>
 <span class="comment"># $CApath - (string) directory containing CA certificates in PEM format (or '')</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure (check the error stack to find out the reason)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_load_verify_locations.html">http://www.openssl.org/docs/ssl/SSL_CTX_load_verify_locations.html</a></p>

</li>
<li><p>CTX_need_tmp_RSA</p>

<p>Return the result of <code><code>SSL_CTX_ctrl(ctx,SSL_CTRL_NEED_TMP_RSA,0,NULL)</code></code></p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_need_tmp_RSA</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: result of SSL_CTRL_NEED_TMP_RSA command</span>
</code></code></pre>

</li>
<li><p>CTX_new</p>

<p>The same as <a href="#CTX_v23_new">&quot;CTX_v23_new&quot;</a></p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_new</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's SSL_CTX structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_new.html">http://www.openssl.org/docs/ssl/SSL_CTX_new.html</a></p>

</li>
<li><p>CTX_v2_new</p>

<p>Creates a new SSL_CTX object - based on SSLv2_method() - as framework to establish TLS/SSL enabled connections.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_v2_new</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's SSL_CTX structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>CTX_v23_new</p>

<p>Creates a new SSL_CTX object - based on SSLv23_method() - as framework to establish TLS/SSL enabled connections.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_v23_new</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's SSL_CTX structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>CTX_v3_new</p>

<p>Creates a new SSL_CTX object - based on SSLv3_method() - as framework to establish TLS/SSL enabled connections.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_v3_new</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's SSL_CTX structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>CTX_tlsv1_new</p>

<p>Creates a new SSL_CTX object - based on TLSv1_method() - as framework to establish TLS/SSL enabled connections.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_tlsv1_new</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's SSL_CTX structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>CTX_new_with_method</p>

<p>Creates a new SSL_CTX object based on $meth method</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_new_with_method</span><span class="operator">(</span><span class="variable">$meth</span><span class="operator">);</span>
 <span class="comment"># $meth - value corresponding to openssl's SSL_METHOD structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's SSL_CTX structure (0 on failure)</span>
 
 <span class="comment">#example</span>
 <span class="keyword">my</span> <span class="variable">$ctx</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_new_with_method</span><span class="operator">(&amp;</span><span class="variable">Net::SSLeay::TLSv1_method</span><span class="operator">);</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_new.html">http://www.openssl.org/docs/ssl/SSL_CTX_new.html</a></p>

</li>
<li><p>CTX_remove_session</p>

<p>Removes the session $ses from the context $ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_remove_session</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$ses</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $ses - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_add_session.html">http://www.openssl.org/docs/ssl/SSL_CTX_add_session.html</a></p>

</li>
<li><p>CTX_sess_accept</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_sess_accept</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: number of started SSL/TLS handshakes in server mode</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html">http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html</a></p>

</li>
<li><p>CTX_sess_accept_good</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_sess_accept_good</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: number of successfully established SSL/TLS sessions in server mode</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html">http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html</a></p>

</li>
<li><p>CTX_sess_accept_renegotiate</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_sess_accept_renegotiate</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: number of start renegotiations in server mode</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html">http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html</a></p>

</li>
<li><p>CTX_sess_cache_full</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_sess_cache_full</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: number of sessions that were removed because the maximum session cache size was exceeded</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html">http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html</a></p>

</li>
<li><p>CTX_sess_cb_hits</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_sess_cb_hits</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: number of successfully retrieved sessions from the external session cache in server mode</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html">http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html</a></p>

</li>
<li><p>CTX_sess_connect</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_sess_connect</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: number of started SSL/TLS handshakes in client mode</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html">http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html</a></p>

</li>
<li><p>CTX_sess_connect_good</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_sess_connect_good</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: number of successfully established SSL/TLS sessions in client mode</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html">http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html</a></p>

</li>
<li><p>CTX_sess_connect_renegotiate</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_sess_connect_renegotiate</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: number of start renegotiations in client mode</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html">http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html</a></p>

</li>
<li><p>CTX_sess_get_cache_size</p>

<p>Returns the currently valid session cache size.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_sess_get_cache_size</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: current size</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_sess_set_cache_size.html">http://www.openssl.org/docs/ssl/SSL_CTX_sess_set_cache_size.html</a></p>

</li>
<li><p>CTX_sess_hits</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_sess_hits</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: number of successfully reused sessions</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html">http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html</a></p>

</li>
<li><p>CTX_sess_misses</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_sess_misses</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: number of sessions proposed by clients that were not found in the internal session cache in server mode</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html">http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html</a></p>

</li>
<li><p>CTX_sess_number</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_sess_number</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: current number of sessions in the internal session cache</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html">http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html</a></p>

</li>
<li><p>CTX_sess_set_cache_size</p>

<p>Sets the size of the internal session cache of context $ctx to $size.</p>

<pre><code><code> <span class="variable">Net::SSLeay::CTX_sess_set_cache_size</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$size</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $size - cache size (0 = unlimited)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: previously valid size</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_sess_set_cache_size.html">http://www.openssl.org/docs/ssl/SSL_CTX_sess_set_cache_size.html</a></p>

</li>
<li><p>CTX_sess_timeouts</p>

<p>Returns the number of sessions proposed by clients and either found in the internal or external session cache in server mode, but that were invalid due to timeout. These sessions are not included in the SSL_CTX_sess_hits count.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_sess_timeouts</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: number of sessions</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html">http://www.openssl.org/docs/ssl/SSL_CTX_sess_number.html</a></p>

</li>
<li><p>CTX_sessions</p>

<p>Returns a pointer to the lhash databases containing the internal session cache for ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_sessions</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's LHASH structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_sessions.html">http://www.openssl.org/docs/ssl/SSL_CTX_sessions.html</a></p>

</li>
<li><p>CTX_set1_param</p>

<p>Applies X509 verification parameters $vpm on $ctx</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_set1_param</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$vpm</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $vpm - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>CTX_set_cert_store</p>

<p>Sets/replaces the certificate verification storage of $ctx to/with $store.</p>

<pre><code><code> <span class="variable">Net::SSLeay::CTX_set_cert_store</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$store</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $store - value corresponding to openssl's X509_STORE structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_cert_store.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_cert_store.html</a></p>

</li>
<li><p>CTX_set_cert_verify_callback</p>

<p>Sets the verification callback function for $ctx. SSL objects that are created from $ctx inherit the setting valid at the time when <code><code>Net::SSLeay::new($ctx)</code></code> is called.</p>

<pre><code><code> <span class="variable">Net::SSLeay::CTX_set_cert_verify_callback</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$func</span><span class="operator">,</span> <span class="variable">$data</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $func - perl reference to callback function</span>
 <span class="comment"># $data - [optional] data that will be passed to callback function when invoked</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_cert_verify_callback.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_cert_verify_callback.html</a></p>

</li>
<li><p>CTX_set_cipher_list</p>

<p>Sets the list of available ciphers for $ctx using the control string $str. The list of ciphers is inherited by all ssl objects created from $ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_set_cipher_list</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">,</span> <span class="variable">$str</span><span class="operator">);</span>
 <span class="comment"># $s - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $str - (string) cipher list e.g. '3DES:+RSA'</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 if any cipher could be selected and 0 on complete failure</span>
</code></code></pre>

<p>The format of $str is described in <a href="http://www.openssl.org/docs/apps/ciphers.html">http://www.openssl.org/docs/apps/ciphers.html</a></p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_cipher_list.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_cipher_list.html</a></p>

</li>
<li><p>CTX_set_client_CA_list</p>

<p>Sets the list of CAs sent to the client when requesting a client certificate for $ctx.</p>

<pre><code><code> <span class="variable">Net::SSLeay::CTX_set_client_CA_list</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$list</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $list - value corresponding to openssl's X509_NAME_STACK structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_client_CA_list.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_client_CA_list.html</a></p>

</li>
<li><p>CTX_set_default_passwd_cb</p>

<p>Sets the default password callback called when loading/storing a PEM certificate with encryption.</p>

<pre><code><code> <span class="variable">Net::SSLeay::CTX_set_default_passwd_cb</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$func</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $func - perl reference to callback function</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_default_passwd_cb.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_default_passwd_cb.html</a></p>

</li>
<li><p>CTX_set_default_passwd_cb_userdata</p>

<p>Sets a pointer to userdata which will be provided to the password callback on invocation.</p>

<pre><code><code> <span class="variable">Net::SSLeay::CTX_set_default_passwd_cb_userdata</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$userdata</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $userdata - data that will be passed to callback function when invoked</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_default_passwd_cb.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_default_passwd_cb.html</a></p>

</li>
<li><p>CTX_set_default_verify_paths</p>

<p>??? (more info needed)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_set_default_verify_paths</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>CTX_set_ex_data</p>

<p>Is used to store application data at $data for $idx into the $ctx object.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_set_ex_data</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$idx</span><span class="operator">,</span> <span class="variable">$data</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $idx - (integer) ???</span>
 <span class="comment"># $data - (pointer) ???</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_get_ex_new_index.html">http://www.openssl.org/docs/ssl/SSL_CTX_get_ex_new_index.html</a></p>

</li>
<li><p>CTX_set_purpose</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_set_purpose</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">,</span> <span class="variable">$purpose</span><span class="operator">);</span>
 <span class="comment"># $s - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $purpose - (integer) purpose identifier</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
 
 <span class="comment">#avainable purpose identifier</span>
 <span class="number">1</span> <span class="operator">-</span> <span class="variable">X509_PURPOSE_SSL_CLIENT</span>
 <span class="number">2</span> <span class="operator">-</span> <span class="variable">X509_PURPOSE_SSL_SERVER</span>
 <span class="number">3</span> <span class="operator">-</span> <span class="variable">X509_PURPOSE_NS_SSL_SERVER</span>
 <span class="number">4</span> <span class="operator">-</span> <span class="variable">X509_PURPOSE_SMIME_SIGN</span>
 <span class="number">5</span> <span class="operator">-</span> <span class="variable">X509_PURPOSE_SMIME_ENCRYPT</span>
 <span class="number">6</span> <span class="operator">-</span> <span class="variable">X509_PURPOSE_CRL_SIGN</span>
 <span class="number">7</span> <span class="operator">-</span> <span class="variable">X509_PURPOSE_ANY</span>
 <span class="number">8</span> <span class="operator">-</span> <span class="variable">X509_PURPOSE_OCSP_HELPER</span>
 <span class="number">9</span> <span class="operator">-</span> <span class="variable">X509_PURPOSE_TIMESTAMP_SIGN</span>
 
 <span class="comment">#or use corresponding constants</span>
 <span class="variable">$purpose</span> <span class="operator">=</span> <span class="operator">&amp;</span><span class="variable">Net::SSLeay::X509_PURPOSE_SSL_CLIENT</span><span class="operator">;</span>
 <span class="operator">...</span>
 <span class="variable">$purpose</span> <span class="operator">=</span> <span class="operator">&amp;</span><span class="variable">Net::SSLeay::X509_PURPOSE_TIMESTAMP_SIGN</span><span class="operator">;</span>
</code></code></pre>

</li>
<li><p>CTX_set_quiet_shutdown</p>

<p>Sets the &#39;quiet shutdown&#39; flag for $ctx to be mode. SSL objects created from $ctx inherit the mode valid at the time <code><code>Net::SSLeay::new($ctx)</code></code> is called.</p>

<pre><code><code> <span class="variable">Net::SSLeay::CTX_set_quiet_shutdown</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$mode</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $mode - 0 or 1</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_quiet_shutdown.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_quiet_shutdown.html</a></p>

</li>
<li><p>CTX_set_read_ahead</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_set_read_ahead</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$val</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $val - read_ahead value to be set</span>
 <span class="comment">#</span>
 <span class="comment"># returns: the original read_ahead value</span>
</code></code></pre>

</li>
<li><p>CTX_set_session_id_context</p>

<p>Sets the context $sid_ctx of length $sid_ctx_len within which a session can be reused for the $ctx object.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_set_session_id_context</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$sid_ctx</span><span class="operator">,</span> <span class="variable">$sid_ctx_len</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $sid_ctx - data buffer</span>
 <span class="comment"># $sid_ctx_len - length of data in $sid_ctx</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure (the error is logged to the error stack)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_session_id_context.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_session_id_context.html</a></p>

</li>
<li><p>CTX_set_ssl_version</p>

<p>Sets a new default TLS/SSL method for SSL objects newly created from this $ctx. SSL objects already created with <code><code>Net::SSLeay::new($ctx)</code></code> are not affected, except when <code><code>Net::SSLeay:clear($ssl)</code></code> is being called.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_set_ssl_version</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$meth</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $meth - value corresponding to openssl's SSL_METHOD structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_ssl_version.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_ssl_version.html</a></p>

</li>
<li><p>CTX_set_timeout</p>

<p>Sets the timeout for newly created sessions for $ctx to $t. The timeout value $t must be given in seconds.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_set_timeout</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$t</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $t - timeout in seconds</span>
 <span class="comment">#</span>
 <span class="comment"># returns: previously set timeout value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_timeout.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_timeout.html</a></p>

</li>
<li><p>CTX_set_tmp_dh</p>

<p>Sets DH parameters to be used to be $dh. The key is inherited by all ssl objects created from $ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_set_tmp_dh</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$dh</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $dh - value corresponding to openssl's DH structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_tmp_dh_callback.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_tmp_dh_callback.html</a></p>

</li>
<li><p>CTX_set_tmp_dh_callback</p>

<p>Sets the callback function for $ctx to be used when a DH parameters are required to $tmp_dh_callback.</p>

<pre><code><code> <span class="variable">Net::SSLeay::CTX_set_tmp_dh_callback</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$tmp_dh_callback</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># tmp_dh_callback - (function pointer) ???</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_tmp_dh_callback.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_tmp_dh_callback.html</a></p>

</li>
<li><p>CTX_set_tmp_rsa</p>

<p>Sets the temporary/ephemeral RSA key to be used to be $rsa.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_set_tmp_rsa</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$rsa</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $rsa - value corresponding to openssl's RSA structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_tmp_rsa_callback.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_tmp_rsa_callback.html</a></p>

</li>
<li><p>CTX_set_tmp_rsa_callback</p>

<p>Sets the callback function for ctx to be used when a temporary/ephemeral RSA key is required to $tmp_rsa_callback.</p>

<p>??? (does this function really work?)</p>

<pre><code><code> <span class="variable">Net::SSLeay::CTX_set_tmp_rsa_callback</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$tmp_rsa_callback</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $tmp_rsa_callback - (function pointer) ???</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_tmp_rsa_callback.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_tmp_rsa_callback.html</a></p>

</li>
<li><p>CTX_set_trust</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_set_trust</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">,</span> <span class="variable">$trust</span><span class="operator">);</span>
 <span class="comment"># $s - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $trust - (integer) trust identifier</span>
 <span class="comment">#</span>
 <span class="comment"># returns: the original value</span>
 
 <span class="comment">#available trust identifiers</span>
 <span class="number">1</span> <span class="operator">-</span> <span class="variable">X509_TRUST_COMPAT</span>
 <span class="number">2</span> <span class="operator">-</span> <span class="variable">X509_TRUST_SSL_CLIENT</span>
 <span class="number">3</span> <span class="operator">-</span> <span class="variable">X509_TRUST_SSL_SERVER</span>
 <span class="number">4</span> <span class="operator">-</span> <span class="variable">X509_TRUST_EMAIL</span>
 <span class="number">5</span> <span class="operator">-</span> <span class="variable">X509_TRUST_OBJECT_SIGN</span>
 <span class="number">6</span> <span class="operator">-</span> <span class="variable">X509_TRUST_OCSP_SIGN</span>
 <span class="number">7</span> <span class="operator">-</span> <span class="variable">X509_TRUST_OCSP_REQUEST</span>
 <span class="number">8</span> <span class="operator">-</span> <span class="variable">X509_TRUST_TSA</span>
 
 <span class="comment">#or use corresponding constants</span>
 <span class="variable">$trust</span> <span class="operator">=</span> <span class="operator">&amp;</span><span class="variable">Net::SSLeay::X509_TRUST_COMPAT</span><span class="operator">;</span>
 <span class="operator">...</span>
 <span class="variable">$trust</span> <span class="operator">=</span> <span class="operator">&amp;</span><span class="variable">Net::SSLeay::X509_TRUST_TSA</span><span class="operator">;</span>
</code></code></pre>

</li>
<li><p>CTX_set_verify_depth</p>

<p>Sets the maximum depth for the certificate chain verification that shall be allowed for ctx.</p>

<pre><code><code> <span class="variable">Net::SSLeay::CTX_set_verify_depth</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$depth</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $depth - max. depth</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_verify.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_verify.html</a></p>

</li>
<li><p>CTX_use_PKCS12_file</p>

<p>Adds the certificate and private key from PKCS12 file $p12filename to $ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_use_PKCS12_file</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$p12filename</span><span class="operator">,</span> <span class="variable">$password</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $p12filename - (string) filename</span>
 <span class="comment"># $password - (string) password to decrypt private key</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>CTX_use_PrivateKey</p>

<p>Adds the private key $pkey to $ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_use_PrivateKey</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$pkey</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $pkey - value corresponding to openssl's EVP_PKEY structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, otherwise check out the error stack to find out the reason</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html">http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html</a></p>

</li>
<li><p>CTX_use_PrivateKey_file</p>

<p>Adds the first private key found in $file to $ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_use_PrivateKey_file</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$file</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $file - (string) file name</span>
 <span class="comment"># $type - (integer) type - use constants &amp;Net::SSLeay::FILETYPE_PEM or &amp;Net::SSLeay::FILETYPE_ASN1</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, otherwise check out the error stack to find out the reason</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html">http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html</a></p>

</li>
<li><p>CTX_use_RSAPrivateKey</p>

<p>Adds the RSA private key $rsa to $ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_use_RSAPrivateKey</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$rsa</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $rsa - value corresponding to openssl's RSA structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, otherwise check out the error stack to find out the reason</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html">http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html</a></p>

</li>
<li><p>CTX_use_RSAPrivateKey_file</p>

<p>Adds the first RSA private key found in $file to $ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_use_RSAPrivateKey_file</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$file</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $file - (string) file name</span>
 <span class="comment"># $type - (integer) type - use constants &amp;Net::SSLeay::FILETYPE_PEM or &amp;Net::SSLeay::FILETYPE_ASN1</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, otherwise check out the error stack to find out the reason</span>
</code></code></pre>

</li>
<li><p>CTX_use_certificate</p>

<p>Loads the certificate $x into $ctx</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_use_certificate</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, otherwise check out the error stack to find out the reason</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html">http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html</a></p>

</li>
<li><p>CTX_use_certificate_chain_file</p>

<p>Loads a certificate chain from $file into $ctx. The certificates must be in PEM format and must be sorted starting with the subject&#39;s certificate (actual client or server certificate), followed by intermediate CA certificates if applicable, and ending at the highest level (root) CA.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_use_certificate_chain_file</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$file</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $file - (string) file name</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, otherwise check out the error stack to find out the reason</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html">http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html</a></p>

</li>
<li><p>CTX_use_certificate_file</p>

<p>Loads the first certificate stored in $file into $ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_use_certificate_file</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$file</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $file - (string) file name</span>
 <span class="comment"># $type - (integer) type - use constants &amp;Net::SSLeay::FILETYPE_PEM or &amp;Net::SSLeay::FILETYPE_ASN1</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, otherwise check out the error stack to find out the reason</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html">http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html</a></p>

</li>
</ul>

<h3 id="Low-level-API:-SSL_-related-functions">Low level API: SSL_* related functions</h3>

<p><b>NOTE:</b> Please note that the function described in this chapter have &quot;SSL_&quot; part stripped from their original openssl names.</p>

<ul>

<li><p>new</p>

<p>Creates a new SSL structure which is needed to hold the data for a TLS/SSL connection. The new structure inherits the settings of the underlying context $ctx: connection method (SSLv2/v3/TLSv1), options, verification settings, timeout settings.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::new</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's SSL structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_new.html">http://www.openssl.org/docs/ssl/SSL_new.html</a></p>

</li>
<li><p>accept</p>

<p>Waits for a TLS/SSL client to initiate the TLS/SSL handshake. The communication channel must already have been set and assigned to the ssl by setting an underlying BIO.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::accept</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 = success, 0 = handshake not successfull, &lt;0 = fatal error during handshake</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_accept.html">http://www.openssl.org/docs/ssl/SSL_accept.html</a></p>

</li>
<li><p>add_client_CA</p>

<p>Adds the CA name extracted from cacert to the list of CAs sent to the client when requesting a client certificate for the chosen ssl, overriding the setting valid for ssl&#39;s SSL_CTX object.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::add_client_CA</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_client_CA_list.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_client_CA_list.html</a></p>

</li>
<li><p>callback_ctrl</p>

<p>??? (more info needed)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::callback_ctrl</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$cmd</span><span class="operator">,</span> <span class="variable">$fp</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $cmd - (integer) command id</span>
 <span class="comment"># $fp - (function pointer) ???</span>
 <span class="comment">#</span>
 <span class="comment"># returns: ???</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_ctrl.html">http://www.openssl.org/docs/ssl/SSL_CTX_ctrl.html</a></p>

</li>
<li><p>check_private_key</p>

<p>Checks the consistency of a private key with the corresponding certificate loaded into $ssl</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::check_private_key</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, otherwise check out the error stack to find out the reason</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html">http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html</a></p>

</li>
<li><p>clear</p>

<p>Reset SSL object to allow another connection.</p>

<pre><code><code> <span class="variable">Net::SSLeay::clear</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_clear.html">http://www.openssl.org/docs/ssl/SSL_clear.html</a></p>

</li>
<li><p>connect</p>

<p>Initiate the TLS/SSL handshake with an TLS/SSL server.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::connect</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 = success, 0 = handshake not successfull, &lt;0 = fatal error during handshake</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_connect.html">http://www.openssl.org/docs/ssl/SSL_connect.html</a></p>

</li>
<li><p>copy_session_id</p>

<p>Copies the session structure fro $from to $to (+ also the private key and certificate associated with $from).</p>

<pre><code><code> <span class="variable">Net::SSLeay::copy_session_id</span><span class="operator">(</span><span class="variable">$to</span><span class="operator">,</span> <span class="variable">$from</span><span class="operator">);</span>
 <span class="comment"># $to - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $from - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

</li>
<li><p>ctrl</p>

<p>Internal handling function for SSL objects.</p>

<p><b>BEWARE:</b> openssl doc says: This function should never be called directly!</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::ctrl</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$cmd</span><span class="operator">,</span> <span class="variable">$larg</span><span class="operator">,</span> <span class="variable">$parg</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $cmd - (integer) command id</span>
 <span class="comment"># $larg - (integer) long ???</span>
 <span class="comment"># $parg - (string/pointer) ???</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (long) result of given command ???</span>
</code></code></pre>

<p>For more details about valid $cmd values check <a href="#CTX_ctrl">&quot;CTX_ctrl&quot;</a>.</p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_ctrl.html">http://www.openssl.org/docs/ssl/SSL_CTX_ctrl.html</a></p>

</li>
<li><p>do_handshake</p>

<p>Will wait for a SSL/TLS handshake to take place. If the connection is in client mode, the handshake will be started. The handshake routines may have to be explicitly set in advance using either SSL_set_connect_state or SSL_set_accept_state(3).</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::do_handshake</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 = success, 0 = handshake not successfull, &lt;0 = fatal error during handshake</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_do_handshake.html">http://www.openssl.org/docs/ssl/SSL_do_handshake.html</a></p>

</li>
<li><p>dup</p>

<p>Returns a duplicate of $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::dup</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's SSL structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>free</p>

<p>Free an allocated SSL structure.</p>

<pre><code><code> <span class="variable">Net::SSLeay::free</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_free.html">http://www.openssl.org/docs/ssl/SSL_free.html</a></p>

</li>
<li><p>get_SSL_CTX</p>

<p>Returns a pointer to the SSL_CTX object, from which $ssl was created with Net::SSLeay::new.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_SSL_CTX</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's SSL_CTX structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_get_SSL_CTX.html">http://www.openssl.org/docs/ssl/SSL_get_SSL_CTX.html</a></p>

</li>
<li><p>get_app_data</p>

<p>Can be used to get application defined value/data.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_app_data</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: string/buffer/pointer ???</span>
</code></code></pre>

</li>
<li><p>set_app_data</p>

<p>Can be used to set some application defined value/data.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set_app_data</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$arg</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $arg - (string/buffer/pointer ???) data</span>
 <span class="comment">#</span>
 <span class="comment"># returns: ???</span>
</code></code></pre>

</li>
<li><p>get_certificate</p>

<p>Gets X509 certificate from an established SSL connection.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_certificate</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509 structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>get_cipher</p>

<p>Obtains the name of the currently used cipher.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_cipher</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (string) cipher name e.g. 'DHE-RSA-AES256-SHA' or '', when no session has been established.</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_get_current_cipher.html">http://www.openssl.org/docs/ssl/SSL_get_current_cipher.html</a></p>

</li>
<li><p>get_cipher_bits</p>

<p>Obtain the number of secret/algorithm bits used.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_cipher_bits</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: number of secret bits used by current cipher</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_get_current_cipher.html">http://www.openssl.org/docs/ssl/SSL_get_current_cipher.html</a> and <a href="http://www.openssl.org/docs/ssl/SSL_CIPHER_get_name.html">http://www.openssl.org/docs/ssl/SSL_CIPHER_get_name.html</a></p>

</li>
<li><p>get_cipher_list</p>

<p>Returns the name (string) of the SSL_CIPHER listed for $ssl with priority $n.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_cipher_list</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$n</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $n - (integer) priority</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (string) cipher name e.g. 'EDH-DSS-DES-CBC3-SHA' or '' in case of error</span>
</code></code></pre>

<p>Call Net::SSLeay::get_cipher_list with priority starting from 0 to obtain the sorted list of available ciphers, until &#39;&#39; is returned:</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$priority</span> <span class="operator">=</span> <span class="number">0</span><span class="operator">;</span>
 <span class="keyword">while</span> <span class="operator">(</span><span class="keyword">my</span> <span class="variable">$c</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_cipher_list</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$priority</span><span class="operator">))</span> <span class="operator">{</span>
   <span class="keyword">print</span> <span class="string">"cipher[</span><span class="variable">$priority</span><span class="string">] = </span><span class="variable">$c</span><span class="string">\n"</span><span class="operator">;</span>
   <span class="variable">$priority</span><span class="operator">++;</span>
 <span class="operator">}</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_get_ciphers.html">http://www.openssl.org/docs/ssl/SSL_get_ciphers.html</a></p>

</li>
<li><p>get_client_CA_list</p>

<p>Returns the list of client CAs explicitly set for $ssl using <code><code>Net::SSleay::set_client_CA_list</code></code> or $ssl&#39;s SSL_CTX object with <code><code>Net::SSLeay::CTX_set_client_CA_list</code></code>, when in server mode.</p>

<p>In client mode, returns the list of client CAs sent from the server, if any.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_client_CA_list</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's STACK_OF(X509_NAME) structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_get_client_CA_list.html">http://www.openssl.org/docs/ssl/SSL_get_client_CA_list.html</a></p>

</li>
<li><p>get_current_cipher</p>

<p>Returns the cipher actually used.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_current_cipher</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's SSL_CIPHER structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_get_current_cipher.html">http://www.openssl.org/docs/ssl/SSL_get_current_cipher.html</a></p>

</li>
<li><p>get_default_timeout</p>

<p>Returns the default timeout value assigned to SSL_SESSION objects negotiated for the protocol valid for $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_default_timeout</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (long) timeout in seconds</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_get_default_timeout.html">http://www.openssl.org/docs/ssl/SSL_get_default_timeout.html</a></p>

</li>
<li><p>get_error</p>

<p>Returns a result code for a preceding call to <code><code>connect</code></code>, <code><code>accept</code></code>, <code><code>do_handshake</code></code>, <code><code>read</code></code>, <code><code>peek</code></code> or <code><code>write</code></code> on $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_error</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$ret</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $ret - return value of preceding TLS/SSL I/O operation</span>
 <span class="comment">#</span>
 <span class="comment"># returns: result code, which is one of the following values:</span>
 <span class="comment">#  0 - SSL_ERROR_NONE</span>
 <span class="comment">#  1 - SSL_ERROR_SSL</span>
 <span class="comment">#  2 - SSL_ERROR_WANT_READ</span>
 <span class="comment">#  3 - SSL_ERROR_WANT_WRITE</span>
 <span class="comment">#  4 - SSL_ERROR_WANT_X509_LOOKUP</span>
 <span class="comment">#  5 - SSL_ERROR_SYSCALL</span>
 <span class="comment">#  6 - SSL_ERROR_ZERO_RETURN</span>
 <span class="comment">#  7 - SSL_ERROR_WANT_CONNECT</span>
 <span class="comment">#  8 - SSL_ERROR_WANT_ACCEPT</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_get_error.html">http://www.openssl.org/docs/ssl/SSL_get_error.html</a></p>

</li>
<li><p>get_ex_data</p>

<p>Is used to retrieve the information for $idx from $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_ex_data</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$idx</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $idx - (integer) index for application specific data</span>
 <span class="comment">#</span>
 <span class="comment"># returns: pointer to ???</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_get_ex_new_index.html">http://www.openssl.org/docs/ssl/SSL_get_ex_new_index.html</a></p>

</li>
<li><p>set_ex_data</p>

<p>Is used to store application data at $data for $idx into the $ssl object.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set_ex_data</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$idx</span><span class="operator">,</span> <span class="variable">$data</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $idx - (integer) ???</span>
 <span class="comment"># $data - (pointer) ???</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_get_ex_new_index.html">http://www.openssl.org/docs/ssl/SSL_get_ex_new_index.html</a></p>

</li>
<li><p>get_ex_new_index</p>

<p>Is used to register a new index for application specific data.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_ex_new_index</span><span class="operator">(</span><span class="variable">$argl</span><span class="operator">,</span> <span class="variable">$argp</span><span class="operator">,</span> <span class="variable">$new_func</span><span class="operator">,</span> <span class="variable">$dup_func</span><span class="operator">,</span> <span class="variable">$free_func</span><span class="operator">);</span>
 <span class="comment"># $argl - (long) ???</span>
 <span class="comment"># $argp - (pointer) ???</span>
 <span class="comment"># $new_func - function pointer ??? (CRYPTO_EX_new *)</span>
 <span class="comment"># $dup_func - function pointer ??? (CRYPTO_EX_dup *)</span>
 <span class="comment"># $free_func - function pointer ??? (CRYPTO_EX_free *)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) ???</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_get_ex_new_index.html">http://www.openssl.org/docs/ssl/SSL_get_ex_new_index.html</a></p>

</li>
<li><p>get_fd</p>

<p>Returns the file descriptor which is linked to $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_fd</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: file descriptor (&gt;=0) or -1 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_get_fd.html">http://www.openssl.org/docs/ssl/SSL_get_fd.html</a></p>

</li>
<li><p>get_finished</p>

<p>Obtains the latest &#39;Finished&#39; message sent to the peer.</p>

<p>??? (does this function really work?)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_finished</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$buf</span><span class="operator">,</span> <span class="variable">$count</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $buf - buffer where the returned data will be stored (pointer ???, pre-allocated ???)</span>
 <span class="comment"># $count - max. size of return data</span>
 <span class="comment">#</span>
 <span class="comment"># returns: actual size of the returned data in $buf</span>
</code></code></pre>

</li>
<li><p>get_peer_finished</p>

<p>Obtains the latest &#39;Finished&#39; message expected from the peer.</p>

<p>??? (does this function really work?)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_peer_finished</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$buf</span><span class="operator">,</span> <span class="variable">$count</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $buf - buffer where the returned data will be stored (pointer ???, pre-allocated ???)</span>
 <span class="comment"># $count - max. size of the return data</span>
 <span class="comment">#</span>
 <span class="comment"># returns: actual size of the returned data in $buf</span>
</code></code></pre>

</li>
<li><p>get_keyblock_size</p>

<p><b>NOTE:</b> Does not exactly correspond to any low level API function.</p>

<p>??? (more info needed)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_keyblock_size</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: keyblock size, -1 on error</span>
</code></code></pre>

</li>
<li><p>get_mode</p>

<p>Returns the mode (bitmask) set for $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_mode</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: mode (bitmask)</span>
</code></code></pre>

<p>To decode the return value (bitmask) see documentation for <a href="#CTX_get_mode">&quot;CTX_get_mode&quot;</a>.</p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_mode.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_mode.html</a></p>

</li>
<li><p>set_mode</p>

<p>Adds the mode set via bitmask in $mode to $ssl. Options already set before are not cleared.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set_mode</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$mode</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $mode - mode (bitmask)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: the new mode bitmask after adding $mode</span>
</code></code></pre>

<p>For $mode bitmask details see <a href="#CTX_get_mode">&quot;CTX_get_mode&quot;</a>.</p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_mode.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_mode.html</a></p>

</li>
<li><p>get_options</p>

<p>Returns the options (bitmask) set for $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_options</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: options (bitmask)</span>
</code></code></pre>

<p>To decode the return value (bitmask) see documentation for <a href="#CTX_get_options">&quot;CTX_get_options&quot;</a>.</p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_options.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_options.html</a></p>

</li>
<li><p>set_options</p>

<p>Adds the options set via bitmask in $options to $ssl. Options already set before are not cleared!</p>

<pre><code><code> <span class="variable">Net::SSLeay::set_options</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$options</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $options - options (bitmask)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: the new options bitmask after adding $options</span>
</code></code></pre>

<p>For $options bitmask details see <a href="#CTX_get_options">&quot;CTX_get_options&quot;</a>.</p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_options.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_options.html</a></p>

</li>
<li><p>get_peer_certificate</p>

<p>Get the X509 certificate of the peer.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_peer_certificate</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509 structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_get_peer_certificate.html">http://www.openssl.org/docs/ssl/SSL_get_peer_certificate.html</a></p>

</li>
<li><p>get_quiet_shutdown</p>

<p>Returns the &#39;quiet shutdown&#39; setting of ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_quiet_shutdown</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) current 'quiet shutdown' value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_quiet_shutdown.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_quiet_shutdown.html</a></p>

</li>
<li><p>get_rbio</p>

<p>Get &#39;read&#39; BIO linked to an SSL object $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_rbio</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's BIO structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_get_rbio.html">http://www.openssl.org/docs/ssl/SSL_get_rbio.html</a></p>

</li>
<li><p>get_read_ahead</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_read_ahead</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) read_ahead value</span>
</code></code></pre>

</li>
<li><p>set_read_ahead</p>

<pre><code><code> <span class="variable">Net::SSLeay::set_read_ahead</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$val</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $val - read_ahead value to be set</span>
 <span class="comment">#</span>
 <span class="comment"># returns: the original read_ahead value</span>
</code></code></pre>

</li>
<li><p>get_server_random</p>

<p>Returns internal SSLv3 server_random value.</p>

<pre><code><code> <span class="variable">Net::SSLeay::get_server_random</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: server_random value (binary data)</span>
</code></code></pre>

</li>
<li><p>get_client_random</p>

<p><b>NOTE:</b> Does not exactly correspond to any low level API function</p>

<p>Returns internal SSLv3 client_random value.</p>

<pre><code><code> <span class="variable">Net::SSLeay::get_client_random</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: client_random value (binary data)</span>
</code></code></pre>

</li>
<li><p>get_session</p>

<p>Retrieve TLS/SSL session data used in $ssl. The reference count of the SSL_SESSION is NOT incremented.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_session</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's SSL_SESSION structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_get_session.html">http://www.openssl.org/docs/ssl/SSL_get_session.html</a></p>

</li>
<li><p>SSL_get0_session</p>

<p>The alias for <a href="#get_session">&quot;get_session&quot;</a> (note that the name is <code><code>SSL_get0_session</code></code> NOT <code><code>get0_session</code></code>).</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SSL_get0_session</span><span class="operator">();</span>
</code></code></pre>

</li>
<li><p>get1_session</p>

<p>Returns a pointer to the SSL_SESSION actually used in $ssl. The reference count of the SSL_SESSION is incremented by 1.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get1_session</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's SSL_SESSION structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_get_session.html">http://www.openssl.org/docs/ssl/SSL_get_session.html</a></p>

</li>
<li><p>get_shared_ciphers</p>

<p>Returns string with a list (colon &#39;:&#39; separated) of ciphers shared between client and server within SSL session $ssl.</p>

<pre><code><code> my $rv = Net::SSLeay::get_shared_ciphers()
 #
 # returns: string like &#39;ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES256-SHA:DHE-DSS-AES256-SHA:...&#39;</code></code></pre>

</li>
<li><p>get_shutdown</p>

<p>Returns the shutdown mode of $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_shutdown</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: shutdown mode (bitmask) of ssl</span>
 
 <span class="comment">#to decode the return value (bitmask) use:</span>
 <span class="number">0</span> <span class="operator">-</span> <span class="variable">No</span> <span class="keyword">shutdown</span> <span class="variable">setting</span><span class="operator">,</span> <span class="variable">yet</span>
 <span class="number">1</span> <span class="operator">-</span> <span class="variable">SSL_SENT_SHUTDOWN</span>
 <span class="number">2</span> <span class="operator">-</span> <span class="variable">SSL_RECEIVED_SHUTDOWN</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_set_shutdown.html">http://www.openssl.org/docs/ssl/SSL_set_shutdown.html</a></p>

</li>
<li><p>get_ssl_method</p>

<p>Returns a function pointer to the TLS/SSL method set in $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_ssl_method</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's SSL_METHOD structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_ssl_version.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_ssl_version.html</a></p>

</li>
<li><p>get_state</p>

<p>Returns the SSL connection state.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_state</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) state value</span>
 <span class="comment">#          to decode the returned state check:</span>
 <span class="comment">#          SSL_ST_* constants in openssl/ssl.h</span>
 <span class="comment">#          SSL2_ST_* constants in openssl/ssl2.h</span>
 <span class="comment">#          SSL23_ST_* constants in openssl/ssl23.h</span>
 <span class="comment">#          SSL3_ST_* + DTLS1_ST_* constants in openssl/ssl3.h</span>
</code></code></pre>

</li>
<li><p>state</p>

<p>Exactly the same as <a href="#get_state">&quot;get_state&quot;</a>.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::state</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>get_verify_depth</p>

<p>Returns the verification depth limit currently set in $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_verify_depth</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: current depth or -1 if no limit has been explicitly set</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_get_verify_mode.html">http://www.openssl.org/docs/ssl/SSL_CTX_get_verify_mode.html</a></p>

</li>
<li><p>set_verify_depth</p>

<p>Sets the maximum depth for the certificate chain verification that shall be allowed for $ssl.</p>

<pre><code><code> <span class="variable">Net::SSLeay::set_verify_depth</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$depth</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $depth - (integer) depth</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_verify.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_verify.html</a></p>

</li>
<li><p>get_verify_mode</p>

<p>Returns the verification mode (bitmask) currently set in $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_verify_mode</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: mode (bitmask)</span>
</code></code></pre>

<p>To decode the return value (bitmask) see documentation for <a href="#CTX_get_verify_mode">&quot;CTX_get_verify_mode&quot;</a>.</p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_get_verify_mode.html">http://www.openssl.org/docs/ssl/SSL_CTX_get_verify_mode.html</a></p>

</li>
<li><p>set_verify</p>

<p>Sets the verification flags for $ssl to be $mode and specifies the $verify_callback function to be used.</p>

<pre><code><code> <span class="variable">Net::SSLeay::set_verify</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$mode</span><span class="operator">,</span> <span class="variable">$callback</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $mode - mode (bitmask)</span>
 <span class="comment"># $callback - [optional] reference to perl callback function</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>For $mode bitmask details see <a href="#CTX_get_verify_mode">&quot;CTX_get_verify_mode&quot;</a>.</p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_verify.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_verify.html</a></p>

</li>
<li><p>get_verify_result</p>

<p>Returns the result of the verification of the X509 certificate presented by the peer, if any.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_verify_result</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer)</span>
 <span class="comment">#      0 - X509_V_OK: ok</span>
 <span class="comment">#      2 - X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT: unable to get issuer certificate</span>
 <span class="comment">#      3 - X509_V_ERR_UNABLE_TO_GET_CRL: unable to get certificate CRL</span>
 <span class="comment">#      4 - X509_V_ERR_UNABLE_TO_DECRYPT_CERT_SIGNATURE: unable to decrypt certificate's signature</span>
 <span class="comment">#      5 - X509_V_ERR_UNABLE_TO_DECRYPT_CRL_SIGNATURE: unable to decrypt CRL's signature</span>
 <span class="comment">#      6 - X509_V_ERR_UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY: unable to decode issuer public key</span>
 <span class="comment">#      7 - X509_V_ERR_CERT_SIGNATURE_FAILURE: certificate signature failure</span>
 <span class="comment">#      8 - X509_V_ERR_CRL_SIGNATURE_FAILURE: CRL signature failure</span>
 <span class="comment">#      9 - X509_V_ERR_CERT_NOT_YET_VALID: certificate is not yet valid</span>
 <span class="comment">#     10 - X509_V_ERR_CERT_HAS_EXPIRED: certificate has expired</span>
 <span class="comment">#     11 - X509_V_ERR_CRL_NOT_YET_VALID: CRL is not yet valid</span>
 <span class="comment">#     12 - X509_V_ERR_CRL_HAS_EXPIRED: CRL has expired</span>
 <span class="comment">#     13 - X509_V_ERR_ERROR_IN_CERT_NOT_BEFORE_FIELD: format error in certificate's notBefore field</span>
 <span class="comment">#     14 - X509_V_ERR_ERROR_IN_CERT_NOT_AFTER_FIELD: format error in certificate's notAfter field</span>
 <span class="comment">#     15 - X509_V_ERR_ERROR_IN_CRL_LAST_UPDATE_FIELD: format error in CRL's lastUpdate field</span>
 <span class="comment">#     16 - X509_V_ERR_ERROR_IN_CRL_NEXT_UPDATE_FIELD: format error in CRL's nextUpdate field</span>
 <span class="comment">#     17 - X509_V_ERR_OUT_OF_MEM: out of memory</span>
 <span class="comment">#     18 - X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT: self signed certificate</span>
 <span class="comment">#     19 - X509_V_ERR_SELF_SIGNED_CERT_IN_CHAIN: self signed certificate in certificate chain</span>
 <span class="comment">#     20 - X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY: unable to get local issuer certificate</span>
 <span class="comment">#     21 - X509_V_ERR_UNABLE_TO_VERIFY_LEAF_SIGNATURE: unable to verify the first certificate</span>
 <span class="comment">#     22 - X509_V_ERR_CERT_CHAIN_TOO_LONG: certificate chain too long</span>
 <span class="comment">#     23 - X509_V_ERR_CERT_REVOKED: certificate revoked</span>
 <span class="comment">#     24 - X509_V_ERR_INVALID_CA: invalid CA certificate</span>
 <span class="comment">#     25 - X509_V_ERR_PATH_LENGTH_EXCEEDED: path length constraint exceeded</span>
 <span class="comment">#     26 - X509_V_ERR_INVALID_PURPOSE: unsupported certificate purpose</span>
 <span class="comment">#     27 - X509_V_ERR_CERT_UNTRUSTED: certificate not trusted</span>
 <span class="comment">#     28 - X509_V_ERR_CERT_REJECTED: certificate rejected</span>
 <span class="comment">#     29 - X509_V_ERR_SUBJECT_ISSUER_MISMATCH: subject issuer mismatch</span>
 <span class="comment">#     30 - X509_V_ERR_AKID_SKID_MISMATCH: authority and subject key identifier mismatch</span>
 <span class="comment">#     31 - X509_V_ERR_AKID_ISSUER_SERIAL_MISMATCH: authority and issuer serial number mismatch</span>
 <span class="comment">#     32 - X509_V_ERR_KEYUSAGE_NO_CERTSIGN:key usage does not include certificate signing</span>
 <span class="comment">#     50 - X509_V_ERR_APPLICATION_VERIFICATION: application verification failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_get_verify_result.html">http://www.openssl.org/docs/ssl/SSL_get_verify_result.html</a></p>

</li>
<li><p>set_verify_result</p>

<p>Override result of peer certificate verification.</p>

<pre><code><code> <span class="variable">Net::SSLeay::set_verify_result</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$v</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $v - (integer) result value</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>For more info about valid return values see <a href="#get_verify_result">&quot;get_verify_result&quot;</a></p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_set_verify_result.html">http://www.openssl.org/docs/ssl/SSL_set_verify_result.html</a></p>

</li>
<li><p>get_wbio</p>

<p>Get &#39;write&#39; BIO linked to an SSL object $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_wbio</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's BIO structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_get_rbio.html">http://www.openssl.org/docs/ssl/SSL_get_rbio.html</a></p>

</li>
<li><p>load_client_CA_file</p>

<p>Load X509 certificates from file (PEM formated).</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::load_client_CA_file</span><span class="operator">(</span><span class="variable">$file</span><span class="operator">);</span>
 <span class="comment"># $file - (string) file name</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's STACK_OF(X509_NAME) structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_load_client_CA_file.html">http://www.openssl.org/docs/ssl/SSL_load_client_CA_file.html</a></p>

</li>
<li><p>clear_num_renegotiations</p>

<p>Executes SSL_CTRL_CLEAR_NUM_RENEGOTIATIONS command on $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::clear_num_renegotiations</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: command result</span>
</code></code></pre>

</li>
<li><p>need_tmp_RSA</p>

<p>Executes SSL_CTRL_NEED_TMP_RSA command on $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::need_tmp_RSA</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: command result</span>
</code></code></pre>

</li>
<li><p>num_renegotiations</p>

<p>Executes SSL_CTRL_GET_NUM_RENEGOTIATIONS command on $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::num_renegotiations</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: command result</span>
</code></code></pre>

</li>
<li><p>total_renegotiations</p>

<p>Executes SSL_CTRL_GET_TOTAL_RENEGOTIATIONS command on $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::total_renegotiations</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: command result</span>
</code></code></pre>

</li>
<li><p>peek</p>

<p>Copies $max bytes from the specified $ssl into the returned value. In constrast to the <code><code>Net::SSLeay::read()</code></code> function, the data in the SSL buffer is unmodified after the SSL_peek() operation.</p>

<pre><code><code> <span class="variable">Net::SSLeay::peek</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$max</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $max - [optional] max bytes to peek (integer) - default is 32768</span>
 <span class="comment">#</span>
 <span class="comment"># returns: read data, undef on error</span>
</code></code></pre>

</li>
<li><p>pending</p>

<p>Obtain number of readable bytes buffered in $ssl object.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::pending</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: the number of bytes pending</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_pending.html">http://www.openssl.org/docs/ssl/SSL_pending.html</a></p>

</li>
<li><p>read</p>

<p>Tries to read $max bytes from the specified $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$got</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::read</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$max</span><span class="operator">);</span>
 <span class="keyword">my</span><span class="operator">(</span><span class="variable">$got</span><span class="operator">,</span> <span class="variable">$rv</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::read</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$max</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $max - [optional] max bytes to read (integer) - default is 32768</span>
 <span class="comment">#</span>
 <span class="comment"># returns:</span>
 <span class="comment"># in scalar context: data read from the TLS/SSL connection, undef on error</span>
 <span class="comment"># in list context:   two-item array consisting of data read (undef on error),</span>
 <span class="comment">#                      and return code from SSL_read().</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_read.html">http://www.openssl.org/docs/ssl/SSL_read.html</a></p>

</li>
<li><p>renegotiate</p>

<p>Turn on flags for renegotiation so that renegotiation will happen</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::renegotiate</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>rstate_string</p>

<p>Returns a 2 letter string indicating the current read state of the SSL object $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::rstate_string</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 2-letter string</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_rstate_string.html">http://www.openssl.org/docs/ssl/SSL_rstate_string.html</a></p>

</li>
<li><p>rstate_string_long</p>

<p>Returns a string indicating the current read state of the SSL object ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::rstate_string_long</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: string with current state</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_rstate_string.html">http://www.openssl.org/docs/ssl/SSL_rstate_string.html</a></p>

</li>
<li><p>session_reused</p>

<p>Query whether a reused session was negotiated during handshake.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::session_reused</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 0 - new session was negotiated; 1 - session was reused.</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_session_reused.html">http://www.openssl.org/docs/ssl/SSL_session_reused.html</a></p>

</li>
<li><p>set1_param</p>

<p>Applies X509 verification parameters $vpm on $ssl</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set1_param</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$vpm</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $vpm - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>set_accept_state</p>

<p>Sets $ssl to work in server mode.</p>

<pre><code><code> <span class="variable">Net::SSLeay::set_accept_state</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_set_connect_state.html">http://www.openssl.org/docs/ssl/SSL_set_connect_state.html</a></p>

</li>
<li><p>set_bio</p>

<p>Connects the BIOs $rbio and $wbio for the read and write operations of the TLS/SSL (encrypted) side of $ssl.</p>

<pre><code><code> <span class="variable">Net::SSLeay::set_bio</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$rbio</span><span class="operator">,</span> <span class="variable">$wbio</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $rbio - value corresponding to openssl's BIO structure</span>
 <span class="comment"># $wbio - value corresponding to openssl's BIO structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_set_bio.html">http://www.openssl.org/docs/ssl/SSL_set_bio.html</a></p>

</li>
<li><p>set_cipher_list</p>

<p>Sets the list of ciphers only for ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set_cipher_list</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$str</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $str - (string) cipher list e.g. '3DES:+RSA'</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 if any cipher could be selected and 0 on complete failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_cipher_list.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_cipher_list.html</a></p>

</li>
<li><p>set_client_CA_list</p>

<p>Sets the list of CAs sent to the client when requesting a client certificate for the chosen $ssl, overriding the setting valid for $ssl&#39;s SSL_CTX object.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set_client_CA_list</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$list</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $list - value corresponding to openssl's STACK_OF(X509_NAME) structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_client_CA_list.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_client_CA_list.html</a></p>

</li>
<li><p>set_connect_state</p>

<p>Sets $ssl to work in client mode.</p>

<pre><code><code> <span class="variable">Net::SSLeay::set_connect_state</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_set_connect_state.html">http://www.openssl.org/docs/ssl/SSL_set_connect_state.html</a></p>

</li>
<li><p>set_fd</p>

<p>Sets the file descriptor $fd as the input/output facility for the TLS/SSL (encrypted) side of $ssl, $fd will typically be the socket file descriptor of a network connection.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set_fd</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$fd</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $fd - (integer) file handle (got via perl's fileno)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_set_fd.html">http://www.openssl.org/docs/ssl/SSL_set_fd.html</a></p>

</li>
<li><p>set_rfd</p>

<p>Sets the file descriptor $fd as the input (read) facility for the TLS/SSL (encrypted) side of $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set_rfd</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$fd</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $fd - (integer) file handle (got via perl's fileno)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_set_fd.html">http://www.openssl.org/docs/ssl/SSL_set_fd.html</a></p>

</li>
<li><p>set_wfd</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set_wfd</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$fd</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $fd - (integer) file handle (got via perl's fileno)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_set_fd.html">http://www.openssl.org/docs/ssl/SSL_set_fd.html</a></p>

</li>
<li><p>set_info_callback</p>

<p>Sets the callback function, that can be used to obtain state information for $ssl during connection setup and use. When callback is 0 (NULL), the callback setting currently valid for ctx is used.</p>

<p>??? (does this function really work?)</p>

<pre><code><code> <span class="variable">Net::SSLeay::set_info_callback</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$cb</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $cb - pointer to function ???</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_info_callback.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_info_callback.html</a></p>

</li>
<li><p>set_pref_cipher</p>

<p>Sets the list of available ciphers for $ssl using the control string $str.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set_pref_cipher</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$str</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $str - (string) cipher list e.g. '3DES:+RSA'</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 if any cipher could be selected and 0 on complete failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_cipher_list.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_cipher_list.html</a></p>

</li>
<li><p>set_purpose</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set_purpose</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$purpose</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $purpose - (integer) purpose identifier</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>For more info about available $purpose identifiers see <a href="#CTX_set_purpose">&quot;CTX_set_purpose&quot;</a>.</p>

</li>
<li><p>set_quiet_shutdown</p>

<p>Sets the &#39;quiet shutdown&#39; flag for $ssl to be $mode.</p>

<pre><code><code> <span class="variable">Net::SSLeay::set_quiet_shutdown</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$mode</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $mode - 0 or 1</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_quiet_shutdown.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_quiet_shutdown.html</a></p>

</li>
<li><p>set_session</p>

<p>Set a TLS/SSL session to be used during TLS/SSL connect.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set_session</span><span class="operator">(</span><span class="variable">$to</span><span class="operator">,</span> <span class="variable">$ses</span><span class="operator">);</span>
 <span class="comment"># $to - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $ses - value corresponding to openssl's SSL_SESSION structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_set_session.html">http://www.openssl.org/docs/ssl/SSL_set_session.html</a></p>

</li>
<li><p>set_session_id_context</p>

<p>Sets the context $sid_ctx of length $sid_ctx_len within which a session can be reused for the $ssl object.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set_session_id_context</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$sid_ctx</span><span class="operator">,</span> <span class="variable">$sid_ctx_len</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $sid_ctx - data buffer</span>
 <span class="comment"># $sid_ctx_len - length of data in $sid_ctx</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_session_id_context.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_session_id_context.html</a></p>

</li>
<li><p>set_session_secret_cb</p>

<p>Setup pre-shared secret session resumption function.</p>

<pre><code><code> <span class="variable">Net::SSLeay::set_session_secret_cb</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$func</span><span class="operator">,</span> <span class="variable">$data</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $func - perl reference to callback function</span>
 <span class="comment"># $data - [optional] data that will be passed to callback function when invoked</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

</li>
<li><p>set_shutdown</p>

<p>Sets the shutdown state of $ssl to $mode.</p>

<pre><code><code> <span class="variable">Net::SSLeay::set_shutdown</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$mode</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $mode - (integer) shutdown mode:</span>
 <span class="comment">#         0 - No shutdown</span>
 <span class="comment">#         1 - SSL_SENT_SHUTDOWN</span>
 <span class="comment">#         2 - SSL_RECEIVED_SHUTDOWN</span>
 <span class="comment">#         3 - SSL_RECEIVED_SHUTDOWN+SSL_SENT_SHUTDOWN</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_set_shutdown.html">http://www.openssl.org/docs/ssl/SSL_set_shutdown.html</a></p>

</li>
<li><p>set_ssl_method</p>

<p>Sets a new TLS/SSL method for a particular $ssl object.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set_ssl_method</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$method</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $method - value corresponding to openssl's SSL_METHOD structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_ssl_version.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_ssl_version.html</a></p>

</li>
<li><p>set_tmp_dh</p>

<p>Sets DH parameters to be used to be $dh.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set_tmp_dh</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$dh</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $dh - value corresponding to openssl's DH structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_tmp_dh_callback.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_tmp_dh_callback.html</a></p>

</li>
<li><p>set_tmp_dh_callback</p>

<p>Sets the callback function for $ssl to be used when a DH parameters are required to $dh_cb.</p>

<p>??? (does this function really work?)</p>

<pre><code><code> <span class="variable">Net::SSLeay::set_tmp_dh_callback</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$dh</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $dh_cb - pointer to function ???</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_tmp_dh_callback.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_tmp_dh_callback.html</a></p>

</li>
<li><p>set_tmp_rsa</p>

<p>Sets the temporary/ephemeral RSA key to be used in $ssl to be $rsa.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set_tmp_rsa</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$rsa</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $rsa - value corresponding to openssl's RSA structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Example:</p>

<pre><code><code> <span class="variable">$rsakey</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::RSA_generate_key</span><span class="operator">();</span>
 <span class="variable">Net::SSLeay::set_tmp_rsa</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$rsakey</span><span class="operator">);</span>
 <span class="variable">Net::SSLeay::RSA_free</span><span class="operator">(</span><span class="variable">$rsakey</span><span class="operator">);</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_tmp_rsa_callback.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_tmp_rsa_callback.html</a></p>

</li>
<li><p>set_tmp_rsa_callback</p>

<p>Sets the callback function for $ssl to be used when a temporary/ephemeral RSA key is required to $tmp_rsa_callback.</p>

<p>??? (does this function really work?)</p>

<pre><code><code> <span class="variable">Net::SSLeay::set_tmp_rsa_callback</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$tmp_rsa_callback</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $tmp_rsa_callback - (function pointer) ???</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_tmp_rsa_callback.html">http://www.openssl.org/docs/ssl/SSL_CTX_set_tmp_rsa_callback.html</a></p>

</li>
<li><p>set_trust</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::set_trust</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$trust</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $trust - (integer) trust identifier</span>
 <span class="comment">#</span>
 <span class="comment"># returns: the original value</span>
</code></code></pre>

<p>For more details about $trust values see <a href="#CTX_set_trust">&quot;CTX_set_trust&quot;</a>.</p>

</li>
<li><p>shutdown</p>

<p>Shuts down an active TLS/SSL connection. It sends the &#39;close notify&#39; shutdown alert to the peer.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::shutdown</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 - shutdown was successfully completed</span>
 <span class="comment">#          0 - shutdown is not yet finished,</span>
 <span class="comment">#         -1 - shutdown was not successful</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_shutdown.html">http://www.openssl.org/docs/ssl/SSL_shutdown.html</a></p>

</li>
<li><p>state_string</p>

<p>Returns a 6 letter string indicating the current state of the SSL object $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::state_string</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 6-letter string</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_state_string.html">http://www.openssl.org/docs/ssl/SSL_state_string.html</a></p>

</li>
<li><p>state_string_long</p>

<p>Returns a string indicating the current state of the SSL object $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::state_string_long</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: state strings</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_state_string.html">http://www.openssl.org/docs/ssl/SSL_state_string.html</a></p>

</li>
<li><p>use_PrivateKey</p>

<p>Adds $pkey as private key to $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::use_PrivateKey</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$pkey</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $pkey - value corresponding to openssl's EVP_PKEY structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, otherwise check out the error stack to find out the reason</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html">http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html</a></p>

</li>
<li><p>use_PrivateKey_ASN1</p>

<p>Adds the private key of type $pk stored in $data to $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::use_PrivateKey_ASN1</span><span class="operator">(</span><span class="variable">$pk</span><span class="operator">,</span> <span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$d</span><span class="operator">,</span> <span class="variable">$len</span><span class="operator">);</span>
 <span class="comment"># $pk - (integer) key type, NID of corresponding algorithm</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $data - key data (binary)</span>
 <span class="comment"># $len - length of $data</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, otherwise check out the error stack to find out the reason</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html">http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html</a></p>

</li>
<li><p>use_PrivateKey_file</p>

<p>Adds the first private key found in $file to $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::use_PrivateKey_file</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$file</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $file - (string) file name</span>
 <span class="comment"># $type - (integer) type - use constants &amp;Net::SSLeay::FILETYPE_PEM or &amp;Net::SSLeay::FILETYPE_ASN1</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, otherwise check out the error stack to find out the reason</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html">http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html</a></p>

</li>
<li><p>use_RSAPrivateKey</p>

<p>Adds $rsa as RSA private key to $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::use_RSAPrivateKey</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$rsa</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $rsa - value corresponding to openssl's RSA structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, otherwise check out the error stack to find out the reason</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html">http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html</a></p>

</li>
<li><p>use_RSAPrivateKey_ASN1</p>

<p>Adds RSA private key stored in $data to $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::use_RSAPrivateKey_ASN1</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$data</span><span class="operator">,</span> <span class="variable">$len</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $data - key data (binary)</span>
 <span class="comment"># $len - length of $data</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, otherwise check out the error stack to find out the reason</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html">http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html</a></p>

</li>
<li><p>use_RSAPrivateKey_file</p>

<p>Adds the first RSA private key found in $file to $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::use_RSAPrivateKey_file</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$file</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $file - (string) file name</span>
 <span class="comment"># $type - (integer) type - use constants &amp;Net::SSLeay::FILETYPE_PEM or &amp;Net::SSLeay::FILETYPE_ASN1</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, otherwise check out the error stack to find out the reason</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html">http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html</a></p>

</li>
<li><p>use_certificate</p>

<p>Loads the certificate $x into $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::use_certificate</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, otherwise check out the error stack to find out the reason</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html">http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html</a></p>

</li>
<li><p>use_certificate_ASN1</p>

<p>Loads the ASN1 encoded certificate from $data to $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::use_certificate_ASN1</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$data</span><span class="operator">,</span> <span class="variable">$len</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $data - certificate data (binary)</span>
 <span class="comment"># $len - length of $data</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, otherwise check out the error stack to find out the reason</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html">http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html</a></p>

</li>
<li><p>use_certificate_file</p>

<p>Loads the first certificate stored in $file into $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::use_certificate_file</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$file</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $file - (string) file name</span>
 <span class="comment"># $type - (integer) type - use constants &amp;Net::SSLeay::FILETYPE_PEM or &amp;Net::SSLeay::FILETYPE_ASN1</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, otherwise check out the error stack to find out the reason</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html">http://www.openssl.org/docs/ssl/SSL_CTX_use_certificate.html</a></p>

</li>
<li><p>version</p>

<p>Returns SSL/TLS protocol version</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::version</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) protocol version</span>
 <span class="comment">#          0x0002 - SSL2_VERSION  (SSLv2)</span>
 <span class="comment">#          0x0300 - SSL3_VERSION  (SSLv3)</span>
 <span class="comment">#          0x0301 - TLS1_VERSION  (TLSv1)</span>
 <span class="comment">#          0xFEFF - DTLS1_VERSION (DTLSv1)</span>
</code></code></pre>

</li>
<li><p>want</p>

<p>Returns state information for the SSL object $ssl.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::want</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: state</span>
 <span class="comment">#          1 - SSL_NOTHING</span>
 <span class="comment">#          2 - SSL_WRITING</span>
 <span class="comment">#          3 - SSL_READING</span>
 <span class="comment">#          4 - SSL_X509_LOOKUP</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_want.html">http://www.openssl.org/docs/ssl/SSL_want.html</a></p>

</li>
<li><p>write</p>

<p>Writes data from the buffer $data into the specified $ssl connection.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::write</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$data</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $data - data to be written</span>
 <span class="comment">#</span>
 <span class="comment"># returns: &gt;0 - (success) number of bytes actually written to the TLS/SSL connection</span>
 <span class="comment">#           0 - write not successful, probably the underlying connection was closed</span>
 <span class="comment">#          &lt;0 - error</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_write.html">http://www.openssl.org/docs/ssl/SSL_write.html</a></p>

</li>
<li><p>write_partial</p>

<p><b>NOTE:</b> Does not exactly correspond to any low level API function</p>

<p>Writes a fragment of data data from the buffer $data into the specified $ssl connection.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::write_partial</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$from</span><span class="operator">,</span> <span class="variable">$count</span><span class="operator">,</span> <span class="variable">$data</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $from - (integer) offset from the beginning of $data</span>
 <span class="comment"># $count - (integer) length of data to be written</span>
 <span class="comment"># $data - data buffer</span>
 <span class="comment">#</span>
 <span class="comment"># returns: &gt;0 - (success) number of bytes actually written to the TLS/SSL connection</span>
 <span class="comment">#           0 - write not successful, probably the underlying connection was closed</span>
 <span class="comment">#          &lt;0 - error</span>
</code></code></pre>

</li>
<li><p>set_tlsext_host_name</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-0.9.8f</p>

<p>Sets TLS servername extension on SLL object $ssl to value $name.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">set_tlsext_host_name</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$name</span><span class="operator">);</span>
 <span class="comment"># $ssl - value corresponding to openssl's SSL structure</span>
 <span class="comment"># $name - (string) name to be set</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
</ul>

<h3 id="Low-level-API:-RAND_-related-functions">Low level API: RAND_* related functions</h3>

<p>Check openssl doc related to RAND stuff <a href="http://www.openssl.org/docs/crypto/rand.html">http://www.openssl.org/docs/crypto/rand.html</a></p>

<ul>

<li><p>RAND_add</p>

<p>Mixes the $num bytes at $buf into the PRNG state.</p>

<pre><code><code> <span class="variable">Net::SSLeay::RAND_add</span><span class="operator">(</span><span class="variable">$buf</span><span class="operator">,</span> <span class="variable">$num</span><span class="operator">,</span> <span class="variable">$entropy</span><span class="operator">);</span>
 <span class="comment"># $buf - buffer with data to be mixed into the PRNG state</span>
 <span class="comment"># $num - number of bytes in $buf</span>
 <span class="comment"># $entropy - estimate of how much randomness is contained in $buf (in bytes)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/RAND_add.html">http://www.openssl.org/docs/crypto/RAND_add.html</a></p>

</li>
<li><p>RAND_seed</p>

<p>Equivalent to <a href="#RAND_add">&quot;RAND_add&quot;</a> when $num == $entropy.</p>

<pre><code><code> <span class="variable">Net::SSLeay::RAND_seed</span><span class="operator">(</span><span class="variable">$buf</span><span class="operator">);</span>   <span class="comment"># Perlishly figures out buf size</span>
 <span class="comment"># $buf - buffer with data to be mixed into the PRNG state</span>
 <span class="comment"># $num - number of bytes in $buf</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/RAND_add.html">http://www.openssl.org/docs/crypto/RAND_add.html</a></p>

</li>
<li><p>RAND_status</p>

<p>Gives PRNG status (seeded enough or not).</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::RAND_status</span><span class="operator">();</span>
 <span class="comment">#returns: 1 if the PRNG has been seeded with enough data, 0 otherwise</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/RAND_add.html">http://www.openssl.org/docs/crypto/RAND_add.html</a></p>

</li>
<li><p>RAND_bytes</p>

<p>Puts $num cryptographically strong pseudo-random bytes into $buf.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::RAND_bytes</span><span class="operator">(</span><span class="variable">$buf</span><span class="operator">,</span> <span class="variable">$num</span><span class="operator">);</span>
 <span class="comment"># $buf - buffer where the random data will be stored</span>
 <span class="comment"># $num - the size (in bytes) of requested random data</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 otherwise</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/RAND_bytes.html">http://www.openssl.org/docs/crypto/RAND_bytes.html</a></p>

</li>
<li><p>RAND_pseudo_bytes</p>

<p>Puts $num pseudo-random (not necessarily unpredictable) bytes into $buf.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::RAND_pseudo_bytes</span><span class="operator">(</span><span class="variable">$buf</span><span class="operator">,</span> <span class="variable">$num</span><span class="operator">);</span>
 <span class="comment"># $buf - buffer where the random data will be stored</span>
 <span class="comment"># $num - the size (in bytes) of requested random data</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 if the bytes generated are cryptographically strong, 0 otherwise</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/RAND_bytes.html">http://www.openssl.org/docs/crypto/RAND_bytes.html</a></p>

</li>
<li><p>RAND_cleanup</p>

<p>Erase the PRNG state.</p>

<pre><code><code> <span class="variable">Net::SSLeay::RAND_cleanup</span><span class="operator">();</span>
 <span class="comment"># no args, no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/RAND_cleanup.html">http://www.openssl.org/docs/crypto/RAND_cleanup.html</a></p>

</li>
<li><p>RAND_egd</p>

<p>Queries the entropy gathering daemon EGD on socket $path for 255 bytes.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::RAND_egd</span><span class="operator">(</span><span class="variable">$path</span><span class="operator">);</span>
 <span class="comment"># $path - path to a socket of entropy gathering daemon EGD</span>
 <span class="comment">#</span>
 <span class="comment"># returns: the number of bytes read from the daemon on success, and -1 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/RAND_egd.html">http://www.openssl.org/docs/crypto/RAND_egd.html</a></p>

</li>
<li><p>RAND_egd_bytes</p>

<p>Queries the entropy gathering daemon EGD on socket $path for $bytes bytes.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::RAND_egd_bytes</span><span class="operator">(</span><span class="variable">$path</span><span class="operator">,</span> <span class="variable">$bytes</span><span class="operator">);</span>
 <span class="comment"># $path - path to a socket of entropy gathering daemon EGD</span>
 <span class="comment"># $bytes - number of bytes we want from EGD</span>
 <span class="comment">#</span>
 <span class="comment"># returns: the number of bytes read from the daemon on success, and -1 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/RAND_egd.html">http://www.openssl.org/docs/crypto/RAND_egd.html</a></p>

</li>
<li><p>RAND_file_name</p>

<p>Generates a default path for the random seed file.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$file</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::RAND_file_name</span><span class="operator">(</span><span class="variable">$num</span><span class="operator">);</span>
 <span class="comment"># $num - maximum size of returned file name</span>
 <span class="comment">#</span>
 <span class="comment"># returns: string with file name on success, '' (empty string) on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/RAND_load_file.html">http://www.openssl.org/docs/crypto/RAND_load_file.html</a></p>

</li>
<li><p>RAND_load_file</p>

<p>Reads $max_bytes of bytes from $file_name and adds them to the PRNG.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::RAND_load_file</span><span class="operator">(</span><span class="variable">$file_name</span><span class="operator">,</span> <span class="variable">$max_bytes</span><span class="operator">);</span>
 <span class="comment"># $file_name - the name of file</span>
 <span class="comment"># $max_bytes - bytes to read from $file_name; -1 =&gt; the complete file is read</span>
 <span class="comment">#</span>
 <span class="comment"># returns: the number of bytes read</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/RAND_load_file.html">http://www.openssl.org/docs/crypto/RAND_load_file.html</a></p>

</li>
<li><p>RAND_write_file</p>

<p>Writes 1024 random bytes to $file_name which can be used to initialize the PRNG by calling <a href="#RAND_load_file">&quot;RAND_load_file&quot;</a> in a later session.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::RAND_write_file</span><span class="operator">(</span><span class="variable">$file_name</span><span class="operator">);</span>
 <span class="comment"># $file_name - the name of file</span>
 <span class="comment">#</span>
 <span class="comment"># returns: the number of bytes written, and -1 if the bytes written were generated without appropriate seed</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/RAND_load_file.html">http://www.openssl.org/docs/crypto/RAND_load_file.html</a></p>

</li>
<li><p>RAND_poll</p>

<p>Collects some entropy from operating system and adds it to the PRNG.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::RAND_poll</span><span class="operator">();</span>
 <span class="comment"># returns: 1 on success, 0 on failure (unable to gather reasonable entropy)</span>
</code></code></pre>

</li>
</ul>

<h3 id="Low-level-API:-OBJ_-related-functions">Low level API: OBJ_* related functions</h3>

<ul>

<li><p>OBJ_cmp</p>

<p>Compares ASN1_OBJECT $a to ASN1_OBJECT $b.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::OBJ_cmp</span><span class="operator">(</span><span class="variable">$a</span><span class="operator">,</span> <span class="variable">$b</span><span class="operator">);</span>
 <span class="comment"># $a - value corresponding to openssl's ASN1_OBJECT structure</span>
 <span class="comment"># $b - value corresponding to openssl's ASN1_OBJECT structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: if the two are identical 0 is returned</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/OBJ_nid2obj.html">http://www.openssl.org/docs/crypto/OBJ_nid2obj.html</a></p>

</li>
<li><p>OBJ_dup</p>

<p>Returns a copy/duplicate of $o.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::OBJ_dup</span><span class="operator">(</span><span class="variable">$o</span><span class="operator">);</span>
 <span class="comment"># $o - value corresponding to openssl's ASN1_OBJECT structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_OBJECT structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/OBJ_nid2obj.html">http://www.openssl.org/docs/crypto/OBJ_nid2obj.html</a></p>

</li>
<li><p>OBJ_nid2ln</p>

<p>Returns long name for given NID $n.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::OBJ_nid2ln</span><span class="operator">(</span><span class="variable">$n</span><span class="operator">);</span>
 <span class="comment"># $n - (integer) NID</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (string) long name e.g. 'commonName'</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/OBJ_nid2obj.html">http://www.openssl.org/docs/crypto/OBJ_nid2obj.html</a></p>

</li>
<li><p>OBJ_ln2nid</p>

<p>Returns NID corresponding to given long name $n.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::OBJ_ln2nid</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">);</span>
 <span class="comment"># $s - (string) long name e.g. 'commonName'</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) NID</span>
</code></code></pre>

</li>
<li><p>OBJ_nid2sn</p>

<p>Returns short name for given NID $n.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::OBJ_nid2sn</span><span class="operator">(</span><span class="variable">$n</span><span class="operator">);</span>
 <span class="comment"># $n - (integer) NID</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (string) short name e.g. 'CN'</span>
</code></code></pre>

<p>Example:</p>

<pre><code><code> <span class="keyword">print</span> <span class="variable">Net::SSLeay::OBJ_nid2sn</span><span class="operator">(&amp;</span><span class="variable">Net::SSLeay::NID_commonName</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>OBJ_sn2nid</p>

<p>Returns NID corresponding to given short name $s.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::OBJ_sn2nid</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">);</span>
 <span class="comment"># $s - (string) short name e.g. 'CN'</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) NID</span>
</code></code></pre>

<p>Example:</p>

<pre><code><code> <span class="keyword">print</span> <span class="string">"NID_commonName constant="</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">Net::SSLeay::NID_commonName</span><span class="operator">;</span>
 <span class="keyword">print</span> <span class="string">"OBJ_sn2nid('CN')="</span><span class="operator">,</span> <span class="variable">Net::SSLeay::OBJ_sn2nid</span><span class="operator">(</span><span class="string">'CN'</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>OBJ_nid2obj</p>

<p>Returns ASN1_OBJECT for given NID $n.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::OBJ_nid2obj</span><span class="operator">(</span><span class="variable">$n</span><span class="operator">);</span>
 <span class="comment"># $n - (integer) NID</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_OBJECT structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/OBJ_nid2obj.html">http://www.openssl.org/docs/crypto/OBJ_nid2obj.html</a></p>

</li>
<li><p>OBJ_obj2nid</p>

<p>Returns NID corresponding to given ASN1_OBJECT $o.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::OBJ_obj2nid</span><span class="operator">(</span><span class="variable">$o</span><span class="operator">);</span>
 <span class="comment"># $o - value corresponding to openssl's ASN1_OBJECT structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) NID</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/OBJ_nid2obj.html">http://www.openssl.org/docs/crypto/OBJ_nid2obj.html</a></p>

</li>
<li><p>OBJ_txt2obj</p>

<p>Converts the text string s into an ASN1_OBJECT structure. If $no_name is 0 then long names (e.g. &#39;commonName&#39;) and short names (e.g. &#39;CN&#39;) will be interpreted as well as numerical forms (e.g. &#39;2.5.4.3&#39;). If $no_name is 1 only the numerical form is acceptable.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::OBJ_txt2obj</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">,</span> <span class="variable">$no_name</span><span class="operator">);</span>
 <span class="comment"># $s - text string to be converted</span>
 <span class="comment"># $no_name - (integer) 0 or 1</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_OBJECT structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/OBJ_nid2obj.html">http://www.openssl.org/docs/crypto/OBJ_nid2obj.html</a></p>

</li>
<li><p>OBJ_obj2txt</p>

<p>Converts the ASN1_OBJECT a into a textual representation.</p>

<pre><code><code> <span class="variable">Net::SSLeay::OBJ_obj2txt</span><span class="operator">(</span><span class="variable">$a</span><span class="operator">,</span> <span class="variable">$no_name</span><span class="operator">);</span>
 <span class="comment"># $a - value corresponding to openssl's ASN1_OBJECT structure</span>
 <span class="comment"># $no_name - (integer) 0 or 1</span>
 <span class="comment">#</span>
 <span class="comment"># returns: textual representation e.g. 'commonName' ($no_name=0), '2.5.4.3' ($no_name=1)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/OBJ_nid2obj.html">http://www.openssl.org/docs/crypto/OBJ_nid2obj.html</a></p>

</li>
<li><p>OBJ_txt2nid</p>

<p>Returns NID corresponding to text string $s which can be a long name, a short name or the numerical respresentation of an object.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::OBJ_txt2nid</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">);</span>
 <span class="comment"># $s - (string) e.g. 'commonName' or 'CN' or '2.5.4.3'</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) NID</span>
</code></code></pre>

<p>Example:</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$nid</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::OBJ_txt2nid</span><span class="operator">(</span><span class="string">'2.5.4.3'</span><span class="operator">);</span>
 <span class="variable">Net::SSLeay::OBJ_nid2sn</span><span class="operator">(</span><span class="variable">$n</span><span class="operator">);</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/OBJ_nid2obj.html">http://www.openssl.org/docs/crypto/OBJ_nid2obj.html</a></p>

</li>
</ul>

<h3 id="Low-level-API:-ASN1_INTEGER_-related-functions">Low level API: ASN1_INTEGER_* related functions</h3>

<ul>

<li><p>ASN1_INTEGER_new</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Creates a new ASN1_INTEGER structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::ASN1_INTEGER_new</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_INTEGER structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>ASN1_INTEGER_free</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Free an allocated ASN1_INTEGER structure.</p>

<pre><code><code> <span class="variable">Net::SSLeay::ASN1_INTEGER_free</span><span class="operator">(</span><span class="variable">$i</span><span class="operator">);</span>
 <span class="comment"># $i - value corresponding to openssl's ASN1_INTEGER structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

</li>
<li><p>ASN1_INTEGER_get</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns integer value of given ASN1_INTEGER object.</p>

<p><b>BEWARE:</b> If the value stored in ASN1_INTEGER is greater than max. integer that can be stored in &#39;long&#39; type (usually 32bit but may vary according to platform) then this function will return -1. For getting large ASN1_INTEGER values consider using <a href="#P_ASN1_INTEGER_get_dec">&quot;P_ASN1_INTEGER_get_dec&quot;</a> or <a href="#P_ASN1_INTEGER_get_hex">&quot;P_ASN1_INTEGER_get_hex&quot;</a>.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::ASN1_INTEGER_get</span><span class="operator">(</span><span class="variable">$a</span><span class="operator">);</span>
 <span class="comment"># $a - value corresponding to openssl's ASN1_INTEGER structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: integer value of ASN1_INTEGER object in $a</span>
</code></code></pre>

</li>
<li><p>ASN1_INTEGER_set</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Sets value of given ASN1_INTEGER object to value $val</p>

<p><b>BEWARE:</b> $val has max. limit (= max. integer that can be stored in &#39;long&#39; type). For setting large ASN1_INTEGER values consider using <a href="#P_ASN1_INTEGER_set_dec">&quot;P_ASN1_INTEGER_set_dec&quot;</a> or <a href="#P_ASN1_INTEGER_set_hex">&quot;P_ASN1_INTEGER_set_hex&quot;</a>.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::ASN1_INTEGER_set</span><span class="operator">(</span><span class="variable">$i</span><span class="operator">,</span> <span class="variable">$val</span><span class="operator">);</span>
 <span class="comment"># $i - value corresponding to openssl's ASN1_INTEGER structure</span>
 <span class="comment"># $val - integer value</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>P_ASN1_INTEGER_get_dec</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns string with decimal representation of integer value of given ASN1_INTEGER object.</p>

<pre><code><code> <span class="variable">Net::SSLeay::P_ASN1_INTEGER_get_dec</span><span class="operator">(</span><span class="variable">$i</span><span class="operator">);</span>
 <span class="comment"># $i - value corresponding to openssl's ASN1_INTEGER structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: string with decimal representation</span>
</code></code></pre>

</li>
<li><p>P_ASN1_INTEGER_get_hex</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns string with hexadecimal representation of integer value of given ASN1_INTEGER object.</p>

<pre><code><code> <span class="variable">Net::SSLeay::P_ASN1_INTEGER_get_hex</span><span class="operator">(</span><span class="variable">$i</span><span class="operator">);</span>
 <span class="comment"># $i - value corresponding to openssl's ASN1_INTEGER structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: string with hexadecimal representation</span>
</code></code></pre>

</li>
<li><p>P_ASN1_INTEGER_set_dec</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Sets value of given ASN1_INTEGER object to value $val (decimal string, suitable for large integers)</p>

<pre><code><code> <span class="variable">Net::SSLeay::P_ASN1_INTEGER_set_dec</span><span class="operator">(</span><span class="variable">$i</span><span class="operator">,</span> <span class="variable">$str</span><span class="operator">);</span>
 <span class="comment"># $i - value corresponding to openssl's ASN1_INTEGER structure</span>
 <span class="comment"># $str - string with decimal representation</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>P_ASN1_INTEGER_set_hex</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Sets value of given ASN1_INTEGER object to value $val (hexadecimal string, suitable for large integers)</p>

<pre><code><code> <span class="variable">Net::SSLeay::P_ASN1_INTEGER_set_hex</span><span class="operator">(</span><span class="variable">$i</span><span class="operator">,</span> <span class="variable">$str</span><span class="operator">);</span>
 <span class="comment"># $i - value corresponding to openssl's ASN1_INTEGER structure</span>
 <span class="comment"># $str - string with hexadecimal representation</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
</ul>

<h3 id="Low-level-API:-ASN1_STRING_-related-functions">Low level API: ASN1_STRING_* related functions</h3>

<ul>

<li><p>P_ASN1_STRING_get</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns string value of given ASN1_STRING object.</p>

<pre><code><code> <span class="variable">Net::SSLeay::P_ASN1_STRING_get</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">,</span> <span class="variable">$utf8_decode</span><span class="operator">);</span>
 <span class="comment"># $s - value corresponding to openssl's ASN1_STRING structure</span>
 <span class="comment"># $utf8_decode - [optional] 0 or 1 whether the returned value should be utf8 decoded (default=0)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: string</span>
 
 <span class="variable">$string</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_ASN1_STRING_get</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">);</span>
 <span class="comment">#is the same as:</span>
 <span class="variable">$string</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_ASN1_STRING_get</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">,</span> <span class="number">0</span><span class="operator">);</span>
</code></code></pre>

</li>
</ul>

<h3 id="Low-level-API:-ASN1_TIME_-related-functions">Low level API: ASN1_TIME_* related functions</h3>

<ul>

<li><p>ASN1_TIME_new</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$time</span> <span class="operator">=</span> <span class="variable">ASN1_TIME_new</span><span class="operator">();</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_TIME structure</span>
</code></code></pre>

</li>
<li><p>ASN1_TIME_free</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before</p>

<pre><code><code> <span class="variable">ASN1_TIME_free</span><span class="operator">(</span><span class="variable">$time</span><span class="operator">);</span>
 <span class="comment"># $time - value corresponding to openssl's ASN1_TIME structure</span>
</code></code></pre>

</li>
<li><p>ASN1_TIME_set</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before</p>

<pre><code><code> <span class="variable">ASN1_TIME_set</span><span class="operator">(</span><span class="variable">$time</span><span class="operator">,</span> <span class="variable">$t</span><span class="operator">);</span>
 <span class="comment"># $time - value corresponding to openssl's ASN1_TIME structure</span>
 <span class="comment"># $t - time value in seconds since 1.1.1970</span>
</code></code></pre>

<p><b>BEWARE:</b> It is platform dependent how this function will handle dates after 2038. Although perl&#39;s integer is large enough the internal implementation of this function is dependent on the size of time_t structure (32bit time_t has problem with 2038).</p>

<p>If you want to safely set date and time after 2038 use function <a href="#P_ASN1_TIME_set_isotime">&quot;P_ASN1_TIME_set_isotime&quot;</a>.</p>

</li>
<li><p>P_ASN1_TIME_get_isotime</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before; requires at least openssl-0.9.7e</p>

<p><b>NOTE:</b> Does not exactly correspond to any low level API function</p>

<p>Gives ISO-8601 string representation of ASN1_TIME structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$datetime_string</span> <span class="operator">=</span> <span class="variable">P_ASN1_TIME_get_isotime</span><span class="operator">(</span><span class="variable">$time</span><span class="operator">);</span>
 <span class="comment"># $time - value corresponding to openssl's ASN1_TIME structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: datetime string like '2033-05-16T20:39:37Z' or '' on failure</span>
</code></code></pre>

<p>The output format is compatible with module <a>DateTime::Format::RFC3339</a></p>

</li>
<li><p>P_ASN1_TIME_set_isotime</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before; requires at least openssl-0.9.7e</p>

<p><b>NOTE:</b> Does not exactly correspond to any low level API function</p>

<p>Sets time and date value of ANS1_time structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">P_ASN1_TIME_set_isotime</span><span class="operator">(</span><span class="variable">$time</span><span class="operator">,</span> <span class="variable">$string</span><span class="operator">);</span>
 <span class="comment"># $time - value corresponding to openssl's ASN1_TIME structure</span>
 <span class="comment"># $string - ISO-8601 timedate string like '2033-05-16T20:39:37Z'</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>The <code><code>$string</code></code> parameter has to be in full form like <code><code>&quot;2012-03-22T23:55:33&quot;</code></code> or <code><code>&quot;2012-03-22T23:55:33Z&quot;</code></code> or <code><code>&quot;2012-03-22T23:55:33CET&quot;</code></code>. Short forms like <code><code>&quot;2012-03-22T23:55&quot;</code></code> or <code><code>&quot;2012-03-22&quot;</code></code> are not supported.</p>

</li>
<li><p>P_ASN1_TIME_put2string</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before, has bugs with openssl-0.9.8i</p>

<p><b>NOTE:</b> Does not exactly correspond to any low level API function</p>

<p>Gives string representation of ASN1_TIME structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$str</span> <span class="operator">=</span> <span class="variable">P_ASN1_TIME_put2string</span><span class="operator">(</span><span class="variable">$time</span><span class="operator">);</span>
 <span class="comment"># $time - value corresponding to openssl's ASN1_TIME structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: datetime string like 'May 16 20:39:37 2033 GMT'</span>
</code></code></pre>

</li>
<li><p>P_ASN1_UTCTIME_put2string</p>

<p><b>NOTE:</b> deprecated function, only for backward compatibility, just an alias for <a href="#P_ASN1_TIME_put2string">&quot;P_ASN1_TIME_put2string&quot;</a></p>

</li>
</ul>

<h3 id="Low-level-API:-X509_-related-functions">Low level API: X509_* related functions</h3>

<ul>

<li><p>X509_new</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Allocates and initializes a X509 structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_new</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509 structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_new.html">http://www.openssl.org/docs/crypto/X509_new.html</a></p>

</li>
<li><p>X509_free</p>

<p>Frees up the X509 structure.</p>

<pre><code><code> <span class="variable">Net::SSLeay::X509_free</span><span class="operator">(</span><span class="variable">$a</span><span class="operator">);</span>
 <span class="comment"># $a - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_new.html">http://www.openssl.org/docs/crypto/X509_new.html</a></p>

</li>
<li><p>X509_certificate_type</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns bitmask with type of certificate $x.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_certificate_type</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) bitmask with certificate type</span>
 
 <span class="comment">#to decode bitmask returned by this function use these constants:</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::EVP_PKS_DSA</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::EVP_PKS_EC</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::EVP_PKS_RSA</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::EVP_PKT_ENC</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::EVP_PKT_EXCH</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::EVP_PKT_EXP</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::EVP_PKT_SIGN</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::EVP_PK_DH</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::EVP_PK_DSA</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::EVP_PK_EC</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::EVP_PK_RSA</span>
</code></code></pre>

</li>
<li><p>X509_digest</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Computes digest/fingerprint of X509 $data using $type hash function.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$digest_value</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_digest</span><span class="operator">(</span><span class="variable">$data</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">);</span>
 <span class="comment"># $data - value corresponding to openssl's X509 structure</span>
 <span class="comment"># $type - value corresponding to openssl's EVP_MD structure - e.g. got via EVP_get_digestbyname()</span>
 <span class="comment">#</span>
 <span class="comment"># returns: hash value (binary)</span>
 
 <span class="comment">#to get printable (hex) value of digest use:</span>
 <span class="keyword">print</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">'H*'</span><span class="operator">,</span> <span class="variable">$digest_value</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>X509_issuer_and_serial_hash</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Sort of a checksum of issuer name and serial number of X509 certificate $x. The result is not a full hash (e.g. sha-1), it is kind-of-a-hash truncated to the size of &#39;unsigned long&#39; (32 bits). The resulting value might differ across different openssl versions for the same X509 certificate.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_issuer_and_serial_hash</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: number representing checksum</span>
</code></code></pre>

</li>
<li><p>X509_issuer_name_hash</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Sort of a checksum of issuer name of X509 certificate $x. The result is not a full hash (e.g. sha-1), it is kind-of-a-hash truncated to the size of &#39;unsigned long&#39; (32 bits). The resulting value might differ across different openssl versions for the same X509 certificate.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_issuer_name_hash</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: number representing checksum</span>
</code></code></pre>

</li>
<li><p>X509_subject_name_hash</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Sort of a checksum of subject name of X509 certificate $x. The result is not a full hash (e.g. sha-1), it is kind-of-a-hash truncated to the size of &#39;unsigned long&#39; (32 bits). The resulting value might differ across different openssl versions for the same X509 certificate.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_subject_name_hash</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: number representing checksum</span>
</code></code></pre>

</li>
<li><p>X509_pubkey_digest</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-0.9.7</p>

<p>Computes digest/fingerprint of public key from X509 certificate $data using $type hash function.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$digest_value</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_pubkey_digest</span><span class="operator">(</span><span class="variable">$data</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">);</span>
 <span class="comment"># $data - value corresponding to openssl's X509 structure</span>
 <span class="comment"># $type - value corresponding to openssl's EVP_MD structure - e.g. got via EVP_get_digestbyname()</span>
 <span class="comment">#</span>
 <span class="comment"># returns: hash value (binary)</span>
 
 <span class="comment">#to get printable (hex) value of digest use:</span>
 <span class="keyword">print</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">'H*'</span><span class="operator">,</span> <span class="variable">$digest_value</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>X509_set_issuer_name</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Sets issuer of X509 certificate $x to $name.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_set_issuer_name</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="variable">$name</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment"># $name - value corresponding to openssl's X509_NAME structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_set_pubkey</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Sets public key of X509 certificate $x to $pkey.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_set_pubkey</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="variable">$pkey</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment"># $pkey - value corresponding to openssl's EVP_PKEY structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_set_serialNumber</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Sets serial number of X509 certificate $x to $serial.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_set_serialNumber</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="variable">$serial</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment"># $serial - value corresponding to openssl's ASN1_INTEGER structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
 
 <span class="comment">#to create $serial value use one of these:</span>
 <span class="variable">$serial</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_ASN1_INTEGER_set_hex</span><span class="operator">(</span><span class="string">'45ad6f'</span><span class="operator">);</span>
 <span class="variable">$serial</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_ASN1_INTEGER_set_dec</span><span class="operator">(</span><span class="string">'7896541238529631478'</span><span class="operator">);</span>
 <span class="variable">$serial</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::ASN1_INTEGER_set</span><span class="operator">(</span><span class="number">45896</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>X509_set_subject_name</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Sets subject of X509 certificate $x to $name.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_set_subject_name</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="variable">$name</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment"># $name - value corresponding to openssl's X509_NAME structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_set_version</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Set &#39;version&#39; value for X509 certificate $ to $version.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_set_version</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="variable">$version</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment"># $version - (integer) version number</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_sign</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Sign X509 certificate $x with private key $pkey (using digest algorithm $md).</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_sign</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="variable">$pkey</span><span class="operator">,</span> <span class="variable">$md</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment"># $pkey - value corresponding to openssl's EVP_PKEY structure</span>
 <span class="comment"># $md - value corresponding to openssl's EVP_MD structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_verify</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Verifies X509 object $a using public key $r (pubkey of issuing CA).</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_verify</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="variable">$r</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment"># $r - value corresponding to openssl's EVP_PKEY structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 0 - verify failure, 1 - verify OK, &lt;0 - error</span>
</code></code></pre>

</li>
<li><p>X509_get_ext_count</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns the total number of extensions in X509 object $x.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_get_ext_count</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: count of extensions</span>
</code></code></pre>

</li>
<li><p>X509_get_pubkey</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns public key corresponding to given X509 object $x.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_get_pubkey</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's EVP_PKEY structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509_get_serialNumber</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns serial number of X509 certificate $x.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_get_serialNumber</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_INTEGER structure (0 on failure)</span>
</code></code></pre>

<p>See <a href="#P_ASN1_INTEGER_get_dec">&quot;P_ASN1_INTEGER_get_dec&quot;</a>, <a href="#P_ASN1_INTEGER_get_hex">&quot;P_ASN1_INTEGER_get_hex&quot;</a> or <a href="#ASN1_INTEGER_get">&quot;ASN1_INTEGER_get&quot;</a> to decode ASN1_INTEGER object.</p>

</li>
<li><p>X509_get_version</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns &#39;version&#39; value of given X509 certificate $x.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_get_version</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) version</span>
</code></code></pre>

</li>
<li><p>X509_get_ext</p>

<p>Returns X509_EXTENSION from $x509 based on given position/index.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_get_ext</span><span class="operator">(</span><span class="variable">$x509</span><span class="operator">,</span> <span class="variable">$index</span><span class="operator">);</span>
 <span class="comment"># $x509 - value corresponding to openssl's X509 structure</span>
 <span class="comment"># $index - (integer) position/index of extension within $x509</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_EXTENSION structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509_get_ext_by_NID</p>

<p>Returns X509_EXTENSION from $x509 based on given NID.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_get_ext_by_NID</span><span class="operator">(</span><span class="variable">$x509</span><span class="operator">,</span> <span class="variable">$nid</span><span class="operator">,</span> <span class="variable">$loc</span><span class="operator">);</span>
 <span class="comment"># $x509 - value corresponding to openssl's X509 structure</span>
 <span class="comment"># $nid - (integer) NID value</span>
 <span class="comment"># $loc - (integer) position to start lookup at</span>
 <span class="comment">#</span>
 <span class="comment"># returns: position/index of extension, negative value on error</span>
 <span class="comment">#          call Net::SSLeay::X509_get_ext($x509, $rv) to get the actual extension</span>
</code></code></pre>

</li>
<li><p>X509_get_fingerprint</p>

<p>Returns fingerprint of certificate $cert.</p>

<p><b>NOTE:</b> Does not exactly correspond to any low level API function. The implementation is basen on openssl&#39;s <code><code>X509_digest()</code></code>.</p>

<pre><code><code> <span class="variable">Net::SSLeay::X509_get_fingerprint</span><span class="operator">(</span><span class="variable">$x509</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">);</span>
 <span class="comment"># $x509 - value corresponding to openssl's X509 structure</span>
 <span class="comment"># $type - (string) digest type, currently supported values:</span>
 <span class="comment">#         "md5"</span>
 <span class="comment">#         "sha1"</span>
 <span class="comment">#         "sha256"</span>
 <span class="comment">#         "ripemd160"</span>
 <span class="comment">#</span>
 <span class="comment"># returns: certificate digest - hexadecimal string (NOT binary data!)</span>
</code></code></pre>

</li>
<li><p>X509_get_issuer_name</p>

<p>Return an X509_NAME object representing the issuer of the certificate $cert.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_get_issuer_name</span><span class="operator">(</span><span class="variable">$cert</span><span class="operator">);</span>
 <span class="comment"># $cert - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_NAME structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509_get_notAfter</p>

<p>Return an object giving the time after which the certificate $cert is not valid.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_get_notAfter</span><span class="operator">(</span><span class="variable">$cert</span><span class="operator">);</span>
 <span class="comment"># $cert - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_TIME structure (0 on failure)</span>
</code></code></pre>

<p>To get human readable/printable form the return value you can use:</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$time</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_get_notAfter</span><span class="operator">(</span><span class="variable">$cert</span><span class="operator">);</span>
 <span class="keyword">print</span> <span class="string">"notAfter="</span><span class="operator">,</span> <span class="variable">Net::SSLeay::P_ASN1_TIME_get_isotime</span><span class="operator">(</span><span class="variable">$time</span><span class="operator">),</span> <span class="string">"\n"</span><span class="operator">;</span>
</code></code></pre>

</li>
<li><p>X509_get_notBefore</p>

<p>Return an object giving the time before which the certificate $cert is not valid</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_get_notBefore</span><span class="operator">(</span><span class="variable">$cert</span><span class="operator">);</span>
 <span class="comment"># $cert - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_TIME structure (0 on failure)</span>
</code></code></pre>

<p>To get human readable/printable form the return value you can use:</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$time</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_get_notBefore</span><span class="operator">(</span><span class="variable">$cert</span><span class="operator">);</span>
 <span class="keyword">print</span> <span class="string">"notBefore="</span><span class="operator">,</span> <span class="variable">Net::SSLeay::P_ASN1_TIME_get_isotime</span><span class="operator">(</span><span class="variable">$time</span><span class="operator">),</span> <span class="string">"\n"</span><span class="operator">;</span>
</code></code></pre>

</li>
<li><p>X509_get_subjectAltNames</p>

<p><b>NOTE:</b> Does not exactly correspond to any low level API function.</p>

<p>Returns the list of alternative subject names from X509 certificate $cert.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">@rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_get_subjectAltNames</span><span class="operator">(</span><span class="variable">$cert</span><span class="operator">);</span>
 <span class="comment"># $cert - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: list containing pairs - name_type (integer), name_value (string)</span>
 <span class="comment">#          where name_type can be:</span>
 <span class="comment">#          0 - GEN_OTHERNAME</span>
 <span class="comment">#          1 - GEN_EMAIL</span>
 <span class="comment">#          2 - GEN_DNS</span>
 <span class="comment">#          3 - GEN_X400</span>
 <span class="comment">#          4 - GEN_DIRNAME</span>
 <span class="comment">#          5 - GEN_EDIPARTY</span>
 <span class="comment">#          6 - GEN_URI</span>
 <span class="comment">#          7 - GEN_IPADD</span>
 <span class="comment">#          8 - GEN_RID</span>
</code></code></pre>

</li>
<li><p>X509_get_subject_name</p>

<p>Returns the subject of the certificate $cert.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_get_subject_name</span><span class="operator">(</span><span class="variable">$cert</span><span class="operator">);</span>
 <span class="comment"># $cert - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_NAME structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509_gmtime_adj</p>

<p>Adjust th ASN1_TIME object to the timestamp (in GMT).</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_gmtime_adj</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">,</span> <span class="variable">$adj</span><span class="operator">);</span>
 <span class="comment"># $s - value corresponding to openssl's ASN1_TIME structure</span>
 <span class="comment"># $adj - timestamp (seconds since 1.1.1970)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_TIME structure (0 on failure)</span>
</code></code></pre>

<p><b>BEWARE:</b> this function may fail for dates after 2038 as it is dependent on time_t size on your system (32bit time_t does not work after 2038). Consider using <a href="#P_ASN1_TIME_set_isotime">&quot;P_ASN1_TIME_set_isotime&quot;</a> instead).</p>

</li>
<li><p>X509_load_cert_crl_file</p>

<p>Takes PEM file and loads all X509 certificates and X509 CRLs from that file into X509_LOOKUP structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_load_cert_crl_file</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$file</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's X509_LOOKUP structure</span>
 <span class="comment"># $file - (string) file name</span>
 <span class="comment"># $type - (integer) type - use constants &amp;Net::SSLeay::FILETYPE_PEM or &amp;Net::SSLeay::FILETYPE_ASN1</span>
 <span class="comment">#                          if not FILETYPE_PEM then behaves as Net::SSLeay::X509_load_cert_file()</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_load_cert_file</p>

<p>Loads/adds X509 certificate from $file to X509_LOOKUP structure</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_load_cert_file</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$file</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's X509_LOOKUP structure</span>
 <span class="comment"># $file - (string) file name</span>
 <span class="comment"># $type - (integer) type - use constants &amp;Net::SSLeay::FILETYPE_PEM or &amp;Net::SSLeay::FILETYPE_ASN1</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_load_crl_file</p>

<p>Loads/adds X509 CRL from $file to X509_LOOKUP structure</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_load_crl_file</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$file</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's X509_LOOKUP structure</span>
 <span class="comment"># $file - (string) file name</span>
 <span class="comment"># $type - (integer) type - use constants &amp;Net::SSLeay::FILETYPE_PEM or &amp;Net::SSLeay::FILETYPE_ASN1</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_policy_level_get0_node</p>

<p>??? (more info needed)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_policy_level_get0_node</span><span class="operator">(</span><span class="variable">$level</span><span class="operator">,</span> <span class="variable">$i</span><span class="operator">);</span>
 <span class="comment"># $level - value corresponding to openssl's X509_POLICY_LEVEL structure</span>
 <span class="comment"># $i - (integer) index/position</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_POLICY_NODE structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509_policy_level_node_count</p>

<p>??? (more info needed)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_policy_level_node_count</span><span class="operator">(</span><span class="variable">$level</span><span class="operator">);</span>
 <span class="comment"># $level - value corresponding to openssl's X509_POLICY_LEVEL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) node count</span>
</code></code></pre>

</li>
<li><p>X509_policy_node_get0_parent</p>

<p>??? (more info needed)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_policy_node_get0_parent</span><span class="operator">(</span><span class="variable">$node</span><span class="operator">);</span>
 <span class="comment"># $node - value corresponding to openssl's X509_POLICY_NODE structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_POLICY_NODE structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509_policy_node_get0_policy</p>

<p>??? (more info needed)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_policy_node_get0_policy</span><span class="operator">(</span><span class="variable">$node</span><span class="operator">);</span>
 <span class="comment"># $node - value corresponding to openssl's X509_POLICY_NODE structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_OBJECT structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509_policy_node_get0_qualifiers</p>

<p>??? (more info needed)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_policy_node_get0_qualifiers</span><span class="operator">(</span><span class="variable">$node</span><span class="operator">);</span>
 <span class="comment"># $node - value corresponding to openssl's X509_POLICY_NODE structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's STACK_OF(POLICYQUALINFO) structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509_policy_tree_free</p>

<p>??? (more info needed)</p>

<pre><code><code> <span class="variable">Net::SSLeay::X509_policy_tree_free</span><span class="operator">(</span><span class="variable">$tree</span><span class="operator">);</span>
 <span class="comment"># $tree - value corresponding to openssl's X509_POLICY_TREE structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

</li>
<li><p>X509_policy_tree_get0_level</p>

<p>??? (more info needed)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_policy_tree_get0_level</span><span class="operator">(</span><span class="variable">$tree</span><span class="operator">,</span> <span class="variable">$i</span><span class="operator">);</span>
 <span class="comment"># $tree - value corresponding to openssl's X509_POLICY_TREE structure</span>
 <span class="comment"># $i - (integer) level index</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_POLICY_LEVEL structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509_policy_tree_get0_policies</p>

<p>??? (more info needed)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_policy_tree_get0_policies</span><span class="operator">(</span><span class="variable">$tree</span><span class="operator">);</span>
 <span class="comment"># $tree - value corresponding to openssl's X509_POLICY_TREE structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_POLICY_NODE structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509_policy_tree_get0_user_policies</p>

<p>??? (more info needed)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_policy_tree_get0_user_policies</span><span class="operator">(</span><span class="variable">$tree</span><span class="operator">);</span>
 <span class="comment"># $tree - value corresponding to openssl's X509_POLICY_TREE structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_POLICY_NODE structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509_policy_tree_level_count</p>

<p>??? (more info needed)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_policy_tree_level_count</span><span class="operator">(</span><span class="variable">$tree</span><span class="operator">);</span>
 <span class="comment"># $tree - value corresponding to openssl's X509_POLICY_TREE structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) count</span>
</code></code></pre>

</li>
<li><p>X509_verify_cert_error_string</p>

<p>Returns a human readable error string for verification error $n.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_verify_cert_error_string</span><span class="operator">(</span><span class="variable">$n</span><span class="operator">);</span>
 <span class="comment"># $n - (long) numeric error code</span>
 <span class="comment">#</span>
 <span class="comment"># returns: error string</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_STORE_CTX_get_error.html">http://www.openssl.org/docs/crypto/X509_STORE_CTX_get_error.html</a></p>

</li>
<li><p>P_X509_add_extensions</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Adds one or more X509 extensions to X509 object $x.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_X509_add_extensions</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="variable">$ca_cert</span><span class="operator">,</span> <span class="variable">$nid</span><span class="operator">,</span> <span class="variable">$value</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment"># $ca_cert - value corresponding to openssl's X509 structure (issuer's cert - necessary for sertting NID_authority_key_identifier)</span>
 <span class="comment"># $nid - NID identifying extension to be set</span>
 <span class="comment"># $value - extension value</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>You can set more extensions at once:</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_X509_add_extensions</span><span class="operator">(</span><span class="variable">$x509</span><span class="operator">,</span> <span class="variable">$ca_cert</span><span class="operator">,</span>
                <span class="operator">&amp;</span><span class="variable">Net::SSLeay::NID_key_usage</span> <span class="operator">=&gt;</span> <span class="string">'digitalSignature,keyEncipherment'</span><span class="operator">,</span>
                <span class="operator">&amp;</span><span class="variable">Net::SSLeay::NID_subject_key_identifier</span> <span class="operator">=&gt;</span> <span class="string">'hash'</span><span class="operator">,</span>
                <span class="operator">&amp;</span><span class="variable">Net::SSLeay::NID_authority_key_identifier</span> <span class="operator">=&gt;</span> <span class="string">'keyid'</span><span class="operator">,</span>
                <span class="operator">&amp;</span><span class="variable">Net::SSLeay::NID_authority_key_identifier</span> <span class="operator">=&gt;</span> <span class="string">'issuer'</span><span class="operator">,</span>
                <span class="operator">&amp;</span><span class="variable">Net::SSLeay::NID_basic_constraints</span> <span class="operator">=&gt;</span> <span class="string">'CA:FALSE'</span><span class="operator">,</span>
                <span class="operator">&amp;</span><span class="variable">Net::SSLeay::NID_ext_key_usage</span> <span class="operator">=&gt;</span> <span class="string">'serverAuth,clientAuth'</span><span class="operator">,</span>
                <span class="operator">&amp;</span><span class="variable">Net::SSLeay::NID_netscape_cert_type</span> <span class="operator">=&gt;</span> <span class="string">'server'</span><span class="operator">,</span>
                <span class="operator">&amp;</span><span class="variable">Net::SSLeay::NID_subject_alt_name</span> <span class="operator">=&gt;</span> <span class="string">'DNS:s1.dom.com,DNS:s2.dom.com,DNS:s3.dom.com'</span><span class="operator">,</span>
          <span class="operator">);</span>
</code></code></pre>

</li>
<li><p>P_X509_copy_extensions</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Copies X509 extensions from X509_REQ object to X509 object - handy when you need to turn X509_REQ into X509 certificate.</p>

<pre><code><code> <span class="variable">Net::SSLeay::P_X509_copy_extensions</span><span class="operator">(</span><span class="variable">$x509_req</span><span class="operator">,</span> <span class="variable">$x509</span><span class="operator">,</span> <span class="variable">$override</span><span class="operator">);</span>
 <span class="comment"># $x509_req - value corresponding to openssl's X509_REQ structure</span>
 <span class="comment"># $x509 - value corresponding to openssl's X509 structure</span>
 <span class="comment"># $override - (integer) flag indication whether to override already existing items in $x509 (default 1)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>P_X509_get_crl_distribution_points</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-0.9.7</p>

<p>Get the list of CRL distribution points from X509 certificate.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">@cdp</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_X509_get_crl_distribution_points</span><span class="operator">(</span><span class="variable">$x509</span><span class="operator">);</span>
 <span class="comment"># $x509 - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: list of distribution points (usually URLs)</span>
</code></code></pre>

</li>
<li><p>P_X509_get_ext_key_usage</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-0.9.7</p>

<p>Gets the list of extended key usage of given X509 certificate $cert.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">@ext_usage</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_X509_get_ext_key_usage</span><span class="operator">(</span><span class="variable">$cert</span><span class="operator">,</span> <span class="variable">$format</span><span class="operator">);</span>
 <span class="comment"># $cert - value corresponding to openssl's X509 structure</span>
 <span class="comment"># $format - choose type of return values: 0=OIDs, 1=NIDs, 2=shortnames, 3=longnames</span>
 <span class="comment">#</span>
 <span class="comment"># returns: list of values</span>
</code></code></pre>

<p>Examples:</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">@extkeyusage_oid</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_X509_get_ext_key_usage</span><span class="operator">(</span><span class="variable">$x509</span><span class="operator">,</span><span class="number">0</span><span class="operator">);</span>
 <span class="comment"># returns for example: ("1.3.6.1.5.5.7.3.1", "1.3.6.1.5.5.7.3.2")</span>
 
 <span class="keyword">my</span> <span class="variable">@extkeyusage_nid</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_X509_get_ext_key_usage</span><span class="operator">(</span><span class="variable">$x509</span><span class="operator">,</span><span class="number">1</span><span class="operator">);</span>
 <span class="comment"># returns for example: (129, 130)</span>
 
 <span class="keyword">my</span> <span class="variable">@extkeyusage_sn</span>  <span class="operator">=</span> <span class="variable">Net::SSLeay::P_X509_get_ext_key_usage</span><span class="operator">(</span><span class="variable">$x509</span><span class="operator">,</span><span class="number">2</span><span class="operator">);</span>
 <span class="comment"># returns for example: ("serverAuth", "clientAuth")</span>
 
 <span class="keyword">my</span> <span class="variable">@extkeyusage_ln</span>  <span class="operator">=</span> <span class="variable">Net::SSLeay::P_X509_get_ext_key_usage</span><span class="operator">(</span><span class="variable">$x509</span><span class="operator">,</span><span class="number">3</span><span class="operator">);</span>
 <span class="comment"># returns for example: ("TLS Web Server Authentication",  "TLS Web Client Authentication")</span>
</code></code></pre>

</li>
<li><p>P_X509_get_key_usage</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Gets the list of key usage of given X509 certificate $cert.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">@keyusage</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_X509_get_key_usage</span><span class="operator">(</span><span class="variable">$cert</span><span class="operator">);</span>
 <span class="comment"># $cert - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: list of key usage values which can be none, one or more from the following list:</span>
 <span class="comment">#          "digitalSignature"</span>
 <span class="comment">#          "nonRepudiation"</span>
 <span class="comment">#          "keyEncipherment"</span>
 <span class="comment">#          "dataEncipherment"</span>
 <span class="comment">#          "keyAgreement"</span>
 <span class="comment">#          "keyCertSign"</span>
 <span class="comment">#          "cRLSign"</span>
 <span class="comment">#          "encipherOnly"</span>
 <span class="comment">#          "decipherOnly"</span>
</code></code></pre>

</li>
<li><p>P_X509_get_netscape_cert_type</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Gets the list of Netscape cert types of given X509 certificate $cert.</p>

<pre><code><code> <span class="variable">Net::SSLeay::P_X509_get_netscape_cert_type</span><span class="operator">(</span><span class="variable">$cert</span><span class="operator">);</span>
 <span class="comment"># $cert - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: list of Netscape type values which can be none, one or more from the following list:</span>
 <span class="comment">#          "client"</span>
 <span class="comment">#          "server"</span>
 <span class="comment">#          "email"</span>
 <span class="comment">#          "objsign"</span>
 <span class="comment">#          "reserved"</span>
 <span class="comment">#          "sslCA"</span>
 <span class="comment">#          "emailCA"</span>
 <span class="comment">#          "objCA"</span>
</code></code></pre>

</li>
<li><p>P_X509_get_pubkey_alg</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns ASN1_OBJECT corresponding to X509 certificate public key algorithm.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_X509_get_pubkey_alg</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_OBJECT structure (0 on failure)</span>
</code></code></pre>

<p>To get textual representation use:</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$alg</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::OBJ_obj2txt</span><span class="operator">(</span><span class="variable">Net::SSLeay::P_X509_get_pubkey_alg</span><span class="operator">(</span><span class="variable">$x509</span><span class="operator">));</span>
 <span class="comment"># returns for example: "rsaEncryption"</span>
</code></code></pre>

</li>
<li><p>P_X509_get_signature_alg</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns ASN1_OBJECT corresponding to X509 signarite key algorithm.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_X509_get_signature_alg</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_OBJECT structure (0 on failure)</span>
</code></code></pre>

<p>To get textual representation use:</p>

<pre><code><code> my $alg = Net::SSLeay::OBJ_obj2txt(Net::SSLeay::P_X509_get_signature_alg($x509))
 # returns for example: &quot;sha1WithRSAEncryption&quot;</code></code></pre>

</li>
</ul>

<h3 id="Low-level-API:-X509_REQ_-related-functions">Low level API: X509_REQ_* related functions</h3>

<ul>

<li><p>X509_REQ_new</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Creates a new X509_REQ structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_REQ_new</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_REQ structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509_REQ_free</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Free an allocated X509_REQ structure.</p>

<pre><code><code> <span class="variable">Net::SSLeay::X509_REQ_free</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_REQ structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

</li>
<li><p>X509_REQ_add1_attr_by_NID</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Adds an attribute whose name is defined by a NID $nid. The field value to be added is in $bytes.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_REQ_add1_attr_by_NID</span><span class="operator">(</span><span class="variable">$req</span><span class="operator">,</span> <span class="variable">$nid</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">,</span> <span class="variable">$bytes</span><span class="operator">);</span>
 <span class="comment"># $req - value corresponding to openssl's X509_REQ structure</span>
 <span class="comment"># $nid - (integer) NID value</span>
 <span class="comment"># $type - (integer) type of data in $bytes (see below)</span>
 <span class="comment"># $bytes - data to be set</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
 
 <span class="comment"># values for $type - use constants:</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::MBSTRING_UTF8</span>     <span class="operator">-</span> <span class="variable">$bytes</span> <span class="variable">contains</span> <span class="variable">utf8</span> <span class="variable">encoded</span> <span class="variable">data</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::MBSTRING_ASC</span>      <span class="operator">-</span> <span class="variable">$bytes</span> <span class="variable">contains</span> <span class="variable">ASCII</span> <span class="variable">data</span>
</code></code></pre>

</li>
<li><p>X509_REQ_digest</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Computes digest/fingerprint of X509_REQ $data using $type hash function.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$digest_value</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_REQ_digest</span><span class="operator">(</span><span class="variable">$data</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">);</span>
 <span class="comment"># $data - value corresponding to openssl's X509_REQ structure</span>
 <span class="comment"># $type - value corresponding to openssl's EVP_MD structure - e.g. got via EVP_get_digestbyname()</span>
 <span class="comment">#</span>
 <span class="comment"># returns: hash value (binary)</span>
 
 <span class="comment">#to get printable (hex) value of digest use:</span>
 <span class="keyword">print</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">'H*'</span><span class="operator">,</span> <span class="variable">$digest_value</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>X509_REQ_get_attr_by_NID</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Retrieve the next index matching $nid after $lastpos ($lastpos should initially be set to -1).</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_REQ_get_attr_by_NID</span><span class="operator">(</span><span class="variable">$req</span><span class="operator">,</span> <span class="variable">$nid</span><span class="operator">,</span> <span class="variable">$lastpos</span><span class="operator">=-</span><span class="number">1</span><span class="operator">);</span>
 <span class="comment"># $req - value corresponding to openssl's X509_REQ structure</span>
 <span class="comment"># $nid - (integer) NID value</span>
 <span class="comment"># $lastpos - [optional] (integer) index where to start search (default -1)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: index (-1 if there are no more entries)</span>
</code></code></pre>

<p>Note: use <a href="#P_X509_REQ_get_attr">&quot;P_X509_REQ_get_attr&quot;</a> to get the actual attribute value - e.g.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$index</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_REQ_get_attr_by_NID</span><span class="operator">(</span><span class="variable">$req</span><span class="operator">,</span> <span class="variable">$nid</span><span class="operator">);</span>
 <span class="keyword">my</span> <span class="variable">@attr_values</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_X509_REQ_get_attr</span><span class="operator">(</span><span class="variable">$req</span><span class="operator">,</span> <span class="variable">$index</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>X509_REQ_get_attr_by_OBJ</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Retrieve the next index matching $obj after $lastpos ($lastpos should initially be set to -1).</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_REQ_get_attr_by_OBJ</span><span class="operator">(</span><span class="variable">$req</span><span class="operator">,</span> <span class="variable">$obj</span><span class="operator">,</span> <span class="variable">$lastpos</span><span class="operator">=-</span><span class="number">1</span><span class="operator">);</span>
 <span class="comment"># $req - value corresponding to openssl's X509_REQ structure</span>
 <span class="comment"># $obj - value corresponding to openssl's ASN1_OBJECT structure</span>
 <span class="comment"># $lastpos - [optional] (integer) index where to start search (default -1)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: index (-1 if there are no more entries)</span>
</code></code></pre>

<p>Note: use <a href="#P_X509_REQ_get_attr">&quot;P_X509_REQ_get_attr&quot;</a> to get the actual attribute value - e.g.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$index</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_REQ_get_attr_by_NID</span><span class="operator">(</span><span class="variable">$req</span><span class="operator">,</span> <span class="variable">$nid</span><span class="operator">);</span>
 <span class="keyword">my</span> <span class="variable">@attr_values</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_X509_REQ_get_attr</span><span class="operator">(</span><span class="variable">$req</span><span class="operator">,</span> <span class="variable">$index</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>X509_REQ_get_attr_count</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns the total number of attributes in $req.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_REQ_get_attr_count</span><span class="operator">(</span><span class="variable">$req</span><span class="operator">);</span>
 <span class="comment"># $req - value corresponding to openssl's X509_REQ structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) items count</span>
</code></code></pre>

</li>
<li><p>X509_REQ_get_pubkey</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns public key corresponding to given X509_REQ object $x.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_REQ_get_pubkey</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_REQ structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's EVP_PKEY structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509_REQ_get_subject_name</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns X509_NAME object corresponding to subject name of given X509_REQ object $x.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_REQ_get_subject_name</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_REQ structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_NAME structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509_REQ_get_version</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns &#39;version&#39; value for given X509_REQ object $x.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_REQ_get_version</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_REQ structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) version e.g. 0 = "version 1"</span>
</code></code></pre>

</li>
<li><p>X509_REQ_set_pubkey</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Sets public key of given X509_REQ object $x to $pkey.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_REQ_set_pubkey</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="variable">$pkey</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_REQ structure</span>
 <span class="comment"># $pkey - value corresponding to openssl's EVP_PKEY structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_REQ_set_subject_name</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Sets subject name of given X509_REQ object $x to X509_NAME object $name.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_REQ_set_subject_name</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="variable">$name</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_REQ structure</span>
 <span class="comment"># $name - value corresponding to openssl's X509_NAME structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_REQ_set_version</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Sets &#39;version&#39; of given X509_REQ object $x to $version.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_REQ_set_version</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="variable">$version</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_REQ structure</span>
 <span class="comment"># $version - (integer) e.g. 0 = "version 1"</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_REQ_sign</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Sign X509_REQ object $x with private key $pk (using digest algorithm $md).</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_REQ_sign</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="variable">$pk</span><span class="operator">,</span> <span class="variable">$md</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_REQ structure</span>
 <span class="comment"># $pk - value corresponding to openssl's EVP_PKEY structure (requestor's private key)</span>
 <span class="comment"># $md - value corresponding to openssl's EVP_MD structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_REQ_verify</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Verifies X509_REQ object $x using public key $r (pubkey of requesting party).</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_REQ_verify</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="variable">$r</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_REQ structure</span>
 <span class="comment"># $r - value corresponding to openssl's EVP_PKEY structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 0 - verify failure, 1 - verify OK, &lt;0 - error</span>
</code></code></pre>

</li>
<li><p>P_X509_REQ_add_extensions</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Adds one or more X509 extensions to X509_REQ object $x.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_X509_REQ_add_extensions</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="variable">$nid</span><span class="operator">,</span> <span class="variable">$value</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_REQ structure</span>
 <span class="comment"># $nid - NID identifying extension to be set</span>
 <span class="comment"># $value - extension value</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>You can set more extensions at once:</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_X509_REQ_add_extensions</span><span class="operator">(</span><span class="variable">$x509_req</span><span class="operator">,</span>
            <span class="operator">&amp;</span><span class="variable">Net::SSLeay::NID_key_usage</span> <span class="operator">=&gt;</span> <span class="string">'digitalSignature,keyEncipherment'</span><span class="operator">,</span>
            <span class="operator">&amp;</span><span class="variable">Net::SSLeay::NID_basic_constraints</span> <span class="operator">=&gt;</span> <span class="string">'CA:FALSE'</span><span class="operator">,</span>
            <span class="operator">&amp;</span><span class="variable">Net::SSLeay::NID_ext_key_usage</span> <span class="operator">=&gt;</span> <span class="string">'serverAuth,clientAuth'</span><span class="operator">,</span>
            <span class="operator">&amp;</span><span class="variable">Net::SSLeay::NID_netscape_cert_type</span> <span class="operator">=&gt;</span> <span class="string">'server'</span><span class="operator">,</span>
            <span class="operator">&amp;</span><span class="variable">Net::SSLeay::NID_subject_alt_name</span> <span class="operator">=&gt;</span> <span class="string">'DNS:s1.com,DNS:s2.com'</span><span class="operator">,</span>
            <span class="operator">&amp;</span><span class="variable">Net::SSLeay::NID_crl_distribution_points</span> <span class="operator">=&gt;</span> <span class="string">'URI:http://pki.com/crl1,URI:http://pki.com/crl2'</span><span class="operator">,</span>
          <span class="operator">);</span>
</code></code></pre>

</li>
<li><p>P_X509_REQ_get_attr</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-0.9.7</p>

<p>Returns attribute value for X509_REQ&#39;s attribute at index $n.</p>

<pre><code><code> <span class="variable">Net::SSLeay::P_X509_REQ_get_attr</span><span class="operator">(</span><span class="variable">$req</span><span class="operator">,</span> <span class="variable">$n</span><span class="operator">);</span>
 <span class="comment"># $req - value corresponding to openssl's X509_REQ structure</span>
 <span class="comment"># $n - (integer) attribute index</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_STRING structure</span>
</code></code></pre>

</li>
</ul>

<h3 id="Low-level-API:-X509_CRL_-related-functions">Low level API: X509_CRL_* related functions</h3>

<ul>

<li><p>X509_CRL_new</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Creates a new X509_CRL structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_CRL_new</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_CRL structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509_CRL_free</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Free an allocated X509_CRL structure.</p>

<pre><code><code> <span class="variable">Net::SSLeay::X509_CRL_free</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_CRL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

</li>
<li><p>X509_CRL_digest</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Computes digest/fingerprint of X509_CRL $data using $type hash function.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$digest_value</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_CRL_digest</span><span class="operator">(</span><span class="variable">$data</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">);</span>
 <span class="comment"># $data - value corresponding to openssl's X509_CRL structure</span>
 <span class="comment"># $type - value corresponding to openssl's EVP_MD structure - e.g. got via EVP_get_digestbyname()</span>
 <span class="comment">#</span>
 <span class="comment"># returns: hash value (binary)</span>
</code></code></pre>

<p>Example:</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$x509_crl</span>
 <span class="keyword">my</span> <span class="variable">$md</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_get_digestbyname</span><span class="operator">(</span><span class="string">"sha1"</span><span class="operator">);</span>
 <span class="keyword">my</span> <span class="variable">$digest_value</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_CRL_digest</span><span class="operator">(</span><span class="variable">$x509_crl</span><span class="operator">,</span> <span class="variable">$md</span><span class="operator">);</span>
 <span class="comment">#to get printable (hex) value of digest use:</span>
 <span class="keyword">print</span> <span class="string">"digest="</span><span class="operator">,</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">'H*'</span><span class="operator">,</span> <span class="variable">$digest_value</span><span class="operator">),</span> <span class="string">"\n"</span><span class="operator">;</span>
</code></code></pre>

</li>
<li><p>X509_CRL_get_issuer</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns X509_NAME object corresponding to the issuer of X509_CRL $x.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_CRL_get_issuer</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_CRL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_NAME structure (0 on failure)</span>
</code></code></pre>

<p>See other <code><code>X509_NAME_*</code></code> functions to get more info from X509_NAME structure.</p>

</li>
<li><p>X509_CRL_get_lastUpdate</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns &#39;lastUpdate&#39; date-time value of X509_CRL object $x.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_CRL_get_lastUpdate</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_CRL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_TIME structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509_CRL_get_nextUpdate</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns &#39;nextUpdate&#39; date-time value of X509_CRL object $x.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_CRL_get_nextUpdate</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_CRL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_TIME structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509_CRL_get_version</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns &#39;version&#39; value of given X509_CRL structure $x.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_CRL_get_version</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_CRL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) version</span>
</code></code></pre>

</li>
<li><p>X509_CRL_set_issuer_name</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-0.9.7</p>

<p>Sets the issuer of X509_CRL object $x to X509_NAME object $name.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_CRL_set_issuer_name</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="variable">$name</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_CRL structure</span>
 <span class="comment"># $name - value corresponding to openssl's X509_NAME structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_CRL_set_lastUpdate</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-0.9.7</p>

<p>Sets &#39;lastUpdate&#39; value of X509_CRL object $x to $tm.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_CRL_set_lastUpdate</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="variable">$tm</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_CRL structure</span>
 <span class="comment"># $tm - value corresponding to openssl's ASN1_TIME structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_CRL_set_nextUpdate</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-0.9.7</p>

<p>Sets &#39;nextUpdate&#39; value of X509_CRL object $x to $tm.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_CRL_set_nextUpdate</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="variable">$tm</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_CRL structure</span>
 <span class="comment"># $tm - value corresponding to openssl's ASN1_TIME structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_CRL_set_version</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-0.9.7</p>

<p>Sets &#39;version&#39; value of given X509_CRL structure $x to $version.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_CRL_set_version</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="variable">$version</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_CRL structure</span>
 <span class="comment"># $version - (integer) version number (1 = version 2 CRL)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Note that if you want to use any X509_CRL extension you need to set &quot;version 2 CRL&quot; - <code><code>Net::SSLeay::X509_CRL_set_version($x, 1)</code></code>.</p>

</li>
<li><p>X509_CRL_sign</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Sign X509_CRL object $x with private key $pkey (using digest algorithm $md).</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_CRL_sign</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">,</span> <span class="variable">$pkey</span><span class="operator">,</span> <span class="variable">$md</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_CRL structure</span>
 <span class="comment"># $pkey - value corresponding to openssl's EVP_PKEY structure</span>
 <span class="comment"># $md - value corresponding to openssl's EVP_MD structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_CRL_sort</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-0.9.7</p>

<p>Sorts the data of X509_CRL object so it will be written in serial number order.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_CRL_sort</span><span class="operator">(</span><span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x - value corresponding to openssl's X509_CRL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_CRL_verify</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Verifies X509_CRL object $a using public key $r (pubkey of issuing CA).</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_CRL_verify</span><span class="operator">(</span><span class="variable">$a</span><span class="operator">,</span> <span class="variable">$r</span><span class="operator">);</span>
 <span class="comment"># $a - value corresponding to openssl's X509_CRL structure</span>
 <span class="comment"># $r - value corresponding to openssl's EVP_PKEY structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 0 - verify failure, 1 - verify OK, &lt;0 - error</span>
</code></code></pre>

</li>
<li><p>P_X509_CRL_add_revoked_serial_hex</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-0.9.7</p>

<p>Adds given serian number $serial_hex to X509_CRL object $crl.</p>

<pre><code><code> <span class="variable">Net::SSLeay::P_X509_CRL_add_revoked_serial_hex</span><span class="operator">(</span><span class="variable">$crl</span><span class="operator">,</span> <span class="variable">$serial_hex</span><span class="operator">,</span> <span class="variable">$rev_time</span><span class="operator">,</span> <span class="variable">$reason_code</span><span class="operator">,</span> <span class="variable">$comp_time</span><span class="operator">);</span>
 <span class="comment"># $crl - value corresponding to openssl's X509_CRL structure</span>
 <span class="comment"># $serial_hex - string (hexadecimal) representation of serial number</span>
 <span class="comment"># $rev_time - (revocation time) value corresponding to openssl's ASN1_TIME structure</span>
 <span class="comment"># $reason_code - [optional] (integer) reason code (see below) - default 0</span>
 <span class="comment"># $comp_time - [optional] (compromise time) value corresponding to openssl's ASN1_TIME structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
 
 <span class="variable">reason</span> <span class="variable">codes</span><span class="operator">:</span>
 <span class="number">0</span> <span class="operator">-</span> <span class="variable">unspecified</span>
 <span class="number">1</span> <span class="operator">-</span> <span class="variable">keyCompromise</span>
 <span class="number">2</span> <span class="operator">-</span> <span class="variable">CACompromise</span>
 <span class="number">3</span> <span class="operator">-</span> <span class="variable">affiliationChanged</span>
 <span class="number">4</span> <span class="operator">-</span> <span class="variable">superseded</span>
 <span class="number">5</span> <span class="operator">-</span> <span class="variable">cessationOfOperation</span>
 <span class="number">6</span> <span class="operator">-</span> <span class="variable">certificateHold</span>
 <span class="number">7</span> <span class="operator">-</span> <span class="variable">removeFromCRL</span>
</code></code></pre>

</li>
<li><p>P_X509_CRL_get_serial</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-0.9.7</p>

<p>Returns serial number of X509_CRL object.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_X509_CRL_get_serial</span><span class="operator">(</span><span class="variable">$crl</span><span class="operator">);</span>
 <span class="comment"># $crl - value corresponding to openssl's X509_CRL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_INTEGER structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>P_X509_CRL_set_serial</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-0.9.7</p>

<p>Sets serial number of X509_CRL object to $crl_number.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_X509_CRL_set_serial</span><span class="operator">(</span><span class="variable">$crl</span><span class="operator">,</span> <span class="variable">$crl_number</span><span class="operator">);</span>
 <span class="comment"># $crl - value corresponding to openssl's X509_CRL structure</span>
 <span class="comment"># $crl_number - value corresponding to openssl's ASN1_INTEGER structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
</ul>

<h3 id="Low-level-API:-X509_EXTENSION_-related-functions">Low level API: X509_EXTENSION_* related functions</h3>

<ul>

<li><p>X509_EXTENSION_get_critical</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns &#39;critical&#39; flag of given X509_EXTENSION object $ex.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_EXTENSION_get_critical</span><span class="operator">(</span><span class="variable">$ex</span><span class="operator">);</span>
 <span class="comment"># $ex - value corresponding to openssl's X509_EXTENSION structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) 1 - critical, 0 - noncritical</span>
</code></code></pre>

</li>
<li><p>X509_EXTENSION_get_data</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns value (raw data) of X509_EXTENSION object $ne.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_EXTENSION_get_data</span><span class="operator">(</span><span class="variable">$ne</span><span class="operator">);</span>
 <span class="comment"># $ne - value corresponding to openssl's X509_EXTENSION structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_OCTET_STRING structure (0 on failure)</span>
</code></code></pre>

<p>Note: you can use <a href="#P_ASN1_STRING_get">&quot;P_ASN1_STRING_get&quot;</a> to convert ASN1_OCTET_STRING into perl scalar variable.</p>

</li>
<li><p>X509_EXTENSION_get_object</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns OID (ASN1_OBJECT) of X509_EXTENSION object $ne.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_EXTENSION_get_object</span><span class="operator">(</span><span class="variable">$ex</span><span class="operator">);</span>
 <span class="comment"># $ex - value corresponding to openssl's X509_EXTENSION structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_OBJECT structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509V3_EXT_print</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns string representation of given X509_EXTENSION object $ext.</p>

<pre><code><code> <span class="variable">Net::SSLeay::X509V3_EXT_print</span><span class="operator">(</span><span class="variable">$ext</span><span class="operator">,</span> <span class="variable">$flags</span><span class="operator">,</span> <span class="variable">$utf8_decode</span><span class="operator">);</span>
 <span class="comment"># $ext - value corresponding to openssl's X509_EXTENSION structure</span>
 <span class="comment"># $flags - [optional] (integer) Currently the flag argument is unused and should be set to 0</span>
 <span class="comment"># $utf8_decode - [optional] 0 or 1 whether the returned value should be utf8 decoded (default=0)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

</li>
<li><p>X509V3_EXT_d2i</p>

<p>Parses an extension and returns its internal structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509V3_EXT_d2i</span><span class="operator">(</span><span class="variable">$ext</span><span class="operator">);</span>
 <span class="comment"># $ext - value corresponding to openssl's X509_EXTENSION structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: pointer ???</span>
</code></code></pre>

</li>
</ul>

<h3 id="Low-level-API:-X509_NAME_-related-functions">Low level API: X509_NAME_* related functions</h3>

<ul>

<li><p>X509_NAME_ENTRY_get_data</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Retrieves the field value of $ne in and ASN1_STRING structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_NAME_ENTRY_get_data</span><span class="operator">(</span><span class="variable">$ne</span><span class="operator">);</span>
 <span class="comment"># $ne - value corresponding to openssl's X509_NAME_ENTRY structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_STRING structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_NAME_ENTRY_get_object.html">http://www.openssl.org/docs/crypto/X509_NAME_ENTRY_get_object.html</a></p>

</li>
<li><p>X509_NAME_ENTRY_get_object</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Retrieves the field name of $ne in and ASN1_OBJECT structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_NAME_ENTRY_get_object</span><span class="operator">(</span><span class="variable">$ne</span><span class="operator">);</span>
 <span class="comment"># $ne - value corresponding to openssl's X509_NAME_ENTRY structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's ASN1_OBJECT structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_NAME_ENTRY_get_object.html">http://www.openssl.org/docs/crypto/X509_NAME_ENTRY_get_object.html</a></p>

</li>
<li><p>X509_NAME_add_entry_by_txt</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-0.9.5</p>

<p>Adds a field whose name is defined by a string $field. The field value to be added is in $bytes.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_NAME_add_entry_by_txt</span><span class="operator">(</span><span class="variable">$name</span><span class="operator">,</span> <span class="variable">$field</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">,</span> <span class="variable">$bytes</span><span class="operator">,</span> <span class="variable">$len</span><span class="operator">,</span> <span class="variable">$loc</span><span class="operator">,</span> <span class="variable">$set</span><span class="operator">);</span>
 <span class="comment"># $name - value corresponding to openssl's X509_NAME structure</span>
 <span class="comment"># $field - (string) field definition (name) - e.g. "organizationName"</span>
 <span class="comment"># $type - (integer) type of data in $bytes (see below)</span>
 <span class="comment"># $bytes - data to be set</span>
 <span class="comment"># $loc - [optional] (integer) index where the new entry is inserted: if it is -1 (default) it is appended</span>
 <span class="comment"># $set - [optional] (integer) determines how the new type is added. If it is 0 (default) a new RDN is created</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
 
 <span class="comment"># values for $type - use constants:</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::MBSTRING_UTF8</span>     <span class="operator">-</span> <span class="variable">$bytes</span> <span class="variable">contains</span> <span class="variable">utf8</span> <span class="variable">encoded</span> <span class="variable">data</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::MBSTRING_ASC</span>      <span class="operator">-</span> <span class="variable">$bytes</span> <span class="variable">contains</span> <span class="variable">ASCII</span> <span class="variable">data</span>
</code></code></pre>

<p>Unicode note: when passing non-ascii (unicode) string in $bytes do not forget to set <code><code>$flags = &amp;Net::SSLeay::MBSTRING_UTF8</code></code> and encode the perl $string via <code><code>$bytes = encode(&#39;utf-8&#39;, $string)</code></code>.</p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_NAME_add_entry_by_txt.html">http://www.openssl.org/docs/crypto/X509_NAME_add_entry_by_txt.html</a></p>

</li>
<li><p>X509_NAME_add_entry_by_NID</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-0.9.5</p>

<p>Adds a field whose name is defined by a NID $nid. The field value to be added is in $bytes.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_NAME_add_entry_by_NID</span><span class="operator">(</span><span class="variable">$name</span><span class="operator">,</span> <span class="variable">$nid</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">,</span> <span class="variable">$bytes</span><span class="operator">,</span> <span class="variable">$len</span><span class="operator">,</span> <span class="variable">$loc</span><span class="operator">,</span> <span class="variable">$set</span><span class="operator">);</span>
 <span class="comment"># $name - value corresponding to openssl's X509_NAME structure</span>
 <span class="comment"># $nid - (integer) field definition - NID value</span>
 <span class="comment"># $type - (integer) type of data in $bytes (see below)</span>
 <span class="comment"># $bytes - data to be set</span>
 <span class="comment"># $loc - [optional] (integer) index where the new entry is inserted: if it is -1 (default) it is appended</span>
 <span class="comment"># $set - [optional] (integer) determines how the new type is added. If it is 0 (default) a new RDN is created</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_NAME_add_entry_by_txt.html">http://www.openssl.org/docs/crypto/X509_NAME_add_entry_by_txt.html</a></p>

</li>
<li><p>X509_NAME_add_entry_by_OBJ</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-0.9.5</p>

<p>Adds a field whose name is defined by a object (OID) $obj . The field value to be added is in $bytes.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_NAME_add_entry_by_OBJ</span><span class="operator">(</span><span class="variable">$name</span><span class="operator">,</span> <span class="variable">$obj</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">,</span> <span class="variable">$bytes</span><span class="operator">,</span> <span class="variable">$len</span><span class="operator">,</span> <span class="variable">$loc</span><span class="operator">,</span> <span class="variable">$set</span><span class="operator">);</span>
 <span class="comment"># $name - value corresponding to openssl's X509_NAME structure</span>
 <span class="comment"># $obj - field definition - value corresponding to openssl's ASN1_OBJECT structure</span>
 <span class="comment"># $type - (integer) type of data in $bytes (see below)</span>
 <span class="comment"># $bytes - data to be set</span>
 <span class="comment"># $loc - [optional] (integer) index where the new entry is inserted: if it is -1 (default) it is appended</span>
 <span class="comment"># $set - [optional] (integer) determines how the new type is added. If it is 0 (default) a new RDN is created</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_NAME_add_entry_by_txt.html">http://www.openssl.org/docs/crypto/X509_NAME_add_entry_by_txt.html</a></p>

</li>
<li><p>X509_NAME_cmp</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Compares two X509_NAME obejcts.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_NAME_cmp</span><span class="operator">(</span><span class="variable">$a</span><span class="operator">,</span> <span class="variable">$b</span><span class="operator">);</span>
 <span class="comment"># $a - value corresponding to openssl's X509_NAME structure</span>
 <span class="comment"># $b - value corresponding to openssl's X509_NAME structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 0 if $a matches $b; non zero otherwise</span>
</code></code></pre>

</li>
<li><p>X509_NAME_digest</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Computes digest/fingerprint of X509_NAME $data using $type hash function.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$digest_value</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_NAME_digest</span><span class="operator">(</span><span class="variable">$data</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">);</span>
 <span class="comment"># $data - value corresponding to openssl's X509_NAME structure</span>
 <span class="comment"># $type - value corresponding to openssl's EVP_MD structure - e.g. got via EVP_get_digestbyname()</span>
 <span class="comment">#</span>
 <span class="comment"># returns: hash value (binary)</span>
 
 <span class="comment">#to get printable (hex) value of digest use:</span>
 <span class="keyword">print</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">'H*'</span><span class="operator">,</span> <span class="variable">$digest_value</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>X509_NAME_entry_count</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns the total number of entries in $name.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_NAME_entry_count</span><span class="operator">(</span><span class="variable">$name</span><span class="operator">);</span>
 <span class="comment"># $name - value corresponding to openssl's X509_NAME structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) entries count</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_NAME_get_index_by_NID.html">http://www.openssl.org/docs/crypto/X509_NAME_get_index_by_NID.html</a></p>

</li>
<li><p>X509_NAME_get_entry</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Retrieves the X509_NAME_ENTRY from $name corresponding to index $loc. Acceptable values for $loc run from 0 to <code><code>Net::SSLeay::X509_NAME_entry_count($name)- 1</code></code>. The value returned is an internal pointer which must not be freed.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_NAME_get_entry</span><span class="operator">(</span><span class="variable">$name</span><span class="operator">,</span> <span class="variable">$loc</span><span class="operator">);</span>
 <span class="comment"># $name - value corresponding to openssl's X509_NAME structure</span>
 <span class="comment"># $loc - (integer) index of wanted entry</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_NAME_ENTRY structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_NAME_get_index_by_NID.html">http://www.openssl.org/docs/crypto/X509_NAME_get_index_by_NID.html</a></p>

</li>
<li><p>X509_NAME_print_ex</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns a string with human readable version of $name.</p>

<pre><code><code> <span class="variable">Net::SSLeay::X509_NAME_print_ex</span><span class="operator">(</span><span class="variable">$name</span><span class="operator">,</span> <span class="variable">$flags</span><span class="operator">,</span> <span class="variable">$utf8_decode</span><span class="operator">);</span>
 <span class="comment"># $name - value corresponding to openssl's X509_NAME structure</span>
 <span class="comment"># $flags - [optional] conversion flags (default XN_FLAG_RFC2253) - see below</span>
 <span class="comment"># $utf8_decode - [optional] 0 or 1 whether the returned value should be utf8 decoded (default=0)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: string representation of $name</span>
 
 <span class="comment">#available conversion flags - use constants:</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::XN_FLAG_COMPAT</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::XN_FLAG_DN_REV</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::XN_FLAG_DUMP_UNKNOWN_FIELDS</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::XN_FLAG_FN_ALIGN</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::XN_FLAG_FN_LN</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::XN_FLAG_FN_MASK</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::XN_FLAG_FN_NONE</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::XN_FLAG_FN_OID</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::XN_FLAG_FN_SN</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::XN_FLAG_MULTILINE</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::XN_FLAG_ONELINE</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::XN_FLAG_RFC2253</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::XN_FLAG_SEP_COMMA_PLUS</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::XN_FLAG_SEP_CPLUS_SPC</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::XN_FLAG_SEP_MASK</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::XN_FLAG_SEP_MULTILINE</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::XN_FLAG_SEP_SPLUS_SPC</span>
 <span class="operator">&amp;</span><span class="variable">Net::SSLeay::XN_FLAG_SPC_EQ</span>
</code></code></pre>

<p>Most likely you will be fine with default:</p>

<pre><code><code> <span class="variable">Net::SSLeay::X509_NAME_print_ex</span><span class="operator">(</span><span class="variable">$name</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">Net::SSLeay::XN_FLAG_RFC2253</span><span class="operator">);</span>
</code></code></pre>

<p>Or you might want RFC2253-like output without utf8 chars escaping:</p>

<pre><code><code> <span class="keyword">use</span> <span class="variable">Net::SSLeay</span> <span class="string">qw/XN_FLAG_RFC2253 ASN1_STRFLGS_ESC_MSB/</span><span class="operator">;</span>
 <span class="keyword">my</span> <span class="variable">$flag_rfc22536_utf8</span> <span class="operator">=</span> <span class="operator">(</span><span class="variable">XN_FLAG_RFC2253</span><span class="operator">)</span> <span class="operator">&amp;</span> <span class="operator">(~</span> <span class="variable">ASN1_STRFLGS_ESC_MSB</span><span class="operator">);</span>
 <span class="keyword">my</span> <span class="variable">$result</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_NAME_print_ex</span><span class="operator">(</span><span class="variable">$name</span><span class="operator">,</span> <span class="variable">$flag_rfc22536_utf8</span><span class="operator">,</span> <span class="number">1</span><span class="operator">);</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_NAME_print_ex.html">http://www.openssl.org/docs/crypto/X509_NAME_print_ex.html</a></p>

</li>
<li><p>X509_NAME_get_text_by_NID</p>

<p>Retrieves the text from the first entry in name which matches $nid, if no such entry exists -1 is returned.</p>

<p><b>openssl note:</b> this is a legacy function which has various limitations which makes it of minimal use in practice. It can only find the first matching entry and will copy the contents of the field verbatim: this can be highly confusing if the target is a muticharacter string type like a BMPString or a UTF8String.</p>

<pre><code><code> <span class="variable">Net::SSLeay::X509_NAME_get_text_by_NID</span><span class="operator">(</span><span class="variable">$name</span><span class="operator">,</span> <span class="variable">$nid</span><span class="operator">);</span>
 <span class="comment"># $name - value corresponding to openssl's X509_NAME structure</span>
 <span class="comment"># $nid - NID value (integer)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: text value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_NAME_get_index_by_NID.html">http://www.openssl.org/docs/crypto/X509_NAME_get_index_by_NID.html</a></p>

</li>
<li><p>X509_NAME_oneline</p>

<p>Return an ASCII version of $name.</p>

<pre><code><code> <span class="variable">Net::SSLeay::X509_NAME_oneline</span><span class="operator">(</span><span class="variable">$name</span><span class="operator">);</span>
 <span class="comment"># $name - value corresponding to openssl's X509_NAME structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (string) ASCII version of $name</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_NAME_print_ex.html">http://www.openssl.org/docs/crypto/X509_NAME_print_ex.html</a></p>

</li>
<li><p>sk_X509_NAME_free</p>

<p>Free an allocated STACK_OF(X509_NAME) structure.</p>

<pre><code><code> <span class="variable">Net::SSLeay::sk_X509_NAME_free</span><span class="operator">(</span><span class="variable">$sk</span><span class="operator">);</span>
 <span class="comment"># $sk - value corresponding to openssl's STACK_OF(X509_NAME) structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

</li>
<li><p>sk_X509_NAME_num</p>

<p>Return number of items in STACK_OF(X509_NAME)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::sk_X509_NAME_num</span><span class="operator">(</span><span class="variable">$sk</span><span class="operator">);</span>
 <span class="comment"># $sk - value corresponding to openssl's STACK_OF(X509_NAME) structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: number of items</span>
</code></code></pre>

</li>
<li><p>sk_X509_NAME_value</p>

<p>Returns X509_NAME from position $index in STACK_OF(X509_NAME)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::sk_X509_NAME_value</span><span class="operator">(</span><span class="variable">$sk</span><span class="operator">,</span> <span class="variable">$i</span><span class="operator">);</span>
 <span class="comment"># $sk - value corresponding to openssl's STACK_OF(X509_NAME) structure</span>
 <span class="comment"># $i - (integer) index/position</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_NAME structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>add_file_cert_subjects_to_stack</p>

<p>Add a file of certs to a stack. All certs in $file that are not already in the $stackCAs will be added.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::add_file_cert_subjects_to_stack</span><span class="operator">(</span><span class="variable">$stackCAs</span><span class="operator">,</span> <span class="variable">$file</span><span class="operator">);</span>
 <span class="comment"># $stackCAs - value corresponding to openssl's STACK_OF(X509_NAME) structure</span>
 <span class="comment"># $file - (string) filename</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>add_dir_cert_subjects_to_stack</p>

<p>Add a directory of certs to a stack. All certs in $dir that are not already in the $stackCAs will be added.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::add_dir_cert_subjects_to_stack</span><span class="operator">(</span><span class="variable">$stackCAs</span><span class="operator">,</span> <span class="variable">$dir</span><span class="operator">);</span>
 <span class="comment"># $stackCAs - value corresponding to openssl's STACK_OF(X509_NAME) structure</span>
 <span class="comment"># $dir - (string) the directory to append from. All files in this directory will be examined as potential certs. Any that are acceptable to SSL_add_dir_cert_subjects_to_stack() that are not already in the stack will be included.</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
</ul>

<h3 id="Low-level-API:-X509_STORE_-related-functions">Low level API: X509_STORE_* related functions</h3>

<ul>

<li><p>X509_STORE_CTX_get_current_cert</p>

<p>Returns the certificate in ctx which caused the error or 0 if no certificate is relevant.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_STORE_CTX_get_current_cert</span><span class="operator">(</span><span class="variable">$x509_store_ctx</span><span class="operator">);</span>
 <span class="comment"># $x509_store_ctx - value corresponding to openssl's X509_STORE_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509 structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_STORE_CTX_get_error.html">http://www.openssl.org/docs/crypto/X509_STORE_CTX_get_error.html</a></p>

</li>
<li><p>X509_STORE_CTX_get_error</p>

<p>Returns the error code of $ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_STORE_CTX_get_error</span><span class="operator">(</span><span class="variable">$x509_store_ctx</span><span class="operator">);</span>
 <span class="comment"># $x509_store_ctx - value corresponding to openssl's X509_STORE_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) error code</span>
</code></code></pre>

<p>For more info about erro code values check function <a href="#get_verify_result">&quot;get_verify_result&quot;</a>.</p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_STORE_CTX_get_error.html">http://www.openssl.org/docs/crypto/X509_STORE_CTX_get_error.html</a></p>

</li>
<li><p>X509_STORE_CTX_get_error_depth</p>

<p>Returns the depth of the error. This is a non-negative integer representing where in the certificate chain the error occurred. If it is zero it occurred in the end entity certificate, one if it is the certificate which signed the end entity certificate and so on.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_STORE_CTX_get_error_depth</span><span class="operator">(</span><span class="variable">$x509_store_ctx</span><span class="operator">);</span>
 <span class="comment"># $x509_store_ctx - value corresponding to openssl's X509_STORE_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integer) depth</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_STORE_CTX_get_error.html">http://www.openssl.org/docs/crypto/X509_STORE_CTX_get_error.html</a></p>

</li>
<li><p>X509_STORE_CTX_get_ex_data</p>

<p>Is used to retrieve the information for $idx from $x509_store_ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_STORE_CTX_get_ex_data</span><span class="operator">(</span><span class="variable">$x509_store_ctx</span><span class="operator">,</span> <span class="variable">$idx</span><span class="operator">);</span>
 <span class="comment"># $x509_store_ctx - value corresponding to openssl's X509_STORE_CTX structure</span>
 <span class="comment"># $idx - (integer) index for application specific data</span>
 <span class="comment">#</span>
 <span class="comment"># returns: pointer to ???</span>
</code></code></pre>

</li>
<li><p>X509_STORE_CTX_set_ex_data</p>

<p>Is used to store application data at arg for idx into $x509_store_ctx.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_STORE_CTX_set_ex_data</span><span class="operator">(</span><span class="variable">$x509_store_ctx</span><span class="operator">,</span> <span class="variable">$idx</span><span class="operator">,</span> <span class="variable">$data</span><span class="operator">);</span>
 <span class="comment"># $x509_store_ctx - value corresponding to openssl's X509_STORE_CTX structure</span>
 <span class="comment"># $idx - (integer) ???</span>
 <span class="comment"># $data - (pointer) ???</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_STORE_CTX_set_cert</p>

<p>Sets the certificate to be vertified in $x509_store_ctx to $x.</p>

<pre><code><code> <span class="variable">Net::SSLeay::X509_STORE_CTX_set_cert</span><span class="operator">(</span><span class="variable">$x509_store_ctx</span><span class="operator">,</span> <span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $x509_store_ctx - value corresponding to openssl's X509_STORE_CTX structure</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_STORE_CTX_new.html">http://www.openssl.org/docs/crypto/X509_STORE_CTX_new.html</a></p>

</li>
<li><p>X509_STORE_CTX_set_error</p>

<p>Sets the error code of $ctx to $s. For example it might be used in a verification callback to set an error based on additional checks.</p>

<pre><code><code> <span class="variable">Net::SSLeay::X509_STORE_CTX_set_error</span><span class="operator">(</span><span class="variable">$x509_store_ctx</span><span class="operator">,</span> <span class="variable">$s</span><span class="operator">);</span>
 <span class="comment"># $x509_store_ctx - value corresponding to openssl's X509_STORE_CTX structure</span>
 <span class="comment"># $s - (integer) error id</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_STORE_CTX_get_error.html">http://www.openssl.org/docs/crypto/X509_STORE_CTX_get_error.html</a></p>

</li>
<li><p>X509_STORE_add_cert</p>

<p>Adds X509 certificate $x into the X509_STORE $store.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_STORE_add_cert</span><span class="operator">(</span><span class="variable">$store</span><span class="operator">,</span> <span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $store - value corresponding to openssl's X509_STORE structure</span>
 <span class="comment"># $x - value corresponding to openssl's X509 structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_STORE_add_crl</p>

<p>Adds X509 CRL $x into the X509_STORE $store.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_STORE_add_crl</span><span class="operator">(</span><span class="variable">$store</span><span class="operator">,</span> <span class="variable">$x</span><span class="operator">);</span>
 <span class="comment"># $store - value corresponding to openssl's X509_STORE structure</span>
 <span class="comment"># $x - value corresponding to openssl's X509_CRL structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_STORE_set1_param</p>

<p>??? (more info needed)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_STORE_set1_param</span><span class="operator">(</span><span class="variable">$store</span><span class="operator">,</span> <span class="variable">$pm</span><span class="operator">);</span>
 <span class="comment"># $store - value corresponding to openssl's X509_STORE structure</span>
 <span class="comment"># $pm - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_STORE_set_flags</p>

<pre><code><code> <span class="variable">Net::SSLeay::X509_STORE_set_flags</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$flags</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's X509_STORE structure</span>
 <span class="comment"># $flags - (unsigned long) flags to be set (bitmask)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
 
 <span class="comment">#to create $flags value use:</span>
 <span class="number">0x0001</span> <span class="operator">-</span> <span class="variable">X509_V_FLAG_CB_ISSUER_CHECK</span> <span class="operator">-</span> <span class="variable">Send</span> <span class="variable">issuer</span><span class="operator">+</span><span class="variable">subject</span> <span class="variable">checks</span> <span class="variable">to</span> <span class="variable">verify_cb</span>
 <span class="number">0x0002</span> <span class="operator">-</span> <span class="variable">X509_V_FLAG_USE_CHECK_TIME</span> <span class="operator">-</span> <span class="variable">Use</span> <span class="variable">check</span> <span class="keyword">time</span> <span class="variable">instead</span> <span class="variable">of</span> <span class="variable">current</span> <span class="keyword">time</span>
 <span class="number">0x0004</span> <span class="operator">-</span> <span class="variable">X509_V_FLAG_CRL_CHECK</span> <span class="operator">-</span> <span class="variable">Lookup</span> <span class="variable">CRLs</span>
 <span class="number">0x0008</span> <span class="operator">-</span> <span class="variable">X509_V_FLAG_CRL_CHECK_ALL</span> <span class="operator">-</span> <span class="variable">Lookup</span> <span class="variable">CRLs</span> <span class="keyword">for</span> <span class="variable">whole</span> <span class="variable">chain</span>
 <span class="number">0x0010</span> <span class="operator">-</span> <span class="variable">X509_V_FLAG_IGNORE_CRITICAL</span> <span class="operator">-</span> <span class="variable">Ignore</span> <span class="variable">unhandled</span> <span class="variable">critical</span> <span class="variable">extensions</span>
 <span class="number">0x0020</span> <span class="operator">-</span> <span class="variable">X509_V_FLAG_X509_STRICT</span> <span class="operator">-</span> <span class="variable">Disable</span> <span class="variable">workarounds</span> <span class="keyword">for</span> <span class="variable">broken</span> <span class="variable">certificates</span>
 <span class="number">0x0040</span> <span class="operator">-</span> <span class="variable">X509_V_FLAG_ALLOW_PROXY_CERTS</span> <span class="operator">-</span> <span class="variable">Enable</span> <span class="variable">proxy</span> <span class="variable">certificate</span> <span class="variable">validation</span>
 <span class="number">0x0080</span> <span class="operator">-</span> <span class="variable">X509_V_FLAG_POLICY_CHECK</span> <span class="operator">-</span> <span class="variable">Enable</span> <span class="variable">policy</span> <span class="variable">checking</span>
 <span class="number">0x0100</span> <span class="operator">-</span> <span class="variable">X509_V_FLAG_EXPLICIT_POLICY</span> <span class="operator">-</span> <span class="variable">Policy</span> <span class="variable">variable</span> <span class="keyword">require</span><span class="operator">-</span><span class="variable">explicit</span><span class="operator">-</span><span class="variable">policy</span>
 <span class="number">0x0200</span> <span class="operator">-</span> <span class="variable">X509_V_FLAG_INHIBIT_ANY</span> <span class="operator">-</span> <span class="variable">Policy</span> <span class="variable">variable</span> <span class="variable">inhibit</span><span class="operator">-</span><span class="variable">any</span><span class="operator">-</span><span class="variable">policy</span>
 <span class="number">0x0400</span> <span class="operator">-</span> <span class="variable">X509_V_FLAG_INHIBIT_MAP</span> <span class="operator">-</span> <span class="variable">Policy</span> <span class="variable">variable</span> <span class="variable">inhibit</span><span class="operator">-</span><span class="variable">policy</span><span class="operator">-</span><span class="variable">mapping</span>
 <span class="number">0x0800</span> <span class="operator">-</span> <span class="variable">X509_V_FLAG_NOTIFY_POLICY</span> <span class="operator">-</span> <span class="variable">Notify</span> <span class="variable">callback</span> <span class="variable">that</span> <span class="variable">policy</span> <span class="variable">is</span> <span class="variable">OK</span>
 <span class="number">0x1000</span> <span class="operator">-</span> <span class="variable">X509_V_FLAG_EXTENDED_CRL_SUPPORT</span> <span class="operator">-</span> <span class="variable">Extended</span> <span class="variable">CRL</span> <span class="variable">features</span> <span class="variable">such</span> <span class="variable">as</span> <span class="variable">indirect</span> <span class="variable">CRLs</span><span class="operator">,</span> <span class="variable">alternate</span> <span class="variable">CRL</span> <span class="variable">signing</span> <span class="keyword">keys</span>
 <span class="number">0x2000</span> <span class="operator">-</span> <span class="variable">X509_V_FLAG_USE_DELTAS</span> <span class="operator">-</span> <span class="variable">Delta</span> <span class="variable">CRL</span> <span class="variable">support</span>
 <span class="number">0x4000</span> <span class="operator">-</span> <span class="variable">X509_V_FLAG_CHECK_SS_SIGNATURE</span> <span class="operator">-</span> <span class="variable">Check</span> <span class="variable">selfsigned</span> <span class="variable">CA</span> <span class="variable">signature</span>
 
 <span class="comment">#or use corresponding constants like</span>
 <span class="variable">$flags</span> <span class="operator">=</span> <span class="operator">&amp;</span><span class="variable">Net::SSLeay::X509_V_FLAG_CB_ISSUER_CHECK</span><span class="operator">;</span>
 <span class="operator">...</span>
 <span class="variable">$flags</span> <span class="operator">=</span> <span class="operator">&amp;</span><span class="variable">Net::SSLeay::X509_V_FLAG_CHECK_SS_SIGNATURE</span><span class="operator">;</span>
</code></code></pre>

</li>
<li><p>X509_STORE_set_purpose</p>

<pre><code><code> <span class="variable">Net::SSLeay::X509_STORE_set_purpose</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$purpose</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's X509_STORE structure</span>
 <span class="comment"># $purpose - (integer) purpose identifier</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>For more details about $purpose identifier check <a href="#CTX_set_purpose">&quot;CTX_set_purpose&quot;</a>.</p>

</li>
<li><p>X509_STORE_set_trust</p>

<pre><code><code> <span class="variable">Net::SSLeay::X509_STORE_set_trust</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$trust</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's X509_STORE structure</span>
 <span class="comment"># $trust - (integer) trust identifier</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>For more details about $trust identifier check <a href="#CTX_set_trust">&quot;CTX_set_trust&quot;</a>.</p>

</li>
</ul>

<h3 id="Low-level-API:-X509_VERIFY_PARAM_-related-functions">Low level API: X509_VERIFY_PARAM_* related functions</h3>

<ul>

<li><p>X509_VERIFY_PARAM_add0_policy</p>

<p>Enables policy checking (it is disabled by default) and adds $policy to the acceptable policy set.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_VERIFY_PARAM_add0_policy</span><span class="operator">(</span><span class="variable">$param</span><span class="operator">,</span> <span class="variable">$policy</span><span class="operator">);</span>
 <span class="comment"># $param - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment"># $policy - value corresponding to openssl's ASN1_OBJECT structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html">http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html</a></p>

</li>
<li><p>X509_VERIFY_PARAM_add0_table</p>

<p>??? (more info needed)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_VERIFY_PARAM_add0_table</span><span class="operator">(</span><span class="variable">$param</span><span class="operator">);</span>
 <span class="comment"># $param - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_VERIFY_PARAM_clear_flags</p>

<p>Clears the flags $flags in param.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_VERIFY_PARAM_clear_flags</span><span class="operator">(</span><span class="variable">$param</span><span class="operator">,</span> <span class="variable">$flags</span><span class="operator">);</span>
 <span class="comment"># $param - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment"># $flags - (unsigned long) flags to be set (bitmask)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>For more details about $flags bitmask see <a href="#X509_STORE_set_flags">&quot;X509_STORE_set_flags&quot;</a>.</p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html">http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html</a></p>

</li>
<li><p>X509_VERIFY_PARAM_free</p>

<p>Frees up the X509_VERIFY_PARAM structure.</p>

<pre><code><code> <span class="variable">Net::SSLeay::X509_VERIFY_PARAM_free</span><span class="operator">(</span><span class="variable">$param</span><span class="operator">);</span>
 <span class="comment"># $param - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

</li>
<li><p>X509_VERIFY_PARAM_get_depth</p>

<p>Returns the current verification depth.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_VERIFY_PARAM_get_depth</span><span class="operator">(</span><span class="variable">$param</span><span class="operator">);</span>
 <span class="comment"># $param - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (ineger) depth</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html">http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html</a></p>

</li>
<li><p>X509_VERIFY_PARAM_get_flags</p>

<p>Returns the current verification flags.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_VERIFY_PARAM_get_flags</span><span class="operator">(</span><span class="variable">$param</span><span class="operator">);</span>
 <span class="comment"># $param - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (unsigned long) flags to be set (bitmask)</span>
</code></code></pre>

<p>For more details about returned flags bitmask see <a href="#X509_STORE_set_flags">&quot;X509_STORE_set_flags&quot;</a>.</p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html">http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html</a></p>

</li>
<li><p>X509_VERIFY_PARAM_set_flags</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_VERIFY_PARAM_set_flags</span><span class="operator">(</span><span class="variable">$param</span><span class="operator">,</span> <span class="variable">$flags</span><span class="operator">);</span>
 <span class="comment"># $param - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment"># $flags - (unsigned long) flags to be set (bitmask)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>For more details about $flags bitmask see <a href="#X509_STORE_set_flags">&quot;X509_STORE_set_flags&quot;</a>.</p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html">http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html</a></p>

</li>
<li><p>X509_VERIFY_PARAM_inherit</p>

<p>??? (more info needed)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_VERIFY_PARAM_inherit</span><span class="operator">(</span><span class="variable">$to</span><span class="operator">,</span> <span class="variable">$from</span><span class="operator">);</span>
 <span class="comment"># $to - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment"># $from - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_VERIFY_PARAM_lookup</p>

<p>Finds X509_VERIFY_PARAM by name.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_VERIFY_PARAM_lookup</span><span class="operator">(</span><span class="variable">$name</span><span class="operator">);</span>
 <span class="comment"># $name - (string) name we want to find</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_VERIFY_PARAM structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509_VERIFY_PARAM_new</p>

<p>Creates a new X509_VERIFY_PARAM structure.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_VERIFY_PARAM_new</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's X509_VERIFY_PARAM structure (0 on failure)</span>
</code></code></pre>

</li>
<li><p>X509_VERIFY_PARAM_set1</p>

<p>Sets the name of X509_VERIFY_PARAM structure $to to the same value as the name of X509_VERIFY_PARAM structure $from.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_VERIFY_PARAM_set1</span><span class="operator">(</span><span class="variable">$to</span><span class="operator">,</span> <span class="variable">$from</span><span class="operator">);</span>
 <span class="comment"># $to - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment"># $from - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_VERIFY_PARAM_set1_name</p>

<p>Sets the name of X509_VERIFY_PARAM structure $param to $name.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_VERIFY_PARAM_set1_name</span><span class="operator">(</span><span class="variable">$param</span><span class="operator">,</span> <span class="variable">$name</span><span class="operator">);</span>
 <span class="comment"># $param - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment"># $name - (string) name to be set</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

</li>
<li><p>X509_VERIFY_PARAM_set1_policies</p>

<p>Enables policy checking (it is disabled by default) and sets the acceptable policy set to policies. Any existing policy set is cleared. The policies parameter can be 0 to clear an existing policy set.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_VERIFY_PARAM_set1_policies</span><span class="operator">(</span><span class="variable">$param</span><span class="operator">,</span> <span class="variable">$policies</span><span class="operator">);</span>
 <span class="comment"># $param - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment"># $policies - value corresponding to openssl's STACK_OF(ASN1_OBJECT) structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html">http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html</a></p>

</li>
<li><p>X509_VERIFY_PARAM_set_depth</p>

<p>Sets the maximum verification depth to depth. That is the maximum number of untrusted CA certificates that can appear in a chain.</p>

<pre><code><code> <span class="variable">Net::SSLeay::X509_VERIFY_PARAM_set_depth</span><span class="operator">(</span><span class="variable">$param</span><span class="operator">,</span> <span class="variable">$depth</span><span class="operator">);</span>
 <span class="comment"># $param - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment"># $depth - (integer) depth to be set</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html">http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html</a></p>

</li>
<li><p>X509_VERIFY_PARAM_set_purpose</p>

<p>Sets the verification purpose in $param to $purpose. This determines the acceptable purpose of the certificate chain, for example SSL client or SSL server.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_VERIFY_PARAM_set_purpose</span><span class="operator">(</span><span class="variable">$param</span><span class="operator">,</span> <span class="variable">$purpose</span><span class="operator">);</span>
 <span class="comment"># $param - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment"># $purpose - (integer) purpose identifier</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>For more details about $purpose identifier check <a href="#CTX_set_purpose">&quot;CTX_set_purpose&quot;</a>.</p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html">http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html</a></p>

</li>
<li><p>X509_VERIFY_PARAM_set_time</p>

<p>Sets the verification time in $param to $t. Normally the current time is used.</p>

<pre><code><code> <span class="variable">Net::SSLeay::X509_VERIFY_PARAM_set_time</span><span class="operator">(</span><span class="variable">$param</span><span class="operator">,</span> <span class="variable">$t</span><span class="operator">);</span>
 <span class="comment"># $param - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment"># $t - (time_t) time in seconds since 1.1.1970</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html">http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html</a></p>

</li>
<li><p>X509_VERIFY_PARAM_set_trust</p>

<p>Sets the trust setting in $param to $trust.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::X509_VERIFY_PARAM_set_trust</span><span class="operator">(</span><span class="variable">$param</span><span class="operator">,</span> <span class="variable">$trust</span><span class="operator">);</span>
 <span class="comment"># $param - value corresponding to openssl's X509_VERIFY_PARAM structure</span>
 <span class="comment"># $trust - (integer) trust identifier</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>For more details about $trust identifier check <a href="#CTX_set_trust">&quot;CTX_set_trust&quot;</a>.</p>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html">http://www.openssl.org/docs/crypto/X509_VERIFY_PARAM_set_flags.html</a></p>

</li>
<li><p>X509_VERIFY_PARAM_table_cleanup</p>

<p>??? (more info needed)</p>

<pre><code><code> <span class="variable">Net::SSLeay::X509_VERIFY_PARAM_table_cleanup</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

</li>
</ul>

<h3 id="Low-level-API:-Cipher-EVP_CIPHER_-related-functions">Low level API: Cipher (EVP_CIPHER_*) related functions</h3>

<ul>

<li><p>EVP_get_cipherbyname</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before</p>

<p>Returns an EVP_CIPHER structure when passed a cipher name.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_get_cipherbyname</span><span class="operator">(</span><span class="variable">$name</span><span class="operator">);</span>
 <span class="comment"># $name - (string) cipher name e.g. 'aes-128-cbc', 'camellia-256-ecb', 'des-ede', ...</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's EVP_CIPHER structure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/EVP_EncryptInit.html">http://www.openssl.org/docs/crypto/EVP_EncryptInit.html</a></p>

</li>
</ul>

<h3 id="Low-level-API:-Digest-EVP_MD_-related-functions">Low level API: Digest (EVP_MD_*) related functions</h3>

<ul>

<li><p>OpenSSL_add_all_digests</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before</p>

<pre><code><code> <span class="variable">Net::SSLeay::OpenSSL_add_all_digests</span><span class="operator">();</span>
 <span class="comment"># no args, no return value</span>
</code></code></pre>

<p>http://www.openssl.org/docs/crypto/OpenSSL_add_all_algorithms.html</p>

</li>
<li><p>P_EVP_MD_list_all</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before; requires at least openssl-1.0.0</p>

<p><b>NOTE:</b> Does not exactly correspond to any low level API function</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::P_EVP_MD_list_all</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: arrayref - list of available digest names</span>
</code></code></pre>

<p>The returned digest names correspond to values expected by <a href="#EVP_get_digestbyname">&quot;EVP_get_digestbyname&quot;</a>.</p>

<p>Note that some of the digets are available by default and some only after calling <a href="#OpenSSL_add_all_digests">&quot;OpenSSL_add_all_digests&quot;</a>.</p>

</li>
<li><p>EVP_get_digestbyname</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_get_digestbyname</span><span class="operator">(</span><span class="variable">$name</span><span class="operator">);</span>
 <span class="comment"># $name - string with digest name</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's EVP_MD structure</span>
</code></code></pre>

<p>The $name param can be:</p>

<pre><code><code> md2
 md4
 md5
 mdc2
 ripemd160
 sha
 sha1
 sha224
 sha256
 sha512
 whirlpool</code></code></pre>

<p>Or better check the supported digests by calling <a href="#P_EVP_MD_list_all">&quot;P_EVP_MD_list_all&quot;</a>.</p>

</li>
<li><p>EVP_MD_type</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_MD_type</span><span class="operator">(</span><span class="variable">$md</span><span class="operator">);</span>
 <span class="comment"># $md - value corresponding to openssl's EVP_MD structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: the NID (integer) of the OBJECT IDENTIFIER representing the given message digest</span>
</code></code></pre>

</li>
<li><p>EVP_MD_size</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_MD_size</span><span class="operator">(</span><span class="variable">$md</span><span class="operator">);</span>
 <span class="comment"># $md - value corresponding to openssl's EVP_MD structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: the size of the message digest in bytes (e.g. 20 for SHA1)</span>
</code></code></pre>

</li>
<li><p>EVP_MD_CTX_md</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before; requires at least openssl-0.9.7</p>

<pre><code><code> <span class="variable">Net::SSLeay::EVP_MD_CTX_md</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's EVP_MD_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's EVP_MD structure</span>
</code></code></pre>

</li>
<li><p>EVP_MD_CTX_create</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before; requires at least openssl-0.9.7</p>

<p>Allocates, initializes and returns a digest context.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_MD_CTX_create</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's EVP_MD_CTX structure</span>
</code></code></pre>

<p>The complete idea behind EVP_MD_CTX looks like this example:</p>

<pre><code><code>  <span class="variable">Net::SSLeay::OpenSSL_add_all_digests</span><span class="operator">();</span>
  
  <span class="keyword">my</span> <span class="variable">$md</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_get_digestbyname</span><span class="operator">(</span><span class="string">"sha1"</span><span class="operator">);</span>
  <span class="keyword">my</span> <span class="variable">$ctx</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_MD_CTX_create</span><span class="operator">();</span>
  <span class="variable">Net::SSLeay::EVP_DigestInit</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$md</span><span class="operator">);</span>
  
  <span class="keyword">while</span><span class="operator">(</span><span class="keyword">my</span> <span class="variable">$chunk</span> <span class="operator">=</span> <span class="variable">get_piece_of_data</span><span class="operator">())</span> <span class="operator">{</span>
    <span class="variable">Net::SSLeay::EVP_DigestUpdate</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span><span class="variable">$chunk</span><span class="operator">);</span>
  <span class="operator">}</span>
  
  <span class="keyword">my</span> <span class="variable">$result</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_DigestFinal</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
  <span class="variable">Net::SSLeay::EVP_MD_CTX_destroy</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
  
  <span class="keyword">print</span> <span class="string">"digest="</span><span class="operator">,</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">'H*'</span><span class="operator">,</span> <span class="variable">$result</span><span class="operator">),</span> <span class="string">"\n"</span><span class="operator">;</span> <span class="comment">#print hex value</span>
</code></code></pre>

</li>
<li><p>EVP_DigestInit_ex</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before; requires at least openssl-0.9.7</p>

<p>Sets up digest context $ctx to use a digest $type from ENGINE $impl, $ctx must be initialized before calling this function, type will typically be supplied by a function such as <a href="#EVP_get_digestbyname">&quot;EVP_get_digestbyname&quot;</a>. If $impl is 0 then the default implementation of digest $type is used.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_DigestInit_ex</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">,</span> <span class="variable">$impl</span><span class="operator">);</span>
 <span class="comment"># $ctx  - value corresponding to openssl's EVP_MD_CTX structure</span>
 <span class="comment"># $type - value corresponding to openssl's EVP_MD structure</span>
 <span class="comment"># $impl - value corresponding to openssl's ENGINE structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 for success and 0 for failure</span>
</code></code></pre>

</li>
<li><p>EVP_DigestInit</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before; requires at least openssl-0.9.7</p>

<p>Behaves in the same way as <a href="#EVP_DigestInit_ex">&quot;EVP_DigestInit_ex&quot;</a> except the passed context $ctx does not have to be initialized, and it always uses the default digest implementation.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_DigestInit</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$type</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's EVP_MD_CTX structure</span>
 <span class="comment"># $type - value corresponding to openssl's EVP_MD structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 for success and 0 for failure</span>
</code></code></pre>

</li>
<li><p>EVP_MD_CTX_destroy</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before; requires at least openssl-0.9.7</p>

<p>Cleans up digest context $ctx and frees up the space allocated to it, it should be called only on a context created using <a href="#EVP_MD_CTX_create">&quot;EVP_MD_CTX_create&quot;</a>.</p>

<pre><code><code> <span class="variable">Net::SSLeay::EVP_MD_CTX_destroy</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's EVP_MD_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

</li>
<li><p>EVP_DigestUpdate</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before; requires at least openssl-0.9.7</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_DigestUpdate</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$data</span><span class="operator">);</span>
 <span class="comment"># $ctx  - value corresponding to openssl's EVP_MD_CTX structure</span>
 <span class="comment"># $data - data to be hashed</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 for success and 0 for failure</span>
</code></code></pre>

</li>
<li><p>EVP_DigestFinal_ex</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before; requires at least openssl-0.9.7</p>

<p>Retrieves the digest value from $ctx. After calling <a href="#EVP_DigestFinal_ex">&quot;EVP_DigestFinal_ex&quot;</a> no additional calls to <a href="#EVP_DigestUpdate">&quot;EVP_DigestUpdate&quot;</a> can be made, but <a href="#EVP_DigestInit_ex">&quot;EVP_DigestInit_ex&quot;</a> can be called to initialize a new digest operation.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$digest_value</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_DigestFinal_ex</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's EVP_MD_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: hash value (binary)</span>
 
 <span class="comment">#to get printable (hex) value of digest use:</span>
 <span class="keyword">print</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">'H*'</span><span class="operator">,</span> <span class="variable">$digest_value</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>EVP_DigestFinal</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before; requires at least openssl-0.9.7</p>

<p>Similar to <a href="#EVP_DigestFinal_ex">&quot;EVP_DigestFinal_ex&quot;</a> except the digest context ctx is automatically cleaned up.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_DigestFinal</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's EVP_MD_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: hash value (binary)</span>
 
 <span class="comment">#to get printable (hex) value of digest use:</span>
 <span class="keyword">print</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">'H*'</span><span class="operator">,</span> <span class="variable">$digest_value</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>MD2</p>

<p><b>COMPATIBILITY:</b> no supported by default in openssl-1.0.0</p>

<p>Computes MD2 from given $data (all data needs to be loaded into memory)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$digest</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::MD2</span><span class="operator">(</span><span class="variable">$data</span><span class="operator">);</span>
 <span class="keyword">print</span> <span class="string">"digest(hexadecimal)="</span><span class="operator">,</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">'H*'</span><span class="operator">,</span> <span class="variable">$digest</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>MD4</p>

<p>Computes MD4 from given $data (all data needs to be loaded into memory)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$digest</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::MD4</span><span class="operator">(</span><span class="variable">$data</span><span class="operator">);</span>
 <span class="keyword">print</span> <span class="string">"digest(hexadecimal)="</span><span class="operator">,</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">'H*'</span><span class="operator">,</span> <span class="variable">$digest</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>MD5</p>

<p>Computes MD5 from given $data (all data needs to be loaded into memory)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$digest</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::MD5</span><span class="operator">(</span><span class="variable">$data</span><span class="operator">);</span>
 <span class="keyword">print</span> <span class="string">"digest(hexadecimal)="</span><span class="operator">,</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">'H*'</span><span class="operator">,</span> <span class="variable">$digest</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>RIPEMD160</p>

<p>Computes RIPEMD160 from given $data (all data needs to be loaded into memory)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$digest</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::RIPEMD160</span><span class="operator">(</span><span class="variable">$data</span><span class="operator">);</span>
 <span class="keyword">print</span> <span class="string">"digest(hexadecimal)="</span><span class="operator">,</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">'H*'</span><span class="operator">,</span> <span class="variable">$digest</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>SHA1</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before</p>

<p>Computes SHA1 from given $data (all data needs to be loaded into memory)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$digest</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SHA1</span><span class="operator">(</span><span class="variable">$data</span><span class="operator">);</span>
 <span class="keyword">print</span> <span class="string">"digest(hexadecimal)="</span><span class="operator">,</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">'H*'</span><span class="operator">,</span> <span class="variable">$digest</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>SHA256</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before; requires at least openssl-0.9.8</p>

<p>Computes SHA256 from given $data (all data needs to be loaded into memory)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$digest</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SHA256</span><span class="operator">(</span><span class="variable">$data</span><span class="operator">);</span>
 <span class="keyword">print</span> <span class="string">"digest(hexadecimal)="</span><span class="operator">,</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">'H*'</span><span class="operator">,</span> <span class="variable">$digest</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>SHA512</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before; requires at least openssl-0.9.8</p>

<p>Computes SHA512 from given $data (all data needs to be loaded into memory)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$digest</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::SHA512</span><span class="operator">(</span><span class="variable">$data</span><span class="operator">);</span>
 <span class="keyword">print</span> <span class="string">"digest(hexadecimal)="</span><span class="operator">,</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">'H*'</span><span class="operator">,</span> <span class="variable">$digest</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>EVP_Digest</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before; requires at least openssl-0.9.7</p>

<p>Computes &quot;any&quot; digest from given $data (all data needs to be loaded into memory)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$md</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_get_digestbyname</span><span class="operator">(</span><span class="string">"sha1"</span><span class="operator">);</span> <span class="comment">#or any other algorithm</span>
 <span class="keyword">my</span> <span class="variable">$digest</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_Digest</span><span class="operator">(</span><span class="variable">$data</span><span class="operator">,</span> <span class="variable">$md</span><span class="operator">);</span>
 <span class="keyword">print</span> <span class="string">"digest(hexadecimal)="</span><span class="operator">,</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">'H*'</span><span class="operator">,</span> <span class="variable">$digest</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>EVP_sha1</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$md</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_sha1</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's EVP_MD structure</span>
</code></code></pre>

</li>
<li><p>EVP_sha256</p>

<p><b>COMPATIBILITY:</b> requires at least openssl-0.9.8</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$md</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_sha256</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's EVP_MD structure</span>
</code></code></pre>

</li>
<li><p>EVP_sha512</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before; requires at least openssl-0.9.8</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$md</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_sha512</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's EVP_MD structure</span>
</code></code></pre>

</li>
<li><p>EVP_add_digest</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::EVP_add_digest</span><span class="operator">(</span><span class="variable">$digest</span><span class="operator">);</span>
 <span class="comment"># $digest - value corresponding to openssl's EVP_MD structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 otherwise</span>
</code></code></pre>

</li>
</ul>

<h3 id="Low-level-API:-CIPHER_-related-functions">Low level API: CIPHER_* related functions</h3>

<ul>

<li><p>CIPHER_get_name</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.42 and before</p>

<p>Returns name of the cipher used.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CIPHER_description</span><span class="operator">(</span><span class="variable">$cipher</span><span class="operator">);</span>
 <span class="comment"># $cipher - value corresponding to openssl's SSL_CIPHER structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (string) cipher name e.g. 'DHE-RSA-AES256-SHA'</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CIPHER_get_name.html">http://www.openssl.org/docs/ssl/SSL_CIPHER_get_name.html</a></p>

<p>Example:</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$ssl_cipher</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::get_current_cipher</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 <span class="keyword">my</span> <span class="variable">$cipher_name</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CIPHER_get_name</span><span class="operator">(</span><span class="variable">$ssl_cipher</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>CIPHER_description</p>

<p>Returns a textual description of the cipher used.</p>

<p>??? (does this function really work?)</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CIPHER_description</span><span class="operator">(</span><span class="variable">$cipher</span><span class="operator">,</span> <span class="variable">$buf</span><span class="operator">,</span> <span class="variable">$size</span><span class="operator">);</span>
 <span class="comment"># $cipher - value corresponding to openssl's SSL_CIPHER structure</span>
 <span class="comment"># $bufer - (string/buffer) ???</span>
 <span class="comment"># $size - (integer) ???</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (string) cipher description e.g. 'DHE-RSA-AES256-SHA SSLv3 Kx=DH Au=RSA Enc=AES(256) Mac=SHA1'</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CIPHER_get_name.html">http://www.openssl.org/docs/ssl/SSL_CIPHER_get_name.html</a></p>

</li>
<li><p>CIPHER_get_bits</p>

<p>Returns the number of secret bits used for cipher.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CIPHER_get_bits</span><span class="operator">(</span><span class="variable">$c</span><span class="operator">);</span>
 <span class="comment"># $c - value corresponding to openssl's SSL_CIPHER structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: (integert) number of secret bits, 0 on error</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_CIPHER_get_name.html">http://www.openssl.org/docs/ssl/SSL_CIPHER_get_name.html</a></p>

</li>
</ul>

<h3 id="Low-level-API:-RSA_-related-functions">Low level API: RSA_* related functions</h3>

<ul>

<li><p>RSA_generate_key</p>

<p>Generates a key pair and returns it in a newly allocated RSA structure. The pseudo-random number generator must be seeded prior to calling RSA_generate_key.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::RSA_generate_key</span><span class="operator">(</span><span class="variable">$bits</span><span class="operator">,</span> <span class="variable">$e</span><span class="operator">,</span> <span class="variable">$perl_cb</span><span class="operator">,</span> <span class="variable">$perl_cb_arg</span><span class="operator">);</span>
 <span class="comment"># $bits - (integer) modulus size in bits e.g. 512, 1024, 2048</span>
 <span class="comment"># $e - (integer) public exponent, an odd number, typically 3, 17 or 65537</span>
 <span class="comment"># $perl_cb - [optional] reference to perl callback function</span>
 <span class="comment"># $perl_cb_arg - [optional] data that will be passed to callback function when invoked</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's RSA structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/RSA_generate_key.html">http://www.openssl.org/docs/crypto/RSA_generate_key.html</a></p>

</li>
<li><p>RSA_free</p>

<p>Frees the RSA structure and its components. The key is erased before the memory is returned to the system.</p>

<pre><code><code> <span class="variable">Net::SSLeay::RSA_free</span><span class="operator">(</span><span class="variable">$r</span><span class="operator">);</span>
 <span class="comment"># $r - value corresponding to openssl's RSA structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/RSA_new.html">http://www.openssl.org/docs/crypto/RSA_new.html</a></p>

</li>
</ul>

<h3 id="Low-level-API:-BIO_-related-functions">Low level API: BIO_* related functions</h3>

<ul>

<li><p>BIO_eof</p>

<p>Returns 1 if the BIO has read EOF, the precise meaning of &#39;EOF&#39; varies according to the BIO type.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_eof</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">);</span>
 <span class="comment"># $s - value corresponding to openssl's BIO structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 if EOF has been reached 0 otherwise</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/BIO_ctrl.html">http://www.openssl.org/docs/crypto/BIO_ctrl.html</a></p>

</li>
<li><p>BIO_f_ssl</p>

<p>Returns the SSL BIO method. This is a filter BIO which is a wrapper round the OpenSSL SSL routines adding a BIO &#39;flavour&#39; to SSL I/O.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_f_ssl</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's BIO_METHOD structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/BIO_f_ssl.html">http://www.openssl.org/docs/crypto/BIO_f_ssl.html</a></p>

</li>
<li><p>BIO_free</p>

<p>Frees up a single BIO.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_free</span><span class="operator">(</span><span class="variable">$bio</span><span class="operator">;);</span>
 <span class="comment"># $bio; - value corresponding to openssl's BIO structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/BIO_new.html">http://www.openssl.org/docs/crypto/BIO_new.html</a></p>

</li>
<li><p>BIO_new</p>

<p>Returns a new BIO using method $type</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_new</span><span class="operator">(</span><span class="variable">$type</span><span class="operator">);</span>
 <span class="comment"># $type - value corresponding to openssl's BIO_METHOD structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's BIO structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/BIO_new.html">http://www.openssl.org/docs/crypto/BIO_new.html</a></p>

</li>
<li><p>BIO_new_buffer_ssl_connect</p>

<p>Creates a new BIO chain consisting of a buffering BIO, an SSL BIO (using ctx) and a connect BIO.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_new_buffer_ssl_connect</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's BIO structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/BIO_f_ssl.html">http://www.openssl.org/docs/crypto/BIO_f_ssl.html</a></p>

</li>
<li><p>BIO_new_file</p>

<p>Creates a new file BIO with mode mode the meaning of mode is the same as the stdio function fopen(). The BIO_CLOSE flag is set on the returned BIO.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_new_file</span><span class="operator">(</span><span class="variable">$filename</span><span class="operator">,</span> <span class="variable">$mode</span><span class="operator">);</span>
 <span class="comment"># $filename - (string) filename</span>
 <span class="comment"># $mode - (string) opening mode (as mode by stdio function fopen)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's BIO structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/BIO_s_file.html">http://www.openssl.org/docs/crypto/BIO_s_file.html</a></p>

</li>
<li><p>BIO_new_ssl</p>

<p>Allocates an SSL BIO using SSL_CTX ctx and using client mode if client is non zero.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_new_ssl</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$client</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $client - (integer) 0 or 1 - indicates ssl client mode</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's BIO structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/BIO_f_ssl.html">http://www.openssl.org/docs/crypto/BIO_f_ssl.html</a></p>

</li>
<li><p>BIO_new_ssl_connect</p>

<p>Creates a new BIO chain consisting of an SSL BIO (using ctx) followed by a connect BIO.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_new_ssl_connect</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's BIO structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/BIO_f_ssl.html">http://www.openssl.org/docs/crypto/BIO_f_ssl.html</a></p>

</li>
<li><p>BIO_pending</p>

<p>Return the number of pending characters in the BIOs read buffers.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_pending</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">);</span>
 <span class="comment"># $s - value corresponding to openssl's BIO structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: the amount of pending data</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/BIO_ctrl.html">http://www.openssl.org/docs/crypto/BIO_ctrl.html</a></p>

</li>
<li><p>BIO_wpending</p>

<p>Return the number of pending characters in the BIOs write buffers.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_wpending</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">);</span>
 <span class="comment"># $s - value corresponding to openssl's BIO structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: the amount of pending data</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/BIO_ctrl.html">http://www.openssl.org/docs/crypto/BIO_ctrl.html</a></p>

</li>
<li><p>BIO_read</p>

<p>Read the underlying descriptor.</p>

<pre><code><code> <span class="variable">Net::SSLeay::BIO_read</span><span class="operator">(</span><span class="variable">$s</span><span class="operator">,</span> <span class="variable">$max</span><span class="operator">);</span>
 <span class="comment"># $s - value corresponding to openssl's BIO structure</span>
 <span class="comment"># $max - [optional] max. bytes to read (if not specified, the value 32768 is used)</span>
 <span class="comment">#</span>
 <span class="comment"># returns: data</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/BIO_read.html">http://www.openssl.org/docs/crypto/BIO_read.html</a></p>

</li>
<li><p>BIO_write</p>

<p>Attempts to write data from $buffer to BIO $b.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_write</span><span class="operator">(</span><span class="variable">$b</span><span class="operator">,</span> <span class="variable">$buffer</span><span class="operator">);</span>
 <span class="comment"># $b - value corresponding to openssl's BIO structure</span>
 <span class="comment"># $buffer - data</span>
 <span class="comment">#</span>
 <span class="comment"># returns: amount of data successfully written</span>
 <span class="comment">#          or that no data was successfully read or written if the result is 0 or -1</span>
 <span class="comment">#          or -2 when the operation is not implemented in the specific BIO type</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/BIO_read.html">http://www.openssl.org/docs/crypto/BIO_read.html</a></p>

</li>
<li><p>BIO_s_mem</p>

<p>Return the memory BIO method function.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_s_mem</span><span class="operator">();</span>
 <span class="comment">#</span>
 <span class="comment"># returns: value corresponding to openssl's BIO_METHOD structure (0 on failure)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/BIO_s_mem.html">http://www.openssl.org/docs/crypto/BIO_s_mem.html</a></p>

</li>
<li><p>BIO_ssl_copy_session_id</p>

<p>Copies an SSL session id between BIO chains from and to. It does this by locating the SSL BIOs in each chain and calling SSL_copy_session_id() on the internal SSL pointer.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::BIO_ssl_copy_session_id</span><span class="operator">(</span><span class="variable">$to</span><span class="operator">,</span> <span class="variable">$from</span><span class="operator">);</span>
 <span class="comment"># $to - value corresponding to openssl's BIO structure</span>
 <span class="comment"># $from - value corresponding to openssl's BIO structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 1 on success, 0 on failure</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/BIO_f_ssl.html">http://www.openssl.org/docs/crypto/BIO_f_ssl.html</a></p>

</li>
<li><p>BIO_ssl_shutdown</p>

<p>Closes down an SSL connection on BIO chain bio. It does this by locating the SSL BIO in the chain and calling SSL_shutdown() on its internal SSL pointer.</p>

<pre><code><code> <span class="variable">Net::SSLeay::BIO_ssl_shutdown</span><span class="operator">(</span><span class="variable">$ssl_bio</span><span class="operator">);</span>
 <span class="comment"># $ssl_bio - value corresponding to openssl's BIO structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/BIO_f_ssl.html">http://www.openssl.org/docs/crypto/BIO_f_ssl.html</a></p>

</li>
</ul>

<h3 id="Low-level-API:-NPN-next-protocol-negotiation-related-functions">Low level API: NPN (next protocol negotiation) related functions</h3>

<p>Simple approach for using NPN support looks like this:</p>

<pre><code><code> <span class="comment">### client side</span>
 <span class="keyword">use</span> <span class="variable">Net::SSLeay</span><span class="operator">;</span>
 <span class="keyword">use</span> <span class="variable">IO::Socket::INET</span><span class="operator">;</span>
 
 <span class="variable">Net::SSLeay::initialize</span><span class="operator">();</span>
 <span class="keyword">my</span> <span class="variable">$sock</span> <span class="operator">=</span> <span class="variable">IO::Socket::INET</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span><span class="string">PeerAddr</span><span class="operator">=&gt;</span><span class="string">'encrypted.google.com:443'</span><span class="operator">)</span> <span class="keyword">or</span> <span class="keyword">die</span><span class="operator">;</span>
 <span class="keyword">my</span> <span class="variable">$ctx</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_tlsv1_new</span><span class="operator">()</span> <span class="keyword">or</span> <span class="keyword">die</span><span class="operator">;</span>
 <span class="variable">Net::SSLeay::CTX_set_options</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">Net::SSLeay::OP_ALL</span><span class="operator">);</span>
 <span class="variable">Net::SSLeay::CTX_set_next_proto_select_cb</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="operator">[</span><span class="string">'http1.1'</span><span class="operator">,</span><span class="string">'spdy/2'</span><span class="operator">]</span><span class="operator">);</span>
 <span class="keyword">my</span> <span class="variable">$ssl</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::new</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">)</span> <span class="keyword">or</span> <span class="keyword">die</span><span class="operator">;</span>
 <span class="variable">Net::SSLeay::set_fd</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="keyword">fileno</span><span class="operator">(</span><span class="variable">$sock</span><span class="operator">))</span> <span class="keyword">or</span> <span class="keyword">die</span><span class="operator">;</span>
 <span class="variable">Net::SSLeay::connect</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
 
 <span class="keyword">warn</span> <span class="string">"client:negotiated="</span><span class="operator">,</span><span class="variable">Net::SSLeay::P_next_proto_negotiated</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">),</span> <span class="string">"\n"</span><span class="operator">;</span>
 <span class="keyword">warn</span> <span class="string">"client:last_status="</span><span class="operator">,</span> <span class="variable">Net::SSLeay::P_next_proto_last_status</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">),</span> <span class="string">"\n"</span><span class="operator">;</span>
 
 <span class="comment">### server side </span>
 <span class="keyword">use</span> <span class="variable">Net::SSLeay</span><span class="operator">;</span>
 <span class="keyword">use</span> <span class="variable">IO::Socket::INET</span><span class="operator">;</span>
 
 <span class="variable">Net::SSLeay::initialize</span><span class="operator">();</span>
 <span class="keyword">my</span> <span class="variable">$ctx</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_tlsv1_new</span><span class="operator">()</span> <span class="keyword">or</span> <span class="keyword">die</span><span class="operator">;</span>
 <span class="variable">Net::SSLeay::CTX_set_options</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">Net::SSLeay::OP_ALL</span><span class="operator">);</span>
 <span class="variable">Net::SSLeay::set_cert_and_key</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="string">"t/data/cert.pem"</span><span class="operator">,</span> <span class="string">"t/data/key.pem"</span><span class="operator">);</span>
 <span class="variable">Net::SSLeay::CTX_set_next_protos_advertised_cb</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="operator">[</span><span class="string">'spdy/2'</span><span class="operator">,</span><span class="string">'http1.1'</span><span class="operator">]</span><span class="operator">);</span>
 <span class="keyword">my</span> <span class="variable">$sock</span> <span class="operator">=</span> <span class="variable">IO::Socket::INET</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span><span class="string">LocalAddr</span><span class="operator">=&gt;</span><span class="string">'localhost'</span><span class="operator">,</span> <span class="string">LocalPort</span><span class="operator">=&gt;</span><span class="number">5443</span><span class="operator">,</span> <span class="string">Proto</span><span class="operator">=&gt;</span><span class="string">'tcp'</span><span class="operator">,</span> <span class="string">Listen</span><span class="operator">=&gt;</span><span class="number">20</span><span class="operator">)</span> <span class="keyword">or</span> <span class="keyword">die</span><span class="operator">;</span>
 
 <span class="keyword">while</span> <span class="operator">(</span><span class="number">1</span><span class="operator">)</span> <span class="operator">{</span>
   <span class="keyword">my</span> <span class="variable">$ssl</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::new</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
   <span class="keyword">warn</span><span class="operator">(</span><span class="string">"server:waiting for incoming connection...\n"</span><span class="operator">);</span>
   <span class="keyword">my</span> <span class="variable">$fd</span> <span class="operator">=</span> <span class="variable">$sock</span><span class="operator">-&gt;</span><span class="variable">accept</span><span class="operator">();</span>
   <span class="variable">Net::SSLeay::set_fd</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$fd</span><span class="operator">-&gt;</span><span class="variable">fileno</span><span class="operator">);</span>
   <span class="variable">Net::SSLeay::accept</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>  
   <span class="keyword">warn</span> <span class="string">"server:negotiated="</span><span class="operator">,</span><span class="variable">Net::SSLeay::P_next_proto_negotiated</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">),</span><span class="string">"\n"</span><span class="operator">;</span>
   <span class="keyword">my</span> <span class="variable">$got</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::read</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
   <span class="variable">Net::SSLeay::ssl_write_all</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="string">"length="</span><span class="operator">.</span><span class="keyword">length</span><span class="operator">(</span><span class="variable">$got</span><span class="operator">));</span>
   <span class="variable">Net::SSLeay::free</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
   <span class="variable">$fd</span><span class="operator">-&gt;</span><span class="variable">close</span><span class="operator">();</span>
 <span class="operator">}</span>
 <span class="comment"># check with: openssl s_client -connect localhost:5443 -nextprotoneg http/1.1,spdy/2</span>
</code></code></pre>

<p>Please note that the selection (negotiation) is performed by client side, the server side simply advertise the list of supported protocols.</p>

<p>Advanced approach allows you to implement your own negotiation algorithm.</p>

<pre><code><code> <span class="comment">#see below documentation for:</span>
 <span class="variable">Net::SSleay::CTX_set_next_proto_select_cb</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$perl_callback_function</span><span class="operator">,</span> <span class="variable">$callback_data</span><span class="operator">);</span>
 <span class="variable">Net::SSleay::CTX_set_next_protos_advertised_cb</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$perl_callback_function</span><span class="operator">,</span> <span class="variable">$callback_data</span><span class="operator">);</span>
</code></code></pre>

<p>Detection of NPN support (works even in older Net::SSLeay versions):</p>

<pre><code><code> <span class="keyword">use</span> <span class="variable">Net::SSLeay</span><span class="operator">;</span>
 
 <span class="keyword">if</span> <span class="operator">(</span><span class="keyword">exists</span> <span class="operator">&amp;</span><span class="variable">Net::SSLeay::P_next_proto_negotiated</span><span class="operator">)</span> <span class="operator">{</span>
   <span class="comment"># do NPN stuff</span>
 <span class="operator">}</span>
</code></code></pre>

<ul>

<li><p>CTX_set_next_proto_select_cb</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-1.0.1</p>

<p><b>NOTE:</b> You need CTX_set_next_proto_select_cb on <b>client side</b> of SSL connection.</p>

<p>Simple usage - in this case a &quot;common&quot; negotiation algorithm (as implemented by openssl&#39;s function SSL_select_next_proto) is used.</p>

<pre><code><code> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSleay::CTX_set_next_proto_select_cb</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$arrayref</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $arrayref - list of accepted protocols - e.g. ['http1.0', 'http1.1']</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 0 on success, 1 on failure</span>
</code></code></pre>

<p>Advanced usage (you probably do not need this):</p>

<pre><code><code> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSleay::CTX_set_next_proto_select_cb</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$perl_callback_function</span><span class="operator">,</span> <span class="variable">$callback_data</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $perl_callback_function - reference to perl function</span>
 <span class="comment"># $callback_data - [optional] data to passed to callback function when invoked</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 0 on success, 1 on failure</span>
 
 <span class="comment"># where callback function looks like</span>
 <span class="keyword">sub</span><span class="variable"> npn_advertised_cb_invoke </span><span class="operator">{</span>
   <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$arrayref_proto_list_advertised_by_server</span><span class="operator">,</span> <span class="variable">$callback_data</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">@_</span><span class="operator">;</span>
   <span class="keyword">my</span> <span class="variable">$status</span><span class="operator">;</span>
   <span class="comment"># ...</span>
   <span class="variable">$status</span> <span class="operator">=</span> <span class="number">1</span><span class="operator">;</span>   <span class="comment">#status can be:</span>
                  <span class="comment"># 0 - OPENSSL_NPN_UNSUPPORTED</span>
                  <span class="comment"># 1 - OPENSSL_NPN_NEGOTIATED</span>
                  <span class="comment"># 2 - OPENSSL_NPN_NO_OVERLAP</span>
   <span class="keyword">return</span> <span class="variable">$status</span><span class="operator">,</span> <span class="operator">[</span><span class="string">'http1.1'</span><span class="operator">,</span><span class="string">'spdy/2'</span><span class="operator">]</span><span class="operator">;</span> <span class="comment"># the callback has to return 2 values</span>
 <span class="operator">}</span>
</code></code></pre>

<p>To undefine/clear this callback use:</p>

<pre><code><code> <span class="variable">Net::SSleay::CTX_set_next_proto_select_cb</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="keyword">undef</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>CTX_set_next_protos_advertised_cb</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-1.0.1</p>

<p><b>NOTE:</b> You need CTX_set_next_proto_select_cb on <b>server side</b> of SSL connection.</p>

<p>Simple usage:</p>

<pre><code><code> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSleay::CTX_set_next_protos_advertised_cb</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$arrayref</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $arrayref - list of advertised protocols - e.g. ['http1.0', 'http1.1']</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 0 on success, 1 on failure</span>
</code></code></pre>

<p>Advanced usage (you probably do not need this):</p>

<pre><code><code> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSleay::CTX_set_next_protos_advertised_cb</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="variable">$perl_callback_function</span><span class="operator">,</span> <span class="variable">$callback_data</span><span class="operator">);</span>
 <span class="comment"># $ctx - value corresponding to openssl's SSL_CTX structure</span>
 <span class="comment"># $perl_callback_function - reference to perl function</span>
 <span class="comment"># $callback_data - [optional] data to passed to callback function when invoked</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 0 on success, 1 on failure</span>
 
 <span class="comment"># where callback function looks like</span>
 <span class="keyword">sub</span><span class="variable"> npn_advertised_cb_invoke </span><span class="operator">{</span>
   <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$callback_data</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">@_</span><span class="operator">;</span>
   <span class="comment"># ...</span>
   <span class="keyword">return</span> <span class="operator">[</span><span class="string">'http1.1'</span><span class="operator">,</span><span class="string">'spdy/2'</span><span class="operator">]</span><span class="operator">;</span> <span class="comment"># the callback has to return arrayref</span>
 <span class="operator">}</span>
</code></code></pre>

<p>To undefine/clear this callback use:</p>

<pre><code><code> <span class="variable">Net::SSleay::CTX_set_next_protos_advertised_cb</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="keyword">undef</span><span class="operator">);</span>
</code></code></pre>

</li>
<li><p>P_next_proto_negotiated</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-1.0.1</p>

<p>Returns the name of negotiated protocol for given SSL connection $ssl.</p>

<pre><code><code> $rv = Net::SSLeay::P_next_proto_negotiated($ssl)
 # $ssl - value corresponding to openssl&#39;s SSL structure
 #
 # returns: (string) negotiated protocol name (or undef if no negotiation was done or failed with fatal error)</code></code></pre>

</li>
<li><p>P_next_proto_last_status</p>

<p><b>COMPATIBILITY:</b> not available in Net-SSLeay-1.45 and before; requires at least openssl-1.0.1</p>

<p>Returns the result of the last negotiation for given SSL connection $ssl.</p>

<pre><code><code> $rv = Net::SSLeay::P_next_proto_last_status($ssl)
 # $ssl - value corresponding to openssl&#39;s SSL structure
 #
 # returns: (integer) negotiation status
 #          0 - OPENSSL_NPN_UNSUPPORTED
 #          1 - OPENSSL_NPN_NEGOTIATED
 #          2 - OPENSSL_NPN_NO_OVERLAP</code></code></pre>

</li>
</ul>

<h3 id="Low-level-API:-Other-functions">Low level API: Other functions</h3>

<ul>

<li><p>COMP_add_compression_method</p>

<p>Adds the compression method cm with the identifier id to the list of available compression methods. This list is globally maintained for all SSL operations within this application. It cannot be set for specific SSL_CTX or SSL objects.</p>

<pre><code><code> <span class="keyword">my</span> <span class="variable">$rv</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::COMP_add_compression_method</span><span class="operator">(</span><span class="variable">$id</span><span class="operator">,</span> <span class="variable">$cm</span><span class="operator">);</span>
 <span class="comment"># $id - (integer) compression method id</span>
 <span class="comment">#       0 to 63:    methods defined by the IETF</span>
 <span class="comment">#       64 to 192:  external party methods assigned by IANA</span>
 <span class="comment">#       193 to 255: reserved for private use</span>
 <span class="comment">#</span>
 <span class="comment"># $cm - value corresponding to openssl's COMP_METHOD structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: 0 on success, 1 on failure (check the error queue to find out the reason)</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/ssl/SSL_COMP_add_compression_method.html">http://www.openssl.org/docs/ssl/SSL_COMP_add_compression_method.html</a></p>

</li>
<li><p>DH_free</p>

<p>Frees the DH structure and its components. The values are erased before the memory is returned to the system.</p>

<pre><code><code> <span class="variable">Net::SSLeay::DH_free</span><span class="operator">(</span><span class="variable">$dh</span><span class="operator">);</span>
 <span class="comment"># $dh - value corresponding to openssl's DH structure</span>
 <span class="comment">#</span>
 <span class="comment"># returns: no return value</span>
</code></code></pre>

<p>Check openssl doc <a href="http://www.openssl.org/docs/crypto/DH_new.html">http://www.openssl.org/docs/crypto/DH_new.html</a></p>

</li>
</ul>

<h2 id="Constants">Constants</h2>

<p>There are many openssl constants available in <a href="../../lib/Net/SSLeay.html">Net::SSLeay</a>. You can use them like this:</p>

<pre><code><code> <span class="keyword">use</span> <span class="variable">Net::SSLeay</span><span class="operator">;</span>
 <span class="keyword">print</span> <span class="operator">&amp;</span><span class="variable">Net::SSLeay::NID_commonName</span><span class="operator">;</span>
 <span class="comment">#or</span>
 <span class="keyword">print</span> <span class="variable">Net::SSLeay::NID_commonName</span><span class="operator">();</span>
</code></code></pre>

<p>Or you can import them and use:</p>

<pre><code><code> <span class="keyword">use</span> <span class="variable">Net::SSLeay</span> <span class="string">qw/NID_commonName/</span><span class="operator">;</span>
 <span class="keyword">print</span> <span class="operator">&amp;</span><span class="variable">NID_commonName</span><span class="operator">;</span>
 <span class="comment">#or</span>
 <span class="keyword">print</span> <span class="variable">NID_commonName</span><span class="operator">();</span>
 <span class="comment">#or</span>
 <span class="keyword">print</span> <span class="variable">NID_commonName</span><span class="operator">;</span>
</code></code></pre>

<p>The constants names are derived from openssl constants, however constants starting with <code><code>SSL_</code></code> prefix have name with <code><code>SSL_</code></code> part stripped - e.g. openssl&#39;s constant <code><code>SSL_OP_ALL</code></code> is available as <code><code>Net::SSleay::OP_ALL</code></code></p>

<p>The list of all available constant names:</p>

<pre><code><code> ASN1_STRFLGS_ESC_CTRL           NID_ext_req                            OP_CISCO_ANYCONNECT
 ASN1_STRFLGS_ESC_MSB            NID_friendlyName                       OP_COOKIE_EXCHANGE
 ASN1_STRFLGS_ESC_QUOTE          NID_givenName                          OP_CRYPTOPRO_TLSEXT_BUG
 ASN1_STRFLGS_RFC2253            NID_hmacWithSHA1                       OP_DONT_INSERT_EMPTY_FRAGMENTS
 CB_ACCEPT_EXIT                  NID_id_ad                              OP_EPHEMERAL_RSA
 CB_ACCEPT_LOOP                  NID_id_ce                              OP_LEGACY_SERVER_CONNECT
 CB_CONNECT_EXIT                 NID_id_kp                              OP_MICROSOFT_BIG_SSLV3_BUFFER
 CB_CONNECT_LOOP                 NID_id_pbkdf2                          OP_MICROSOFT_SESS_ID_BUG
 ERROR_NONE                      NID_id_pe                              OP_MSIE_SSLV2_RSA_PADDING
 ERROR_SSL                       NID_id_pkix                            OP_NETSCAPE_CA_DN_BUG
 ERROR_SYSCALL                   NID_id_qt_cps                          OP_NETSCAPE_CHALLENGE_BUG
 ERROR_WANT_ACCEPT               NID_id_qt_unotice                      OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG
 ERROR_WANT_CONNECT              NID_idea_cbc                           OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG
 ERROR_WANT_READ                 NID_idea_cfb64                         OP_NON_EXPORT_FIRST
 ERROR_WANT_WRITE                NID_idea_ecb                           OP_NO_COMPRESSION
 ERROR_WANT_X509_LOOKUP          NID_idea_ofb64                         OP_NO_QUERY_MTU
 ERROR_ZERO_RETURN               NID_info_access                        OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION
 EVP_PKS_DSA                     NID_initials                           OP_NO_SSLv2
 EVP_PKS_EC                      NID_invalidity_date                    OP_NO_SSLv3
 EVP_PKS_RSA                     NID_issuer_alt_name                    OP_NO_TICKET
 EVP_PKT_ENC                     NID_keyBag                             OP_NO_TLSv1
 EVP_PKT_EXCH                    NID_key_usage                          OP_NO_TLSv1_1
 EVP_PKT_EXP                     NID_localKeyID                         OP_NO_TLSv1_2
 EVP_PKT_SIGN                    NID_localityName                       OP_PKCS1_CHECK_1
 EVP_PK_DH                       NID_md2                                OP_PKCS1_CHECK_2
 EVP_PK_DSA                      NID_md2WithRSAEncryption               OP_SINGLE_DH_USE
 EVP_PK_EC                       NID_md5                                OP_SINGLE_ECDH_USE
 EVP_PK_RSA                      NID_md5WithRSA                         OP_SSLEAY_080_CLIENT_DH_BUG
 FILETYPE_ASN1                   NID_md5WithRSAEncryption               OP_SSLREF2_REUSE_CERT_TYPE_BUG
 FILETYPE_PEM                    NID_md5_sha1                           OP_TLS_BLOCK_PADDING_BUG
 F_CLIENT_CERTIFICATE            NID_mdc2                               OP_TLS_D5_BUG
 F_CLIENT_HELLO                  NID_mdc2WithRSA                        OP_TLS_ROLLBACK_BUG
 F_CLIENT_MASTER_KEY             NID_ms_code_com                        READING
 F_D2I_SSL_SESSION               NID_ms_code_ind                        RECEIVED_SHUTDOWN
 F_GET_CLIENT_FINISHED           NID_ms_ctl_sign                        RSA_3
 F_GET_CLIENT_HELLO              NID_ms_efs                             RSA_F4
 F_GET_CLIENT_MASTER_KEY         NID_ms_ext_req                         R_BAD_AUTHENTICATION_TYPE
 F_GET_SERVER_FINISHED           NID_ms_sgc                             R_BAD_CHECKSUM
 F_GET_SERVER_HELLO              NID_name                               R_BAD_MAC_DECODE
 F_GET_SERVER_VERIFY             NID_netscape                           R_BAD_RESPONSE_ARGUMENT
 F_I2D_SSL_SESSION               NID_netscape_base_url                  R_BAD_SSL_FILETYPE
 F_READ_N                        NID_netscape_ca_policy_url             R_BAD_SSL_SESSION_ID_LENGTH
 F_REQUEST_CERTIFICATE           NID_netscape_ca_revocation_url         R_BAD_STATE
 F_SERVER_HELLO                  NID_netscape_cert_extension            R_BAD_WRITE_RETRY
 F_SSL_CERT_NEW                  NID_netscape_cert_sequence             R_CHALLENGE_IS_DIFFERENT
 F_SSL_GET_NEW_SESSION           NID_netscape_cert_type                 R_CIPHER_TABLE_SRC_ERROR
 F_SSL_NEW                       NID_netscape_comment                   R_INVALID_CHALLENGE_LENGTH
 F_SSL_READ                      NID_netscape_data_type                 R_NO_CERTIFICATE_SET
 F_SSL_RSA_PRIVATE_DECRYPT       NID_netscape_renewal_url               R_NO_CERTIFICATE_SPECIFIED
 F_SSL_RSA_PUBLIC_ENCRYPT        NID_netscape_revocation_url            R_NO_CIPHER_LIST
 F_SSL_SESSION_NEW               NID_netscape_ssl_server_name           R_NO_CIPHER_MATCH
 F_SSL_SESSION_PRINT_FP          NID_ns_sgc                             R_NO_PRIVATEKEY
 F_SSL_SET_FD                    NID_organizationName                   R_NO_PUBLICKEY
 F_SSL_SET_RFD                   NID_organizationalUnitName             R_NULL_SSL_CTX
 F_SSL_SET_WFD                   NID_pbeWithMD2AndDES_CBC               R_PEER_DID_NOT_RETURN_A_CERTIFICATE
 F_SSL_USE_CERTIFICATE           NID_pbeWithMD2AndRC2_CBC               R_PEER_ERROR
 F_SSL_USE_CERTIFICATE_ASN1      NID_pbeWithMD5AndCast5_CBC             R_PEER_ERROR_CERTIFICATE
 F_SSL_USE_CERTIFICATE_FILE      NID_pbeWithMD5AndDES_CBC               R_PEER_ERROR_NO_CIPHER
 F_SSL_USE_PRIVATEKEY            NID_pbeWithMD5AndRC2_CBC               R_PEER_ERROR_UNSUPPORTED_CERTIFICATE_TYPE
 F_SSL_USE_PRIVATEKEY_ASN1       NID_pbeWithSHA1AndDES_CBC              R_PUBLIC_KEY_ENCRYPT_ERROR
 F_SSL_USE_PRIVATEKEY_FILE       NID_pbeWithSHA1AndRC2_CBC              R_PUBLIC_KEY_IS_NOT_RSA
 F_SSL_USE_RSAPRIVATEKEY         NID_pbe_WithSHA1And128BitRC2_CBC       R_READ_WRONG_PACKET_TYPE
 F_SSL_USE_RSAPRIVATEKEY_ASN1    NID_pbe_WithSHA1And128BitRC4           R_SHORT_READ
 F_SSL_USE_RSAPRIVATEKEY_FILE    NID_pbe_WithSHA1And2_Key_TripleDES_CBC R_SSL_SESSION_ID_IS_DIFFERENT
 F_WRITE_PENDING                 NID_pbe_WithSHA1And3_Key_TripleDES_CBC R_UNABLE_TO_EXTRACT_PUBLIC_KEY
 GEN_DIRNAME                     NID_pbe_WithSHA1And40BitRC2_CBC        R_UNKNOWN_REMOTE_ERROR_TYPE
 GEN_DNS                         NID_pbe_WithSHA1And40BitRC4            R_UNKNOWN_STATE
 GEN_EDIPARTY                    NID_pbes2                              R_X509_LIB
 GEN_EMAIL                       NID_pbmac1                             SENT_SHUTDOWN
 GEN_IPADD                       NID_pkcs                               SESSION_ASN1_VERSION
 GEN_OTHERNAME                   NID_pkcs3                              ST_ACCEPT
 GEN_RID                         NID_pkcs7                              ST_BEFORE
 GEN_URI                         NID_pkcs7_data                         ST_CONNECT
 GEN_X400                        NID_pkcs7_digest                       ST_INIT
 MBSTRING_ASC                    NID_pkcs7_encrypted                    ST_OK
 MBSTRING_BMP                    NID_pkcs7_enveloped                    ST_READ_BODY
 MBSTRING_FLAG                   NID_pkcs7_signed                       ST_READ_HEADER
 MBSTRING_UNIV                   NID_pkcs7_signedAndEnveloped           VERIFY_CLIENT_ONCE
 MBSTRING_UTF8                   NID_pkcs8ShroudedKeyBag                VERIFY_FAIL_IF_NO_PEER_CERT
 MIN_RSA_MODULUS_LENGTH_IN_BYTES NID_pkcs9                              VERIFY_NONE
 MODE_ACCEPT_MOVING_WRITE_BUFFER NID_pkcs9_challengePassword            VERIFY_PEER
 MODE_AUTO_RETRY                 NID_pkcs9_contentType                  WRITING
 MODE_ENABLE_PARTIAL_WRITE       NID_pkcs9_countersignature             X509_LOOKUP
 MODE_RELEASE_BUFFERS            NID_pkcs9_emailAddress                 X509_PURPOSE_ANY
 NID_OCSP_sign                   NID_pkcs9_extCertAttributes            X509_PURPOSE_CRL_SIGN
 NID_SMIMECapabilities           NID_pkcs9_messageDigest                X509_PURPOSE_NS_SSL_SERVER
 NID_X500                        NID_pkcs9_signingTime                  X509_PURPOSE_OCSP_HELPER
 NID_X509                        NID_pkcs9_unstructuredAddress          X509_PURPOSE_SMIME_ENCRYPT
 NID_ad_OCSP                     NID_pkcs9_unstructuredName             X509_PURPOSE_SMIME_SIGN
 NID_ad_ca_issuers               NID_private_key_usage_period           X509_PURPOSE_SSL_CLIENT
 NID_algorithm                   NID_rc2_40_cbc                         X509_PURPOSE_SSL_SERVER
 NID_authority_key_identifier    NID_rc2_64_cbc                         X509_PURPOSE_TIMESTAMP_SIGN
 NID_basic_constraints           NID_rc2_cbc                            X509_TRUST_COMPAT
 NID_bf_cbc                      NID_rc2_cfb64                          X509_TRUST_EMAIL
 NID_bf_cfb64                    NID_rc2_ecb                            X509_TRUST_OBJECT_SIGN
 NID_bf_ecb                      NID_rc2_ofb64                          X509_TRUST_OCSP_REQUEST
 NID_bf_ofb64                    NID_rc4                                X509_TRUST_OCSP_SIGN
 NID_cast5_cbc                   NID_rc4_40                             X509_TRUST_SSL_CLIENT
 NID_cast5_cfb64                 NID_rc5_cbc                            X509_TRUST_SSL_SERVER
 NID_cast5_ecb                   NID_rc5_cfb64                          X509_TRUST_TSA
 NID_cast5_ofb64                 NID_rc5_ecb                            X509_V_FLAG_ALLOW_PROXY_CERTS
 NID_certBag                     NID_rc5_ofb64                          X509_V_FLAG_CB_ISSUER_CHECK
 NID_certificate_policies        NID_ripemd160                          X509_V_FLAG_CHECK_SS_SIGNATURE
 NID_client_auth                 NID_ripemd160WithRSA                   X509_V_FLAG_CRL_CHECK
 NID_code_sign                   NID_rle_compression                    X509_V_FLAG_CRL_CHECK_ALL
 NID_commonName                  NID_rsa                                X509_V_FLAG_EXPLICIT_POLICY
 NID_countryName                 NID_rsaEncryption                      X509_V_FLAG_EXTENDED_CRL_SUPPORT
 NID_crlBag                      NID_rsadsi                             X509_V_FLAG_IGNORE_CRITICAL
 NID_crl_distribution_points     NID_safeContentsBag                    X509_V_FLAG_INHIBIT_ANY
 NID_crl_number                  NID_sdsiCertificate                    X509_V_FLAG_INHIBIT_MAP
 NID_crl_reason                  NID_secretBag                          X509_V_FLAG_NOTIFY_POLICY
 NID_delta_crl                   NID_serialNumber                       X509_V_FLAG_POLICY_CHECK
 NID_des_cbc                     NID_server_auth                        X509_V_FLAG_POLICY_MASK
 NID_des_cfb64                   NID_sha                                X509_V_FLAG_USE_CHECK_TIME
 NID_des_ecb                     NID_sha1                               X509_V_FLAG_USE_DELTAS
 NID_des_ede                     NID_sha1WithRSA                        X509_V_FLAG_X509_STRICT
 NID_des_ede3                    NID_sha1WithRSAEncryption              X509_V_OK
 NID_des_ede3_cbc                NID_shaWithRSAEncryption               XN_FLAG_COMPAT
 NID_des_ede3_cfb64              NID_stateOrProvinceName                XN_FLAG_DN_REV
 NID_des_ede3_ofb64              NID_subject_alt_name                   XN_FLAG_DUMP_UNKNOWN_FIELDS
 NID_des_ede_cbc                 NID_subject_key_identifier             XN_FLAG_FN_ALIGN
 NID_des_ede_cfb64               NID_surname                            XN_FLAG_FN_LN
 NID_des_ede_ofb64               NID_sxnet                              XN_FLAG_FN_MASK
 NID_des_ofb64                   NID_time_stamp                         XN_FLAG_FN_NONE
 NID_description                 NID_title                              XN_FLAG_FN_OID
 NID_desx_cbc                    NID_undef                              XN_FLAG_FN_SN
 NID_dhKeyAgreement              NID_uniqueIdentifier                   XN_FLAG_MULTILINE
 NID_dnQualifier                 NID_x509Certificate                    XN_FLAG_ONELINE
 NID_dsa                         NID_x509Crl                            XN_FLAG_RFC2253
 NID_dsaWithSHA                  NID_zlib_compression                   XN_FLAG_SEP_COMMA_PLUS
 NID_dsaWithSHA1                 NOTHING                                XN_FLAG_SEP_CPLUS_SPC
 NID_dsaWithSHA1_2               OPENSSL_VERSION_NUMBER                 XN_FLAG_SEP_MASK
 NID_dsa_2                       OP_ALL                                 XN_FLAG_SEP_MULTILINE
 NID_email_protect               OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION   XN_FLAG_SEP_SPLUS_SPC
 NID_ext_key_usage               OP_CIPHER_SERVER_PREFERENCE            XN_FLAG_SPC_EQ</code></code></pre>

<h2 id="INTERNAL-ONLY-functions-do-not-use-these-">INTERNAL ONLY functions (do not use these)</h2>

<p>The following functions are not intended for use from outside of <a href="../../lib/Net/SSLeay.html">Net::SSLeay</a> module. They might be removed, renamed or changed without prior notice in future version.</p>

<p>Simply <b>DO NOT USE THEM</b>!</p>

<ul>

<li><p>hello</p>

</li>
<li><p>blength</p>

</li>
<li><p>constant</p>

</li>
</ul>

<h1 id="EXAMPLES">EXAMPLES</h1>

<p>One very good example to look at is the implementation of <code><code>sslcat()</code></code> in the <code><code>SSLeay.pm</code></code> file.</p>

<p>The following is a simple SSLeay client (with too little error checking :-(</p>

<pre><code><code>    <span class="comment">#!/usr/bin/perl</span>
    <span class="keyword">use</span> <span class="variable">Socket</span><span class="operator">;</span>
    <span class="keyword">use</span> <span class="variable">Net::SSLeay</span> <span class="string">qw(die_now die_if_ssl_error)</span> <span class="operator">;</span>
    <span class="variable">Net::SSLeay::load_error_strings</span><span class="operator">();</span>
    <span class="variable">Net::SSLeay::SSLeay_add_ssl_algorithms</span><span class="operator">();</span>
    <span class="variable">Net::SSLeay::randomize</span><span class="operator">();</span>
    
    <span class="operator">(</span><span class="variable">$dest_serv</span><span class="operator">,</span> <span class="variable">$port</span><span class="operator">,</span> <span class="variable">$msg</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">@ARGV</span><span class="operator">;</span>      <span class="comment"># Read command line</span>
    <span class="variable">$port</span> <span class="operator">=</span> <span class="keyword">getservbyname</span> <span class="operator">(</span><span class="variable">$port</span><span class="operator">,</span> <span class="string">'tcp'</span><span class="operator">)</span> <span class="keyword">unless</span> <span class="variable">$port</span> <span class="operator">=~</span> <span class="regex">/^\d+$/</span><span class="operator">;</span>
    <span class="variable">$dest_ip</span> <span class="operator">=</span> <span class="keyword">gethostbyname</span> <span class="operator">(</span><span class="variable">$dest_serv</span><span class="operator">);</span>
    <span class="variable">$dest_serv_params</span>  <span class="operator">=</span> <span class="variable">sockaddr_in</span><span class="operator">(</span><span class="variable">$port</span><span class="operator">,</span> <span class="variable">$dest_ip</span><span class="operator">);</span>
    
    <span class="keyword">socket</span>  <span class="operator">(</span><span class="variable">S</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">AF_INET</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">SOCK_STREAM</span><span class="operator">,</span> <span class="number">0</span><span class="operator">)</span>  <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"socket: $!"</span><span class="operator">;</span>
    <span class="keyword">connect</span> <span class="operator">(</span><span class="variable">S</span><span class="operator">,</span> <span class="variable">$dest_serv_params</span><span class="operator">)</span>          <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"connect: $!"</span><span class="operator">;</span>
    <span class="keyword">select</span>  <span class="operator">(</span><span class="variable">S</span><span class="operator">);</span> <span class="variable">$|</span> <span class="operator">=</span> <span class="number">1</span><span class="operator">;</span> <span class="keyword">select</span> <span class="operator">(</span><span class="variable">STDOUT</span><span class="operator">);</span>   <span class="comment"># Eliminate STDIO buffering</span>
    
    <span class="comment"># The network connection is now open, lets fire up SSL</span>
    
    <span class="variable">$ctx</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_new</span><span class="operator">()</span> <span class="keyword">or</span> <span class="variable">die_now</span><span class="operator">(</span><span class="string">"Failed to create SSL_CTX $!"</span><span class="operator">);</span>
    <span class="variable">Net::SSLeay::CTX_set_options</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">Net::SSLeay::OP_ALL</span><span class="operator">)</span>
         <span class="keyword">or</span> <span class="variable">die_if_ssl_error</span><span class="operator">(</span><span class="string">"ssl ctx set options"</span><span class="operator">);</span>
    <span class="variable">$ssl</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::new</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">)</span> <span class="keyword">or</span> <span class="variable">die_now</span><span class="operator">(</span><span class="string">"Failed to create SSL $!"</span><span class="operator">);</span>
    <span class="variable">Net::SSLeay::set_fd</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="keyword">fileno</span><span class="operator">(</span><span class="variable">S</span><span class="operator">));</span>   <span class="comment"># Must use fileno</span>
    <span class="variable">$res</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::connect</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">)</span> <span class="keyword">and</span> <span class="variable">die_if_ssl_error</span><span class="operator">(</span><span class="string">"ssl connect"</span><span class="operator">);</span>
    <span class="keyword">print</span> <span class="string">"Cipher `"</span> <span class="operator">.</span> <span class="variable">Net::SSLeay::get_cipher</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">)</span> <span class="operator">.</span> <span class="string">"'\n"</span><span class="operator">;</span>
    
    <span class="comment"># Exchange data</span>
    
    <span class="variable">$res</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::write</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$msg</span><span class="operator">);</span>  <span class="comment"># Perl knows how long $msg is</span>
    <span class="variable">die_if_ssl_error</span><span class="operator">(</span><span class="string">"ssl write"</span><span class="operator">);</span>
    <span class="variable">CORE::shutdown</span> <span class="variable">S</span><span class="operator">,</span> <span class="number">1</span><span class="operator">;</span>  <span class="comment"># Half close --&gt; No more output, sends EOF to server</span>
    <span class="variable">$got</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::read</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>         <span class="comment"># Perl returns undef on failure</span>
    <span class="variable">die_if_ssl_error</span><span class="operator">(</span><span class="string">"ssl read"</span><span class="operator">);</span>
    <span class="keyword">print</span> <span class="variable">$got</span><span class="operator">;</span>
    
    <span class="variable">Net::SSLeay::free</span> <span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>               <span class="comment"># Tear down connection</span>
    <span class="variable">Net::SSLeay::CTX_free</span> <span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
    <span class="keyword">close</span> <span class="variable">S</span><span class="operator">;</span>
</code></code></pre>

<p>The following is a simple SSLeay echo server (non forking):</p>

<pre><code><code>    <span class="comment">#!/usr/bin/perl -w</span>
    <span class="keyword">use</span> <span class="variable">Socket</span><span class="operator">;</span>
    <span class="keyword">use</span> <span class="variable">Net::SSLeay</span> <span class="string">qw(die_now die_if_ssl_error)</span><span class="operator">;</span>
    <span class="variable">Net::SSLeay::load_error_strings</span><span class="operator">();</span>
    <span class="variable">Net::SSLeay::SSLeay_add_ssl_algorithms</span><span class="operator">();</span>
    <span class="variable">Net::SSLeay::randomize</span><span class="operator">();</span>
    
    <span class="variable">$our_ip</span> <span class="operator">=</span> <span class="string">"\0\0\0\0"</span><span class="operator">;</span> <span class="comment"># Bind to all interfaces</span>
    <span class="variable">$port</span> <span class="operator">=</span> <span class="number">1235</span><span class="operator">;</span>
    <span class="variable">$sockaddr_template</span> <span class="operator">=</span> <span class="string">'S n a4 x8'</span><span class="operator">;</span>
    <span class="variable">$our_serv_params</span> <span class="operator">=</span> <span class="keyword">pack</span> <span class="operator">(</span><span class="variable">$sockaddr_template</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">AF_INET</span><span class="operator">,</span> <span class="variable">$port</span><span class="operator">,</span> <span class="variable">$our_ip</span><span class="operator">);</span>
    
    <span class="keyword">socket</span> <span class="operator">(</span><span class="variable">S</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">AF_INET</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">SOCK_STREAM</span><span class="operator">,</span> <span class="number">0</span><span class="operator">)</span>  <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"socket: $!"</span><span class="operator">;</span>
    <span class="keyword">bind</span> <span class="operator">(</span><span class="variable">S</span><span class="operator">,</span> <span class="variable">$our_serv_params</span><span class="operator">)</span>             <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"bind:   $!"</span><span class="operator">;</span>
    <span class="keyword">listen</span> <span class="operator">(</span><span class="variable">S</span><span class="operator">,</span> <span class="number">5</span><span class="operator">)</span>                          <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"listen: $!"</span><span class="operator">;</span>
    <span class="variable">$ctx</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_new</span> <span class="operator">()</span>         <span class="keyword">or</span> <span class="variable">die_now</span><span class="operator">(</span><span class="string">"CTX_new (</span><span class="variable">$ctx</span><span class="string">): $!"</span><span class="operator">);</span>
    <span class="variable">Net::SSLeay::CTX_set_options</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">Net::SSLeay::OP_ALL</span><span class="operator">)</span>
         <span class="keyword">or</span> <span class="variable">die_if_ssl_error</span><span class="operator">(</span><span class="string">"ssl ctx set options"</span><span class="operator">);</span>
    
    <span class="comment"># Following will ask password unless private key is not encrypted</span>
    <span class="variable">Net::SSLeay::CTX_use_RSAPrivateKey_file</span> <span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="string">'plain-rsa.pem'</span><span class="operator">,</span>
                                             <span class="operator">&amp;</span><span class="variable">Net::SSLeay::FILETYPE_PEM</span><span class="operator">);</span>
    <span class="variable">die_if_ssl_error</span><span class="operator">(</span><span class="string">"private key"</span><span class="operator">);</span>
    <span class="variable">Net::SSLeay::CTX_use_certificate_file</span> <span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="string">'plain-cert.pem'</span><span class="operator">,</span>
                                           <span class="operator">&amp;</span><span class="variable">Net::SSLeay::FILETYPE_PEM</span><span class="operator">);</span>
    <span class="variable">die_if_ssl_error</span><span class="operator">(</span><span class="string">"certificate"</span><span class="operator">);</span>
    
    <span class="keyword">while</span> <span class="operator">(</span><span class="number">1</span><span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">print</span> <span class="string">"Accepting connections...\n"</span><span class="operator">;</span>
        <span class="operator">(</span><span class="variable">$addr</span> <span class="operator">=</span> <span class="keyword">accept</span> <span class="operator">(</span><span class="variable">NS</span><span class="operator">,</span> <span class="variable">S</span><span class="operator">))</span>           <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"accept: $!"</span><span class="operator">;</span>
        <span class="keyword">select</span> <span class="operator">(</span><span class="variable">NS</span><span class="operator">);</span> <span class="variable">$|</span> <span class="operator">=</span> <span class="number">1</span><span class="operator">;</span> <span class="keyword">select</span> <span class="operator">(</span><span class="variable">STDOUT</span><span class="operator">);</span>  <span class="comment"># Piping hot!</span>
    
        <span class="operator">(</span><span class="variable">$af</span><span class="operator">,</span><span class="variable">$client_port</span><span class="operator">,</span><span class="variable">$client_ip</span><span class="operator">)</span> <span class="operator">=</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="variable">$sockaddr_template</span><span class="operator">,</span><span class="variable">$addr</span><span class="operator">);</span>
        <span class="variable">@inetaddr</span> <span class="operator">=</span> <span class="keyword">unpack</span><span class="operator">(</span><span class="string">'C4'</span><span class="operator">,</span><span class="variable">$client_ip</span><span class="operator">);</span>
        <span class="keyword">print</span> <span class="string">"</span><span class="variable">$af</span><span class="string"> connection from "</span> <span class="operator">.</span>
        <span class="keyword">join</span> <span class="operator">(</span><span class="string">'.'</span><span class="operator">,</span> <span class="variable">@inetaddr</span><span class="operator">)</span> <span class="operator">.</span> <span class="string">":</span><span class="variable">$client_port</span><span class="string">\n"</span><span class="operator">;</span>
    
        <span class="comment"># We now have a network connection, lets fire up SSLeay...</span>
    
        <span class="variable">$ssl</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::new</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">)</span>      <span class="keyword">or</span> <span class="variable">die_now</span><span class="operator">(</span><span class="string">"SSL_new (</span><span class="variable">$ssl</span><span class="string">): $!"</span><span class="operator">);</span>
        <span class="variable">Net::SSLeay::set_fd</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="keyword">fileno</span><span class="operator">(</span><span class="variable">NS</span><span class="operator">));</span>
    
        <span class="variable">$err</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::accept</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">)</span> <span class="keyword">and</span> <span class="variable">die_if_ssl_error</span><span class="operator">(</span><span class="string">'ssl accept'</span><span class="operator">);</span>
        <span class="keyword">print</span> <span class="string">"Cipher `"</span> <span class="operator">.</span> <span class="variable">Net::SSLeay::get_cipher</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">)</span> <span class="operator">.</span> <span class="string">"'\n"</span><span class="operator">;</span>
    
        <span class="comment"># Connected. Exchange some data.</span>
    
        <span class="variable">$got</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::read</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>     <span class="comment"># Returns undef on fail</span>
        <span class="variable">die_if_ssl_error</span><span class="operator">(</span><span class="string">"ssl read"</span><span class="operator">);</span>
        <span class="keyword">print</span> <span class="string">"Got `</span><span class="variable">$got</span><span class="string">' ("</span> <span class="operator">.</span> <span class="keyword">length</span> <span class="operator">(</span><span class="variable">$got</span><span class="operator">)</span> <span class="operator">.</span> <span class="string">" chars)\n"</span><span class="operator">;</span>
    
        <span class="variable">Net::SSLeay::write</span> <span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="keyword">uc</span> <span class="operator">(</span><span class="variable">$got</span><span class="operator">))</span> <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"write: $!"</span><span class="operator">;</span>
        <span class="variable">die_if_ssl_error</span><span class="operator">(</span><span class="string">"ssl write"</span><span class="operator">);</span>
    
        <span class="variable">Net::SSLeay::free</span> <span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>           <span class="comment"># Tear down connection</span>
        <span class="keyword">close</span> <span class="variable">NS</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>Yet another echo server. This one runs from <code><code>/etc/inetd.conf</code></code> so it avoids all the socket code overhead. Only caveat is opening an rsa key file - it had better be without any encryption or else it will not know where to ask for the password. Note how <code><code>STDIN</code></code> and <code><code>STDOUT</code></code> are wired to SSL.</p>

<pre><code><code>    <span class="comment">#!/usr/bin/perl</span>
    <span class="comment"># /etc/inetd.conf</span>
    <span class="comment">#    ssltst stream tcp nowait root /path/to/server.pl server.pl</span>
    <span class="comment"># /etc/services</span>
    <span class="comment">#    ssltst         1234/tcp</span>
    
    <span class="keyword">use</span> <span class="variable">Net::SSLeay</span> <span class="string">qw(die_now die_if_ssl_error)</span><span class="operator">;</span>
    <span class="variable">Net::SSLeay::load_error_strings</span><span class="operator">();</span>
    <span class="variable">Net::SSLeay::SSLeay_add_ssl_algorithms</span><span class="operator">();</span>
    <span class="variable">Net::SSLeay::randomize</span><span class="operator">();</span>
    
    <span class="keyword">chdir</span> <span class="string">'/key/dir'</span> <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"chdir: $!"</span><span class="operator">;</span>
    <span class="variable">$|</span> <span class="operator">=</span> <span class="number">1</span><span class="operator">;</span>  <span class="comment"># Piping hot!</span>
    <span class="keyword">open</span> <span class="variable">LOG</span><span class="operator">,</span> <span class="string">"&gt;&gt;/dev/console"</span> <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"Can't open log file $!"</span><span class="operator">;</span>
    <span class="keyword">select</span> <span class="variable">LOG</span><span class="operator">;</span> <span class="keyword">print</span> <span class="string">"server.pl started\n"</span><span class="operator">;</span>
    
    <span class="variable">$ctx</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::CTX_new</span><span class="operator">()</span>     <span class="keyword">or</span> <span class="variable">die_now</span> <span class="string">"CTX_new (</span><span class="variable">$ctx</span><span class="string">) ($!)"</span><span class="operator">;</span>
    <span class="variable">$ssl</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::new</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">)</span>     <span class="keyword">or</span> <span class="variable">die_now</span> <span class="string">"new (</span><span class="variable">$ssl</span><span class="string">) ($!)"</span><span class="operator">;</span>
    <span class="variable">Net::SSLeay::set_options</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">Net::SSLeay::OP_ALL</span><span class="operator">)</span>
         <span class="keyword">and</span> <span class="variable">die_if_ssl_error</span><span class="operator">(</span><span class="string">"ssl set options"</span><span class="operator">);</span>
    
    <span class="comment"># We get already open network connection from inetd, now we just</span>
    <span class="comment"># need to attach SSLeay to STDIN and STDOUT</span>
    <span class="variable">Net::SSLeay::set_rfd</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="keyword">fileno</span><span class="operator">(</span><span class="variable">STDIN</span><span class="operator">));</span>
    <span class="variable">Net::SSLeay::set_wfd</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="keyword">fileno</span><span class="operator">(</span><span class="variable">STDOUT</span><span class="operator">));</span>
    
    <span class="variable">Net::SSLeay::use_RSAPrivateKey_file</span> <span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="string">'plain-rsa.pem'</span><span class="operator">,</span>
                                         <span class="variable">Net::SSLeay::FILETYPE_PEM</span><span class="operator">);</span>
    <span class="variable">die_if_ssl_error</span><span class="operator">(</span><span class="string">"private key"</span><span class="operator">);</span>
    <span class="variable">Net::SSLeay::use_certificate_file</span> <span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="string">'plain-cert.pem'</span><span class="operator">,</span>
                                       <span class="variable">Net::SSLeay::FILETYPE_PEM</span><span class="operator">);</span>
    <span class="variable">die_if_ssl_error</span><span class="operator">(</span><span class="string">"certificate"</span><span class="operator">);</span>
    
    <span class="variable">Net::SSLeay::accept</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">)</span> <span class="keyword">and</span> <span class="variable">die_if_ssl_err</span><span class="operator">(</span><span class="string">"ssl accept: $!"</span><span class="operator">);</span>
    <span class="keyword">print</span> <span class="string">"Cipher `"</span> <span class="operator">.</span> <span class="variable">Net::SSLeay::get_cipher</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">)</span> <span class="operator">.</span> <span class="string">"'\n"</span><span class="operator">;</span>
    
    <span class="variable">$got</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::read</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>
    <span class="variable">die_if_ssl_error</span><span class="operator">(</span><span class="string">"ssl read"</span><span class="operator">);</span>
    <span class="keyword">print</span> <span class="string">"Got `</span><span class="variable">$got</span><span class="string">' ("</span> <span class="operator">.</span> <span class="keyword">length</span> <span class="operator">(</span><span class="variable">$got</span><span class="operator">)</span> <span class="operator">.</span> <span class="string">" chars)\n"</span><span class="operator">;</span>
    
    <span class="variable">Net::SSLeay::write</span> <span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="keyword">uc</span><span class="operator">(</span><span class="variable">$got</span><span class="operator">))</span> <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"write: $!"</span><span class="operator">;</span>
    <span class="variable">die_if_ssl_error</span><span class="operator">(</span><span class="string">"ssl write"</span><span class="operator">);</span>
    
    <span class="variable">Net::SSLeay::free</span> <span class="operator">(</span><span class="variable">$ssl</span><span class="operator">);</span>         <span class="comment"># Tear down the connection</span>
    <span class="variable">Net::SSLeay::CTX_free</span> <span class="operator">(</span><span class="variable">$ctx</span><span class="operator">);</span>
    <span class="keyword">close</span> <span class="variable">LOG</span><span class="operator">;</span>
</code></code></pre>

<p>There are also a number of example/test programs in the examples directory:</p>

<pre><code><code>    sslecho.pl   -  A simple server, not unlike the one above
    minicli.pl   -  Implements a client using low level SSLeay routines
    sslcat.pl    -  Demonstrates using high level sslcat utility function
    get_page.pl  -  Is a utility for getting html pages from secure servers
    callback.pl  -  Demonstrates certificate verification and callback usage
    stdio_bulk.pl       - Does SSL over Unix pipes
    ssl-inetd-serv.pl   - SSL server that can be invoked from inetd.conf
    httpd-proxy-snif.pl - Utility that allows you to see how a browser
                          sends https request to given server and what reply
                          it gets back (very educative :-)
    makecert.pl  -  Creates a self signed cert (does not use this module)</code></code></pre>

<h1 id="LIMITATIONS">LIMITATIONS</h1>

<p><code><code>Net::SSLeay::read()</code></code> uses an internal buffer of 32KB, thus no single read will return more. In practice one read returns much less, usually as much as fits in one network packet. To work around this, you should use a loop like this:</p>

<pre><code><code>    <span class="variable">$reply</span> <span class="operator">=</span> <span class="string">''</span><span class="operator">;</span>
    <span class="keyword">while</span> <span class="operator">(</span><span class="variable">$got</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::read</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">))</span> <span class="operator">{</span>
        <span class="keyword">last</span> <span class="keyword">if</span> <span class="variable">print_errs</span><span class="operator">(</span><span class="string">'SSL_read'</span><span class="operator">);</span>
        <span class="variable">$reply</span> <span class="operator">.=</span> <span class="variable">$got</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></code></pre>

<p>Although there is no built-in limit in <code><code>Net::SSLeay::write()</code></code>, the network packet size limitation applies here as well, thus use:</p>

<pre><code><code>    <span class="variable">$written</span> <span class="operator">=</span> <span class="number">0</span><span class="operator">;</span>
    
    <span class="keyword">while</span> <span class="operator">(</span><span class="variable">$written</span> <span class="operator">&lt;</span> <span class="keyword">length</span><span class="operator">(</span><span class="variable">$message</span><span class="operator">))</span> <span class="operator">{</span>
        <span class="variable">$written</span> <span class="operator">+=</span> <span class="variable">Net::SSLeay::write</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="keyword">substr</span><span class="operator">(</span><span class="variable">$message</span><span class="operator">,</span> <span class="variable">$written</span><span class="operator">));</span>
        <span class="keyword">last</span> <span class="keyword">if</span> <span class="variable">print_errs</span><span class="operator">(</span><span class="string">'SSL_write'</span><span class="operator">);</span>
    <span class="operator">}</span>
</code></code></pre>

<p>Or alternatively you can just use the following convenience functions:</p>

<pre><code><code>    <span class="variable">Net::SSLeay::ssl_write_all</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">,</span> <span class="variable">$message</span><span class="operator">)</span> <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"ssl write failure"</span><span class="operator">;</span>
    <span class="variable">$got</span> <span class="operator">=</span> <span class="variable">Net::SSLeay::ssl_read_all</span><span class="operator">(</span><span class="variable">$ssl</span><span class="operator">)</span> <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"ssl read failure"</span><span class="operator">;</span>
</code></code></pre>

<h1 id="KNOWN-BUGS-AND-CAVEATS">KNOWN BUGS AND CAVEATS</h1>

<p>Autoloader emits a</p>

<pre><code><code>    Argument &quot;xxx&quot; isn&#39;t numeric in entersub at blib/lib/Net/SSLeay.pm&#39;</code></code></pre>

<p>warning if die_if_ssl_error is made autoloadable. If you figure out why, drop me a line.</p>

<p>Callback set using <code><code>SSL_set_verify()</code></code> does not appear to work. This may well be an openssl problem (e.g. see <code><code>ssl/ssl_lib.c</code></code> line 1029). Try using <code><code>SSL_CTX_set_verify()</code></code> instead and do not be surprised if even this stops working in future versions.</p>

<p>Callback and certificate verification stuff is generally too little tested.</p>

<p>Random numbers are not initialized randomly enough, especially if you do not have <code><code>/dev/random</code></code> and/or <code><code>/dev/urandom</code></code> (such as in Solaris platforms - but it&#39;s been suggested that cryptorand daemon from the SUNski package solves this). In this case you should investigate third party software that can emulate these devices, e.g. by way of a named pipe to some program.</p>

<p>Another gotcha with random number initialization is randomness depletion. This phenomenon, which has been extensively discussed in OpenSSL, Apache-SSL, and Apache-mod_ssl forums, can cause your script to block if you use <code><code>/dev/random</code></code> or to operate insecurely if you use <code><code>/dev/urandom</code></code>. What happens is that when too much randomness is drawn from the operating system&#39;s randomness pool then randomness can temporarily be unavailable. <code><code>/dev/random</code></code> solves this problem by waiting until enough randomness can be gathered - and this can take a long time since blocking reduces activity in the machine and less activity provides less random events: a vicious circle. <code><code>/dev/urandom</code></code> solves this dilemma more pragmatically by simply returning predictable &quot;random&quot; numbers. Some<code><code> /dev/urandom</code></code> emulation software however actually seems to implement <code><code>/dev/random</code></code> semantics. Caveat emptor.</p>

<p>I&#39;ve been pointed to two such daemons by Mik Firestone &lt;mik@@speed.stdio._com&gt; who has used them on Solaris 8:</p>

<ol>

<li><p>Entropy Gathering Daemon (EGD) at <a href="http://www.lothar.com/tech/crypto/">http://www.lothar.com/tech/crypto/</a></p>

</li>
<li><p>Pseudo-random number generating daemon (PRNGD) at <a href="http://www.aet.tu-cottbus.de/personen/jaenicke/postfix_tls/prngd.html">http://www.aet.tu-cottbus.de/personen/jaenicke/postfix_tls/prngd.html</a></p>

</li>
</ol>

<p>If you are using the low level API functions to communicate with other SSL implementations, you would do well to call</p>

<pre><code><code>    <span class="variable">Net::SSLeay::CTX_set_options</span><span class="operator">(</span><span class="variable">$ctx</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">Net::SSLeay::OP_ALL</span><span class="operator">)</span>
         <span class="keyword">or</span> <span class="variable">die_if_ssl_error</span><span class="operator">(</span><span class="string">"ssl ctx set options"</span><span class="operator">);</span>
</code></code></pre>

<p>to cope with some well know bugs in some other SSL implementations. The high level API functions always set all known compatibility options.</p>

<p>Sometimes <code><code>sslcat()</code></code> (and the high level HTTPS functions that build on it) is too fast in signaling the EOF to legacy HTTPS servers. This causes the server to return empty page. To work around this problem you can set the global variable</p>

<pre><code><code>    <span class="variable">$Net::SSLeay::slowly</span> <span class="operator">=</span> <span class="number">1</span><span class="operator">;</span>   <span class="comment"># Add sleep so broken servers can keep up</span>
</code></code></pre>

<p>HTTP/1.1 is not supported. Specifically this module does not know to issue or serve multiple http requests per connection. This is a serious shortcoming, but using the SSL session cache on your server helps to alleviate the CPU load somewhat.</p>

<p>As of version 1.09 many newer OpenSSL auxiliary functions were added (from <code><code>REM_AUTOMATICALLY_GENERATED_1_09</code></code> onwards in <code><code>SSLeay.xs</code></code>). Unfortunately I have not had any opportunity to test these. Some of them are trivial enough that I believe they &quot;just work&quot;, but others have rather complex interfaces with function pointers and all. In these cases you should proceed wit great caution.</p>

<p>This module defaults to using OpenSSL automatic protocol negotiation code for automatically detecting the version of the SSL protocol that the other end talks. With most web servers this works just fine, but once in a while I get complaints from people that the module does not work with some web servers. Usually this can be solved by explicitly setting the protocol version, e.g.</p>

<pre><code><code>   <span class="variable">$Net::SSLeay::ssl_version</span> <span class="operator">=</span> <span class="number">2</span><span class="operator">;</span>  <span class="comment"># Insist on SSLv2</span>
   <span class="variable">$Net::SSLeay::ssl_version</span> <span class="operator">=</span> <span class="number">3</span><span class="operator">;</span>  <span class="comment"># Insist on SSLv3</span>
   <span class="variable">$Net::SSLeay::ssl_version</span> <span class="operator">=</span> <span class="number">10</span><span class="operator">;</span> <span class="comment"># Insist on TLSv1</span>
</code></code></pre>

<p>Although the autonegotiation is nice to have, the SSL standards do not formally specify any such mechanism. Most of the world has accepted the SSLeay/OpenSSL way of doing it as the de facto standard. But for the few that think differently, you have to explicitly speak the correct version. This is not really a bug, but rather a deficiency in the standards. If a site refuses to respond or sends back some nonsensical error codes (at the SSL handshake level), try this option before mailing me.</p>

<p>On some systems, OpenSSL may be compiled without support for SSLv2. If this is the case, Net::SSLeay will warn if ssl_version has been set to 2.</p>

<p>The high level API returns the certificate of the peer, thus allowing one to check what certificate was supplied. However, you will only be able to check the certificate after the fact, i.e. you already sent your form data by the time you find out that you did not trust them, oops.</p>

<p>So, while being able to know the certificate after the fact is surely useful, the security minded would still choose to do the connection and certificate verification first and only then exchange data with the site. Currently none of the high level API functions do this, thus you would have to program it using the low level API. A good place to start is to see how the <code><code>Net::SSLeay::http_cat()</code></code> function is implemented.</p>

<p>The high level API functions use a global file handle <code><code>SSLCAT_S</code></code> internally. This really should not be a problem because there is no way to interleave the high level API functions, unless you use threads (but threads are not very well supported in perl anyway (as of version 5.6.1). However, you may run into problems if you call undocumented internal functions in an interleaved fashion. The best solution is to &quot;require Net::SSLeay&quot; in one thread after all the threads have been created.</p>

<h1 id="DIAGNOSTICS">DIAGNOSTICS</h1>

<dl>

<dt id="Random-number-generator-not-seeded-">Random number generator not seeded!!!</dt>
<dd>

<p><b>(W)</b> This warning indicates that <code><code>randomize()</code></code> was not able to read <code><code>/dev/random</code></code> or <code><code>/dev/urandom</code></code>, possibly because your system does not have them or they are differently named. You can still use SSL, but the encryption will not be as strong.</p>

</dd>
<dt id="open_tcp_connection:-destination-host-not-found:-server-port-123-">open_tcp_connection: destination host not found:`server&#39; (port 123) ($!)</dt>
<dd>

<p>Name lookup for host named <code><code>server</code></code> failed.</p>

</dd>
<dt id="open_tcp_connection:-failed-server-123-">open_tcp_connection: failed `server&#39;, 123 ($!)</dt>
<dd>

<p>The name was resolved, but establishing the TCP connection failed.</p>

</dd>
<dt id="msg-123:-1---error:140770F8:SSL-routines:SSL23_GET_SERVER_HELLO:unknown-proto">msg 123: 1 - error:140770F8:SSL routines:SSL23_GET_SERVER_HELLO:unknown proto</dt>
<dd>

<p>SSLeay error string. The first number (123) is the PID, the second number (1) indicates the position of the error message in SSLeay error stack. You often see a pile of these messages as errors cascade.</p>

</dd>
<dt id="msg-123:-1---error:02001002::lib-2-:func-1-:reason-2-">msg 123: 1 - error:02001002::lib(2) :func(1) :reason(2)</dt>
<dd>

<p>The same as above, but you didn&#39;t call load_error_strings() so SSLeay couldn&#39;t verbosely explain the error. You can still find out what it means with this command:</p>

<pre><code><code>    /usr/local/ssl/bin/ssleay errstr 02001002</code></code></pre>

</dd>
<dt id="Password-is-being-asked-for-private-key">Password is being asked for private key</dt>
<dd>

<p>This is normal behaviour if your private key is encrypted. Either you have to supply the password or you have to use an unencrypted private key. Scan OpenSSL.org for the FAQ that explains how to do this (or just study examples/makecert.pl which is used during <code><code>make test</code></code> to do just that).</p>

</dd>
</dl>

<h1 id="SECURITY">SECURITY</h1>

<p>You can mitigate some of the security vulnerabilites that might be present in your SSL/TLS application:</p>

<h2 id="BEAST-Attack">BEAST Attack</h2>

<p>http://blogs.cisco.com/security/beat-the-beast-with-tls/ https://community.qualys.com/blogs/securitylabs/2011/10/17/mitigating-the-beast-attack-on-tls http://blog.zoller.lu/2011/09/beast-summary-tls-cbc-countermeasures.html</p>

<p>The BEAST attack relies on a weakness in the way CBC mode is used in SSL/TLS. In OpenSSL versions 0.9.6d and later, the protocol-level mitigation is enabled by default, thus making it not vulnerable to the BEAST attack.</p>

<p>Solutions:</p>

<ul>

<li><p>Compile with OpenSSL versions 0.9.6d or later, which enables SSL_OP_ALL by default</p>

</li>
<li><p>Ensure SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS is not enabled (its not enabled by default)</p>

</li>
<li><p>Dont support SSLv2, SSLv3</p>

</li>
<li><p>Actively control the ciphers your server supports with set_cipher_list:</p>

</li>
</ul>

<p>Net::SSLeay::set_cipher_list($ssl, &#39;RC4-SHA:HIGH:!ADH&#39;);</p>

<h2 id="Session-Resumption">Session Resumption</h2>

<p>http://www.openssl.org/docs/ssl/SSL_CTX_set_options.html</p>

<p>The SSL Labs vulnerability test on your SSL server might report in red:</p>

<p>Session resumption No (IDs assigned but not accepted)</p>

<p>This report is not really bug or a vulnerability, since the server will not accept session resumption requests. However, you can prevent this noise in the report by disabling the session cache altogether: Net::SSLeay::CTX_set_session_cache_mode($ssl_ctx, 0);</p>

<h2 id="Secure-Renegotiation-and-DoS-Attack">Secure Renegotiation and DoS Attack</h2>

<p>https://community.qualys.com/blogs/securitylabs/2011/10/31/tls-renegotiation-and-denial-of-service-attacks</p>

<p>This is not a &quot;security flaw,&quot; it is more of a DoS vulnerability.</p>

<p>Solutions:</p>

<ul>

<li><p>Do not support SSLv2</p>

</li>
<li><p>Do not set the SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION option</p>

</li>
<li><p>Compile with OpenSSL 0.9.8m or later</p>

</li>
</ul>

<h1 id="BUGS-AND-SUPPORT">BUGS AND SUPPORT</h1>

<p>Please report any bugs or feature requests to <code><code>bug-Net-SSLeay at rt.cpan.org</code></code>, or through the web interface at <a href="http://rt.cpan.org/Public/Dist/Display.html?Name=Net-SSLeay">http://rt.cpan.org/Public/Dist/Display.html?Name=Net-SSLeay</a>. I will be notified, and then you&#39;ll automatically be notified of progress on your bug as I make changes.</p>

<p>Subversion access to the latest source code etc can be obtained at <a href="http://alioth.debian.org/projects/net-ssleay">http://alioth.debian.org/projects/net-ssleay</a></p>

<p>The developer mailing list (for people interested in contributing to the source code) can be found at <a href="http://lists.alioth.debian.org/mailman/listinfo/net-ssleay-devel">http://lists.alioth.debian.org/mailman/listinfo/net-ssleay-devel</a></p>

<p>You can find documentation for this module with the <code><code>perldoc</code></code> command.</p>

<pre><code><code>    perldoc Net::SSLeay</code></code></pre>

<p>You can also look for information at:</p>

<ul>

<li><p>AnnoCPAN: Annotated CPAN documentation</p>

<p><a href="http://annocpan.org/dist/Net-SSLeay">http://annocpan.org/dist/Net-SSLeay</a></p>

</li>
<li><p>CPAN Ratings</p>

<p><a href="http://cpanratings.perl.org/d/Net-SSLeay">http://cpanratings.perl.org/d/Net-SSLeay</a></p>

</li>
<li><p>Search CPAN</p>

<p><a href="http://search.cpan.org/dist/Net-SSLeay">http://search.cpan.org/dist/Net-SSLeay</a></p>

</li>
</ul>

<p>Commercial support for Net::SSLeay may be obtained from</p>

<pre><code><code>   Symlabs (netssleay@symlabs.com)
   Tel: +351-214.222.630
   Fax: +351-214.222.637</code></code></pre>

<h1 id="AUTHOR">AUTHOR</h1>

<p>Maintained by Mike McCauley and Florian Ragwitz since November 2005</p>

<p>Originally written by Sampo Kellom&auml;ki &lt;sampo@symlabs.com&gt;</p>

<h1 id="COPYRIGHT">COPYRIGHT</h1>

<p>Copyright (c) 1996-2003 Sampo Kellom&auml;ki &lt;sampo@symlabs.com&gt;</p>

<p>Copyright (C) 2005-2006 Florian Ragwitz &lt;rafl@debian.org&gt;</p>

<p>Copyright (C) 2005 Mike McCauley &lt;mikem@open.com.au&gt;</p>

<p>All Rights Reserved.</p>

<p>Distribution and use of this module is under the same terms as the OpenSSL package itself (i.e. free, but mandatory attribution; NO WARRANTY). Please consult LICENSE file in the root of the OpenSSL distribution.</p>

<p>While the source distribution of this perl module does not contain Eric&#39;s or OpenSSL&#39;s code, if you use this module you will use OpenSSL library. Please give Eric and OpenSSL team credit (as required by their licenses).</p>

<p>And remember, you, and nobody else but you, are responsible for auditing this module and OpenSSL library for security problems, backdoors, and general suitability for your application.</p>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<pre><code><code>  Net::SSLeay::Handle                      - File handle interface
  ./examples                               - Example servers and a clients
  &lt;http://www.openssl.org/&gt;                - OpenSSL source, documentation, etc
  openssl-users-request@openssl.org        - General OpenSSL mailing list
  &lt;http://www.ietf.org/rfc/rfc2246.txt&gt;    - TLS 1.0 specification
  &lt;http://www.w3c.org&gt;                     - HTTP specifications
  &lt;http://www.ietf.org/rfc/rfc2617.txt&gt;    - How to send password
  &lt;http://www.lothar.com/tech/crypto/&gt;     - Entropy Gathering Daemon (EGD)
  &lt;http://www.aet.tu-cottbus.de/personen/jaenicke/postfix_tls/prngd.html&gt;
                           - pseudo-random number generating daemon (PRNGD)
  perl(1)
  perlref(1)
  perllol(1)
  perldoc ~openssl/doc/ssl/SSL_CTX_set_verify.pod</code></code></pre>


</body>

</html>


